---
title: Kapitel 3 – funktionella komponenter i Azure återställnings tider NetX Duo
description: Det här kapitlet innehåller en beskrivning av den högpresterande Azure återställnings tider NetX Duo TCP/IP-stacken från ett funktionellt perspektiv.
author: philmea
ms.author: philmea
ms.date: 05/19/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 31900c7b822c88079e4b9fe28a8a388d20f819aa
ms.sourcegitcommit: 60ad844b58639d88830f2660ab0c4ff86b92c10f
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 04/07/2021
ms.locfileid: "106549852"
---
# <a name="chapter-3---functional-components-of-azure-rtos-netx-duo"></a><span data-ttu-id="deb40-103">Kapitel 3 – funktionella komponenter i Azure återställnings tider NetX Duo</span><span class="sxs-lookup"><span data-stu-id="deb40-103">Chapter 3 - Functional Components of Azure RTOS NetX Duo</span></span>

<span data-ttu-id="deb40-104">Det här kapitlet innehåller en beskrivning av den högpresterande Azure återställnings tider NetX Duo TCP/IP-stacken från ett funktionellt perspektiv.</span><span class="sxs-lookup"><span data-stu-id="deb40-104">This chapter contains a description of the high- performance Azure RTOS NetX Duo TCP/IP stack from a functional perspective.</span></span> 

## <a name="execution-overview"></a><span data-ttu-id="deb40-105">Översikt över körning</span><span class="sxs-lookup"><span data-stu-id="deb40-105">Execution Overview</span></span>

<span data-ttu-id="deb40-106">Det finns fem typer av program körningar i ett NetX Duo-program: initiering, program gränssnitts anrop, intern IP-tråd, periodiska timers och nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="deb40-106">There are five types of program execution within a NetX Duo application: initialization, application interface calls, internal IP thread, IP periodic timers, and the network driver.</span></span>

> [!NOTE]
> <span data-ttu-id="deb40-107">*NetX Duo förutsätter att det finns ThreadX och beror på dess tråd körning, upphängning, periodiska timers och ömsesidiga undantags funktioner.*</span><span class="sxs-lookup"><span data-stu-id="deb40-107">*NetX Duo assumes the existence of ThreadX and depends on its thread execution, suspension, periodic timers, and mutual exclusion facilities.*</span></span>

### <a name="initialization"></a><span data-ttu-id="deb40-108">Initiering</span><span class="sxs-lookup"><span data-stu-id="deb40-108">Initialization</span></span>

<span data-ttu-id="deb40-109">Tjänsten \***nx_system_initialize** _ måste anropas innan någon annan netx Duo-tjänst anropas.</span><span class="sxs-lookup"><span data-stu-id="deb40-109">The service \***nx_system_initialize** _ must be called before any other NetX Duo service is called.</span></span> <span data-ttu-id="deb40-110">System initiering kan anropas antingen från ThreadX _ *_tx_application_define_*\* Function eller from Application threads.</span><span class="sxs-lookup"><span data-stu-id="deb40-110">System initialization can be called either from the ThreadX _ *_tx_application_define_*\* function or from application threads.</span></span>

<span data-ttu-id="deb40-111">Efter \***nx_system_initialize** _ returnerar, är systemet redo att skapa paket pooler och IP-instanser.</span><span class="sxs-lookup"><span data-stu-id="deb40-111">After \***nx_system_initialize** _ returns, the system is ready to create packet pools and IP instances.</span></span> <span data-ttu-id="deb40-112">Eftersom det krävs en standardpool för att skapa en IP-instans måste minst en NetX Duo-paket finnas innan du skapar en IP-instans.</span><span class="sxs-lookup"><span data-stu-id="deb40-112">Because creating an IP instance requires a default packet pool, at least one NetX Duo packet pool must exist prior to creating an IP instance.</span></span> <span data-ttu-id="deb40-113">Det går att skapa paket pooler och IP-instanser från initierings funktionen ThreadX _ *_tx_application_define_*\* och från program trådar.</span><span class="sxs-lookup"><span data-stu-id="deb40-113">Creating packet pools and IP instances are allowed from the ThreadX initialization function _ *_tx_application_define_*\* and from application threads.</span></span>

<span data-ttu-id="deb40-114">Internt skapas en IP-instans i två delar: den första delen görs inom kontexten för anroparen, antingen från ***tx_application_define*** eller från en program tråds kontext.</span><span class="sxs-lookup"><span data-stu-id="deb40-114">Internally, creating an IP instance is accomplished in two parts: The first part is done within the context of the caller, either from ***tx_application_define*** or from an application thread's context.</span></span> <span data-ttu-id="deb40-115">Detta innefattar att konfigurera IP-datastrukturen och skapa olika IP-resurser, inklusive den interna IP-tråden.</span><span class="sxs-lookup"><span data-stu-id="deb40-115">This includes setting up the IP data structure and creating various IP resources, including the internal IP thread.</span></span> <span data-ttu-id="deb40-116">Den andra delen utförs vid den första körningen från den interna IP-tråden.</span><span class="sxs-lookup"><span data-stu-id="deb40-116">The second part is performed during the initial execution from the internal IP thread.</span></span> <span data-ttu-id="deb40-117">Det är här som nätverks driv rutinen, som angavs under den första delen av IP-skapandet, först anropas.</span><span class="sxs-lookup"><span data-stu-id="deb40-117">This is where the network driver, supplied during the first part of IP creation, is first called.</span></span> <span data-ttu-id="deb40-118">Genom att anropa nätverks driv rutinen från den interna IP-tråden kan driv rutinen utföra I/O och pausa under initierings bearbetningen.</span><span class="sxs-lookup"><span data-stu-id="deb40-118">Calling the network driver from the internal IP thread enables the driver to perform I/O and suspend during its initialization processing.</span></span>

<span data-ttu-id="deb40-119">När nätverks driv rutinen återgår från initierings processen slutförs IP-skapandet.</span><span class="sxs-lookup"><span data-stu-id="deb40-119">When the network driver returns from its initialization processing, the IP creation is complete.</span></span>

<span data-ttu-id="deb40-120">Initiering av IPv6 i NetX Duo kräver ytterligare NetX Duo-tjänster.</span><span class="sxs-lookup"><span data-stu-id="deb40-120">Initialization of IPv6 in NetX Duo requires a few additional NetX Duo services.</span></span> <span data-ttu-id="deb40-121">Dessa beskrivs mer detaljerat i avsnittet [IPv6 i netx Duo](#ipv6-in-netx-duo) senare i det här kapitlet.</span><span class="sxs-lookup"><span data-stu-id="deb40-121">These are described in greater detail in the section [IPv6 in NetX Duo](#ipv6-in-netx-duo) later in this chapter.</span></span>

> [!NOTE]
> <span data-ttu-id="deb40-122">*NetX Duo-tjänsten **nx_ip_status_check** finns tillgänglig för att hämta information om IP-instansen och dess primära gränssnitts status. Sådan statusinformation innehåller om länken är initierad, aktive rad och IP-adressen är löst. Den här informationen används för att synkronisera program trådar som behöver använda en nyligen skapad IP-instans. För multihome-system, se [stöd för multihome](#multihome-support). **nx_ip_interface_status_check** finns tillgängligt för att hämta 3information på det angivna gränssnittet.*</span><span class="sxs-lookup"><span data-stu-id="deb40-122">*The NetX Duo service **nx_ip_status_check** is available to obtain information on the IP instance and its primary interface status. Such status information includes whether or not the link is initialized, enabled and IP address is resolved. This information is used to synchronize application threads needing to use a newly created IP instance. For multihome systems, see [Multihome Support](#multihome-support). **nx_ip_interface_status_check** is available to obtain 3information on the specified interface.*</span></span>

### <a name="application-interface-calls"></a><span data-ttu-id="deb40-123">Program gränssnitts anrop</span><span class="sxs-lookup"><span data-stu-id="deb40-123">Application Interface Calls</span></span>

<span data-ttu-id="deb40-124">Anrop från programmet görs i stort sett från program trådar som körs under ThreadX-återställnings tider.</span><span class="sxs-lookup"><span data-stu-id="deb40-124">Calls from the application are largely made from application threads running under the ThreadX RTOS.</span></span> <span data-ttu-id="deb40-125">Vissa initierings-, Create-och enable-tjänster kan dock anropas från ***tx_application_define***.</span><span class="sxs-lookup"><span data-stu-id="deb40-125">However, some initialization, create, and enable services may be called from ***tx_application_define***.</span></span> <span data-ttu-id="deb40-126">I avsnitten "tillåtet från" i [kapitel 4 – Beskrivning av Azure återställnings tider netx Duo-tjänsterna](chapter4.md) anges från vilka varje netx Duo-tjänst kan anropas.</span><span class="sxs-lookup"><span data-stu-id="deb40-126">The "Allowed From" sections in [Chapter 4 - Description of Azure RTOS NetX Duo Services](chapter4.md) indicate from which each NetX Duo service can be called.</span></span>

<span data-ttu-id="deb40-127">För det mesta görs bearbetningen av intensiva aktiviteter, till exempel beräknings kontroll summor i den anropande trådens kontext, utan att blockera åtkomsten till andra trådar till IP-instansen.</span><span class="sxs-lookup"><span data-stu-id="deb40-127">For the most part, processing intensive activities such as computing checksums is done within the calling thread's context—without blocking access of other threads to the IP instance.</span></span> <span data-ttu-id="deb40-128">Vid överföring utförs exempelvis beräkningen av UDP-kontrollsumma i \***nx_udp_socket_send** _-tjänsten innan den underliggande IP-Send-funktionen anropas.</span><span class="sxs-lookup"><span data-stu-id="deb40-128">For example, on transmission, the UDP checksum calculation is performed inside the \***nx_udp_socket_send** _ service, prior to calling the underlying IP send function.</span></span> <span data-ttu-id="deb40-129">På ett mottaget paket beräknas UDP-kontrollsummaet i mappen _ *_nx_udp_socket_receive_*\* som körs i program tråden.</span><span class="sxs-lookup"><span data-stu-id="deb40-129">On a received packet, the UDP checksum is calculated in the _ *_nx_udp_socket_receive_*\* service, executed in the  of the application thread.</span></span> <span data-ttu-id="deb40-130">Detta bidrar till att förhindra att nätverks begär Anden med högre prioritet kan stoppas på grund av bearbetning av intensiv beräkning av kontroll summa i trådar med lägre prioritet.</span><span class="sxs-lookup"><span data-stu-id="deb40-130">This helps prevent stalling network requests of higher-priority threads because of processing intensive checksum computation in lower-priority threads.</span></span>

<span data-ttu-id="deb40-131">Värden, till exempel IP-adresser och port nummer, skickas till API: er i värdens byte ordning.</span><span class="sxs-lookup"><span data-stu-id="deb40-131">Values, such as IP addresses and port numbers, are passed to APIs in host byte order.</span></span> <span data-ttu-id="deb40-132">Internt lagras dessa värden i värdens byte-ordning.</span><span class="sxs-lookup"><span data-stu-id="deb40-132">Internally these values are stored in host byte order as well.</span></span> <span data-ttu-id="deb40-133">På så sätt kan utvecklare enkelt visa värdena via en fel sökare.</span><span class="sxs-lookup"><span data-stu-id="deb40-133">This allows developers to easily view the values via a debugger.</span></span> <span data-ttu-id="deb40-134">När dessa värden är programmerade i en ram för överföring, konverteras de till byte ordning för nätverk.</span><span class="sxs-lookup"><span data-stu-id="deb40-134">When these values are programmed into a frame for transmission, they are converted to network byte order.</span></span>

### <a name="internal-ip-thread"></a><span data-ttu-id="deb40-135">Intern IP-tråd</span><span class="sxs-lookup"><span data-stu-id="deb40-135">Internal IP Thread</span></span>

<span data-ttu-id="deb40-136">Som nämnts har varje IP-instans i NetX Duo en egen tråd.</span><span class="sxs-lookup"><span data-stu-id="deb40-136">As mentioned, each IP instance in NetX Duo has its own thread.</span></span> <span data-ttu-id="deb40-137">Prioriteten och stack storleken för den interna IP-tråden definieras i ***nx_ip_creates*** tjänsten.</span><span class="sxs-lookup"><span data-stu-id="deb40-137">The priority and stack size of the internal IP thread is defined in the ***nx_ip_create*** service.</span></span> <span data-ttu-id="deb40-138">Den interna IP-tråden skapas i ett läge som är klart att köras.</span><span class="sxs-lookup"><span data-stu-id="deb40-138">The internal IP thread is created in a ready-to-execute mode.</span></span> <span data-ttu-id="deb40-139">Om IP-tråden har högre prioritet än den anropande tråden kan avstängningen uppstå i IP-Create-anropet.</span><span class="sxs-lookup"><span data-stu-id="deb40-139">If the IP thread has a higher priority than the calling thread, preemption may occur inside the IP create call.</span></span>

<span data-ttu-id="deb40-140">Start punkten för den interna IP-tråden är i den interna funktionen _ ***nx_ip_thread_entry***.</span><span class="sxs-lookup"><span data-stu-id="deb40-140">The entry point of the internal IP thread is at the internal function _ ***nx_ip_thread_entry***.</span></span> <span data-ttu-id="deb40-141">När den interna IP-tråden startas slutförs först nätverks driv Rutinens initiering, som består av tre anrop till den programspecifika nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="deb40-141">When started, the internal IP thread first completes network driver initialization, which consists of making three calls to the application-specific network driver.</span></span> <span data-ttu-id="deb40-142">Det första anropet är att koppla nätverks driv rutinen till IP-instansen, följt av ett initierings anrop, vilket gör att nätverks driv rutinen kan gå igenom initierings processen.</span><span class="sxs-lookup"><span data-stu-id="deb40-142">The first call is to attach the network driver to the IP instance, followed by an initialization call, which allows the network driver to go through the initialization process.</span></span> <span data-ttu-id="deb40-143">När nätverks driv rutinen har returnerat från initieringen (den kan stoppas under väntan på att maskin varan ska konfigureras korrekt), anropar den interna IP-tråden nätverks driv rutinen igen för att aktivera länken.</span><span class="sxs-lookup"><span data-stu-id="deb40-143">After the network driver returns from initialization (it may suspend while waiting for the hardware to be properly set up), the internal IP thread calls the network driver again to enable the link.</span></span> <span data-ttu-id="deb40-144">När nätverks driv rutinen har returnerat från länken Aktivera anrop, anger den interna IP-tråden en oändlig loop-kontroll för olika händelser som behöver bearbetas för den här IP-instansen.</span><span class="sxs-lookup"><span data-stu-id="deb40-144">After the network driver returns from the link enable call, the internal IP thread enters a forever loop checking for various events that need processing for this IP instance.</span></span> <span data-ttu-id="deb40-145">Händelser som bearbetas i den här slingan är inskjuten mottagning av IP-paket, sammansättning av IP-paket, ICMP-Ping-bearbetning, IGMP-bearbetning, bearbetning av TCP-paketfiltrering, TCP-periodisk bearbetning, timeout för IP-fragment och IGMP-periodisk bearbetning.</span><span class="sxs-lookup"><span data-stu-id="deb40-145">Events processed in this loop include deferred IP packet reception, IP packet fragment assembly, ICMP ping processing, IGMP processing, TCP packet queue processing, TCP periodic processing, IP fragment assembly timeouts, and IGMP periodic processing.</span></span> <span data-ttu-id="deb40-146">Händelser omfattar även adress matchnings aktiviteter. Bearbetning av ARP-paket och regelbunden ARP-bearbetning i IPv4, dubblettidentifiering, router-inbjudningar och identifiering av grannar i IPv6.</span><span class="sxs-lookup"><span data-stu-id="deb40-146">Events also include address resolution activities; ARP packet processing and ARP periodic processing in IPv4, Duplicate Address Detection, Router Solicitation, and Neighbor Discovery in IPv6.</span></span>

> [!CAUTION]
> <span data-ttu-id="deb40-147">*NetX Duo-callback-funktionerna, inklusive lyssnings-och från kopplings-motanrop, anropas från den interna IP-tråden, inte den ursprungliga anropande tråden. Programmet måste ta hand om att inte pausa i någon NetX Duo-callback-funktion.*</span><span class="sxs-lookup"><span data-stu-id="deb40-147">*The NetX Duo callback functions, including listen and disconnect callbacks, are called from the internal IP thread—not the original calling thread. The application must take care not to suspend inside any NetX Duo callback function.*</span></span>

### <a name="ip-periodic-timers"></a><span data-ttu-id="deb40-148">Periodiska timers för IP</span><span class="sxs-lookup"><span data-stu-id="deb40-148">IP Periodic Timers</span></span>

<span data-ttu-id="deb40-149">Det finns två ThreadX-periodiska timers som används för varje IP-instans.</span><span class="sxs-lookup"><span data-stu-id="deb40-149">There are two ThreadX periodic timers used for each IP instance.</span></span> <span data-ttu-id="deb40-150">Den första är en eng-Second-timer för ARP, IGMP, TCP-tidsgräns och den också bearbetar ommonteringen av IP-fragment.</span><span class="sxs-lookup"><span data-stu-id="deb40-150">The first one is a one-second timer for ARP, IGMP, TCP timeout, and it also drives IP fragment reassemble processing.</span></span> <span data-ttu-id="deb40-151">Den andra timern är en 100 MS-timer för att köra timeout för TCP-överföring och IPv6-relaterade åtgärder.</span><span class="sxs-lookup"><span data-stu-id="deb40-151">The second timer is a 100ms timer to drive the TCP retransmission timeout and IPv6-related operations.</span></span>

### <a name="network-driver"></a><span data-ttu-id="deb40-152">Nätverks driv rutin</span><span class="sxs-lookup"><span data-stu-id="deb40-152">Network Driver</span></span>

<span data-ttu-id="deb40-153">Varje IP-instans i NetX Duo har ett primärt gränssnitt som identifieras av den driv rutin som anges i ***nx_ip_creates*** tjänsten.</span><span class="sxs-lookup"><span data-stu-id="deb40-153">Each IP instance in NetX Duo has a primary interface, which is identified by its device driver specified in the ***nx_ip_create*** service.</span></span> <span data-ttu-id="deb40-154">Nätverks driv rutinen ansvarar för hantering av olika NetX Duo-begäranden, inklusive paket överföring, paket mottagning och förfrågningar om status och kontroll.</span><span class="sxs-lookup"><span data-stu-id="deb40-154">The network driver is responsible for handling various NetX Duo requests, including packet transmission, packet reception, and requests for status and control.</span></span> 

<span data-ttu-id="deb40-155">För ett multi-Home-system har IP-instansen flera gränssnitt, var och en med en associerad nätverks driv rutin som utför dessa uppgifter för respektive gränssnitt.</span><span class="sxs-lookup"><span data-stu-id="deb40-155">For a multi-home system, the IP instance has multiple interfaces, each with an associated network driver that performs these tasks for the respective interface.</span></span>

<span data-ttu-id="deb40-156">Nätverks driv rutinen måste också hantera asynkrona händelser som inträffar på mediet.</span><span class="sxs-lookup"><span data-stu-id="deb40-156">The network driver must also handle asynchronous events occurring on the media.</span></span> <span data-ttu-id="deb40-157">Asynkrona händelser från mediet omfattar paket mottagning, slut för ande av paket överföring och status ändringar.</span><span class="sxs-lookup"><span data-stu-id="deb40-157">Asynchronous events from the media include packet reception, packet transmission completion, and status changes.</span></span> <span data-ttu-id="deb40-158">NetX Duo tillhandahåller nätverks driv rutinen med flera åtkomst funktioner för att hantera olika händelser.</span><span class="sxs-lookup"><span data-stu-id="deb40-158">NetX Duo provides the network driver with several access functions to handle various events.</span></span> <span data-ttu-id="deb40-159">Dessa funktioner är utformade för att anropas från Interrupt Service Routine delen av nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="deb40-159">These functions are designed to be called from the  interrupt service routine portion of the network driver.</span></span> <span data-ttu-id="deb40-160">För IPv4-nätverk bör nätverks driv rutinen vidarebefordra alla ARP-paket som tas emot till den ***_nx_arp_packet_deferred_receive*** interna funktionen.</span><span class="sxs-lookup"><span data-stu-id="deb40-160">For IPv4 networks, the network driver should forward all ARP packets received to the ***_nx_arp_packet_deferred_receive*** internal function.</span></span> <span data-ttu-id="deb40-161">Alla RARP-paket ska vidarebefordras till \***_nx_rarp_packet_deferred_receive** _ intern funktion.</span><span class="sxs-lookup"><span data-stu-id="deb40-161">All RARP packets should be forwarded to \***_nx_rarp_packet_deferred_receive** _ internal function.</span></span> <span data-ttu-id="deb40-162">Det finns två alternativ för IP-paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-162">There are two options for IP packets.</span></span> <span data-ttu-id="deb40-163">Om snabb sändning av IP-paket krävs ska inkommande IP-paket vidarebefordras till _ *_ _nx_ip_packet_receive_* _ för omedelbar bearbetning.</span><span class="sxs-lookup"><span data-stu-id="deb40-163">If fast dispatch of IP packets is required, incoming IP packets should be forwarded to _ *_ _nx_ip_packet_receive_* _ for immediate processing.</span></span> <span data-ttu-id="deb40-164">Detta förbättrar prestandan för NetX Duo i hantering av IP-paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-164">This greatly improves NetX Duo performance in handling IP packets.</span></span> <span data-ttu-id="deb40-165">Annars bör vidarebefordrande IP-paket till _ *_ _nx_ip_packet_deferred_receive_*\* göras.</span><span class="sxs-lookup"><span data-stu-id="deb40-165">Otherwise, forwarding IP packets to _ *_ _nx_ip_packet_deferred_receive_*\* should be done.</span></span> <span data-ttu-id="deb40-166">Den här tjänsten placerar IP-paketet i den uppskjutna bearbetnings kön där den hanteras av den interna IP-tråden, vilket resulterar i minst mängden ISR-bearbetnings tid.</span><span class="sxs-lookup"><span data-stu-id="deb40-166">This service places the IP packet in the deferred processing queue where it is then handled by the internal IP thread, which results in the least amount of ISR processing time.</span></span>

<span data-ttu-id="deb40-167">Nätverks driv rutinen kan också skjuta upp avbrott-bearbetningen så att den inte går att använda i kontexten för IP-tråden.</span><span class="sxs-lookup"><span data-stu-id="deb40-167">The network driver can also defer interrupt processing to run out of the context of the IP thread.</span></span> <span data-ttu-id="deb40-168">I det här läget måste ISR Spara nödvändig information, anropa den interna funktionen ***_nx_ip_driver_deferred_processing*** och bekräfta avbrotts styrenheten.</span><span class="sxs-lookup"><span data-stu-id="deb40-168">In this mode, the ISR shall save the necessary information, call the internal function ***_nx_ip_driver_deferred_processing***, and acknowledge the interrupt controller.</span></span> <span data-ttu-id="deb40-169">Den här tjänsten meddelar IP-tråden att schemalägga ett återanrop till enhets driv rutinen för att slutföra processen för händelsen som orsakar avbrottet.</span><span class="sxs-lookup"><span data-stu-id="deb40-169">This service notifies IP thread to schedule a callback to the device driver to complete the process of the event that causes the interrupt.</span></span>

<span data-ttu-id="deb40-170">Vissa nätverks styrenheter kan utföra beräkning och validering av kontroll summa för TCP/IP-huvud i maskin vara, utan att ta upp värdefulla processor resurser.</span><span class="sxs-lookup"><span data-stu-id="deb40-170">Some network controllers are capable of performing TCP/IP header checksum computation and validation in hardware, without taking up valuable CPU resources.</span></span> <span data-ttu-id="deb40-171">För att kunna dra nytta av funktionen för maskin varu kapacitet tillhandahåller NetX Duo alternativ för att aktivera eller inaktivera olika beräkningar av program varu kontroll vid kompilering, samt för att aktivera eller inaktivera beräkning av kontroll Summa vid körning, om enhetens driv rutin kan kommunicera med IP-lagret om är maskin varu funktioner.</span><span class="sxs-lookup"><span data-stu-id="deb40-171">To take advantage of the hardware capability feature, NetX Duo provides options to enable or disable various software checksum computation at compilation time, as well as turning on or off checksum computation at run time, if the device driver is able to communicate with the IP layer about is hardware capabilities.</span></span> <span data-ttu-id="deb40-172">Mer detaljerad information om hur du skriver NetX Duo [-återställnings tider finns i kapitel 5 – Azure netx Duo-nätverks driv rutiner](chapter5.md) .</span><span class="sxs-lookup"><span data-stu-id="deb40-172">See [Chapter 5 - Azure RTOS NetX Duo Network Drivers](chapter5.md) for more detailed information on writing NetX Duo network drivers.</span></span>

### <a name="multihome-support"></a><span data-ttu-id="deb40-173">Support för multihome</span><span class="sxs-lookup"><span data-stu-id="deb40-173">Multihome Support</span></span>

<span data-ttu-id="deb40-174">NetX Duo stöder system som är anslutna till flera fysiska enheter som använder en enda IP-instans.</span><span class="sxs-lookup"><span data-stu-id="deb40-174">NetX Duo supports systems connected to multiple physical devices using a single IP instance.</span></span> <span data-ttu-id="deb40-175">Varje fysiskt gränssnitt tilldelas ett gränssnitts kontroll block i IP-instansen.</span><span class="sxs-lookup"><span data-stu-id="deb40-175">Each physical interface is assigned to an interface control block in the IP instance.</span></span> <span data-ttu-id="deb40-176">Program som vill använda ett hem system måste definiera värdet för \***NX_MAX_PHSYCIAL_INTERFACES** _ till antalet fysiska enheter som är anslutna till systemet och återskapa netx Duo-biblioteket.</span><span class="sxs-lookup"><span data-stu-id="deb40-176">Applications wishing to use a multihome system must define the value for \***NX_MAX_PHSYCIAL_INTERFACES** _ to the number of physical devices attached to the system, and rebuild NetX Duo library.</span></span> <span data-ttu-id="deb40-177">Som standard är _ *_NX_MAX_PHYSICAL_INTERFACES_*\* inställt på ett, vilket skapar ett gränssnitts kontroll block i IP-instansen.</span><span class="sxs-lookup"><span data-stu-id="deb40-177">By default _ *_NX_MAX_PHYSICAL_INTERFACES_*\* is set to one, creating one interface control block in the IP instance.</span></span>

<span data-ttu-id="deb40-178">NetX Duo-programmet skapar en enda IP-instans för den primära enheten med hjälp av tjänsten \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="deb40-178">The NetX Duo application creates a single IP instance for the primary device using the \***nx_ip_create** _ service.</span></span> <span data-ttu-id="deb40-179">För varje ytterligare nätverks enheter ansluter programmet enheten till IP-instansen med hjälp av tjänsten _ \*_nx_ip_interface_attach_\*\*.</span><span class="sxs-lookup"><span data-stu-id="deb40-179">For each additional network devices, the application attaches the device to the IP instance using the _ *_nx_ip_interface_attach_*\* service.</span></span>

<span data-ttu-id="deb40-180">Varje nätverks gränssnitts struktur innehåller en delmängd av nätverksinformation om nätverks gränssnittet som finns i kontroll blocket för IP, inklusive gränssnitts-IPv4-adress, nätmask, IP-MTU-storlek och adress information för MAC-lager.</span><span class="sxs-lookup"><span data-stu-id="deb40-180">Each network interface structure contains a subset of network information about the network interface that is contained in the IP control block, including interface IPv4 address, subnet mask, IP MTU size, and MAC-layer address information.</span></span>

> [!NOTE]
> <span data-ttu-id="deb40-181">*NetX Duo med stöd för multihome är bakåtkompatibel med tidigare versioner av NetX Duo. Tjänster som inte har uttryckligen gränssnitts information som standard till den primära nätverks enheten.*</span><span class="sxs-lookup"><span data-stu-id="deb40-181">*NetX Duo with multihome support is backward compatible with earlier versions of NetX Duo. Services that do not take explicit interface information default to the primary network device.*</span></span>

<span data-ttu-id="deb40-182">Det primära gränssnittet har index noll i listan över IP-instanser.</span><span class="sxs-lookup"><span data-stu-id="deb40-182">The primary interface has index zero in the IP instance list.</span></span> <span data-ttu-id="deb40-183">Varje efterföljande enhet som är kopplad till IP-instansen tilldelas nästa index.</span><span class="sxs-lookup"><span data-stu-id="deb40-183">Each subsequent device attached to the IP instance is assigned the next index.</span></span>

<span data-ttu-id="deb40-184">Alla de övre skikt protokoll tjänsterna för vilka IP-instansen är aktive rad, inklusive TCP, UDP, ICMP och IGMP, är tillgängliga för alla anslutna enheter.</span><span class="sxs-lookup"><span data-stu-id="deb40-184">All upper layer protocol services for which the IP instance is enabled, including TCP, UDP, ICMP, and IGMP, are available to all the attached devices.</span></span>

<span data-ttu-id="deb40-185">I de flesta fall kan NetX Duo avgöra den bästa käll adressen som ska användas vid överföring av ett paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-185">In most cases, NetX Duo can determine the best source address to use when transmitting a packet.</span></span> <span data-ttu-id="deb40-186">Käll adress valet baseras på mål adressen.</span><span class="sxs-lookup"><span data-stu-id="deb40-186">The source address selection is based on the destination address.</span></span> <span data-ttu-id="deb40-187">NetX Duo-tjänster läggs till för att tillåta att program anger en speciell käll adress som ska användas, i de fall där den lämpligaste orsaken inte kan fastställas av mål adressen.</span><span class="sxs-lookup"><span data-stu-id="deb40-187">NetX Duo services are added to allow applications to specify a specific source address to use, in cases where the most suitable one cannot be determined by the destination address.</span></span> <span data-ttu-id="deb40-188">Ett exempel skulle finnas i ett hem system, ett program måste skicka ett paket till en IPv4-broadcast eller multicast-mål adresser.</span><span class="sxs-lookup"><span data-stu-id="deb40-188">An example would be in a multihome system, an application needs to send a packet to an IPv4 broadcast or multicast destination addresses.</span></span>

<span data-ttu-id="deb40-189">Tjänster som är specifika för att utveckla program med fler Hem nätverk är följande:</span><span class="sxs-lookup"><span data-stu-id="deb40-189">Services specifically for developing multihome applications include the following:</span></span>

- <span data-ttu-id="deb40-190">*nx_igmp_multicast_interface_join*</span><span class="sxs-lookup"><span data-stu-id="deb40-190">*nx_igmp_multicast_interface_join*</span></span>
- <span data-ttu-id="deb40-191">*nx_igmp_multicast_interface_leave*</span><span class="sxs-lookup"><span data-stu-id="deb40-191">*nx_igmp_multicast_interface_leave*</span></span>
- <span data-ttu-id="deb40-192">*nx_ip_driver_interface_direct_command*</span><span class="sxs-lookup"><span data-stu-id="deb40-192">*nx_ip_driver_interface_direct_command*</span></span>
- <span data-ttu-id="deb40-193">*nx_ip_interface_address_get*</span><span class="sxs-lookup"><span data-stu-id="deb40-193">*nx_ip_interface_address_get*</span></span>
- <span data-ttu-id="deb40-194">*nx_ip_interface_address_mapping_configure*</span><span class="sxs-lookup"><span data-stu-id="deb40-194">*nx_ip_interface_address_mapping_configure*</span></span>
- <span data-ttu-id="deb40-195">*nx_ip_interface_address_set*</span><span class="sxs-lookup"><span data-stu-id="deb40-195">*nx_ip_interface_address_set*</span></span>  
- <span data-ttu-id="deb40-196">*nx_ip_interface_attach*</span><span class="sxs-lookup"><span data-stu-id="deb40-196">*nx_ip_interface_attach*</span></span>
- <span data-ttu-id="deb40-197">*nx_ip_interface_capability_get*</span><span class="sxs-lookup"><span data-stu-id="deb40-197">*nx_ip_interface_capability_get*</span></span> 
- <span data-ttu-id="deb40-198">*nx_ip_interface_capability_set*</span><span class="sxs-lookup"><span data-stu-id="deb40-198">*nx_ip_interface_capability_set*</span></span>
- <span data-ttu-id="deb40-199">*nx_ip_interface_detach*</span><span class="sxs-lookup"><span data-stu-id="deb40-199">*nx_ip_interface_detach*</span></span>
- <span data-ttu-id="deb40-200">*nx_ip_interface_info_get*</span><span class="sxs-lookup"><span data-stu-id="deb40-200">*nx_ip_interface_info_get*</span></span>
- <span data-ttu-id="deb40-201">*nx_ip_interface_mtu_set*</span><span class="sxs-lookup"><span data-stu-id="deb40-201">*nx_ip_interface_mtu_set*</span></span>
- <span data-ttu-id="deb40-202">*nx_ip_interface_physical_address_get*</span><span class="sxs-lookup"><span data-stu-id="deb40-202">*nx_ip_interface_physical_address_get*</span></span>
- <span data-ttu-id="deb40-203">*nx_ip_interface_physical_address_set*</span><span class="sxs-lookup"><span data-stu-id="deb40-203">*nx_ip_interface_physical_address_set*</span></span>
- <span data-ttu-id="deb40-204">*nx_ip_interface_status_check*</span><span class="sxs-lookup"><span data-stu-id="deb40-204">*nx_ip_interface_status_check*</span></span>
- <span data-ttu-id="deb40-205">*nx_ip_raw_packet_source_send*</span><span class="sxs-lookup"><span data-stu-id="deb40-205">*nx_ip_raw_packet_source_send*</span></span>
- <span data-ttu-id="deb40-206">*nx_ipv4_multicast_interface_join*</span><span class="sxs-lookup"><span data-stu-id="deb40-206">*nx_ipv4_multicast_interface_join*</span></span>
- <span data-ttu-id="deb40-207">*nx_ipv4_multicast_interface_leave*</span><span class="sxs-lookup"><span data-stu-id="deb40-207">*nx_ipv4_multicast_interface_leave*</span></span>
- <span data-ttu-id="deb40-208">*nx_udp_socket_source_send*</span><span class="sxs-lookup"><span data-stu-id="deb40-208">*nx_udp_socket_source_send*</span></span>
- <span data-ttu-id="deb40-209">*nxd_ipv6_multicast_interface_join*</span><span class="sxs-lookup"><span data-stu-id="deb40-209">*nxd_ipv6_multicast_interface_join*</span></span>
- <span data-ttu-id="deb40-210">*nxd_ipv6_multicast_interface_leave*</span><span class="sxs-lookup"><span data-stu-id="deb40-210">*nxd_ipv6_multicast_interface_leave*</span></span> 
- <span data-ttu-id="deb40-211">*nxd_udp_socket_source_send*</span><span class="sxs-lookup"><span data-stu-id="deb40-211">*nxd_udp_socket_source_send*</span></span>
- <span data-ttu-id="deb40-212">*nxd_icmp_source_ping*</span><span class="sxs-lookup"><span data-stu-id="deb40-212">*nxd_icmp_source_ping*</span></span>
- <span data-ttu-id="deb40-213">*nxd_ip_raw_packet_source_send*</span><span class="sxs-lookup"><span data-stu-id="deb40-213">*nxd_ip_raw_packet_source_send*</span></span>
- <span data-ttu-id="deb40-214">*nxd_udp_socket_source_send*</span><span class="sxs-lookup"><span data-stu-id="deb40-214">*nxd_udp_socket_source_send*</span></span>

<span data-ttu-id="deb40-215">Dessa tjänster förklaras mer detaljerat i [beskrivningen av netx Duo-tjänster](chapter4.md).</span><span class="sxs-lookup"><span data-stu-id="deb40-215">These services are explained in greater detail in [Description of NetX Duo Services](chapter4.md).</span></span>

### <a name="loopback-interface"></a><span data-ttu-id="deb40-216">Loopback-gränssnitt</span><span class="sxs-lookup"><span data-stu-id="deb40-216">Loopback Interface</span></span>

<span data-ttu-id="deb40-217">Loopback-gränssnittet är ett särskilt nätverks gränssnitt utan en fysisk länk som är kopplad till.</span><span class="sxs-lookup"><span data-stu-id="deb40-217">The loopback interface is a special network interface without an physical link attached to.</span></span> <span data-ttu-id="deb40-218">Loopback-gränssnittet gör att program kan kommunicera med IPv4 loopback-adressen 127.0.0.1 för att använda ett logiskt loopback-gränssnitt, se till att det konfigurerbara alternativet ***NX_DISABLE_LOOPBACK_INTERFACE*** inte har angetts.</span><span class="sxs-lookup"><span data-stu-id="deb40-218">The loopback interface allows applications to communicate using the IPv4 loopback address 127.0.0.1 To utilize a logical loopback interface, ensure the configurable option ***NX_DISABLE_LOOPBACK_INTERFACE*** is not set.</span></span>

### <a name="interface-control-blocks"></a><span data-ttu-id="deb40-219">Gränssnitts kontroll block</span><span class="sxs-lookup"><span data-stu-id="deb40-219">Interface Control Blocks</span></span>

<span data-ttu-id="deb40-220">Antalet gränssnitts kontroll block i IP-instansen är antalet fysiska gränssnitt (definieras med \***NX_MAX_PHYSICAL_INTERFACES** _) plus loopback-gränssnittet om det är aktiverat.</span><span class="sxs-lookup"><span data-stu-id="deb40-220">The number of interface control blocks in the IP instance is the number of physical interfaces (defined by \***NX_MAX_PHYSICAL_INTERFACES** _) plus the loopback interface if it is enabled.</span></span> <span data-ttu-id="deb40-221">Det totala antalet gränssnitt definieras i _ *_NX_MAX_IP_INTERFACES_* \*.</span><span class="sxs-lookup"><span data-stu-id="deb40-221">The total number of interfaces is defined in _\*_NX_MAX_IP_INTERFACES_\*\*.</span></span>

## <a name="protocol-layering"></a><span data-ttu-id="deb40-222">Protokoll skikt</span><span class="sxs-lookup"><span data-stu-id="deb40-222">Protocol Layering</span></span>

<span data-ttu-id="deb40-223">TCP/IP som implementeras av NetX Duo är ett lager protokoll, vilket innebär att mer komplexa protokoll skapas ovanpå enklare underliggande protokoll.</span><span class="sxs-lookup"><span data-stu-id="deb40-223">The TCP/IP implemented by NetX Duo is a layered protocol, which means more complex protocols are built on top of simpler underlying protocols.</span></span> <span data-ttu-id="deb40-224">I TCP/IP finns det lägsta skikt protokollet på *länk nivån* och hanteras av nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="deb40-224">In TCP/IP, the lowest layer protocol is at the *link level* and is handled by the network driver.</span></span> <span data-ttu-id="deb40-225">Den här nivån är normalt riktad mot Ethernet, men det kan också vara fiber, seriellt eller praktiskt taget valfritt fysiskt medium.</span><span class="sxs-lookup"><span data-stu-id="deb40-225">This level is typically targeted towards Ethernet, but it could also be fiber, serial, or virtually any physical media.</span></span>

<span data-ttu-id="deb40-226">Ovanpå länk skiktet finns *nätverks skiktet*.</span><span class="sxs-lookup"><span data-stu-id="deb40-226">On top of the link layer is the *network layer*.</span></span> <span data-ttu-id="deb40-227">I TCP/IP är detta IP-adressen, som i princip ansvarar för att skicka och ta emot enkla paket – på bästa möjliga sätt – över nätverket.</span><span class="sxs-lookup"><span data-stu-id="deb40-227">In TCP/IP, this is the IP, which is basically responsible for sending and receiving simple packets—in a best-effort manner—across the network.</span></span> <span data-ttu-id="deb40-228">Hanterings typ protokoll som ICMP och IGMP kategoriseras vanligt vis som nätverks lager, även om de förlitar sig på IP för att skicka och ta emot.</span><span class="sxs-lookup"><span data-stu-id="deb40-228">Management-type protocols like ICMP and IGMP are typically also categorized as network layers, even though they rely on IP for sending and receiving.</span></span>

<span data-ttu-id="deb40-229">*Transport lagret* vilar ovanpå nätverks nivån.</span><span class="sxs-lookup"><span data-stu-id="deb40-229">The *transport layer* rests on top of the network layer.</span></span> <span data-ttu-id="deb40-230">Det här lagret ansvarar för att hantera data flödet mellan värdar i nätverket.</span><span class="sxs-lookup"><span data-stu-id="deb40-230">This layer is responsible for managing the flow of data between hosts on the network.</span></span> <span data-ttu-id="deb40-231">Det finns två typer av transport tjänster som stöds av NetX Duo: UDP och TCP.</span><span class="sxs-lookup"><span data-stu-id="deb40-231">There are two types of transport services supported by NetX Duo: UDP and TCP.</span></span> <span data-ttu-id="deb40-232">UDP-tjänsterna ger dig bästa möjliga sändning och mottagning av data mellan två värdar på ett anslutnings effektivt sätt, medan TCP tillhandahåller Reliable anslutningsorienterade tjänster mellan två värd enheter.</span><span class="sxs-lookup"><span data-stu-id="deb40-232">UDP services provide best-effort sending and receiving of data between two hosts in a connectionless manner, while TCP provides reliable connection-oriented service between two host entities.</span></span>

<span data-ttu-id="deb40-233">Skiktning visas i de faktiska nätverks data paketen.</span><span class="sxs-lookup"><span data-stu-id="deb40-233">This layering is reflected in the actual network data packets.</span></span> <span data-ttu-id="deb40-234">Varje lager i TCP/IP innehåller ett block med information som kallas rubrik.</span><span class="sxs-lookup"><span data-stu-id="deb40-234">Each layer in TCP/IP contains a block of information called a header.</span></span> <span data-ttu-id="deb40-235">Den här metoden för omgivande data (och eventuellt protokoll information) med en rubrik kallas vanligt vis för data inkapsling.</span><span class="sxs-lookup"><span data-stu-id="deb40-235">This technique of surrounding data (and possibly protocol information) with a header is typically called data encapsulation.</span></span> <span data-ttu-id="deb40-236">Bild 1 visar ett exempel på NetX Duo-lager och bild 2 visar den resulterande data inkapslingen för UDP-data som skickas.</span><span class="sxs-lookup"><span data-stu-id="deb40-236">Figure 1 shows an example of NetX Duo layering and Figure 2 shows the resulting data encapsulation for UDP data being sent.</span></span>

![Protokoll skikt](./media/user-guide/image12.jpg)

<span data-ttu-id="deb40-238">**BILD 1. Protokoll skikt**</span><span class="sxs-lookup"><span data-stu-id="deb40-238">**FIGURE 1. Protocol Layering**</span></span>

## <a name="packet-pools"></a><span data-ttu-id="deb40-239">Paket pooler</span><span class="sxs-lookup"><span data-stu-id="deb40-239">Packet Pools</span></span>

<span data-ttu-id="deb40-240">Att allokera paket på ett snabbt och entydigt sätt är alltid en utmaning i real tids nätverks program.</span><span class="sxs-lookup"><span data-stu-id="deb40-240">Allocating packets in a fast and deterministic manner is always a challenge in real-time networking applications.</span></span> <span data-ttu-id="deb40-241">Med detta i åtanke ger NetX Duo möjlighet att skapa och hantera flera pooler med nätverks paket med fast storlek.</span><span class="sxs-lookup"><span data-stu-id="deb40-241">With this in mind, NetX Duo provides the ability to create and manage multiple pools of fixed-size network packets.</span></span>

<span data-ttu-id="deb40-242">Eftersom NetX Duo-paket består av minnes block med fast storlek, finns det aldrig några interna fragmenterings problem.</span><span class="sxs-lookup"><span data-stu-id="deb40-242">Because NetX Duo packet pools consist of fixed-size memory blocks, there are never any internal fragmentation problems.</span></span> <span data-ttu-id="deb40-243">Fragmenteringen orsakar naturligtvis att beteendet är icke deterministiskt.</span><span class="sxs-lookup"><span data-stu-id="deb40-243">Of course, fragmentation causes behavior that is inherently nondeterministic.</span></span> <span data-ttu-id="deb40-244">Dessutom är tiden som krävs för att allokera och frigöra ett NetX Duo-paket med en enkel hantering av länkade listor.</span><span class="sxs-lookup"><span data-stu-id="deb40-244">In addition, the time required to allocate and free a NetX Duo packet amounts to simple linked-list manipulation.</span></span> <span data-ttu-id="deb40-245">Paket tilldelningen och avallokeringen görs dessutom på huvud sidan i listan över tillgängliga.</span><span class="sxs-lookup"><span data-stu-id="deb40-245">Furthermore, packet allocation and deallocation is done at the head of the available list.</span></span> <span data-ttu-id="deb40-246">Detta ger snabbast möjlig länkad List bearbetning.</span><span class="sxs-lookup"><span data-stu-id="deb40-246">This provides the fastest possible linked list processing.</span></span>

![UDP-inkapsling](./media/user-guide/image13.png)

<span data-ttu-id="deb40-248">**BILD 2. UDP-inkapsling**</span><span class="sxs-lookup"><span data-stu-id="deb40-248">**FIGURE 2. UDP Data Encapsulation**</span></span>

<span data-ttu-id="deb40-249">Brist på flexibilitet är vanligt vis den huvudsakliga nack delen med paket med fast storlek.</span><span class="sxs-lookup"><span data-stu-id="deb40-249">Lack of flexibility is typically the main drawback of fixed-size packet pools.</span></span> <span data-ttu-id="deb40-250">Att fastställa den optimala paket nytto Last storleken som även hanterar det värsta inkommande paketet är en svår uppgift.</span><span class="sxs-lookup"><span data-stu-id="deb40-250">Determining the optimal packet payload size that also handles the worst-case incoming packet is a difficult task.</span></span> <span data-ttu-id="deb40-251">NetX Duo-paketen löser det här problemet med en valfri funktion som kallas paket länkning.</span><span class="sxs-lookup"><span data-stu-id="deb40-251">NetX Duo packets address this problem with an optional feature called packet chaining.</span></span> <span data-ttu-id="deb40-252">Ett faktiskt nätverks paket kan skapas för en eller flera NetX Duo-paket som länkas samman.</span><span class="sxs-lookup"><span data-stu-id="deb40-252">An actual network packet can be made of one or more NetX Duo packets linked together.</span></span> <span data-ttu-id="deb40-253">Dessutom upprätthåller paket huvudet en pekare överst i paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-253">In addition, the packet header maintains a pointer to the top of the packet.</span></span> <span data-ttu-id="deb40-254">När ytterligare protokoll läggs till flyttas den här pekaren bara baklänges och det nya sidhuvudet skrivs direkt framför data.</span><span class="sxs-lookup"><span data-stu-id="deb40-254">As additional protocols are added, this pointer is simply moved backwards and the new header is written directly in front of the data.</span></span> <span data-ttu-id="deb40-255">Utan flexibel paket teknik skulle stacken behöva allokera en annan buffert och kopiera data till en ny buffert med det nya sidhuvudet, vilket är bearbetnings intensiv.</span><span class="sxs-lookup"><span data-stu-id="deb40-255">Without the flexible packet technology, the stack would have to allocate another buffer and copy the data into a new buffer with the new header, which is processing intensive.</span></span>

<span data-ttu-id="deb40-256">Eftersom varje paket nytto Last har åtgärd ATS för en viss modempool, kräver program data som är större än nytto Last storleken flera paket sammankopplade.</span><span class="sxs-lookup"><span data-stu-id="deb40-256">Since each packet payload size is fixed for a given packet pool, application data larger than the payload size would require multiple packets chained together.</span></span> <span data-ttu-id="deb40-257">När ett paket fylls med användar data, ska programmet använda tjänsten ***nx_packet_data_append***.</span><span class="sxs-lookup"><span data-stu-id="deb40-257">When filling a packet with user data, the application shall use the service ***nx_packet_data_append***.</span></span> <span data-ttu-id="deb40-258">Den här tjänsten flyttar program data till ett paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-258">This service moves application data into a packet.</span></span> <span data-ttu-id="deb40-259">I situationer där ett paket inte är tillräckligt för att lagra användar data allokeras ytterligare paket för att lagra användar data.</span><span class="sxs-lookup"><span data-stu-id="deb40-259">In situations where a packet is not enough to hold user data, additional packets are allocated to store user data.</span></span> <span data-ttu-id="deb40-260">Om du vill använda paket länkning måste driv rutinen kunna ta emot eller överföra från kedjade paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-260">To use packet chaining, the driver must be able to receive into or transmit from chained packets.</span></span>

<span data-ttu-id="deb40-261">För inbäddade system som inte behöver använda funktionen paket länkning kan NetX Duo-biblioteket skapas med \***NX_DISABLE_PACKET_CHAIN** _ för att ta bort paket länknings logiken.</span><span class="sxs-lookup"><span data-stu-id="deb40-261">For embedded systems that do not need to use the packet chaining feature, the NetX Duo library can be built with \***NX_DISABLE_PACKET_CHAIN** _ to remove the packet chaining logic.</span></span> <span data-ttu-id="deb40-262">Observera att funktionen för att komma åt IP-fragment och omsammansättning kan behöva använda funktionen för kedjade paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-262">Note that the IP fragmentation and reassembly feature may need to utilize the chained packet feature.</span></span> <span data-ttu-id="deb40-263">Därför krävs _ *_NX_DISABLE_FRAGMENTATION_*\* även för att definiera _*_NX_DISABLE_PACKET_CHAIN_*_ .</span><span class="sxs-lookup"><span data-stu-id="deb40-263">Therefore defining _*_NX_DISABLE_PACKET_CHAIN_*_ requires _ *_NX_DISABLE_FRAGMENTATION_*\* also be defined.</span></span> 

<span data-ttu-id="deb40-264">Varje NetX Duo Packet-pool är en offentlig resurs.</span><span class="sxs-lookup"><span data-stu-id="deb40-264">Each NetX Duo packet memory pool is a public resource.</span></span> <span data-ttu-id="deb40-265">NetX Duo placerar inga begränsningar för hur paket pooler används.</span><span class="sxs-lookup"><span data-stu-id="deb40-265">NetX Duo places no constraints on how packet pools are used.</span></span> 

### <a name="packet-pool-memory-area"></a><span data-ttu-id="deb40-266">Minnes området för paket pool</span><span class="sxs-lookup"><span data-stu-id="deb40-266">Packet Pool Memory Area</span></span>

<span data-ttu-id="deb40-267">Minnes området för Packet-poolen anges när den skapas.</span><span class="sxs-lookup"><span data-stu-id="deb40-267">The memory area for the packet pool is specified during creation.</span></span> <span data-ttu-id="deb40-268">Precis som andra minnes områden för ThreadX-och NetX Duo-objekt kan det finnas var som helst i målets adress utrymme.</span><span class="sxs-lookup"><span data-stu-id="deb40-268">Like other memory areas for ThreadX and NetX Duo objects, it can be located anywhere in the target's address space.</span></span> 

<span data-ttu-id="deb40-269">Detta är en viktig funktion på grund av den stora flexibiliteten ger programmet.</span><span class="sxs-lookup"><span data-stu-id="deb40-269">This is an important feature because of the considerable flexibility it gives the application.</span></span> <span data-ttu-id="deb40-270">Anta till exempel att en kommunikations produkt har ett höghastighets minnes utrymme för nätverks buffertar.</span><span class="sxs-lookup"><span data-stu-id="deb40-270">For example, suppose that a communication product has a high-speed memory area for network buffers.</span></span> <span data-ttu-id="deb40-271">Det här minnes området används enkelt genom att göra det till en NetX Duo-paketets minnes uppsättning.</span><span class="sxs-lookup"><span data-stu-id="deb40-271">This memory area is easily utilized by making it into a NetX Duo packet memory pool.</span></span>

### <a name="creating-packet-pools"></a><span data-ttu-id="deb40-272">Skapa paket pooler</span><span class="sxs-lookup"><span data-stu-id="deb40-272">Creating Packet Pools</span></span>

<span data-ttu-id="deb40-273">Paket pooler skapas antingen under initieringen eller under körningen av program trådar.</span><span class="sxs-lookup"><span data-stu-id="deb40-273">Packet pools are created either during initialization or during runtime by  application threads.</span></span> <span data-ttu-id="deb40-274">Det finns inga begränsningar för antalet paket minnes pooler i ett NetX Duo-program.</span><span class="sxs-lookup"><span data-stu-id="deb40-274">There are no limits on the number of packet memory pools in a NetX Duo application.</span></span>

### <a name="dual-packet-pool"></a><span data-ttu-id="deb40-275">Pool med dubbla paket</span><span class="sxs-lookup"><span data-stu-id="deb40-275">Dual Packet Pool</span></span>

<span data-ttu-id="deb40-276">Normalt är nytto Last storleken för standardpoolen för IP-paket tillräckligt stor för att rymma ram storleken upp till nätverks gränssnittets MTU.</span><span class="sxs-lookup"><span data-stu-id="deb40-276">Typically the payload size of the default IP packet pool is large enough to accommodate frame size up to the network interface MTU.</span></span> <span data-ttu-id="deb40-277">Under normal drift måste IP-tråden skicka meddelanden som ARP, TCP-kontrollmeddelanden, IGMP-meddelanden och ICMPv6-meddelanden.</span><span class="sxs-lookup"><span data-stu-id="deb40-277">During normal operation, the IP thread needs to send messages such as ARP, TCP control messages, IGMP messages, ICMPv6 messages.</span></span> <span data-ttu-id="deb40-278">Dessa meddelanden använder de paket som tilldelas från standard paketets pool i IP-instansen.</span><span class="sxs-lookup"><span data-stu-id="deb40-278">These messages use the packets allocated from the default packet pool in the IP instance.</span></span> <span data-ttu-id="deb40-279">På ett minnes begränsat system där mängden minne som är tillgängligt för Packet-poolen är begränsad, är det inte säkert att du använder en enda adresspool (med stor nytto Last storlek som matchar MTU-storleken).</span><span class="sxs-lookup"><span data-stu-id="deb40-279">On a memory-constrained system where the amount of memory available for packet pool is limited, using a single packet pool (with the large payload size to match MTU size) may not be an optimal solution.</span></span> <span data-ttu-id="deb40-280">NetX Duo gör det möjligt för program att installera en tilläggs paket pool, där nytto Last storleken är mindre.</span><span class="sxs-lookup"><span data-stu-id="deb40-280">NetX Duo allows application to install an auxiliary packet pool, where the payload size is smaller.</span></span> <span data-ttu-id="deb40-281">När tilläggs paketets pool har installerats allokerar IP-hjälp-tråden paket från antingen standardpoolen eller tilläggs poolen, beroende på storleken på det meddelande som den överför.</span><span class="sxs-lookup"><span data-stu-id="deb40-281">Once the auxiliary packet pool is installed, the IP helper thread would allocate packets from either the default packet pool or the auxiliary pool, depending on the size of the message it transmits.</span></span> <span data-ttu-id="deb40-282">För en tilläggs paket pool kommer en nytto Last storlek på 200 byte att fungera med de flesta av de meddelanden som IP-hjälpens tråd överför.</span><span class="sxs-lookup"><span data-stu-id="deb40-282">For an auxiliary packet pool, a payload size of 200 bytes would work with most of the messages the IP helper thread transmits.</span></span>

<span data-ttu-id="deb40-283">Som standard har NetX Duo-biblioteket skapats utan att du behöver aktivera Dual Packet-pool.</span><span class="sxs-lookup"><span data-stu-id="deb40-283">By default NetX Duo library is built without enabling dual packet pool.</span></span> <span data-ttu-id="deb40-284">Om du vill aktivera funktionen skapar du biblioteket med \***NX_DUAL_PACKET_POOL_ENABLE** _ definierat.</span><span class="sxs-lookup"><span data-stu-id="deb40-284">To enable the feature, build the library with \***NX_DUAL_PACKET_POOL_ENABLE** _ defined.</span></span> <span data-ttu-id="deb40-285">Sedan kan du ställa in tilläggs paketets pool genom att anropa _ *_nx_ip_auxiliary_packet_pool_set_* \*.</span><span class="sxs-lookup"><span data-stu-id="deb40-285">Then the auxiliary packet pool can be set by calling _\*_nx_ip_auxiliary_packet_pool_set_\*\*.</span></span>

<span data-ttu-id="deb40-286">Det finns också möjlighet att skapa fler än en modempool.</span><span class="sxs-lookup"><span data-stu-id="deb40-286">There is also the option of creating more than one packet pool.</span></span> <span data-ttu-id="deb40-287">Till exempel skapas en pool för överförings paket med optimal nytto Last storlek för förväntade meddelande storlekar.</span><span class="sxs-lookup"><span data-stu-id="deb40-287">For example a transmit packet pool is created with optimal payload size for expected message sizes.</span></span> <span data-ttu-id="deb40-288">En Receive Packet-pool skapas i driv rutinen med en nytto Last storlek som är inställd på driv Rutinens MTU, eftersom det inte går att förutse storleken på mottagna paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-288">A receive packet pool is created in the driver with a payload size set to the driver MTU, since one cannot predict the size of received packets.</span></span>

### <a name="packet-header-nx_packet"></a><span data-ttu-id="deb40-289">Paket huvud NX_PACKET</span><span class="sxs-lookup"><span data-stu-id="deb40-289">Packet Header NX_PACKET</span></span>   
<span data-ttu-id="deb40-290">Som standard placerar NetX Duo paket rubriken omedelbart före paketets nytto Last-sektion.</span><span class="sxs-lookup"><span data-stu-id="deb40-290">By default, NetX Duo places the packet header immediately before the packet payload area.</span></span> <span data-ttu-id="deb40-291">Paketets minnes uppsättning är i princip en serie paket – huvuden som följs omedelbart av paketets nytto Last.</span><span class="sxs-lookup"><span data-stu-id="deb40-291">The packet memory pool is basically a series of packets— headers followed immediately by the packet payload.</span></span> <span data-ttu-id="deb40-292">Paket huvudet (***NX_PACKET***) och poolens layout visas i bild 3.</span><span class="sxs-lookup"><span data-stu-id="deb40-292">The packet header (***NX_PACKET***) and the layout of the packet pool are pictured in Figure 3.</span></span>

<span data-ttu-id="deb40-293">För nätverks enhets driv rutin som kan utföra kostnads kopierings åtgärder är vanligt vis start adressen för paketets nytto Last i DMA-logiken.</span><span class="sxs-lookup"><span data-stu-id="deb40-293">For network devices driver that are able to perform zero copy operations, typically the starting address of the packet payload area is programmed into the DMA logic.</span></span> <span data-ttu-id="deb40-294">Vissa DMA-motorer har justerings krav på nytto lasts ytan.</span><span class="sxs-lookup"><span data-stu-id="deb40-294">Certain DMA engines have alignment requirement on the payload area.</span></span> <span data-ttu-id="deb40-295">Om du vill att start adressen för nytto lastområdet ska justeras korrekt för DMA-motorn eller cache-åtgärden kan användaren definiera symbol ***NX_PACKET_ALIGNMENT***.</span><span class="sxs-lookup"><span data-stu-id="deb40-295">To make the starting address of the payload area align properly for the DMA engine, or the cache operation, the user can define the symbol ***NX_PACKET_ALIGNMENT***.</span></span>

> [!WARNING]
> <span data-ttu-id="deb40-296">*Det är viktigt att nätverks driv rutinen använder funktionen **nx_packet_transmit_release** när överföringen av ett paket har slutförts. Den här funktionen kontrollerar att paketet inte ingår i en kö för TCP-utdata innan den faktiskt placeras i den tillgängliga poolen.*</span><span class="sxs-lookup"><span data-stu-id="deb40-296">*It is important for the network driver to use the **nx_packet_transmit_release** function when transmission of a packet is complete. This function checks to make sure the packet is not part of a TCP output queue before it is actually placed back in the available pool.*</span></span>

![Layout för paket huvud och adresspool](./media/user-guide/image14.jpg)

<span data-ttu-id="deb40-298">**BILD 3. Layout för paket huvud och adresspool**</span><span class="sxs-lookup"><span data-stu-id="deb40-298">**FIGURE 3. Packet Header and Packet Pool Layout**</span></span>

<span data-ttu-id="deb40-299">Fälten i paket rubriken definieras enligt följande.</span><span class="sxs-lookup"><span data-stu-id="deb40-299">The fields of the packet header are defined as follows.</span></span> <span data-ttu-id="deb40-300">Observera att den här tabellen inte är en omfattande lista över alla medlemmar i *NX_PACKETs* strukturen.</span><span class="sxs-lookup"><span data-stu-id="deb40-300">Note that this table is not a comprehensive list of all the members in the *NX_PACKET* structure.</span></span>

|<span data-ttu-id="deb40-301">Paket huvud</span><span class="sxs-lookup"><span data-stu-id="deb40-301">Packet header</span></span> | <span data-ttu-id="deb40-302">Syfte</span><span class="sxs-lookup"><span data-stu-id="deb40-302">Purpose</span></span> |
|---|---|
|<span data-ttu-id="deb40-303">***nx_packet_pool_owner***</span><span class="sxs-lookup"><span data-stu-id="deb40-303">***nx_packet_pool_owner***</span></span>|<span data-ttu-id="deb40-304">Det här fältet pekar på den modempool som äger det aktuella paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-304">This field points to the packet pool that owns this particular packet.</span></span> <span data-ttu-id="deb40-305">När paketet släpps släpps det till den här poolen.</span><span class="sxs-lookup"><span data-stu-id="deb40-305">When the packet is released, it is released to this particular pool.</span></span> <span data-ttu-id="deb40-306">Med poolen ägarskap i varje paket är det möjligt för ett datagram att spänna över flera paket från flera paket pooler.</span><span class="sxs-lookup"><span data-stu-id="deb40-306">With the pool ownership inside each packet, it is possible for a datagram to span multiple packets from multiple packet pools.</span></span>|
|<span data-ttu-id="deb40-307">\***nx_packet_next** _</span><span class="sxs-lookup"><span data-stu-id="deb40-307">\***nx_packet_next** _</span></span>|<span data-ttu-id="deb40-308">Det här fältet pekar på nästa paket inom samma ram.</span><span class="sxs-lookup"><span data-stu-id="deb40-308">This field points to the next packet within the same frame.</span></span> <span data-ttu-id="deb40-309">Om värdet är NULL finns det inga ytterligare paket som är en del av ramen.</span><span class="sxs-lookup"><span data-stu-id="deb40-309">If NULL, there are no additional packets that are part of the frame.</span></span> <span data-ttu-id="deb40-310">Det här fältet används också för att lagra fragmenterade paket tills hela paketet kan sammanställas igen.</span><span class="sxs-lookup"><span data-stu-id="deb40-310">This field is also used to hold fragmented packets until the entire packet can be re-assembled.</span></span> <span data-ttu-id="deb40-311">det tas bort om _ *_NX_DISABLE_PACKET_CHAIN_* \* har definierats.</span><span class="sxs-lookup"><span data-stu-id="deb40-311">it is removed if _\*_NX_DISABLE_PACKET_CHAIN_\*\*is defined.</span></span>|
|<span data-ttu-id="deb40-312">\***nx_packet_last** _</span><span class="sxs-lookup"><span data-stu-id="deb40-312">\***nx_packet_last** _</span></span>|<span data-ttu-id="deb40-313">Det här fältet pekar på det sista paketet i samma nätverks paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-313">This field points to the last packet within the same network packet.</span></span> <span data-ttu-id="deb40-314">Om värdet är NULL representerar det här paketet hela nätverks paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-314">If NULL, this packet represents the entire network packet.</span></span> <span data-ttu-id="deb40-315">Det här fältet tas bort om _ *_NX_DISABLE_PACKET_CHAIN_* \* har definierats.</span><span class="sxs-lookup"><span data-stu-id="deb40-315">This field is removed if _\*_NX_DISABLE_PACKET_CHAIN_\*\*is defined.</span></span>|
|<span data-ttu-id="deb40-316">\***nx_packet_length** _</span><span class="sxs-lookup"><span data-stu-id="deb40-316">\***nx_packet_length** _</span></span>| <span data-ttu-id="deb40-317">Det här fältet innehåller det totala antalet byte i hela nätverks paketet, inklusive summan av alla byte i alla paket som sammankopplas av _nx_packet_next \*-medlemmen.</span><span class="sxs-lookup"><span data-stu-id="deb40-317">This field contains the total number of bytes in the entire network packet, including the total of all bytes in all packets chained together by the _nx_packet_next\*member.</span></span>|
|<span data-ttu-id="deb40-318">***nx_packet_ip_interface***</span><span class="sxs-lookup"><span data-stu-id="deb40-318">***nx_packet_ip_interface***</span></span>| <span data-ttu-id="deb40-319">Det här fältet är gränssnitts kontroll blocket som tilldelas paketet när det tas emot av gränssnitts driv rutinen och av NetX Duo för utgående paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-319">This field is the interface control block which is assigned to the packet when it is received by the interface driver, and by NetX Duo for outgoing packets.</span></span> <span data-ttu-id="deb40-320">Ett gränssnitts kontroll block beskriver gränssnittet, t. ex. nätverks adress, MAC-adress, IP-adress och gränssnitts status, till exempel länk aktiverat och fysisk mappning krävs.</span><span class="sxs-lookup"><span data-stu-id="deb40-320">An interface control block describes the interface e.g. network address, MAC address, IP address and interface status such as link enabled and physical mapping required.</span></span>|
|<span data-ttu-id="deb40-321">\***nx_packet_data_start** _</span><span class="sxs-lookup"><span data-stu-id="deb40-321">\***nx_packet_data_start** _</span></span>| <span data-ttu-id="deb40-322">Det här fältet pekar på början av det fysiska nytto Last området för det här paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-322">This field points to the start of the physical payload area of this packet.</span></span> <span data-ttu-id="deb40-323">Det behöver inte omedelbart följa NX_PACKET huvud, men det är standardinställningen för tjänsten _ \*_nx_packet_pool_create_\*\*.</span><span class="sxs-lookup"><span data-stu-id="deb40-323">It does not have to be immediately following the NX_PACKET header, but that is the default for the _ *_nx_packet_pool_create_*\* service.</span></span>|
|<span data-ttu-id="deb40-324">\***nx_packet_data_end** _</span><span class="sxs-lookup"><span data-stu-id="deb40-324">\***nx_packet_data_end** _</span></span>|<span data-ttu-id="deb40-325">Det här fältet pekar på slutet av det fysiska nytto Last området för det här paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-325">This field points to the end of the physical payload area of this packet.</span></span> <span data-ttu-id="deb40-326">Skillnaden mellan det här fältet och fältet _nx_packet_data_start \* representerar nytto lastens storlek.</span><span class="sxs-lookup"><span data-stu-id="deb40-326">The difference between this field and the _nx_packet_data_start\* field represents the payload size.</span></span>|
|<span data-ttu-id="deb40-327">\***nx_packet_prepend_ptr** _</span><span class="sxs-lookup"><span data-stu-id="deb40-327">\***nx_packet_prepend_ptr** _</span></span>|<span data-ttu-id="deb40-328">Det här fältet pekar på platsen där paket data, antingen protokoll huvud eller faktiska data, läggs till framför befintliga paket data (om sådana finns) i paketets nytto Last område.</span><span class="sxs-lookup"><span data-stu-id="deb40-328">This field points to the location of where packet data, either protocol header or actual data, is added in front of the existing packet data (if any) in the packet payload area.</span></span> <span data-ttu-id="deb40-329">Det måste vara större än eller lika med _nx_packet_data_start \* pekare och mindre än eller lika med *nx_packet_append_ptrs* pekaren.</span><span class="sxs-lookup"><span data-stu-id="deb40-329">It must be greater than or equal to the _nx_packet_data_start\* pointer location and less than or equal to the *nx_packet_append_ptr* pointer.</span></span>|
> [!CAUTION]
> <span data-ttu-id="deb40-330">*Av prestanda skäl förutsätter NetX Duo att när paketet skickas till NetX Duo-tjänster för överföring, pekar lägga pekar på lång Word-justerad adress.*</span><span class="sxs-lookup"><span data-stu-id="deb40-330">*For performance reasons, NetX Duo assumes that when the packet is passed into NetX Duo services for transmission, the prepend pointer points to long word aligned address.*</span></span>

| <span data-ttu-id="deb40-331">Paket huvud</span><span class="sxs-lookup"><span data-stu-id="deb40-331">Packet header</span></span> | <span data-ttu-id="deb40-332">Syfte</span><span class="sxs-lookup"><span data-stu-id="deb40-332">Purpose</span></span> |
|---|---|
|<span data-ttu-id="deb40-333">\***nx_packet_append_ptr** _</span><span class="sxs-lookup"><span data-stu-id="deb40-333">\***nx_packet_append_ptr** _</span></span>|<span data-ttu-id="deb40-334">Det här fältet pekar på slutet av de data som för närvarande finns i paketets nytto Last område.</span><span class="sxs-lookup"><span data-stu-id="deb40-334">This field points to the end of the data currently in the packet payload area.</span></span> <span data-ttu-id="deb40-335">Det måste ligga mellan minnes platsen som _nx_packet_prepend_ptr \* och *nx_packet_data_end.*</span><span class="sxs-lookup"><span data-stu-id="deb40-335">It must be in between the memory location pointed to by _nx_packet_prepend_ptr\* and *nx_packet_data_end.*</span></span> <span data-ttu-id="deb40-336">Skillnaden mellan det här fältet och fältet *nx_packet_prepend_ptr* representerar mängden data i det här paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-336">The difference between this field and the *nx_packet_prepend_ptr* field represents the amount of data in this packet.</span></span>|
|<span data-ttu-id="deb40-337">\***nx_packet_packet_pad** _</span><span class="sxs-lookup"><span data-stu-id="deb40-337">\***nx_packet_packet_pad** _</span></span>|<span data-ttu-id="deb40-338">I det här fältet definieras längden på utfyllnad i 4 byte-ord för att uppnå det önskade justerings kravet.</span><span class="sxs-lookup"><span data-stu-id="deb40-338">This fields defines the length of padding in 4-byte words to achieve the desired alignment requirement.</span></span> <span data-ttu-id="deb40-339">Det här fältet tas bort om _*_NX_PACKET_HEADER_PAD_*_ inte har definierats.</span><span class="sxs-lookup"><span data-stu-id="deb40-339">This field is removed if _*_NX_PACKET_HEADER_PAD_*_ is not defined.</span></span> <span data-ttu-id="deb40-340">Du kan också använda _*_NX_PACKET_ALIGNMENT_*_ i stället för att definiera _nx_packet_header_pad. \*</span><span class="sxs-lookup"><span data-stu-id="deb40-340">Alternatively _*_NX_PACKET_ALIGNMENT_*_ can be used instead of defining _nx_packet_header_pad.\*</span></span>|

### <a name="packet-header-offsets"></a><span data-ttu-id="deb40-341">Paket huvud förskjutningar</span><span class="sxs-lookup"><span data-stu-id="deb40-341">Packet Header Offsets</span></span>

<span data-ttu-id="deb40-342">Paketets huvud storlek definieras för att tillåta tillräckligt med utrymme för att rymma rubrikens storlek.</span><span class="sxs-lookup"><span data-stu-id="deb40-342">Packet header size is defined to allow enough room  to accommodate the size of the header.</span></span> <span data-ttu-id="deb40-343">Tjänsten ***nx_packet_allocate*** används för att allokera ett paket och justerar lägga-pekaren i paketet enligt den typ av paket som angetts.</span><span class="sxs-lookup"><span data-stu-id="deb40-343">The ***nx_packet_allocate*** service is used to allocate a packet and adjusts the prepend pointer in the packet according to the type of packet specified.</span></span> <span data-ttu-id="deb40-344">Paket typen talar om för NetX Duo vilken förskjutning som krävs för att lägga till protokoll huvudet (till exempel UDP, TCP eller ICMP) framför protokoll data.</span><span class="sxs-lookup"><span data-stu-id="deb40-344">The packet type tells NetX Duo the offset required for inserting the protocol header (such as UDP, TCP, or ICMP) in front of the protocol data.</span></span>

<span data-ttu-id="deb40-345">Följande typer definieras i NetX Duo för att ta hänsyn till IP-huvudet och det fysiska skiktet (Ethernet) i paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-345">The following types are defined in NetX Duo to take into account the IP header and physical layer (Ethernet) header in the packet.</span></span> <span data-ttu-id="deb40-346">I det senare fallet antas det vara 16 byte som tar hänsyn till den nödvändiga justeringen av 4 byte.</span><span class="sxs-lookup"><span data-stu-id="deb40-346">In the latter case, it is assumed to be 16 bytes taking the required 4-byte alignment into consideration.</span></span> <span data-ttu-id="deb40-347">IPv4-paket definieras fortfarande i NetX Duo för program för att allokera paket för IPv4-nätverk.</span><span class="sxs-lookup"><span data-stu-id="deb40-347">IPv4 packets are still defined in NetX Duo for applications to allocate packets for IPv4 networks.</span></span> <span data-ttu-id="deb40-348">Observera att om NetX Duo-biblioteket har skapats med IPv6 aktiverat, mappas de generiska paket typerna (till exempel NX_IP_PACKET) till IPv6-versionen.</span><span class="sxs-lookup"><span data-stu-id="deb40-348">Note that if the NetX Duo library is built with IPv6 enabled, the generic packet types (such as NX_IP_PACKET) are mapped to the IPv6 version.</span></span> <span data-ttu-id="deb40-349">Om NetX Duo-biblioteket har skapats utan IPv6 aktive rad, mappas dessa generiska paket typer till IPv4-versionen.</span><span class="sxs-lookup"><span data-stu-id="deb40-349">If the NetX Duo Library is built without IPv6 enabled, these generic packet types are mapped to the IPv4 version.</span></span>

<span data-ttu-id="deb40-350">I följande tabell visas symboler som definierats med IPv6 aktiverat:</span><span class="sxs-lookup"><span data-stu-id="deb40-350">The following table shows symbols defined with IPv6 enabled:</span></span>

|<span data-ttu-id="deb40-351">**Pakettyp**</span><span class="sxs-lookup"><span data-stu-id="deb40-351">**Packet Type**</span></span> |<span data-ttu-id="deb40-352">**Värde**</span><span class="sxs-lookup"><span data-stu-id="deb40-352">**Value**</span></span> |
|---|---|
|<span data-ttu-id="deb40-353">NX_IPv6_PACKET (NX_IP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="deb40-353">NX_IPv6_PACKET (NX_IP_PACKET)</span></span> | <span data-ttu-id="deb40-354">0x38</span><span class="sxs-lookup"><span data-stu-id="deb40-354">0x38</span></span> |
|<span data-ttu-id="deb40-355">NX_UDPv6_PACKET (NX_UDP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="deb40-355">NX_UDPv6_PACKET (NX_UDP_PACKET)</span></span> |<span data-ttu-id="deb40-356">0x40</span><span class="sxs-lookup"><span data-stu-id="deb40-356">0x40</span></span> |
|<span data-ttu-id="deb40-357">NX_TCPv6_PACKET (NX_TCP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="deb40-357">NX_TCPv6_PACKET (NX_TCP_PACKET)</span></span> |<span data-ttu-id="deb40-358">0x4c</span><span class="sxs-lookup"><span data-stu-id="deb40-358">0x4c</span></span> |
|<span data-ttu-id="deb40-359">NX_IPv4_PACKET</span><span class="sxs-lookup"><span data-stu-id="deb40-359">NX_IPv4_PACKET</span></span> |<span data-ttu-id="deb40-360">0x24</span><span class="sxs-lookup"><span data-stu-id="deb40-360">0x24</span></span> |
|<span data-ttu-id="deb40-361">NX_IPv4_UDP_PACKET</span><span class="sxs-lookup"><span data-stu-id="deb40-361">NX_IPv4_UDP_PACKET</span></span> |<span data-ttu-id="deb40-362">0x2c</span><span class="sxs-lookup"><span data-stu-id="deb40-362">0x2c</span></span> |
|<span data-ttu-id="deb40-363">NX_IPv4_TCP_PACKET</span><span class="sxs-lookup"><span data-stu-id="deb40-363">NX_IPv4_TCP_PACKET</span></span> |<span data-ttu-id="deb40-364">0x38</span><span class="sxs-lookup"><span data-stu-id="deb40-364">0x38</span></span> |

<span data-ttu-id="deb40-365">I följande tabell visas symboler som definierats med IPv6 inaktiverat:</span><span class="sxs-lookup"><span data-stu-id="deb40-365">The following table shows symbols defined with IPv6 disabled:</span></span>

|<span data-ttu-id="deb40-366">**Pakettyp**</span><span class="sxs-lookup"><span data-stu-id="deb40-366">**Packet Type**</span></span> |<span data-ttu-id="deb40-367">**Värde**</span><span class="sxs-lookup"><span data-stu-id="deb40-367">**Value**</span></span> |
|---|---|
|<span data-ttu-id="deb40-368">NX_IPv4_PACKET (NX_IP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="deb40-368">NX_IPv4_PACKET (NX_IP_PACKET)</span></span> |<span data-ttu-id="deb40-369">0x24</span><span class="sxs-lookup"><span data-stu-id="deb40-369">0x24</span></span> |
|<span data-ttu-id="deb40-370">NX_IPv4_UDP_PACKET (NX_UDP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="deb40-370">NX_IPv4_UDP_PACKET (NX_UDP_PACKET)</span></span> |<span data-ttu-id="deb40-371">0x2c</span><span class="sxs-lookup"><span data-stu-id="deb40-371">0x2c</span></span> |
|<span data-ttu-id="deb40-372">NX_IPv4_TCP_PACKET (NX_TCP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="deb40-372">NX_IPv4_TCP_PACKET (NX_TCP_PACKET)</span></span> |<span data-ttu-id="deb40-373">0x38</span><span class="sxs-lookup"><span data-stu-id="deb40-373">0x38</span></span> |

<span data-ttu-id="deb40-374">Observera att dessa värden kommer att ändras om *NX_IPSEC_ENABLE* har definierats.</span><span class="sxs-lookup"><span data-stu-id="deb40-374">Note that these values will change if *NX_IPSEC_ENABLE* is defined.</span></span> <span data-ttu-id="deb40-375">För program som använder IPsec finns mer information i användar handboken för NetX Duo IPsec.</span><span class="sxs-lookup"><span data-stu-id="deb40-375">For application using IPsec, refer to NetX Duo IPsec User Guide for more information.</span></span>

### <a name="pool-capacity"></a><span data-ttu-id="deb40-376">Pool-kapacitet</span><span class="sxs-lookup"><span data-stu-id="deb40-376">Pool Capacity</span></span>

<span data-ttu-id="deb40-377">Antalet paket i en adresspool är en funktion i nytto lastens storlek och det totala antalet byte i minnes området som har angetts till Packet poolens Create-tjänst.</span><span class="sxs-lookup"><span data-stu-id="deb40-377">The number of packets in a packet pool is a function of the payload size and the total number of bytes in the memory area supplied to the packet pool create service.</span></span> <span data-ttu-id="deb40-378">Poolens kapacitet beräknas genom att du dividerar paket storleken (inklusive storleken på NX_PACKET huvud, nytto lastens storlek och rätt justering) till det totala antalet byte i det angivna minnes området.</span><span class="sxs-lookup"><span data-stu-id="deb40-378">The capacity of the pool is calculated by dividing the packet size (including the size of the NX_PACKET header, the payload size, and proper alignment) into the total number of bytes in the supplied memory area.</span></span>

### <a name="payload-area-alignment"></a><span data-ttu-id="deb40-379">Justering av nytto Last områden</span><span class="sxs-lookup"><span data-stu-id="deb40-379">Payload Area Alignment</span></span>

<span data-ttu-id="deb40-380">Skrivarpool i NetX Duo stöder noll-kopiering.</span><span class="sxs-lookup"><span data-stu-id="deb40-380">Packet pool design in NetX Duo supports zero-copy.</span></span> <span data-ttu-id="deb40-381">På enhets driv rutins nivån kan driv rutinen tilldela nytto lastområdet direkt till buffertens beskrivningar för att ta emot data.</span><span class="sxs-lookup"><span data-stu-id="deb40-381">At the device driver level, the driver is able to assign the payload area directly into buffer descriptors for data reception.</span></span> <span data-ttu-id="deb40-382">Ibland måste DMA-motorn eller mekanismen för cachelagring kräva start adressen för nytto lastområdet för att få ett visst justerings krav.</span><span class="sxs-lookup"><span data-stu-id="deb40-382">Sometimes the DMA engine or the cache synchronization mechanism requires the starting address of the payload area to have a certain alignment requirement.</span></span> <span data-ttu-id="deb40-383">Detta kan uppnås genom att definiera det önskade justerings kravet (i byte) i ***NX_PACKET_ALIGNMENT***.</span><span class="sxs-lookup"><span data-stu-id="deb40-383">This can be achieved by defining the desired alignment requirement (in bytes) in ***NX_PACKET_ALIGNMENT***.</span></span> <span data-ttu-id="deb40-384">När du skapar en adresspool, justeras start adressen för nytto Last ytan till det här värdet.</span><span class="sxs-lookup"><span data-stu-id="deb40-384">When creating a packet pool, the starting address of the payload area will aligned to this value.</span></span> <span data-ttu-id="deb40-385">Som standard är start adressen 4 byte justerad.</span><span class="sxs-lookup"><span data-stu-id="deb40-385">By default, starting address is 4-byte aligned.</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="deb40-386">Tråd upphängning</span><span class="sxs-lookup"><span data-stu-id="deb40-386">Thread Suspension</span></span>

<span data-ttu-id="deb40-387">Program trådar kan pausas i väntan på ett paket från en tom pool.</span><span class="sxs-lookup"><span data-stu-id="deb40-387">Application threads can suspend while waiting for a packet from an empty pool.</span></span> <span data-ttu-id="deb40-388">När ett paket returneras till poolen får den pausade tråden det här paketet och återupptas.</span><span class="sxs-lookup"><span data-stu-id="deb40-388">When a packet is returned to the pool, the suspended thread is given this packet and resumed.</span></span>

<span data-ttu-id="deb40-389">Om flera trådar har pausats på samma modempool, återupptas de i den ordning som de var pausade (FIFO).</span><span class="sxs-lookup"><span data-stu-id="deb40-389">If multiple threads are suspended on the same packet pool, they  resumed in the order they were suspended (FIFO).</span></span>

### <a name="pool-statistics-and-errors"></a><span data-ttu-id="deb40-390">Statistik och fel i pooler</span><span class="sxs-lookup"><span data-stu-id="deb40-390">Pool Statistics and Errors</span></span>

<span data-ttu-id="deb40-391">Om den här inställningen är aktive rad håller NetX Duo Packet Management-programvaran reda på flera statistik och fel som kan vara användbara för programmet.</span><span class="sxs-lookup"><span data-stu-id="deb40-391">If enabled, the NetX Duo packet management software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="deb40-392">Följande statistik och fel rapporter underhålls för paketbaserade pooler:</span><span class="sxs-lookup"><span data-stu-id="deb40-392">The following statistics and error reports are maintained for packet pools:</span></span>

- <span data-ttu-id="deb40-393">Totalt antal paket i poolen</span><span class="sxs-lookup"><span data-stu-id="deb40-393">Total Packets in Pool</span></span>
- <span data-ttu-id="deb40-394">Lediga paket i poolen</span><span class="sxs-lookup"><span data-stu-id="deb40-394">Free Packets in Pool</span></span>
- <span data-ttu-id="deb40-395">Totalt antal paket tilldelningar</span><span class="sxs-lookup"><span data-stu-id="deb40-395">Total Packet Allocations</span></span>
- <span data-ttu-id="deb40-396">Pool tomma tilldelnings begär Anden</span><span class="sxs-lookup"><span data-stu-id="deb40-396">Pool Empty Allocation Requests</span></span>
- <span data-ttu-id="deb40-397">Förskjutande av pool, tomma allokeringar</span><span class="sxs-lookup"><span data-stu-id="deb40-397">Pool Empty Allocation Suspensions</span></span>
- <span data-ttu-id="deb40-398">Ogiltiga paket versioner</span><span class="sxs-lookup"><span data-stu-id="deb40-398">Invalid Packet Releases</span></span>

<span data-ttu-id="deb40-399">Alla dessa statistik-och fel rapporter, förutom det totala antalet och det lediga paket antalet i poolen, är inbyggda i NetX Duo-biblioteket om inte \***NX_DISABLE_PACKET_INFO** _ har definierats.</span><span class="sxs-lookup"><span data-stu-id="deb40-399">All of these statistics and error reports, except for total and free packet count in pool, are built into NetX Duo library unless \***NX_DISABLE_PACKET_INFO** _ is defined.</span></span> <span data-ttu-id="deb40-400">Dessa data är tillgängliga för programmet med tjänsten _ \*_nx_packet_pool_info_get_\*\*.</span><span class="sxs-lookup"><span data-stu-id="deb40-400">This data is available to the application with the _ *_nx_packet_pool_info_get_*\* service.</span></span>

### <a name="packet-pool-control-block-nx_packet_pool"></a><span data-ttu-id="deb40-401">Kontroll block för Packet-pool NX_PACKET_POOL</span><span class="sxs-lookup"><span data-stu-id="deb40-401">Packet Pool Control Block NX_PACKET_POOL</span></span>

<span data-ttu-id="deb40-402">Egenskaperna för varje paket minnes uppsättning finns i kontroll blocket.</span><span class="sxs-lookup"><span data-stu-id="deb40-402">The characteristics of each packet memory pool are found in its control block.</span></span> <span data-ttu-id="deb40-403">Den innehåller användbar information, till exempel den länkade listan över lediga paket, antalet lediga paket och nytto Last storleken för paket i den här poolen.</span><span class="sxs-lookup"><span data-stu-id="deb40-403">It contains useful information such as the linked list of free packets, the number of free packets, and the payload size for packets in this pool.</span></span> <span data-ttu-id="deb40-404">Den här strukturen definieras i filen ***nx_api. h*** .</span><span class="sxs-lookup"><span data-stu-id="deb40-404">This structure is defined in the ***nx_api.h*** file.</span></span>

<span data-ttu-id="deb40-405">Du kan placera kontroll block var som helst i minnet, men det är vanligt att kontrol lera att kontrollen blockerar en global struktur genom att definiera den utanför omfånget för en funktion.</span><span class="sxs-lookup"><span data-stu-id="deb40-405">Packet pool control blocks can be located anywhere in memory, but it is most common to make the control block a global structure by defining it outside the scope of any function.</span></span>

## <a name="ipv4-protocol"></a><span data-ttu-id="deb40-406">IPv4-protokoll</span><span class="sxs-lookup"><span data-stu-id="deb40-406">IPv4 Protocol</span></span>

<span data-ttu-id="deb40-407">Komponenten Internet Protocol (IP) i NetX Duo ansvarar för att skicka och ta emot IPv4-paket på Internet.</span><span class="sxs-lookup"><span data-stu-id="deb40-407">The Internet Protocol (IP) component of NetX Duo is responsible for sending and receiving IPv4 packets on the Internet.</span></span> <span data-ttu-id="deb40-408">I NetX Duo är det den komponent som slutligen ansvarar för att skicka och ta emot TCP-, UDP-, ICMP-och IGMP-meddelanden med hjälp av den underliggande nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="deb40-408">In NetX Duo, it is the component ultimately responsible for sending and receiving TCP, UDP, ICMP, and IGMP messages, utilizing the underlying network driver.</span></span>

<span data-ttu-id="deb40-409">NetX Duo stöder både IPv4-protokollet (RFC 791) och IPv6-protokollet (RFC 2460).</span><span class="sxs-lookup"><span data-stu-id="deb40-409">NetX Duo supports both IPv4 protocol (RFC 791) and IPv6 protocol (RFC 2460).</span></span> <span data-ttu-id="deb40-410">I det här avsnittet beskrivs IPv4.</span><span class="sxs-lookup"><span data-stu-id="deb40-410">This section discusses IPv4.</span></span> <span data-ttu-id="deb40-411">IPv6 beskrivs i nästa avsnitt.</span><span class="sxs-lookup"><span data-stu-id="deb40-411">IPv6 is discussed in the next section.</span></span>

### <a name="ipv4-addresses"></a><span data-ttu-id="deb40-412">IPv4-adresser</span><span class="sxs-lookup"><span data-stu-id="deb40-412">IPv4 Addresses</span></span>

<span data-ttu-id="deb40-413">Varje värd på Internet har en unik 32-bitars identifierare som kallas för en IP-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-413">Each host on the Internet has a unique 32-bit identifier called an IP address.</span></span> <span data-ttu-id="deb40-414">Det finns fem klasser av IPv4-adresser enligt beskrivningen i bild 4.</span><span class="sxs-lookup"><span data-stu-id="deb40-414">There are five classes of IPv4 addresses as described in Figure 4.</span></span> <span data-ttu-id="deb40-415">Intervallen för de fem IPv4-adress klasserna är följande:</span><span class="sxs-lookup"><span data-stu-id="deb40-415">The ranges of the five IPv4 address classes are as follows:</span></span>

|<span data-ttu-id="deb40-416">Klass</span><span class="sxs-lookup"><span data-stu-id="deb40-416">Class</span></span>|<span data-ttu-id="deb40-417">Intervall</span><span class="sxs-lookup"><span data-stu-id="deb40-417">Range</span></span>|
|---|---|
|<span data-ttu-id="deb40-418">A</span><span class="sxs-lookup"><span data-stu-id="deb40-418">A</span></span> |<span data-ttu-id="deb40-419">0.0.0.0 till 127.255.255.255</span><span class="sxs-lookup"><span data-stu-id="deb40-419">0.0.0.0 to 127.255.255.255</span></span>|
|<span data-ttu-id="deb40-420">B</span><span class="sxs-lookup"><span data-stu-id="deb40-420">B</span></span> |<span data-ttu-id="deb40-421">128.0.0.0 till 191.255.255.255</span><span class="sxs-lookup"><span data-stu-id="deb40-421">128.0.0.0 to 191.255.255.255</span></span>|
|<span data-ttu-id="deb40-422">C</span><span class="sxs-lookup"><span data-stu-id="deb40-422">C</span></span> |<span data-ttu-id="deb40-423">192.0.0.0 till 223.255.255.255</span><span class="sxs-lookup"><span data-stu-id="deb40-423">192.0.0.0 to 223.255.255.255</span></span>|
|<span data-ttu-id="deb40-424">D</span><span class="sxs-lookup"><span data-stu-id="deb40-424">D</span></span> |<span data-ttu-id="deb40-425">224.0.0.0 till 239.255.255.255</span><span class="sxs-lookup"><span data-stu-id="deb40-425">224.0.0.0 to 239.255.255.255</span></span>|
|<span data-ttu-id="deb40-426">E</span><span class="sxs-lookup"><span data-stu-id="deb40-426">E</span></span> |<span data-ttu-id="deb40-427">240.0.0.0 till 247.255.255.255</span><span class="sxs-lookup"><span data-stu-id="deb40-427">240.0.0.0 to 247.255.255.255</span></span>|

![Diagram över IPv4-adress strukturen.](./media/user-guide/ipv4-address-structure.png)

### <a name="figure-4-ipv4-address-structure"></a><span data-ttu-id="deb40-429">BILD 4.</span><span class="sxs-lookup"><span data-stu-id="deb40-429">FIGURE 4.</span></span> <span data-ttu-id="deb40-430">IPv4-adress struktur</span><span class="sxs-lookup"><span data-stu-id="deb40-430">IPv4 Address Structure</span></span>

<span data-ttu-id="deb40-431">Det finns också tre typer av adress specifikationer: *unicast*, *broadcast* och *multicast*.</span><span class="sxs-lookup"><span data-stu-id="deb40-431">There are also three types of address specifications: *unicast*, *broadcast*, and *multicast*.</span></span> <span data-ttu-id="deb40-432">Unicast-adresser är de IPv4-adresser som identifierar en speciell värd på Internet.</span><span class="sxs-lookup"><span data-stu-id="deb40-432">Unicast addresses are those IPv4 addresses that identify a specific host on the Internet.</span></span> <span data-ttu-id="deb40-433">Unicast-adresser kan antingen vara en källa eller en mål-IPv4-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-433">Unicast addresses can be either a source or a destination IPv4 address.</span></span> <span data-ttu-id="deb40-434">En broadcast-adress identifierar alla värdar i ett särskilt nätverk eller under nätverk och kan bara användas som mål adresser.</span><span class="sxs-lookup"><span data-stu-id="deb40-434">A broadcast address identifies all hosts on a specific network or sub-network and can only be used as destination addresses.</span></span> <span data-ttu-id="deb40-435">Broadcast-adresser anges genom att ha den värd-ID-del av adressen som anges till dem.</span><span class="sxs-lookup"><span data-stu-id="deb40-435">Broadcast addresses are specified by having the host ID portion of the address set to ones.</span></span> <span data-ttu-id="deb40-436">Multicast-adresser (klass D) anger en dynamisk grupp värdar på Internet.</span><span class="sxs-lookup"><span data-stu-id="deb40-436">Multicast addresses (Class D) specify a dynamic group of hosts on the Internet.</span></span> <span data-ttu-id="deb40-437">Medlemmar i multicast-gruppen kan ansluta till och lämna när de vill.</span><span class="sxs-lookup"><span data-stu-id="deb40-437">Members of the multicast group may join and leave whenever they wish.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="deb40-438">*Endast anslutnings bara protokoll som UDP över IPv4 kan använda broadcast och begränsad broadcast-kapacitet för multicast-gruppen.*</span><span class="sxs-lookup"><span data-stu-id="deb40-438">*Only connectionless protocols like UDP over IPv4 can utilize broadcast and the limited broadcast capability of the multicast group.*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="deb40-439">\* Makro *IP_ADDRESS* definieras i \***nx_api. h** _.</span><span class="sxs-lookup"><span data-stu-id="deb40-439">\*The macro *IP_ADDRESS* is defined in \***nx_api.h** _.</span></span> <span data-ttu-id="deb40-440">Det möjliggör enkel specifikation av IPv4-adresser med kommatecken i stället för en punkt.</span><span class="sxs-lookup"><span data-stu-id="deb40-440">It allows easy specification of IPv4 addresses using commas instead of a periods.</span></span> <span data-ttu-id="deb40-441">Exempel: _IP_ADDRESS (128, 0, 0) \* anger den första klass B-adressen som visas i bild 4. \*</span><span class="sxs-lookup"><span data-stu-id="deb40-441">For example, _IP_ADDRESS(128,0,0,0)\* specifies the first class B address shown in Figure 4.\*</span></span>

### <a name="ipv4-gateway-address"></a><span data-ttu-id="deb40-442">IPv4-Gateway-adress</span><span class="sxs-lookup"><span data-stu-id="deb40-442">IPv4 Gateway Address</span></span>

<span data-ttu-id="deb40-443">Nätverksgateway hjälper värdar i sina nätverk att vidarebefordra paket som är avsedda för destinationer utanför den lokala domänen.</span><span class="sxs-lookup"><span data-stu-id="deb40-443">Network gateways assist hosts on their networks to relay packets destined to destinations outside the local domain.</span></span> <span data-ttu-id="deb40-444">Varje nod har en viss kunskap om vilka nästa hopp som ska skickas till, antingen på målet en av dess grannar, eller genom en förprogrammerad statisk routningstabell.</span><span class="sxs-lookup"><span data-stu-id="deb40-444">Each node has some knowledge of which next hop to send to, either the destination one of its neighbors, or through a pre-programmed static routing table.</span></span> <span data-ttu-id="deb40-445">Men om dessa metoder inte fungerar bör noden vidarebefordra paketet till dess standardgateway som har bättre kunskap om hur paketet dirigeras till målet.</span><span class="sxs-lookup"><span data-stu-id="deb40-445">However if these approaches fail, the node should forward the packet to its default gateway which has better knowledge on how to route the packet to its destination.</span></span> <span data-ttu-id="deb40-446">Observera att standardgateway måste vara direkt tillgänglig via ett av de fysiska gränssnitt som är kopplade till IP-instansen.</span><span class="sxs-lookup"><span data-stu-id="deb40-446">Note that the default gateway must be directly accessible through one of the physical interfaces attached to the IP instance.</span></span> <span data-ttu-id="deb40-447">Programmet anropar \***nx_ip_gateway_address_set** _ för att konfigurera IPv4-standardgateway.</span><span class="sxs-lookup"><span data-stu-id="deb40-447">The application calls \***nx_ip_gateway_address_set** _ to configure IPv4 default gateway address.</span></span> <span data-ttu-id="deb40-448">Använd tjänst _*_nx_ip_gateway_address_get_*_ för att hämta de aktuella inställningarna för IPv4 Gateway.</span><span class="sxs-lookup"><span data-stu-id="deb40-448">Use the service _*_nx_ip_gateway_address_get_*_ to retrieve the current IPv4 gateway settings.</span></span> <span data-ttu-id="deb40-449">Programmet ska använda tjänsten _ *_nx_ip_gateway_address_clear_*\* för att rensa Gateway-inställningen.</span><span class="sxs-lookup"><span data-stu-id="deb40-449">Application shall use the service _ *_nx_ip_gateway_address_clear_*\* to clear the gateway setting.</span></span>

### <a name="ipv4-header"></a><span data-ttu-id="deb40-450">IPv4-sidhuvud</span><span class="sxs-lookup"><span data-stu-id="deb40-450">IPv4 Header</span></span>

<span data-ttu-id="deb40-451">För att IPv4-paket ska kunna skickas på Internet måste det ha ett IPv4-huvud.</span><span class="sxs-lookup"><span data-stu-id="deb40-451">For any IPv4 packet to be sent on the Internet, it must have an IPv4 header.</span></span> <span data-ttu-id="deb40-452">När protokoll på högre nivå (UDP, TCP, ICMP eller IGMP) anropar IP-komponenten för att skicka ett paket, placerar modulen IPv4-överföring ett IPv4-huvud framför data.</span><span class="sxs-lookup"><span data-stu-id="deb40-452">When higher-level protocols (UDP, TCP, ICMP, or IGMP) call the IP component to send a packet, the IPv4 transmit module places an IPv4 header in front of the data.</span></span> <span data-ttu-id="deb40-453">När IP-paket tas emot från nätverket tar IP-komponenten bort IPv4-huvudet från paketet innan det levereras till protokollen på högre nivå.</span><span class="sxs-lookup"><span data-stu-id="deb40-453">Conversely, when IP packets are received from the network, the IP component removes the IPv4 header from the packet before delivery to the higher-level protocols.</span></span> <span data-ttu-id="deb40-454">Bild 5 visar formatet på IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-454">Figure 5 shows the format of the IP header.</span></span>

![Format för IPv4-sidhuvud](./media/user-guide/ipv4-header-format.png)

### <a name="figure-5-ipv4-header-format"></a><span data-ttu-id="deb40-456">BILD 5.</span><span class="sxs-lookup"><span data-stu-id="deb40-456">FIGURE 5.</span></span> <span data-ttu-id="deb40-457">Format för IPv4-sidhuvud</span><span class="sxs-lookup"><span data-stu-id="deb40-457">IPv4 Header Format</span></span>

> [!IMPORTANT]
> <span data-ttu-id="deb40-458">*Alla rubriker i TCP/IP-implementeringen förväntas vara i **big endian** format. I det här formatet finns de mest signifikanta byten av ordet på den lägsta byte-adressen. Till exempel måste 4-bitars versionen och längden på 4-bitars huvudet för IP-huvudet finnas på den första byten i rubriken.*</span><span class="sxs-lookup"><span data-stu-id="deb40-458">*All headers in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address. For example, the 4-bit version and the 4-bit header length of the IP header must be located on the first byte of the header.*</span></span>

<span data-ttu-id="deb40-459">Fälten i IPv4-rubriken definieras enligt följande:</span><span class="sxs-lookup"><span data-stu-id="deb40-459">The fields of the IPv4 header are defined as follows:</span></span>

|<span data-ttu-id="deb40-460">Fält för IPv4- &nbsp; huvud &nbsp;</span><span class="sxs-lookup"><span data-stu-id="deb40-460">IPv4&nbsp;Header&nbsp;Field</span></span> |<span data-ttu-id="deb40-461">Syfte</span><span class="sxs-lookup"><span data-stu-id="deb40-461">Purpose</span></span> |
|---|---|
|<span data-ttu-id="deb40-462">***4-bitars version***</span><span class="sxs-lookup"><span data-stu-id="deb40-462">***4-bit version***</span></span> |<span data-ttu-id="deb40-463">Det här fältet innehåller den version av IP som detta sidhuvud representerar.</span><span class="sxs-lookup"><span data-stu-id="deb40-463">This field contains the version of IP this header represents.</span></span> <span data-ttu-id="deb40-464">För IP version 4, som är det som NetX Duo stöder, är värdet för det här fältet 4.</span><span class="sxs-lookup"><span data-stu-id="deb40-464">For IP version 4, which is what NetX Duo supports, the value of this field is 4.</span></span> |
|<span data-ttu-id="deb40-465">***4-bitars rubrik längd***</span><span class="sxs-lookup"><span data-stu-id="deb40-465">***4-bit header length***</span></span> |<span data-ttu-id="deb40-466">Det här fältet anger antalet 32-bitars ord i IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-466">This field specifies the number of 32-bit words in the IP header.</span></span> <span data-ttu-id="deb40-467">Om det inte finns några alternativ ord är värdet för det här fältet 5.</span><span class="sxs-lookup"><span data-stu-id="deb40-467">If no option words are present, the value for this field is 5.</span></span> |
|<span data-ttu-id="deb40-468">***8-bitars typ av tjänst (TOS)***</span><span class="sxs-lookup"><span data-stu-id="deb40-468">***8-bit type of service (TOS)***</span></span> |<span data-ttu-id="deb40-469">I det här fältet anges vilken typ av tjänst som begärs för det här IP-paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-469">This field specifies the type of service requested for this IP packet.</span></span> <span data-ttu-id="deb40-470">Giltiga begär Anden är följande:</span><span class="sxs-lookup"><span data-stu-id="deb40-470">Valid requests are as follows:</span></span><br /><span data-ttu-id="deb40-471">-Normal: 0x00</span><span class="sxs-lookup"><span data-stu-id="deb40-471">- Normal: 0x00</span></span> <br /><span data-ttu-id="deb40-472">-Minsta fördröjning: 0x00</span><span class="sxs-lookup"><span data-stu-id="deb40-472">- Minimum Delay: 0x00</span></span><br /><span data-ttu-id="deb40-473">-Högsta data: 0x08</span><span class="sxs-lookup"><span data-stu-id="deb40-473">- Maximum Data: 0x08</span></span><br /><span data-ttu-id="deb40-474">-Högsta tillförlitlighet: 0x04</span><span class="sxs-lookup"><span data-stu-id="deb40-474">- Maximum Reliability: 0x04</span></span><br /><span data-ttu-id="deb40-475">-Lägsta kostnad: protokollnumret 0x02</span><span class="sxs-lookup"><span data-stu-id="deb40-475">- Minimum Cost: 0x02</span></span> |
|<span data-ttu-id="deb40-476">***16-bitars total längd***</span><span class="sxs-lookup"><span data-stu-id="deb40-476">***16-bit total length***</span></span> |<span data-ttu-id="deb40-477">Det här fältet innehåller den totala längden för IP-datagram i byte, inklusive IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-477">This field contains the total length of the IP datagram in bytes, including the IP header.</span></span> <span data-ttu-id="deb40-478">Ett IP-datagram är den grundläggande informations enheten som finns på ett TCP/IP-Internet.</span><span class="sxs-lookup"><span data-stu-id="deb40-478">An IP datagram is the basic unit of information found on a TCP/IP Internet.</span></span> <span data-ttu-id="deb40-479">Den innehåller en mål-och käll adress förutom data.</span><span class="sxs-lookup"><span data-stu-id="deb40-479">It contains a destination and source address in addition to data.</span></span> <span data-ttu-id="deb40-480">Eftersom det är ett 16-bitars fält är den maximala storleken för ett IP-datagram 65 535 byte.</span><span class="sxs-lookup"><span data-stu-id="deb40-480">Because it is a 16-bit field, the maximum size of an IP datagram is 65,535 bytes.</span></span>|
|<span data-ttu-id="deb40-481">***16-bitars identifiering***</span><span class="sxs-lookup"><span data-stu-id="deb40-481">***16-bit identification***</span></span> |<span data-ttu-id="deb40-482">Fältet är ett tal som används för att unikt identifiera varje IP-datagram som skickas från en värd.</span><span class="sxs-lookup"><span data-stu-id="deb40-482">The field is a number used to uniquely identify each IP datagram sent from a host.</span></span> <span data-ttu-id="deb40-483">Det här talet ökar ofta när ett IP-datagram har skickats.</span><span class="sxs-lookup"><span data-stu-id="deb40-483">This number is typically incremented after an IP datagram is sent.</span></span> <span data-ttu-id="deb40-484">Det är särskilt användbart i att montera mottagna IP-paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-484">It is especially useful in assembling received IP packet fragments.</span></span>|
|<span data-ttu-id="deb40-485">***3-bitars flaggor***</span><span class="sxs-lookup"><span data-stu-id="deb40-485">***3-bit flags***</span></span> |<span data-ttu-id="deb40-486">Det här fältet innehåller information om IP-fragment.</span><span class="sxs-lookup"><span data-stu-id="deb40-486">This field contains IP fragmentation information.</span></span> <span data-ttu-id="deb40-487">Bit 14 är biten "ingen fragment".</span><span class="sxs-lookup"><span data-stu-id="deb40-487">Bit 14 is the "don't fragment" bit.</span></span> <span data-ttu-id="deb40-488">Om den här biten anges fragmenteras inte det utgående IP-datagrammet.</span><span class="sxs-lookup"><span data-stu-id="deb40-488">If this bit is set, the outgoing IP datagram will not be fragmented.</span></span> <span data-ttu-id="deb40-489">Bit 13 är biten "fler fragment".</span><span class="sxs-lookup"><span data-stu-id="deb40-489">Bit 13 is the "more fragments" bit.</span></span> <span data-ttu-id="deb40-490">Om den här biten anges finns det fler fragment.</span><span class="sxs-lookup"><span data-stu-id="deb40-490">If this bit is set, there are more fragments.</span></span> <span data-ttu-id="deb40-491">Om den här biten är klar är det sista fragmentet i IP-paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-491">If this bit is clear, this is the last fragment of the IP packet.</span></span>|
|<span data-ttu-id="deb40-492">***13-bitars fragment förskjutning***</span><span class="sxs-lookup"><span data-stu-id="deb40-492">***13-bit fragment offset***</span></span> |<span data-ttu-id="deb40-493">Det här fältet innehåller den övre 13 bitarna i fragment förskjutningen.</span><span class="sxs-lookup"><span data-stu-id="deb40-493">This field contains the upper 13-bits of the fragment offset.</span></span> <span data-ttu-id="deb40-494">Därför tillåts fragment förskjutningar bara på 8 byte-gränser.</span><span class="sxs-lookup"><span data-stu-id="deb40-494">Because of this, fragment offsets are only allowed on 8-byte boundaries.</span></span> <span data-ttu-id="deb40-495">Det första fragmentet i ett fragmenterat IP-datagram kommer att ha biten "fler fragment" och ha en förskjutning på 0.</span><span class="sxs-lookup"><span data-stu-id="deb40-495">The first fragment of a fragmented IP datagram will have the "more fragments" bit set and have an offset of 0.</span></span>|
|<span data-ttu-id="deb40-496">***8-bitars TTL-värde (Time to Live)***</span><span class="sxs-lookup"><span data-stu-id="deb40-496">***8-bit time to live (TTL)***</span></span> |<span data-ttu-id="deb40-497">Det här fältet innehåller antalet routrar som det här datagrammet kan skicka, vilket i princip är det som begränsar datagrammets livstid.</span><span class="sxs-lookup"><span data-stu-id="deb40-497">This field contains the number of routers this datagram can pass, which basically limits the lifetime of the datagram.</span></span>|
|<span data-ttu-id="deb40-498">***8-bitars protokoll***</span><span class="sxs-lookup"><span data-stu-id="deb40-498">***8-bit protocol***</span></span>|<span data-ttu-id="deb40-499">Det här fältet anger vilket protokoll som använder IP-datagrammet.</span><span class="sxs-lookup"><span data-stu-id="deb40-499">This field specifies which protocol is using the IP datagram.</span></span> <span data-ttu-id="deb40-500">Följande är en lista över giltiga protokoll och deras värden:</span><span class="sxs-lookup"><span data-stu-id="deb40-500">The following is a list of valid protocols and their values:</span></span><br /><span data-ttu-id="deb40-501">-ICMP: 0x01</span><span class="sxs-lookup"><span data-stu-id="deb40-501">- ICMP: 0x01</span></span> <br /><span data-ttu-id="deb40-502">-IGMP: protokollnumret 0x02</span><span class="sxs-lookup"><span data-stu-id="deb40-502">- IGMP: 0x02</span></span><br /><span data-ttu-id="deb40-503">-TCP: 0X06</span><span class="sxs-lookup"><span data-stu-id="deb40-503">- TCP: 0X06</span></span><br /><span data-ttu-id="deb40-504">-UDP: 0X11</span><span class="sxs-lookup"><span data-stu-id="deb40-504">- UDP: 0X11</span></span> |
|<span data-ttu-id="deb40-505">***16-bitars kontroll Summa***</span><span class="sxs-lookup"><span data-stu-id="deb40-505">***16-bit checksum***</span></span> |<span data-ttu-id="deb40-506">Det här fältet innehåller 16-bitars kontroll summa som endast täcker IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-506">This field contains the 16-bit checksum that covers the IP header only.</span></span> <span data-ttu-id="deb40-507">Det finns ytterligare kontroll summor i protokoll på högre nivå som behandlar IP-nyttolasten.</span><span class="sxs-lookup"><span data-stu-id="deb40-507">There are additional checksums in the higher level protocols that cover the IP payload.</span></span> |
|<span data-ttu-id="deb40-508">***32-bitars käll-IP-adress***</span><span class="sxs-lookup"><span data-stu-id="deb40-508">***32-bit source IP address***</span></span> |<span data-ttu-id="deb40-509">Det här fältet innehåller avsändarens IP-adress och är alltid en värd adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-509">This field contains the IP address of the sender and is always a host address.</span></span> |
|<span data-ttu-id="deb40-510">***32-bitars mål-IP-adress***</span><span class="sxs-lookup"><span data-stu-id="deb40-510">***32-bit destination IP address***</span></span> |<span data-ttu-id="deb40-511">Det här fältet innehåller mottagarens eller mottagarens IP-adress om adressen är en broadcast-eller multicast-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-511">This field contains the IP address of the receiver or receivers if the address is a broadcast or multicast address.</span></span> |

### <a name="creating-ip-instances"></a><span data-ttu-id="deb40-512">Skapar IP-instanser</span><span class="sxs-lookup"><span data-stu-id="deb40-512">Creating IP Instances</span></span>

<span data-ttu-id="deb40-513">IP-instanser skapas antingen under initieringen eller under körningen av program trådar.</span><span class="sxs-lookup"><span data-stu-id="deb40-513">IP instances are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="deb40-514">Den första IPv4-adressen, nätverks masken, standardpoolen, medie driv rutinen och minnet och prioriteten för den interna IP-tråden definieras av den ***nx_ip_create*** tjänsten även om programmet endast avser att använda IPv6-nätverk.</span><span class="sxs-lookup"><span data-stu-id="deb40-514">The initial IPv4 address, network mask, default packet pool, media driver, and memory and priority of the internal IP thread are defined by the ***nx_ip_create*** service even if the application intends to use IPv6 networks only.</span></span> <span data-ttu-id="deb40-515">Om programmet initierar IP-instansen med IPv4-adressen inställt på en ogiltig adress (0.0.0.0), förutsätts att gränssnitts adressen kommer att lösas genom manuell konfiguration senare, via RARP eller via DHCP eller liknande protokoll.</span><span class="sxs-lookup"><span data-stu-id="deb40-515">If the application initializes the IP instance with its IPv4 address set to an invalid address(0.0.0.0), it is assumed that the interface address is going to resolved by manual configuration later, via RARP, or through DHCP or similar protocols.</span></span>

<span data-ttu-id="deb40-516">För system med flera nätverks gränssnitt anges det primära gränssnittet vid anrop till \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="deb40-516">For systems with multiple network interfaces, the primary interface is designated when calling \***nx_ip_create** _.</span></span> <span data-ttu-id="deb40-517">Varje ytterligare gränssnitt kan kopplas till samma IP-instans genom att anropa _ *_nx_ip_interface_attach_* \*.</span><span class="sxs-lookup"><span data-stu-id="deb40-517">Each additional interface can be attached to the same IP instance by calling _\*_nx_ip_interface_attach_\*\*.</span></span> <span data-ttu-id="deb40-518">Den här tjänsten lagrar information om nätverks gränssnittet (till exempel IP-adress, nätverks mask) i gränssnitts kontroll blocket och kopplar driv rutins instansen till gränssnitts kontroll blocket i IP-instansen.</span><span class="sxs-lookup"><span data-stu-id="deb40-518">This service stores information about the network interface (such as IP address, network mask) in the interface control block, and associates the driver instance with the interface control block in the IP instance.</span></span> <span data-ttu-id="deb40-519">När driv rutinen tar emot ett data paket måste den lagra gränssnitts informationen i NX_PACKETs strukturen innan den vidarebefordras till IP Receive-logiken.</span><span class="sxs-lookup"><span data-stu-id="deb40-519">As the driver receives a data packet, it needs to store the interface information in the NX_PACKET structure before forwarding it to the IP receive logic.</span></span> <span data-ttu-id="deb40-520">Observera att en IP-instans redan måste skapas innan du kopplar några gränssnitt.</span><span class="sxs-lookup"><span data-stu-id="deb40-520">Note an IP instance must already be created before attaching any interfaces.</span></span>

<span data-ttu-id="deb40-521">IPv6-tjänster har inte startats efter anrop till \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="deb40-521">IPv6 services are not started after calling \***nx_ip_create** _.</span></span> <span data-ttu-id="deb40-522">Program som vill använda IPv6-tjänster måste anropa tjänsten _ *_nx_ipv6_enable_*\* för att starta IPv6.</span><span class="sxs-lookup"><span data-stu-id="deb40-522">Applications wishing to use IPv6 services must call the service _ *_nx_ipv6_enable_*\* to start IPv6.</span></span>

<span data-ttu-id="deb40-523">I IPv6-nätverket kan varje gränssnitt i en IP-instans ha flera globala IPv6-adresser.</span><span class="sxs-lookup"><span data-stu-id="deb40-523">On the IPv6 network, each interface in an IP instance may have multiple IPv6 global addresses.</span></span> <span data-ttu-id="deb40-524">Förutom att använda DHCPv6 för IPv6-adresstilldelning, kan en enhet även använda automatisk adress konfiguration.</span><span class="sxs-lookup"><span data-stu-id="deb40-524">In addition to using DHCPv6 for IPv6 address assignment, a device may also use Stateless Address Autoconfiguration.</span></span> <span data-ttu-id="deb40-525">Mer information finns i avsnitten "IP Control Block" och "IPv6-adress matchning" senare i det här kapitlet.</span><span class="sxs-lookup"><span data-stu-id="deb40-525">More information is available in the "IP Control Block" and "IPv6 Address Resolution" sections later in this chapter.</span></span>

### <a name="ip-send"></a><span data-ttu-id="deb40-526">IP-sändning</span><span class="sxs-lookup"><span data-stu-id="deb40-526">IP Send</span></span>

<span data-ttu-id="deb40-527">IP-sändnings bearbetningen i NetX Duo är mycket effektiv.</span><span class="sxs-lookup"><span data-stu-id="deb40-527">The IP send processing in NetX Duo is very streamlined.</span></span> <span data-ttu-id="deb40-528">Lägga-pekaren i paketet flyttas bakåt för att hantera IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-528">The prepend pointer in the packet is moved backwards to accommodate the IP header.</span></span> <span data-ttu-id="deb40-529">IP-huvudet har slutförts (med alla alternativ som anges av anrops protokoll skiktet) beräknas kontroll summan på raden (endast för IPv4-paket) och paketet skickas till den associerade nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="deb40-529">The IP header is completed (with all the options specified by the calling protocol layer), the IP checksum is computed in-line (for IPv4 packets only), and the packet is dispatched to the associated network driver.</span></span> <span data-ttu-id="deb40-530">Dessutom samordnas utgående fragmentering från bearbetningen av IP-överföring.</span><span class="sxs-lookup"><span data-stu-id="deb40-530">In addition, outgoing fragmentation is also coordinated from within the IP send processing.</span></span>

<span data-ttu-id="deb40-531">För IPv4 initierar NetX Duo ARP-begäranden om fysisk mappning krävs för målets IP-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-531">For IPv4, NetX Duo initiates ARP requests if physical mapping is needed for the destination IP address.</span></span> <span data-ttu-id="deb40-532">IPv6 använder Neighbor Discovery för IPv6-Address-tophysical-Address-mappning.</span><span class="sxs-lookup"><span data-stu-id="deb40-532">IPv6 uses Neighbor Discovery for IPv6-address-tophysical-address mapping.</span></span>

> [!NOTE]
> <span data-ttu-id="deb40-533">*För IPv4-anslutningar är paket som kräver IP-namnmatchning (dvs. fysisk mappning) i kö i ARP-kön tills antalet paket i kö överskrider ARP-ködjup (definieras av symbolen **NX_ARP_MAX_QUEUE_DEPTH**). Om ködjup nås tar NetX Duo bort det äldsta paketet i kön och fortsätter att vänta på adress matchning för de återstående paketen i kö. Å andra sidan, om en ARP-post inte har lösts, släpps de väntande paketen på ARP-posten vid tids gränsen för ARP-posten.*</span><span class="sxs-lookup"><span data-stu-id="deb40-533">*For IPv4 connectivity, packets that require IP address resolution (i.e., physical mapping) are enqueued on the ARP queue until the number of packets queued exceeds the ARP queue depth (defined by the symbol **NX_ARP_MAX_QUEUE_DEPTH**). If the queue depth is reached, NetX Duo will remove the oldest packet on the queue and continue waiting for address resolution for the remaining packets enqueued. On the other hand, if an ARP entry is not resolved, the pending packets on the ARP entry are released upon ARP entry timeout.*</span></span>

<span data-ttu-id="deb40-534">För system med flera nätverks gränssnitt väljer NetX Duo ett gränssnitt baserat på mål-IP-adressen.</span><span class="sxs-lookup"><span data-stu-id="deb40-534">For systems with multiple network interfaces, NetX Duo chooses an interface based on the destination IP address.</span></span> <span data-ttu-id="deb40-535">Följande procedur gäller för urvals processen:</span><span class="sxs-lookup"><span data-stu-id="deb40-535">The following procedure applies to the selection process:</span></span>

1. <span data-ttu-id="deb40-536">Om avsändaren anger ett utgående gränssnitt och gränssnittet är giltigt använder du det gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="deb40-536">If the sender specifies an outgoing interface and the interface is valid, use that interface.</span></span>
2. <span data-ttu-id="deb40-537">Om en mål adress är IPv4-broadcast eller multicast används det första aktiverade fysiska gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="deb40-537">If a destination address is IPv4 broadcast or multicast, the first enabled physical interface is used.</span></span>
3. <span data-ttu-id="deb40-538">Om mål adressen finns i tabellen för statisk routning används det gränssnitt som är associerat med gatewayen.</span><span class="sxs-lookup"><span data-stu-id="deb40-538">If the destination address is found in the static routing table, the interface associated with the gateway is used.</span></span>
4. <span data-ttu-id="deb40-539">Om målet är länkat, används on-Link-gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="deb40-539">If the destination is on-link, the on-link interface is used.</span></span>
5. <span data-ttu-id="deb40-540">Om mål adressen är en länk lokal adress (169.254.0.0/16) används det första giltiga gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="deb40-540">If the destination address is a link-local address (169.254.0.0/16), the first valid interface is used.</span></span>
6. <span data-ttu-id="deb40-541">Om standard-gatewayen har kon figurer ATS använder du det gränssnitt som är associerat med standardgateway för att överföra paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-541">If the default gateway is configured, use the interface associated with the default gateway to transmit the packet.</span></span>
7. <span data-ttu-id="deb40-542">Slutligen, om en av de giltiga IP-adresserna för gränssnittet är länk lokal adress (169.254.0.0/16), används det här gränssnittet som käll adress för överföringen.</span><span class="sxs-lookup"><span data-stu-id="deb40-542">Finally, if one of the valid interface IP address is link-local address (169.254.0.0/16), this interface is used as source address for the transmission.</span></span>
8. <span data-ttu-id="deb40-543">Utgående paket ignoreras om inget av ovanstående inträffar.</span><span class="sxs-lookup"><span data-stu-id="deb40-543">The output packet is dropped if all above fails.</span></span>

### <a name="ip-receive"></a><span data-ttu-id="deb40-544">IP-mottagning</span><span class="sxs-lookup"><span data-stu-id="deb40-544">IP Receive</span></span>

<span data-ttu-id="deb40-545">Den mottagna IP-bearbetningen anropas antingen från nätverks driv rutinen eller den interna IP-tråden (för bearbetning av paket i kön med uppskjutna mottagna paket).</span><span class="sxs-lookup"><span data-stu-id="deb40-545">The IP receive processing is either called from the network driver or the internal IP thread (for processing packets on the deferred received packet queue).</span></span> <span data-ttu-id="deb40-546">IP-inleveransbearbetning undersöker protokoll fältet och försöker skicka paketet till rätt protokoll komponent.</span><span class="sxs-lookup"><span data-stu-id="deb40-546">The IP receive processing examines the protocol field and attempts to dispatch the packet to the proper protocol component.</span></span> <span data-ttu-id="deb40-547">Innan paketet skickas tas IP-huvudet bort genom att lägga-pekaren flyttas förbi IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-547">Before the packet is actually dispatched, the IP header is removed by advancing the prepend pointer past the IP header.</span></span>

<span data-ttu-id="deb40-548">IP Receive-bearbetning identifierar också fragmenterade IP-paket och utför nödvändiga steg för att sätta samman dem igen om fragmentering har Aktiver ATS.</span><span class="sxs-lookup"><span data-stu-id="deb40-548">IP receive processing also detects fragmented IP packets and performs the necessary steps to reassemble them if fragmentation is enabled.</span></span> <span data-ttu-id="deb40-549">Om fragmentering krävs men inte aktive rad, ignoreras paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-549">If fragmentation is needed but not enabled, the packet is dropped.</span></span>

<span data-ttu-id="deb40-550">NetX Duo avgör lämpligt nätverks gränssnitt baserat på det gränssnitt som anges i paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-550">NetX Duo determines the appropriate network interface based on the interface specified in the packet.</span></span> <span data-ttu-id="deb40-551">Om paket gränssnittet är NULL är NetX Duo standardvärdet för det primära gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="deb40-551">If the packet interface is NULL, NetX Duo defaults to the primary interface.</span></span> <span data-ttu-id="deb40-552">Detta görs för att garantera kompatibilitet med äldre NetX Duo Ethernet-drivrutiner.</span><span class="sxs-lookup"><span data-stu-id="deb40-552">This is done to guarantee compatibility with legacy NetX Duo Ethernet drivers.</span></span>

### <a name="raw-ip-send"></a><span data-ttu-id="deb40-553">RAW IP-sändning</span><span class="sxs-lookup"><span data-stu-id="deb40-553">Raw IP Send</span></span>

<span data-ttu-id="deb40-554">Ett RAW IP-paket är en IP-ram som innehåller nytto lasten i versaler och protokoll som inte stöds direkt (och bearbetas) av NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="deb40-554">A raw IP packet is an IP frame that contains upper layer protocol payload not directly supported (and processed) by NetX Duo.</span></span> <span data-ttu-id="deb40-555">Med ett RAW-paket kan utvecklare definiera sina egna IP-baserade program.</span><span class="sxs-lookup"><span data-stu-id="deb40-555">A raw packet allows developers to define their own IP-based applications.</span></span> <span data-ttu-id="deb40-556">Ett program kan skicka Raw IP-paket direkt med hjälp av ***nxd_ip_raw_packet_send** _-tjänsten om RAW IP-paketfiltrering har Aktiver ATS med tjänsten _*_nx_ip_raw_packet_enabled_\*_ .</span><span class="sxs-lookup"><span data-stu-id="deb40-556">An application may send raw IP packets directly using the ***nxd_ip_raw_packet_send** _ service if raw IP packet processing has been enabled with the _*_nx_ip_raw_packet_enabled_\*_ service.</span></span> <span data-ttu-id="deb40-557">När du överför ett unicast-paket i ett IPv6-nätverk fastställer NetX Duo automatiskt den bästa käll-IPv6-adressen som ska användas för att skicka paketen utifrån mål adressen.</span><span class="sxs-lookup"><span data-stu-id="deb40-557">When transmitting a unicast packet on an IPv6 network, NetX Duo automatically determines the best source IPv6 address to use to send the packets out on, based on the destination address.</span></span> <span data-ttu-id="deb40-558">Om mål adressen är en multicast-eller broadcast för IPv4-adress, kommer NetX Duo att standardvärdet för det första (primära) gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="deb40-558">If the destination address is a multicast (or broadcast for IPv4) address, however, NetX Duo will default to the first (primary) interface.</span></span> <span data-ttu-id="deb40-559">För att skicka sådana paket från sekundära gränssnitt måste programmet därför använda tjänsten _ *_nx_ip_raw_packet_source_send_*\* för att ange käll adressen som ska användas för det utgående paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-559">Therefore, to send such packets out on secondary interfaces, the application must use the _ *_nx_ip_raw_packet_source_send_*\* service to specify the source address to use for the outgoing packet.</span></span>

### <a name="raw-ip-receive"></a><span data-ttu-id="deb40-560">RAW IP-mottagning</span><span class="sxs-lookup"><span data-stu-id="deb40-560">Raw IP Receive</span></span>

<span data-ttu-id="deb40-561">Om RAW IP-paketfiltrering är aktive rad kan programmet få obehandlade IP-paket via tjänsten \***nx_ip_raw_packet_receive** _.</span><span class="sxs-lookup"><span data-stu-id="deb40-561">If raw IP packet processing is enabled, the application may receive raw IP packets through the \***nx_ip_raw_packet_receive** _ service.</span></span> <span data-ttu-id="deb40-562">Alla inkommande paket bearbetas enligt det protokoll som anges i IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-562">All incoming packets are processed according to the protocol specified in the IP header.</span></span> <span data-ttu-id="deb40-563">Om protokollet anger UDP, TCP, IGMP eller ICMP, kommer NetX Duo att bearbeta paketet med lämplig hanterare för paket protokoll typen.</span><span class="sxs-lookup"><span data-stu-id="deb40-563">If the protocol specifies UDP, TCP, IGMP or ICMP, NetX Duo will process the packet using the appropriate handler for the packet protocol type.</span></span> <span data-ttu-id="deb40-564">Om protokollet inte är ett av dessa protokoll och RAW IP Receive är aktiverat placeras det inkommande paketet i kön för rå paket som väntar på att programmet ska ta emot det via _\*_nx_ip_raw_packet_receive_\*\*-tjänsten. Dessutom kan program trådar pausas med en valfri tids gräns vid väntan på ett RAW IP-paket. Antalet paket som kan köas i kön för obehandlade paket är begränsat. Max värdet definieras i \***NX_IP_RAW_MAX_QUEUE_DEPTH**_, vars standardvärde är 20.</span><span class="sxs-lookup"><span data-stu-id="deb40-564">If the protocol is not one of these protocols, and raw IP receive is enabled, the incoming packet will be put into the raw packet queue waiting for the application to receive it via the _*_nx_ip_raw_packet_receive_*\* service. In addition, application threads may suspend with an optional timeout while waiting for a raw IP packet. The number of packets that can be queued on the raw packet queue is limited. The maximum value is defined in \***NX_IP_RAW_MAX_QUEUE_DEPTH**_, whose default value is 20.</span></span> <span data-ttu-id="deb40-565">Ett program kan ändra det maximala värdet genom att anropa tjänsten _ \*_nx_ip_raw_receive_queue_max_set_\*\*.</span><span class="sxs-lookup"><span data-stu-id="deb40-565">An application may change the maximum value by calling the _ *_nx_ip_raw_receive_queue_max_set_*\* service.</span></span>

<span data-ttu-id="deb40-566">Alternativt kan NetX Duo-biblioteket skapas med \*\**NX_ENABLE_IP_RAW_PACKET_FILTER *.**</span><span class="sxs-lookup"><span data-stu-id="deb40-566">Alternatively, the NetX Duo library may be built with \***NX_ENABLE_IP_RAW_PACKET_FILTER\*.**</span></span> <span data-ttu-id="deb40-567">I det här läget har programmet en motringnings funktion som anropas varje gång ett paket med en ohanterad protokoll typ tas emot.</span><span class="sxs-lookup"><span data-stu-id="deb40-567">In this mode of operation, the application provides a callback function that is invoked every time a packet with an unhandled protocol type is received.</span></span> <span data-ttu-id="deb40-568">IP Receive-logiken vidarebefordrar paketet till den användardefinierade RAW-paketets mottagnings filter rutin.</span><span class="sxs-lookup"><span data-stu-id="deb40-568">The IP receive logic forwards the packet to the user-defined raw packet receive filter routine.</span></span> <span data-ttu-id="deb40-569">Filter rutinen bestämmer huruvida RAW-paketet ska behållas för framtida processer eller inte.</span><span class="sxs-lookup"><span data-stu-id="deb40-569">The filter routine decides whether or not to keep the raw packet for future process.</span></span> <span data-ttu-id="deb40-570">Returvärdet från återanrops rutinen visar om paketet har bearbetats av det obehandlade paket mottagnings filtret.</span><span class="sxs-lookup"><span data-stu-id="deb40-570">The return value from the callback routine indicates whether the packet has been processed by the raw packet receive filter.</span></span> <span data-ttu-id="deb40-571">Om paketet bearbetas av motringningsfunktionen bör paketet frisläppas när programmet har gjorts med paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-571">If the packet is processed by the callback function, the packet should be released after the application is done with the packet.</span></span> <span data-ttu-id="deb40-572">Annars är NetX Duo ansvarig för att släppa paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-572">Otherwise, NetX Duo is responsible for releasing the packet.</span></span> <span data-ttu-id="deb40-573">Mer information om hur du använder funktionen RAW Packet filter hittar du i **_nx_ip_raw_packet_filter_set_** .</span><span class="sxs-lookup"><span data-stu-id="deb40-573">Refer to the **_nx_ip_raw_packet_filter_set_** for more information on how to use the raw packet filter function.</span></span>

> [!NOTE]
> <span data-ttu-id="deb40-574">\* BSD-funktionen för NetX Duo förlitar sig på funktionen för RAW Packet filter för att hantera BSD RAW-socketar.</span><span class="sxs-lookup"><span data-stu-id="deb40-574">\*The BSD wrapper function for NetX Duo relies on the raw packet filter function to handle BSD raw sockets.</span></span> <span data-ttu-id="deb40-575">För att stödja RAW-socket i BSD-omslutningen måste NetX Duo-biblioteket skapas med ***NX_ENABLE_IP_RAW_PACKET_FILTER** _ definieras och programmet ska inte använda _*_nx_ip_raw_packet_filter_set_\*_ för att installera ett eget paket FILTER för rå data functions._</span><span class="sxs-lookup"><span data-stu-id="deb40-575">Therefore, to support raw socket in the BSD wrapper, the NetX Duo library must be built with ***NX_ENABLE_IP_RAW_PACKET_FILTER** _ defined, and the application should not use the _*_nx_ip_raw_packet_filter_set_\*_ to install its own raw packet filter functions._</span></span>

### <a name="default-packet-pool"></a><span data-ttu-id="deb40-576">Standard pakets bassäng</span><span class="sxs-lookup"><span data-stu-id="deb40-576">Default Packet Pool</span></span>

<span data-ttu-id="deb40-577">Varje IP-instans tilldelas en standardpool för paket när den skapas.</span><span class="sxs-lookup"><span data-stu-id="deb40-577">Each IP instance is given a default packet pool during creation.</span></span> <span data-ttu-id="deb40-578">Den här poolen används för att allokera paket för ARP, RARP, ICMP, IGMP, olika TCP-kontroll paket (SYN, ACK, och så vidare), identifiering av grannar, routerupptäckt och duplicerad adress identifiering.</span><span class="sxs-lookup"><span data-stu-id="deb40-578">This packet pool is used to allocate packets for ARP, RARP, ICMP, IGMP, various TCP control packets (SYN, ACK, and so on), Neighbor Discovery, Router Discovery, and Duplicate Address Detection.</span></span> <span data-ttu-id="deb40-579">Om standardpoolen är tom när NetX Duo måste allokera ett paket kan NetX Duo behöva avbryta den specifika åtgärden och returnera ett fel meddelande om möjligt.</span><span class="sxs-lookup"><span data-stu-id="deb40-579">If the default packet pool is empty when NetX Duo needs to allocate a packet, NetX Duo may have to abort the particular operation, and will return an error message if possible.</span></span>

### <a name="ip-helper-thread"></a><span data-ttu-id="deb40-580">IP-hjälp tråd</span><span class="sxs-lookup"><span data-stu-id="deb40-580">IP Helper Thread</span></span>

<span data-ttu-id="deb40-581">Varje IP-instans har en hjälp tråd.</span><span class="sxs-lookup"><span data-stu-id="deb40-581">Each IP instance has a helper thread.</span></span> <span data-ttu-id="deb40-582">Den här tråden ansvarar för hantering av all uppskjuten paket bearbetning och all periodisk bearbetning.</span><span class="sxs-lookup"><span data-stu-id="deb40-582">This thread is responsible for handling all deferred packet processing and all periodic processing.</span></span> <span data-ttu-id="deb40-583">IP-hjälpens tråd skapas i ***nx_ip_create.*** Det är här som tråden tilldelas sin stack och prioritet.</span><span class="sxs-lookup"><span data-stu-id="deb40-583">The IP helper thread is created in ***nx_ip_create.*** This is where the thread is given its stack and priority.</span></span> <span data-ttu-id="deb40-584">Observera att den första bearbetningen i IP Helper-tråden är att slutföra initieringen av nätverks driv rutinen som är associerad med IP-Create-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="deb40-584">Note that the first processing in the IP helper thread is to finish the network driver initialization associated with the IP create service.</span></span> <span data-ttu-id="deb40-585">När nätverks driv rutins initieringen är klar startar hjälp tråden en oändlig slinga för att bearbeta paket och periodiska begär Anden.</span><span class="sxs-lookup"><span data-stu-id="deb40-585">After the network driver initialization is complete, the helper thread starts an endless loop to process packet and periodic requests.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="deb40-586">*Om ett oförutsägbart beteende visas i IP-undersöknings tråden, är det första fel söknings steget att öka dess stack storlek under IP-tjänsten för att skapa fel sökning. Om stacken är för liten kan IP-hjälpen eventuellt skriva över minne, vilket kan orsaka ovanliga problem.*</span><span class="sxs-lookup"><span data-stu-id="deb40-586">*If unexplained behavior is seen within the IP helper thread, increasing its stack size during the IP create service is the first debugging step. If the stack is too small, the IP helper thread could possibly be overwriting memory, which may cause unusual problems.*</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="deb40-587">Tråd upphängning</span><span class="sxs-lookup"><span data-stu-id="deb40-587">Thread Suspension</span></span>

<span data-ttu-id="deb40-588">Program trådar kan pausas vid försök att ta emot obehandlade IP-paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-588">Application threads can suspend while attempting to receive raw IP packets.</span></span> <span data-ttu-id="deb40-589">När ett RAW-paket tas emot, tilldelas det nya paketet den första tråden och tråden återupptas.</span><span class="sxs-lookup"><span data-stu-id="deb40-589">After a raw packet is received, the new packet is given to the first thread suspended and that thread is resumed.</span></span> <span data-ttu-id="deb40-590">NetX Duo-tjänster för att ta emot paket har en valfri tids gräns för avstängning.</span><span class="sxs-lookup"><span data-stu-id="deb40-590">NetX Duo services for receiving packets all have an optional suspension timeout.</span></span> <span data-ttu-id="deb40-591">När ett paket tas emot eller tids gränsen går ut, återupptas program tråden med rätt slut för ande status.</span><span class="sxs-lookup"><span data-stu-id="deb40-591">When a packet is received or the timeout expires, the application thread is resumed with the appropriate completion status.</span></span>

### <a name="ip-statistics-and-errors"></a><span data-ttu-id="deb40-592">IP-statistik och fel</span><span class="sxs-lookup"><span data-stu-id="deb40-592">IP Statistics and Errors</span></span>

<span data-ttu-id="deb40-593">Om den är aktive rad håller NetX Duo reda på flera statistik och fel som kan vara användbara för programmet.</span><span class="sxs-lookup"><span data-stu-id="deb40-593">If enabled, the NetX Duo keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="deb40-594">Följande statistik och fel rapporter underhålls för varje IP-instans:</span><span class="sxs-lookup"><span data-stu-id="deb40-594">The following statistics and error reports are maintained for each IP instance:</span></span>

- <span data-ttu-id="deb40-595">Totalt antal skickade IP-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-595">Total IP Packets Sent</span></span>
- <span data-ttu-id="deb40-596">Totalt antal skickade IP-byte</span><span class="sxs-lookup"><span data-stu-id="deb40-596">Total IP Bytes Sent</span></span>
- <span data-ttu-id="deb40-597">Totalt antal mottagna IP-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-597">Total IP Packets Received</span></span>
- <span data-ttu-id="deb40-598">Totalt antal mottagna IP-byte</span><span class="sxs-lookup"><span data-stu-id="deb40-598">Total IP Bytes Received</span></span>
- <span data-ttu-id="deb40-599">Totalt antal ogiltiga IP-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-599">Total IP Invalid Packets</span></span>
- <span data-ttu-id="deb40-600">Totalt antal borttagna IP-mottagna paket</span><span class="sxs-lookup"><span data-stu-id="deb40-600">Total IP Receive Packets Dropped</span></span>
- <span data-ttu-id="deb40-601">Totalt antal fel vid kontroll av IP-mottagning</span><span class="sxs-lookup"><span data-stu-id="deb40-601">Total IP Receive Checksum Errors</span></span>
- <span data-ttu-id="deb40-602">Totalt antal borttagna IP-skickade paket</span><span class="sxs-lookup"><span data-stu-id="deb40-602">Total IP Send Packets Dropped</span></span>
- <span data-ttu-id="deb40-603">Totalt antal skickade IP-fragment</span><span class="sxs-lookup"><span data-stu-id="deb40-603">Total IP Fragments Sent</span></span>
- <span data-ttu-id="deb40-604">Totalt antal mottagna IP-fragment</span><span class="sxs-lookup"><span data-stu-id="deb40-604">Total IP Fragments Received</span></span>

<span data-ttu-id="deb40-605">Alla dessa statistik-och fel rapporter är tillgängliga för programmet med tjänsten ***nx_ip_info_get***.</span><span class="sxs-lookup"><span data-stu-id="deb40-605">All of these statistics and error reports are available to the application with the ***nx_ip_info_get*** service.</span></span>

### <a name="ip-control-block-nx_ip"></a><span data-ttu-id="deb40-606">Kontroll block för IP-kontroll NX_IP</span><span class="sxs-lookup"><span data-stu-id="deb40-606">IP Control Block NX_IP</span></span>

<span data-ttu-id="deb40-607">Egenskaperna för varje IP-instans finns i kontroll blocket.</span><span class="sxs-lookup"><span data-stu-id="deb40-607">The characteristics of each IP instance are found in its control block.</span></span> <span data-ttu-id="deb40-608">Den innehåller användbar information, till exempel IP-adresser och nätverks masker för varje nätverks enhet och en tabell med grann-IP och mappning av fysiska maskin varu adresser.</span><span class="sxs-lookup"><span data-stu-id="deb40-608">It contains useful information such as the IP addresses and network masks of each network device, and a table of neighbor IP and physical hardware address mapping.</span></span> <span data-ttu-id="deb40-609">Den här strukturen definieras i \***nx_api. h**-_file.</span><span class="sxs-lookup"><span data-stu-id="deb40-609">This structure is defined in the \***nx_api.h** _file.</span></span> <span data-ttu-id="deb40-610">Om IPv6 är aktiverat innehåller den även en matris med IPv6-adress, antalet som anges av alternativet användare som kan konfigureras, _ *_NX_MAX_IPV6_ADDRESSES_* \*.</span><span class="sxs-lookup"><span data-stu-id="deb40-610">If IPv6 is enabled, it also contains an array of IPv6 address, the number of which is specified by the user configurable option _\*_NX_MAX_IPV6_ADDRESSES_\*\*.</span></span> <span data-ttu-id="deb40-611">Standardvärdet tillåter att varje fysiskt nätverks gränssnitt har tre IPv6-adresser.</span><span class="sxs-lookup"><span data-stu-id="deb40-611">The default value allows each physical network interface to have three IPv6 addresses.</span></span>

<span data-ttu-id="deb40-612">Kontroll block för IP-instans kan finnas var som helst i minnet, men det är vanligt att kontrol lera att kontrollen blockerar en global struktur genom att definiera den utanför omfånget för en funktion.</span><span class="sxs-lookup"><span data-stu-id="deb40-612">IP instance control blocks can be located anywhere in memory, but it is most common to make the control block a global structure by defining it outside the scope of any function.</span></span>

### <a name="static-ipv4-routing"></a><span data-ttu-id="deb40-613">Statisk IPv4-routning</span><span class="sxs-lookup"><span data-stu-id="deb40-613">Static IPv4 Routing</span></span>

<span data-ttu-id="deb40-614">Funktionen för statisk routning gör det möjligt för ett program att ange ett IPv4-nätverk och nästa hopp adress för specifika nätverks mål-IP-adresser.</span><span class="sxs-lookup"><span data-stu-id="deb40-614">The static routing feature allows an application to specify an IPv4 network and next hop address for specific out of network destination IP addresses.</span></span> <span data-ttu-id="deb40-615">Om statisk routning är aktiverat söker NetX Duo igenom den statiska routningstabellen för en post som matchar mål adressen för det paket som ska skickas.</span><span class="sxs-lookup"><span data-stu-id="deb40-615">If static routing is enabled, NetX Duo searches through the static routing table for an entry matching the destination address of the packet to send.</span></span> <span data-ttu-id="deb40-616">Om ingen matchning hittas söker NetX Duo igenom listan över fysiska gränssnitt och väljer en käll-IP-adress och nästa hopp adress baserat på mål-IP-adressen och nätverks masken.</span><span class="sxs-lookup"><span data-stu-id="deb40-616">If no match is found, NetX Duo searches through the list of physical interfaces and chooses a source IP address and next hop address based on the destination IP address and the network mask.</span></span> <span data-ttu-id="deb40-617">Om målet inte matchar någon av IP-adresserna för de nätverks driv rutiner som är kopplade till IP-instansen, väljer NetX Duo ett gränssnitt som är direkt anslutet till standard-gatewayen och använder gränssnittets IP-adress som käll adress och standard-gateway som nästa hopp.</span><span class="sxs-lookup"><span data-stu-id="deb40-617">If the destination does not match any of the IP addresses of the network drivers attached to the IP instance, NetX Duo chooses an interface that is directly connected to the default gateway, and uses the IP address of the interface as source address, and the default gateway as the next hop.</span></span>

<span data-ttu-id="deb40-618">Du kan lägga till och ta bort poster från tabellen för statisk routning med hjälp av \***nx_ip_static_route_add** _ och _ \*_nx_ip_static_route_delete_\*\*-tjänsterna.</span><span class="sxs-lookup"><span data-stu-id="deb40-618">Entries can be added and removed from the static routing table using the ***nx_ip_static_route_add** _ and _ *_nx_ip_static_route_delete_** services, respectively.</span></span> <span data-ttu-id="deb40-619">Om du vill använda statisk routning måste värd programmet aktivera den här funktionen genom att definiera ***NX_ENABLE_IP_STATIC_ROUTING.***</span><span class="sxs-lookup"><span data-stu-id="deb40-619">To use static routing, the host application must enable this feature by defining ***NX_ENABLE_IP_STATIC_ROUTING.***</span></span>

> [!NOTE]
> <span data-ttu-id="deb40-620">*När du lägger till en post i den statiska routningstabellen söker NetX Duo efter en matchande post för den angivna mål adressen redan i tabellen. Om det finns en sådan, ger den företräde för posten med det mindre nätverket (längre prefix) i nätverks masken.*</span><span class="sxs-lookup"><span data-stu-id="deb40-620">*When adding an entry to the static routing table, NetX Duo checks for a matching entry for the specified destination address already in the table. If one exists, it gives preference to the entry with the smaller network (longer prefix) in the network mask.*</span></span>

### <a name="ipv4-forwarding"></a><span data-ttu-id="deb40-621">IPv4-vidarebefordring</span><span class="sxs-lookup"><span data-stu-id="deb40-621">IPv4 Forwarding</span></span>

<span data-ttu-id="deb40-622">Om det inkommande IPv4-paketet inte är avsett för den här noden och IPv4-vidarebefordrings funktionen är aktive rad försöker NetX Duo vidarebefordra paketet via de andra gränssnitten.</span><span class="sxs-lookup"><span data-stu-id="deb40-622">If the incoming IPv4 packet is not destined for this node and IPv4 forwarding feature is enabled, NetX Duo attempts to forward the packet out via the other interfaces.</span></span>  

### <a name="ip-fragmentation"></a><span data-ttu-id="deb40-623">IP-fragmentering</span><span class="sxs-lookup"><span data-stu-id="deb40-623">IP Fragmentation</span></span>

<span data-ttu-id="deb40-624">Nätverks enheten kan ha gränser för storleken på utgående paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-624">The network device may have limits on the size of outgoing packets.</span></span> <span data-ttu-id="deb40-625">Den här gränsen kallas för maximal överförings enhet (MTU).</span><span class="sxs-lookup"><span data-stu-id="deb40-625">This limit is called the maximum transmission unit (MTU).</span></span> <span data-ttu-id="deb40-626">IP-MTU är den största IP-bildrutans storlek som en länk skikt driv rutin kan överföra utan att fragmentera IP-paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-626">IP MTU is the largest IP frame size a link layer driver is able to transmit without fragmenting the IP packet.</span></span> <span data-ttu-id="deb40-627">Under en initierings fas av enhets driv rutinen måste driv rutins modulen konfigurera dess IP-MTU-storlek via tjänsten ***nx_ip_interface_mtu_set.***</span><span class="sxs-lookup"><span data-stu-id="deb40-627">During a device driver initialization phase, the driver module must configure its IP MTU size via the service ***nx_ip_interface_mtu_set.***</span></span>

<span data-ttu-id="deb40-628">Även om det inte rekommenderas kan programmet generera datagram som är större än den underliggande IP-MTU som stöds av enheten.</span><span class="sxs-lookup"><span data-stu-id="deb40-628">Although not recommended, the application may generate datagrams larger than the underlying IP MTU supported by the device.</span></span> <span data-ttu-id="deb40-629">Innan det här IP-datagrammet överförs måste IP-skiktet fragmentera dessa paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-629">Before transmitting such IP datagram, the IP layer must fragment these packets.</span></span> <span data-ttu-id="deb40-630">När du tar emot fragmenterade IP-ramar måste det mottagande slutet lagra alla fragmenterade IP-ramar med samma fragment-ID och ommontera dem i rätt ordning.</span><span class="sxs-lookup"><span data-stu-id="deb40-630">On receiving fragmented IP frames, the receiving end must store all fragmented IP frames with the same fragmentation ID, and reassemble them in order.</span></span> <span data-ttu-id="deb40-631">Om IP-mottagnings logiken inte kan samla in alla fragment för att återställa den ursprungliga IP-ramen i tiden, släpps alla fragment.</span><span class="sxs-lookup"><span data-stu-id="deb40-631">If the IP receive logic is unable to collect all the fragments to restore the original IP frame in time, all the fragments are released.</span></span> <span data-ttu-id="deb40-632">Det är upp till det övre skikt protokollet för att identifiera sådana paket förluster och återställa från det.</span><span class="sxs-lookup"><span data-stu-id="deb40-632">It is up to the upper layer protocol to detect such packet loss and recover from it.</span></span>

<span data-ttu-id="deb40-633">IP-fragmentering gäller för både IPv4-och IPv6-paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-633">The IP fragmentation applies to both IPv4 and IPv6 packets.</span></span>

<span data-ttu-id="deb40-634">För att stödja IP-fragmentering och omsammansättnings åtgärd måste system designern aktivera funktionen IP-fragmentering i NetX Duo med hjälp av tjänsten ***nx_ip_fragment_enable*** .</span><span class="sxs-lookup"><span data-stu-id="deb40-634">In order to support IP fragmentation and reassembly operation, the system designer must enable the IP fragmentation feature in NetX Duo using the ***nx_ip_fragment_enable*** service.</span></span> <span data-ttu-id="deb40-635">Om den här funktionen inte är aktive rad ignoreras inkommande fragmenterade IP-paket, samt paket som överskrider nätverks driv Rutinens MTU.</span><span class="sxs-lookup"><span data-stu-id="deb40-635">If this feature is not enabled, incoming fragmented IP packets are discarded, as well as packets that exceed the network driver's MTU.</span></span>

> [!NOTE]
> <span data-ttu-id="deb40-636">\* Logiken för IP-fragmentering kan tas bort helt genom att definiera \***NX_DISABLE_FRAGMENTATION** _ när du skapar netx Duo-biblioteket.</span><span class="sxs-lookup"><span data-stu-id="deb40-636">\*The IP Fragmentation logic can be removed completely by defining \***NX_DISABLE_FRAGMENTATION** _ when building the NetX Duo library.</span></span> <span data-ttu-id="deb40-637">Detta bidrar till att minska kod storleken för NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="deb40-637">Doing so helps reduce the code size of NetX Duo.</span></span> <span data-ttu-id="deb40-638">Observera att i den här situationen är funktionerna för både IPv4-och IPv6-fragmentering/ommontering disabled._</span><span class="sxs-lookup"><span data-stu-id="deb40-638">Note that in this situation, both the IPv4 and IPv6 fragmentation/reassembly functions are disabled._</span></span>

> [!NOTE]
> <span data-ttu-id="deb40-639">*Om **NX_DISABLE_CHAINED_PACKET** har definierats måste IP-fragmentering vara inaktiverat.*</span><span class="sxs-lookup"><span data-stu-id="deb40-639">*If **NX_DISABLE_CHAINED_PACKET** is defined, IP fragmentation must be disabled.*</span></span>

> [!NOTE]
> <span data-ttu-id="deb40-640">*I ett IPv6-nätverk fragmenterar inte routrar ett datagram om storleken på datagrammet överskrider den minsta MTU-storleken. Därför är det upp till den sändande enheten för att fastställa den minsta MTU mellan källan och målet, och för att säkerställa att storleken på IP-datagram inte överskrider sökvägen till MTU. I NetX Duo kan IPv6-SÖKVÄGens MTU-identifiering aktive ras genom att skapa NetX Duo-biblioteket med symbolen **NX_ENABLE_IPV6_PATH_MTU_DISCOVERY** definierad.*</span><span class="sxs-lookup"><span data-stu-id="deb40-640">*In an IPv6 network, routers do not fragment a datagram if the size of the datagram exceeds its minimum MTU size. Therefore, it is up to the sending device to determine the minimum MTU between the source and the destination, and to ensure the IP datagram size does not exceed the path MTU. In NetX Duo, IPv6 PATH MTU discovery can be enabled by building NetX Duo library with the symbol **NX_ENABLE_IPV6_PATH_MTU_DISCOVERY** defined.*</span></span>

## <a name="address-resolution-protocol-arp-in-ipv4"></a><span data-ttu-id="deb40-641">ARP (Address Resolution Protocol) i IPv4</span><span class="sxs-lookup"><span data-stu-id="deb40-641">Address Resolution Protocol (ARP) in IPv4</span></span>

<span data-ttu-id="deb40-642">ARP-protokollet (Address Resolution Protocol) ansvarar för att dynamiskt mappa 32-bitars IPv4-adresser till de underliggande fysiska medierna (RFC 826).</span><span class="sxs-lookup"><span data-stu-id="deb40-642">The Address Resolution Protocol (ARP) is responsible for dynamically mapping 32-bit IPv4 addresses to those of the underlying physical media (RFC 826).</span></span> <span data-ttu-id="deb40-643">Ethernet är det mest typiska fysiska mediet och stöder 48-bitars adresser.</span><span class="sxs-lookup"><span data-stu-id="deb40-643">Ethernet is the most typical physical media, and it supports 48-bit addresses.</span></span> <span data-ttu-id="deb40-644">Behovet av ARP bestäms av nätverks driv rutinen som tillhandahålls till tjänsten \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="deb40-644">The need for ARP is determined by the network driver supplied to the \***nx_ip_create** _ service.</span></span> <span data-ttu-id="deb40-645">Om fysisk mappning krävs måste nätverks driv rutinen använda _ \*_nx_interface_address_mapping_needed_\*\*-tjänsten för att konfigurera driv rutins gränssnittet korrekt.</span><span class="sxs-lookup"><span data-stu-id="deb40-645">If physical mapping is required, the network driver must use the _ *_nx_interface_address_mapping_needed_*\* service to configure the driver interface properly.</span></span>

### <a name="arp-enable"></a><span data-ttu-id="deb40-646">Aktivera ARP</span><span class="sxs-lookup"><span data-stu-id="deb40-646">ARP Enable</span></span>

<span data-ttu-id="deb40-647">För att ARP ska fungera korrekt måste den först aktive ras av programmet med ***nx_arp_enable*** -tjänsten.</span><span class="sxs-lookup"><span data-stu-id="deb40-647">For ARP to function properly, it must first be enabled by the application with the ***nx_arp_enable*** service.</span></span> <span data-ttu-id="deb40-648">Den här tjänsten konfigurerar olika data strukturer för ARP-bearbetning, inklusive skapandet av ett ARP-cache-utrymme från det minne som har angetts till tjänsten ARP enable.</span><span class="sxs-lookup"><span data-stu-id="deb40-648">This service sets up various data structures for ARP processing, including the creation of an ARP cache area from the memory supplied to the ARP enable service.</span></span>

### <a name="arp-cache"></a><span data-ttu-id="deb40-649">ARP-cache</span><span class="sxs-lookup"><span data-stu-id="deb40-649">ARP Cache</span></span>

<span data-ttu-id="deb40-650">ARP-cachen kan visas som en matris med interna ARP-mappnings data strukturer.</span><span class="sxs-lookup"><span data-stu-id="deb40-650">The ARP cache can be viewed as an array of internal ARP mapping data structures.</span></span> <span data-ttu-id="deb40-651">Varje intern struktur kan underhålla relationen mellan en IP-adress och en fysisk maskin varu adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-651">Each internal structure is capable of maintaining the relationship between an IP address and a physical hardware address.</span></span> <span data-ttu-id="deb40-652">Dessutom har varje data struktur länk pekare så att den kan ingå i flera länkade listor.</span><span class="sxs-lookup"><span data-stu-id="deb40-652">In addition, each data structure has link pointers so it can be part of multiple linked lists.</span></span>

<span data-ttu-id="deb40-653">Programmet kan slå upp en IP-adress från ARP-cachen genom att tillhandahålla maskin varans MAC-adress med hjälp av tjänsten \***nx_arp_ip_address_find** _ om mappningen finns i ARP-tabellen.</span><span class="sxs-lookup"><span data-stu-id="deb40-653">Application can look up an IP address from the ARP cache by supplying hardware MAC address using the service \***nx_arp_ip_address_find** _ if the mapping exists in the ARP table.</span></span> <span data-ttu-id="deb40-654">På samma sätt returnerar tjänsten _ *_nx_arp_hardware_address_find_*\* Mac-adressen för en specifik IP-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-654">Similarly, the service _ *_nx_arp_hardware_address_find_*\* returns the MAC address for a given IP address.</span></span>

### <a name="arp-dynamic-entries"></a><span data-ttu-id="deb40-655">Dynamiska ARP-poster</span><span class="sxs-lookup"><span data-stu-id="deb40-655">ARP Dynamic Entries</span></span>

<span data-ttu-id="deb40-656">Som standard placerar tjänsten ARP Enable alla poster i ARP-cachen i listan över tillgängliga dynamiska ARP-poster.</span><span class="sxs-lookup"><span data-stu-id="deb40-656">By default, the ARP enable service places all entries in the ARP cache on the list of available dynamic ARP entries.</span></span> <span data-ttu-id="deb40-657">En dynamisk ARP-post tilldelas från den här listan av NetX Duo när en skicka-begäran till en omappad IP-adress identifieras.</span><span class="sxs-lookup"><span data-stu-id="deb40-657">A dynamic ARP entry is allocated from this list by NetX Duo when a send request to an unmapped IP address is detected.</span></span> <span data-ttu-id="deb40-658">Efter allokeringen konfigureras ARP-posten och en ARP-begäran skickas till det fysiska mediet.</span><span class="sxs-lookup"><span data-stu-id="deb40-658">After allocation, the ARP entry is set up and an ARP request is sent to the physical media.</span></span>

<span data-ttu-id="deb40-659">En dynamisk post kan också skapas av tjänsten ***nx_arp_dynamic_entry_set***.</span><span class="sxs-lookup"><span data-stu-id="deb40-659">A dynamic entry can also be created by the service ***nx_arp_dynamic_entry_set***.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="deb40-660">*Om alla dynamiska ARP-poster används ersätts den senast använda ARP-posten med en ny mappning.*</span><span class="sxs-lookup"><span data-stu-id="deb40-660">*If all dynamic ARP entries are in use, the least recently used ARP entry is replaced with a new mapping.*</span></span>

### <a name="arp-static-entries"></a><span data-ttu-id="deb40-661">Statiska ARP-poster</span><span class="sxs-lookup"><span data-stu-id="deb40-661">ARP Static Entries</span></span>

<span data-ttu-id="deb40-662">Programmet kan också konfigurera statiska ARP-mappningar genom att använda \***nx_arp_static_entry_create** _service.</span><span class="sxs-lookup"><span data-stu-id="deb40-662">The application can also set up static ARP mapping by using the \***nx_arp_static_entry_create** _service.</span></span> <span data-ttu-id="deb40-663">Den här tjänsten allokerar en ARP-post från listan över dynamiska ARP-poster och placerar den på den statiska listan med mappnings informationen som tillhandahålls av programmet.</span><span class="sxs-lookup"><span data-stu-id="deb40-663">This service allocates an ARP entry from the dynamic ARP entry list and places it on the static list with the mapping information supplied by the application.</span></span> <span data-ttu-id="deb40-664">Statiska ARP-poster omfattas inte av åter användning eller åldrande.</span><span class="sxs-lookup"><span data-stu-id="deb40-664">Static ARP entries are not subject to reuse or aging.</span></span> <span data-ttu-id="deb40-665">Programmet kan ta bort en statisk post genom att använda tjänsten _*_nx_arp_static_entry_delete_*_.</span><span class="sxs-lookup"><span data-stu-id="deb40-665">The application can delete a static entry by using the service _*_nx_arp_static_entry_delete_*_.</span></span> <span data-ttu-id="deb40-666">Om du vill ta bort alla statiska poster i ARP-tabellen kan programmet använda tjänsten _ *_nx_arp_static_entries_delete_* \*.</span><span class="sxs-lookup"><span data-stu-id="deb40-666">To remove all static entries in the ARP table, the application may use the service _\*_nx_arp_static_entries_delete_\*\*.</span></span>

### <a name="automatic-arp-entry"></a><span data-ttu-id="deb40-667">Automatisk ARP-post</span><span class="sxs-lookup"><span data-stu-id="deb40-667">Automatic ARP Entry</span></span>

<span data-ttu-id="deb40-668">NetX Duo registrerar peers IP/MAC-mappning efter peer-svar på ARP-begäran.</span><span class="sxs-lookup"><span data-stu-id="deb40-668">NetX Duo records the peer's IP/MAC mapping after the peer responses to the ARP request.</span></span> <span data-ttu-id="deb40-669">NetX Duo implementerar också funktionen automatisk ARP-post där den registrerar peer IP/MAC-adress mappning baserat på oombedda ARP-förfrågningar från nätverket.</span><span class="sxs-lookup"><span data-stu-id="deb40-669">NetX Duo also implements the automatic ARP entry feature where it records peer IP/MAC address mapping based on unsolicited ARP requests from the network.</span></span> <span data-ttu-id="deb40-670">Med den här funktionen kan ARP-tabellen fyllas i med peer-information, vilket minskar fördröjningen som krävs för att gå igenom ARP-begäran/svars cykeln.</span><span class="sxs-lookup"><span data-stu-id="deb40-670">This feature allows the ARP table to be populated with peer information, reducing the delay needed to go through the ARP request/response cycle.</span></span> <span data-ttu-id="deb40-671">Nack delen med att aktivera automatisk ARP är dock att ARP-tabellen ofta fyller på ett upptaget nätverk med många noder på den lokala länken, vilket skulle leda till byte av ARP-post.</span><span class="sxs-lookup"><span data-stu-id="deb40-671">However the downside with enabling automatic ARP is that the ARP table tend to fill up quickly on a busy network with many nodes on the local link, which would eventually lead to ARP entry replacement.</span></span>

<span data-ttu-id="deb40-672">Den här funktionen är aktive rad som standard.</span><span class="sxs-lookup"><span data-stu-id="deb40-672">This feature is enabled by default.</span></span> <span data-ttu-id="deb40-673">För att inaktivera det måste NetX Duo-biblioteket kompileras med symbolen ***NX_DISABLE_ARP_AUTO_ENTRY*** definierad.</span><span class="sxs-lookup"><span data-stu-id="deb40-673">To disable it, the NetX Duo library must be compiled with the symbol ***NX_DISABLE_ARP_AUTO_ENTRY*** defined.</span></span></p>

### <a name="arp-messages"></a><span data-ttu-id="deb40-674">ARP-meddelanden</span><span class="sxs-lookup"><span data-stu-id="deb40-674">ARP Messages</span></span>

<span data-ttu-id="deb40-675">Som tidigare nämnts skickas ett meddelande om ARP-begäran när IP-aktiviteten identifierar att mappning krävs för en IP-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-675">As mentioned previously, an ARP request message is sent when the IP task detects that mapping is needed for an IP address.</span></span> <span data-ttu-id="deb40-676">ARP-begäranden skickas regelbundet (var \***NX_ARP_UPDATE_RATE** _ sekunder) tills ett motsvarande ARP-svar tas emot.</span><span class="sxs-lookup"><span data-stu-id="deb40-676">ARP requests are sent periodically (every \***NX_ARP_UPDATE_RATE** _ seconds) until a corresponding ARP response is received.</span></span> <span data-ttu-id="deb40-677">Totalt _ *_NX_ARP_MAXIMUM_RETRIES_*\* ARP-begäranden görs innan ARP-försöket överges.</span><span class="sxs-lookup"><span data-stu-id="deb40-677">A total of _ *_NX_ARP_MAXIMUM_RETRIES_*\* ARP requests are made before the ARP attempt is abandoned.</span></span> <span data-ttu-id="deb40-678">När ett ARP-svar tas emot lagras den associerade fysiska adress informationen i ARP-posten i cacheminnet.</span><span class="sxs-lookup"><span data-stu-id="deb40-678">When an ARP response is received, the associated physical address information is stored in the ARP entry that is in the cache.</span></span>

<span data-ttu-id="deb40-679">För NetX Duo avgör Duo vilket gränssnitt som skickar ARP-förfrågningar och svar baserat på den angivna mål adressen.</span><span class="sxs-lookup"><span data-stu-id="deb40-679">For multihome systems, NetX Duo determines which interface to send the ARP requests and responses based on destination address specified.</span></span>

> [!NOTE]
> <span data-ttu-id="deb40-680">*Utgående IP-paket köas medan NetX Duo väntar på ARP-svaret. Antalet utgående IP-paket i kö definieras av konstanten **NX_ARP_MAX_QUEUE_DEPTH**.*</span><span class="sxs-lookup"><span data-stu-id="deb40-680">*Outgoing IP packets are queued while NetX Duo waits for the ARP response. The number of outgoing IP packets queued is defined by the constant **NX_ARP_MAX_QUEUE_DEPTH**.*</span></span>

<span data-ttu-id="deb40-681">NetX Duo svarar även på ARP-förfrågningar från andra noder i det lokala IPv4-nätverket.</span><span class="sxs-lookup"><span data-stu-id="deb40-681">NetX Duo also responds to ARP requests from other nodes on the local IPv4 network.</span></span> <span data-ttu-id="deb40-682">När en extern ARP-begäran görs som matchar den aktuella IP-adressen för det gränssnitt som tar emot ARP-begäran, skapar NetX Duo ett ARP-svarsmeddelande som innehåller den aktuella fysiska adressen.</span><span class="sxs-lookup"><span data-stu-id="deb40-682">When an external ARP request is made that matches the current IP address of the interface that receives the ARP request, NetX Duo builds an ARP response message that contains the current physical address.</span></span>

<span data-ttu-id="deb40-683">Formatet på Ethernet ARP-begäranden och-svar visas i bild 6 och beskrivs nedan.</span><span class="sxs-lookup"><span data-stu-id="deb40-683">The formats of Ethernet ARP requests and responses are shown in Figure 6 and are described below.</span></span>

| <span data-ttu-id="deb40-684">**Fråge-/svars &nbsp; fält**</span><span class="sxs-lookup"><span data-stu-id="deb40-684">**Request/Response&nbsp;Field**</span></span>         | <span data-ttu-id="deb40-685">**Syfte**</span><span class="sxs-lookup"><span data-stu-id="deb40-685">**Purpose**</span></span>            |
| ---------------------------------- | ---------------------- |
| <span data-ttu-id="deb40-686">***Ethernet-mål adress***</span><span class="sxs-lookup"><span data-stu-id="deb40-686">***Ethernet Destination Address***</span></span> | <span data-ttu-id="deb40-687">Detta 6-byte-fält innehåller mål adressen för ARP-svaret och är en sändning (alla) för ARP-förfrågningar.</span><span class="sxs-lookup"><span data-stu-id="deb40-687">This 6-byte field contains the destination address for the ARP response and is a broadcast (all ones) for ARP requests.</span></span> <span data-ttu-id="deb40-688">Det här fältet ställs in av nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="deb40-688">This field is setup by the network driver.</span></span> 
| <span data-ttu-id="deb40-689">***Ethernet-källans adress***</span><span class="sxs-lookup"><span data-stu-id="deb40-689">***Ethernet Source Address***</span></span>      | <span data-ttu-id="deb40-690">Detta 6-byte-fält innehåller adressen till avsändaren av ARP-begäran eller-svaret och har kon figurer ATS av nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="deb40-690">This 6-byte field contains the address of the sender of the ARP request or response and is set up by the network driver.</span></span> |
| <span data-ttu-id="deb40-691">***Ramtyp***</span><span class="sxs-lookup"><span data-stu-id="deb40-691">***Frame Type***</span></span> | <span data-ttu-id="deb40-692">Detta fält i 2 byte innehåller typen av Ethernet-ram som finns och, för ARP-förfrågningar och svar, detta är lika med 0x0806.</span><span class="sxs-lookup"><span data-stu-id="deb40-692">This 2-byte field contains the type of Ethernet frame present and, for ARP requests and responses, this is equal to 0x0806.</span></span> <span data-ttu-id="deb40-693">Detta är det sista fältet som nätverks driv rutinen ansvarar för att konfigurera.</span><span class="sxs-lookup"><span data-stu-id="deb40-693">This is the last field the network driver is responsible for setting up.</span></span> |
| <span data-ttu-id="deb40-694">***Maskin varu typ***</span><span class="sxs-lookup"><span data-stu-id="deb40-694">***Hardware Type***</span></span> | <span data-ttu-id="deb40-695">Detta fält i 2 byte innehåller maskin varu typen, som är 0x0001 för Ethernet.</span><span class="sxs-lookup"><span data-stu-id="deb40-695">This 2-byte field contains the hardware type, which is 0x0001 for Ethernet.</span></span> |
| <span data-ttu-id="deb40-696">***Protokoll typ***</span><span class="sxs-lookup"><span data-stu-id="deb40-696">***Protocol Type***</span></span> | <span data-ttu-id="deb40-697">Detta fält i 2 byte innehåller protokoll typen, som är 0x0800 för IP-adresser.</span><span class="sxs-lookup"><span data-stu-id="deb40-697">This 2-byte field contains the protocol type, which is 0x0800 for IP addresses.</span></span> |
| <span data-ttu-id="deb40-698">***Maskin varu storlek***</span><span class="sxs-lookup"><span data-stu-id="deb40-698">***Hardware Size***</span></span> | <span data-ttu-id="deb40-699">Det här 1-byte fältet innehåller maskin varu adressens storlek, som är 6 för Ethernet-adresser.</span><span class="sxs-lookup"><span data-stu-id="deb40-699">This 1-byte field contains the hardware address size, which is 6 for Ethernet addresses.</span></span> |

![Diagram över ARP-paketets format.](./media/user-guide/arp-packet-format.png)

<span data-ttu-id="deb40-701">**BILD 6. ARP-paketfilter**</span><span class="sxs-lookup"><span data-stu-id="deb40-701">**FIGURE 6. ARP Packet Format**</span></span>

| <span data-ttu-id="deb40-702">Fråge-/svars &nbsp; fält</span><span class="sxs-lookup"><span data-stu-id="deb40-702">Request/Response&nbsp;Field</span></span> | <span data-ttu-id="deb40-703">Syfte</span><span class="sxs-lookup"><span data-stu-id="deb40-703">Purpose</span></span> |
|---|---|
| <span data-ttu-id="deb40-704">***Protokoll storlek***</span><span class="sxs-lookup"><span data-stu-id="deb40-704">***Protocol Size***</span></span> | <span data-ttu-id="deb40-705">Detta 1-byte-fält innehåller IP-adressens storlek, som är 4 för IP-adresser.</span><span class="sxs-lookup"><span data-stu-id="deb40-705">This 1-byte field contains the IP address size, which is 4 for IP addresses.</span></span> |
| <span data-ttu-id="deb40-706">***Åtgärds kod***</span><span class="sxs-lookup"><span data-stu-id="deb40-706">***Operation Code***</span></span> | <span data-ttu-id="deb40-707">Detta fält i 2 byte innehåller åtgärden för det här ARP-paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-707">This 2-byte field contains the operation for this ARP packet.</span></span> <span data-ttu-id="deb40-708">En ARP-begäran anges med värdet 0x0001, medan ett ARP-svar representeras av värdet 0x0002.</span><span class="sxs-lookup"><span data-stu-id="deb40-708">An ARP request is specified with the value of 0x0001, while an ARP response is represented by a value of 0x0002.</span></span> |
| <span data-ttu-id="deb40-709">***Avsändarens Ethernet-adress***</span><span class="sxs-lookup"><span data-stu-id="deb40-709">***Sender Ethernet Address***</span></span> | <span data-ttu-id="deb40-710">Det här 6-byte-fältet innehåller avsändarens Ethernet-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-710">This 6-byte field contains the sender's Ethernet address.</span></span> |
| <span data-ttu-id="deb40-711">***Avsändarens IP-adress***</span><span class="sxs-lookup"><span data-stu-id="deb40-711">***Sender IP Address***</span></span> | <span data-ttu-id="deb40-712">Detta fält med fyra byte innehåller avsändarens IP-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-712">This 4-byte field contains the sender's IP address.</span></span> |
| <span data-ttu-id="deb40-713">***Mål-Ethernet-adress***</span><span class="sxs-lookup"><span data-stu-id="deb40-713">***Target Ethernet Address***</span></span> | <span data-ttu-id="deb40-714">Detta 6-byte-fält innehåller målets Ethernet-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-714">This 6-byte field contains the target's Ethernet address.</span></span> |
| <span data-ttu-id="deb40-715">***Mål-IP-adress***</span><span class="sxs-lookup"><span data-stu-id="deb40-715">***Target IP Address***</span></span> | <span data-ttu-id="deb40-716">Detta fält i 4 byte innehåller målets IP-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-716">This 4-byte field contains the target's IP address.</span></span> |

> [!NOTE]
> <span data-ttu-id="deb40-717">*ARP-förfrågningar och-svar är paket med Ethernet-nivå. Alla andra TCP/IP-paket kapslas in av ett IP-pakets huvud.*</span><span class="sxs-lookup"><span data-stu-id="deb40-717">*ARP requests and responses are Ethernet-level packets. All other TCP/IP packets are encapsulated by an IP packet header.*</span></span>

> [!NOTE]
> <span data-ttu-id="deb40-718">*Alla ARP-meddelanden i TCP/IP-implementeringen förväntas vara i **big endian** format. I det här formatet finns de mest signifikanta byten av ordet på den lägsta byte-adressen.*</span><span class="sxs-lookup"><span data-stu-id="deb40-718">*All ARP messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="arp-aging"></a><span data-ttu-id="deb40-719">ARP-åldrande</span><span class="sxs-lookup"><span data-stu-id="deb40-719">ARP Aging</span></span>

<span data-ttu-id="deb40-720">NetX stöder automatisk ogiltig dynamisk ARP-post.</span><span class="sxs-lookup"><span data-stu-id="deb40-720">NetX supports automatic dynamic ARP entry invalidation.</span></span><span data-ttu-id="deb40-721">\ ***NX_ARP_EXPIRATION_RATE** _ anger antalet sekunder som en upprättad IP-adress till fysisk mappning är giltig.</span><span class="sxs-lookup"><span data-stu-id="deb40-721">\ ***NX_ARP_EXPIRATION_RATE** _ specifies the number of seconds an established IP address to physical mapping stays valid.</span></span> <span data-ttu-id="deb40-722">Efter förfallo datum tas ARP-posten bort från ARP-cachen.</span><span class="sxs-lookup"><span data-stu-id="deb40-722">After expiration, the ARP entry is removed from the ARP cache.</span></span> <span data-ttu-id="deb40-723">Nästa försök att skicka till motsvarande IP-adress leder till en ny ARP-begäran.</span><span class="sxs-lookup"><span data-stu-id="deb40-723">The next attempt to send to the corresponding IP address will result in a new ARP request.</span></span> <span data-ttu-id="deb40-724">Om du anger _ *_NX_ARP_EXPIRATION_RATE_*\* till noll inaktive ras ARP-åldrande, vilket är standard konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="deb40-724">Setting _ *_NX_ARP_EXPIRATION_RATE_*\* to zero disables ARP aging, which is the default configuration.</span></span>

### <a name="arp-defend"></a><span data-ttu-id="deb40-725">ARP-försvara</span><span class="sxs-lookup"><span data-stu-id="deb40-725">ARP Defend</span></span>

<span data-ttu-id="deb40-726">När en ARP-begäran eller ett ARP-svars paket tas emot och avsändaren har samma IP-adress, som står i konflikt med IP-adressen för den här noden, skickar NetX Duo en ARP-begäran för den adressen som försvars tid.</span><span class="sxs-lookup"><span data-stu-id="deb40-726">When an ARP request or ARP response packet is received and the sender has the same IP address, which conflicts with the IP address of this node, NetX Duo sends an ARP request for that address as a defense.</span></span> <span data-ttu-id="deb40-727">Om ett konflikt-ARP-paket tas emot mer än en gång på 10 sekunder skickar NetX Duo inte fler försvarande paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-727">If the conflict ARP packet is received more than once in 10 seconds, NetX Duo does not send more defend packets.</span></span> <span data-ttu-id="deb40-728">Standard intervallet på 10 sekunder kan omdefinieras med \***NX_ARP_DEFEND_INTERVAL** _.</span><span class="sxs-lookup"><span data-stu-id="deb40-728">The default interval 10 seconds can be redefined by \***NX_ARP_DEFEND_INTERVAL** _.</span></span> <span data-ttu-id="deb40-729">Det här beteendet följer principen som anges i 2.4 (c) av RFC5227.</span><span class="sxs-lookup"><span data-stu-id="deb40-729">This behavior follows the policy specified in 2.4(c) of RFC5227.</span></span> <span data-ttu-id="deb40-730">Eftersom Windows XP ignorerar ARP-meddelande som ett svar för sin ARP-avsökning kan användaren definiera _ *_NX_ARP_DEFEND_BY_REPLY_*\* för att skicka ARP-svar som ytterligare försvar.</span><span class="sxs-lookup"><span data-stu-id="deb40-730">Since Windows XP ignores ARP announcement as a response for its ARP probe, user can define _ *_NX_ARP_DEFEND_BY_REPLY_*\* to send ARP response as additional defence.</span></span>

### <a name="arp-statistics-and-errors"></a><span data-ttu-id="deb40-731">ARP-statistik och fel</span><span class="sxs-lookup"><span data-stu-id="deb40-731">ARP Statistics and Errors</span></span>

<span data-ttu-id="deb40-732">Om den här inställningen är aktive rad håller NetX Duo ARP reda på flera statistik och fel som kan vara användbara för programmet.</span><span class="sxs-lookup"><span data-stu-id="deb40-732">If enabled, the NetX Duo ARP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="deb40-733">Följande statistik och fel rapporter underhålls för varje IP-ARP-bearbetning:</span><span class="sxs-lookup"><span data-stu-id="deb40-733">The following statistics and error reports are maintained for each IP's ARP processing:</span></span>

- <span data-ttu-id="deb40-734">Totalt antal skickade ARP-begäranden</span><span class="sxs-lookup"><span data-stu-id="deb40-734">Total ARP Requests Sent</span></span>
- <span data-ttu-id="deb40-735">Totalt antal mottagna ARP-begäranden</span><span class="sxs-lookup"><span data-stu-id="deb40-735">Total ARP Requests Received</span></span>
- <span data-ttu-id="deb40-736">Totalt antal skickade ARP-svar</span><span class="sxs-lookup"><span data-stu-id="deb40-736">Total ARP Responses Sent</span></span> 
- <span data-ttu-id="deb40-737">Totalt antal mottagna ARP-svar</span><span class="sxs-lookup"><span data-stu-id="deb40-737">Total ARP Responses Received</span></span> 
- <span data-ttu-id="deb40-738">Totalt antal dynamiska ARP-poster</span><span class="sxs-lookup"><span data-stu-id="deb40-738">Total ARP Dynamic Entries</span></span> 
- <span data-ttu-id="deb40-739">Totalt antal statiska ARP-poster</span><span class="sxs-lookup"><span data-stu-id="deb40-739">Total ARP Static Entries</span></span> 
- <span data-ttu-id="deb40-740">Totalt antal inaktuella ARP-poster</span><span class="sxs-lookup"><span data-stu-id="deb40-740">Total ARP Aged Entries</span></span> 
- <span data-ttu-id="deb40-741">Totalt antal ogiltiga ARP-meddelanden</span><span class="sxs-lookup"><span data-stu-id="deb40-741">Total ARP Invalid Messages</span></span> 

<span data-ttu-id="deb40-742">Alla dessa statistik-och fel rapporter är tillgängliga för programmet med tjänsten ***nx_arp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="deb40-742">All these statistics and error reports are available to the application with the ***nx_arp_info_get*** service.</span></span>

## <a name="reverse-address-resolution-protocol-rarp-in-ipv4"></a><span data-ttu-id="deb40-743">RARP (reversed Address Resolution Protocol) i IPv4</span><span class="sxs-lookup"><span data-stu-id="deb40-743">Reverse Address Resolution Protocol (RARP) in IPv4</span></span>

<span data-ttu-id="deb40-744">RARP (reversed Address Resolution Protocol) är protokollet för att begära nätverks tilldelning av värdens 32-bitars IP-adresser (RFC 903).</span><span class="sxs-lookup"><span data-stu-id="deb40-744">The Reverse Address Resolution Protocol (RARP) is the protocol for requesting network assignment of the host's 32-bit IP addresses (RFC 903).</span></span> <span data-ttu-id="deb40-745">Detta görs via en RARP-begäran och fortsätter regelbundet tills en nätverks medlem tilldelar en IP-adress till värd nätverks gränssnittet i ett RARP-svar.</span><span class="sxs-lookup"><span data-stu-id="deb40-745">This is done through an RARP request and continues periodically until a network member assigns an IP address to the host network interface in an RARP response.</span></span> <span data-ttu-id="deb40-746">Programmet skapar en IP-instans av tjänsten ***nx_ip_create*** med en noll IP-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-746">The application creates an IP instance by the service ***nx_ip_create*** with a zero IP address.</span></span> <span data-ttu-id="deb40-747">Om RARP har Aktiver ATS av programmet kan det använda RARP-protokollet för att begära en IP-adress från nätverks servern som är tillgänglig via gränssnittet som har en noll IP-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-747">If RARP is enabled by the application, it can use the RARP protocol to request an IP address from the network server accessible through the interface that has a zero IP address.</span></span>

### <a name="rarp-enable"></a><span data-ttu-id="deb40-748">Aktivera RARP</span><span class="sxs-lookup"><span data-stu-id="deb40-748">RARP Enable</span></span>

<span data-ttu-id="deb40-749">Om du vill använda RARP måste programmet skapa IP-instansen med en IP-adress som är noll och sedan aktivera RARP med hjälp av tjänsten ***nx_rarp_enable***.</span><span class="sxs-lookup"><span data-stu-id="deb40-749">To use RARP, the application must create the IP instance with an IP address of zero, then enable RARP using the service ***nx_rarp_enable***.</span></span> <span data-ttu-id="deb40-750">För flera hem system måste minst en nätverks enhet som är associerad med IP-instansen ha en IP-adress som är noll.</span><span class="sxs-lookup"><span data-stu-id="deb40-750">For multihome systems, at least one network device associated with the IP instance must have an IP address of zero.</span></span> <span data-ttu-id="deb40-751">RARP-bearbetningen skickar regelbundet RARP begär Anden för NetX Duo-systemet som kräver en IP-adress tills ett giltigt RARP-svar med den angivna IP-adressen för nätverket tas emot.</span><span class="sxs-lookup"><span data-stu-id="deb40-751">The RARP processing periodically sends RARP request messages for the NetX Duo system requiring an IP address until a valid RARP reply with the network designated IP address is received.</span></span> <span data-ttu-id="deb40-752">I det här läget är RARP-bearbetningen klar.</span><span class="sxs-lookup"><span data-stu-id="deb40-752">At this point, RARP processing is complete.</span></span>

<span data-ttu-id="deb40-753">När RARP har Aktiver ATS inaktive ras den automatiskt när alla gränssnitts adresser har lösts.</span><span class="sxs-lookup"><span data-stu-id="deb40-753">After RARP has been enabled, it is disabled automatically after all interface addresses are resolved.</span></span> <span data-ttu-id="deb40-754">Programmet kan tvinga RARP att avslutas genom att använda tjänsten ***nx_rarp_disable***.</span><span class="sxs-lookup"><span data-stu-id="deb40-754">The application may force RARP to terminate by using the service ***nx_rarp_disable***.</span></span>

### <a name="rarp-request"></a><span data-ttu-id="deb40-755">RARP-begäran</span><span class="sxs-lookup"><span data-stu-id="deb40-755">RARP Request</span></span>

<span data-ttu-id="deb40-756">Formatet på ett RARP begär ande paket är nästan identiskt med ARP-paketet som visas i [bild 6](#arp-messages). Den enda skillnaden är att fältet ramtyp är 0x8035 och fältet *Åtgärds kod* är 3, vilket anger en RARP-begäran.</span><span class="sxs-lookup"><span data-stu-id="deb40-756">The format of an RARP request packet is almost identical to the ARP packet shown in [Figure 6](#arp-messages).The only difference is the frame type field is 0x8035 and the *Operation Code* field is 3, designating an RARP request.</span></span> <span data-ttu-id="deb40-757">Som tidigare nämnts kommer RARP-begäranden att skickas regelbundet (var ***NX_RARP_UPDATE_RATE*** sekund) tills ett RARP-svar med den tilldelade IP-adressen för nätverket tas emot.</span><span class="sxs-lookup"><span data-stu-id="deb40-757">As mentioned previously, RARP requests will be sent periodically (every ***NX_RARP_UPDATE_RATE*** seconds) until a RARP reply with the network assigned IP address is received.</span></span>

> [!NOTE]
> <span data-ttu-id="deb40-758">*Alla RARP-meddelanden i TCP/IP-implementeringen förväntas vara i **big endian** format. I det här formatet finns de mest signifikanta byten av ordet på den lägsta byte-adressen.*</span><span class="sxs-lookup"><span data-stu-id="deb40-758">*All RARP messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="rarp-reply"></a><span data-ttu-id="deb40-759">RARP-svar</span><span class="sxs-lookup"><span data-stu-id="deb40-759">RARP Reply</span></span>

<span data-ttu-id="deb40-760">RARP svarsmeddelanden tas emot från nätverket och innehåller den nätverks tilldelade IP-adressen för den här värden.</span><span class="sxs-lookup"><span data-stu-id="deb40-760">RARP reply messages are received from the network and contain the network assigned IP address for this host.</span></span> <span data-ttu-id="deb40-761">Formatet på ett RARP Reply-paket är nästan identiskt med ARP-paketet som visas i bild 6.</span><span class="sxs-lookup"><span data-stu-id="deb40-761">The format of an RARP reply packet is almost identical to the ARP packet shown in Figure 6.</span></span> <span data-ttu-id="deb40-762">Den enda skillnaden är att fältet ramtyp är 0x8035 och fältet *Åtgärds kod* är 4, vilket anger ett RARP-svar.</span><span class="sxs-lookup"><span data-stu-id="deb40-762">The only difference is the frame type field is 0x8035 and the *Operation Code* field is 4, which designates an RARP reply.</span></span> <span data-ttu-id="deb40-763">När den har tagits emot är IP-adressen konfigurerad i IP-instansen, den periodiska RARP-begäran är inaktive rad och IP-instansen är nu klar för normal nätverks drift.</span><span class="sxs-lookup"><span data-stu-id="deb40-763">After received, the IP address is setup in the IP instance, the periodic RARP request is disabled, and the IP instance is now ready for normal network operation.</span></span>

<span data-ttu-id="deb40-764">För multihome-värdar tillämpas IP-adressen på det begärda nätverks gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="deb40-764">For multihome hosts, the IP address is applied to the requesting network interface.</span></span> <span data-ttu-id="deb40-765">Om det fortfarande finns andra nätverks gränssnitt som begär en tilldelning av IP-adresser, fortsätter den periodiska RARP-tjänsten tills alla IP-begäranden för IP-adresser är lösta.</span><span class="sxs-lookup"><span data-stu-id="deb40-765">If there are other network interfaces still requesting an IP address assignment, the periodic RARP service continues until all interface IP address requests are resolved.</span></span>

> [!NOTE]
> <span data-ttu-id="deb40-766">*Programmet ska inte använda IP-instansen förrän RARP-bearbetningen har slutförts. **Nx_ip_status_check** kan användas av program för att vänta på att RARP slutförs. För multihome-system ska programmet inte använda det begärda gränssnittet förrän RARP-bearbetningen har slutförts på det gränssnittet. Status för IP-adressen på den sekundära enheten kan kontrol leras med tjänsten **nx_ip_interface_status_check** .*</span><span class="sxs-lookup"><span data-stu-id="deb40-766">*The application should not use the IP instance until the RARP processing is complete. The **nx_ip_status_check** may be used by applications to wait for the RARP completion. For multihome systems, the application should not use the requesting interface until the RARP processing is complete on that interface. Status of the IP address on the secondary device can be checked with the **nx_ip_interface_status_check** service.*</span></span>

### <a name="rarp-statistics-and-errors"></a><span data-ttu-id="deb40-767">RARP statistik och fel</span><span class="sxs-lookup"><span data-stu-id="deb40-767">RARP Statistics and Errors</span></span>

<span data-ttu-id="deb40-768">Om den här inställningen är aktive rad håller NetX Duo RARP koll på flera statistik och fel som kan vara användbara för programmet.</span><span class="sxs-lookup"><span data-stu-id="deb40-768">If enabled, the NetX Duo RARP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="deb40-769">Följande statistik och fel rapporter underhålls för varje IP-RARP bearbetning:</span><span class="sxs-lookup"><span data-stu-id="deb40-769">The following statistics and error reports are maintained for each IP's RARP processing:</span></span>

- <span data-ttu-id="deb40-770">Totalt antal skickade RARP-begäranden</span><span class="sxs-lookup"><span data-stu-id="deb40-770">Total RARP Requests Sent</span></span>
- <span data-ttu-id="deb40-771">Totalt antal mottagna RARP-svar</span><span class="sxs-lookup"><span data-stu-id="deb40-771">Total RARP Responses Received</span></span>
- <span data-ttu-id="deb40-772">Totalt antal RARP ogiltiga meddelanden</span><span class="sxs-lookup"><span data-stu-id="deb40-772">Total RARP Invalid Messages</span></span>

<span data-ttu-id="deb40-773">Alla dessa statistik-och fel rapporter är tillgängliga för programmet med tjänsten ***nx_rarp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="deb40-773">All these statistics and error reports are available to the application with the ***nx_rarp_info_get*** service.</span></span>

## <a name="internet-control-message-protocol-icmp"></a><span data-ttu-id="deb40-774">Internet Control Message Protocol (ICMP)</span><span class="sxs-lookup"><span data-stu-id="deb40-774">Internet Control Message Protocol (ICMP)</span></span>

<span data-ttu-id="deb40-775">Internet Control Message Protocol för IPv4 (ICMP) är begränsad till överföring av fel och kontroll av information mellan IP-medlemmar.</span><span class="sxs-lookup"><span data-stu-id="deb40-775">Internet Control Message Protocol for IPv4 (ICMP) is limited to passing error and control information between IP network members.</span></span> <span data-ttu-id="deb40-776">Internet Control Message Protocol för IPv6 (ICMPv6) hanterar också fel-och kontroll information och krävs för adress matchnings protokoll som duplicerad adress identifiering (pappa) och automatisk adress konfiguration för tillstånd.</span><span class="sxs-lookup"><span data-stu-id="deb40-776">Internet Control Message Protocol for IPv6 (ICMPv6) also handles error and control information and is required for address resolution protocols such as Duplicate Address Detection (DAD) and stateless address autoconfiguration.</span></span>

<span data-ttu-id="deb40-777">Precis som de flesta andra program skikt (t. ex. TCP/IP-meddelanden) kapslas ICMP-och ICMPv6-meddelanden av ett IP-huvud med protokoll beteckningen ICMP (eller ICMPv6).</span><span class="sxs-lookup"><span data-stu-id="deb40-777">Like most other application layer (e.g., TCP/IP) messages, ICMP and ICMPv6 messages are encapsulated by an IP header with the ICMP (or ICMPv6) protocol designation.</span></span>

### <a name="icmp-statistics-and-errors"></a><span data-ttu-id="deb40-778">ICMP-statistik och fel</span><span class="sxs-lookup"><span data-stu-id="deb40-778">ICMP Statistics and Errors</span></span>

<span data-ttu-id="deb40-779">Om den är aktive rad håller NetX Duo reda på flera ICMP-statistik och fel som kan vara användbara för programmet.</span><span class="sxs-lookup"><span data-stu-id="deb40-779">If enabled, NetX Duo keeps track of several ICMP statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="deb40-780">Följande statistik och fel rapporter hanteras för varje IP-ICMP-bearbetning:</span><span class="sxs-lookup"><span data-stu-id="deb40-780">The following statistics and error reports are maintained for each IP's ICMP processing:</span></span> 

- <span data-ttu-id="deb40-781">Totalt antal ICMP-pingar som skickats</span><span class="sxs-lookup"><span data-stu-id="deb40-781">Total ICMP Pings Sent</span></span>  
- <span data-ttu-id="deb40-782">Totalt antal ICMP-Ping-Timeoutar</span><span class="sxs-lookup"><span data-stu-id="deb40-782">Total ICMP Ping Timeouts</span></span> 
- <span data-ttu-id="deb40-783">Totalt antal inaktiverade ICMP Ping-trådar</span><span class="sxs-lookup"><span data-stu-id="deb40-783">Total ICMP Ping Threads Suspended</span></span> 
- <span data-ttu-id="deb40-784">Totalt antal mottagna ICMP ping-svar</span><span class="sxs-lookup"><span data-stu-id="deb40-784">Total ICMP Ping Responses Received</span></span> 
- <span data-ttu-id="deb40-785">Totalt antal fel i ICMP-kontrollsumma</span><span class="sxs-lookup"><span data-stu-id="deb40-785">Total ICMP Checksum Errors</span></span> 
- <span data-ttu-id="deb40-786">Totalt antal ICMP-ohanterade meddelanden</span><span class="sxs-lookup"><span data-stu-id="deb40-786">Total ICMP Unhandled Messages</span></span> 

<span data-ttu-id="deb40-787">Alla dessa statistik-och fel rapporter är tillgängliga för programmet med tjänsten ***nx_icmp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="deb40-787">All these statistics and error reports are available to the application with the ***nx_icmp_info_get*** service.</span></span>

## <a name="icmpv4-services-in-netx-duo"></a><span data-ttu-id="deb40-788">ICMPv4-tjänster i NetX Duo</span><span class="sxs-lookup"><span data-stu-id="deb40-788">ICMPv4 Services in NetX Duo</span></span>

### <a name="icmpv4-enable"></a><span data-ttu-id="deb40-789">ICMPv4 Enable</span><span class="sxs-lookup"><span data-stu-id="deb40-789">ICMPv4 Enable</span></span>

<span data-ttu-id="deb40-790">Innan ICMPv4-meddelanden kan bearbetas av NetX Duo måste programmet anropa tjänsten ***nx_icmp_enable*** för att aktivera ICMPv4-bearbetning.</span><span class="sxs-lookup"><span data-stu-id="deb40-790">Before ICMPv4 messages can be processed by NetX Duo, the application must call the ***nx_icmp_enable*** service to enable ICMPv4 processing.</span></span> <span data-ttu-id="deb40-791">När det är färdigt kan programmet utfärda ping-begäranden och fält inkommande ping-paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-791">After this is done, the application can issue ping requests and field incoming ping packets.</span></span>  

### <a name="icmpv4-echo-request"></a><span data-ttu-id="deb40-792">ICMPv4 ECHO-begäran</span><span class="sxs-lookup"><span data-stu-id="deb40-792">ICMPv4 Echo Request</span></span>

<span data-ttu-id="deb40-793">En ekobegäran är en typ av ICMPv4-meddelande som vanligt vis används för att kontrol lera om det finns en speciell nod i nätverket, som identifieras av dess värd-IP-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-793">An echo request is one type of ICMPv4 message that is typically used to check for the existence of a specific node on the network, as identified by its host IP address.</span></span> <span data-ttu-id="deb40-794">Det populära Ping-kommandot implementeras med ICMP Echo Request/Echo Reply-meddelanden.</span><span class="sxs-lookup"><span data-stu-id="deb40-794">The popular ping command is implemented using ICMP echo request/echo reply messages.</span></span> <span data-ttu-id="deb40-795">Om den aktuella värden finns, bearbetar dess nätverks stack ping-begäran och svaren med ett ping-svar.</span><span class="sxs-lookup"><span data-stu-id="deb40-795">If the specific host is present, its network stack processes the ping request and responses with a ping response.</span></span> <span data-ttu-id="deb40-796">Bild 7 information om formatet ICMPv4 ping Message.</span><span class="sxs-lookup"><span data-stu-id="deb40-796">Figure 7 details the ICMPv4 ping message format.</span></span>

![ICMPv4 ping-meddelande](./media/user-guide/icmpv4-ping-message.png)  

<span data-ttu-id="deb40-798">**BILD 7. ICMPv4 ping-meddelande**</span><span class="sxs-lookup"><span data-stu-id="deb40-798">**FIGURE 7. ICMPv4 Ping Message**</span></span>

> [!NOTE]
> <span data-ttu-id="deb40-799">*Alla ICMPv4-meddelanden i TCP/IP-implementeringen förväntas vara i **big endian** format. I det här formatet finns de mest signifikanta byten av ordet på den lägsta byte-adressen.*</span><span class="sxs-lookup"><span data-stu-id="deb40-799">*All ICMPv4 messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

<span data-ttu-id="deb40-800">Följande beskriver formatet ICMPv4-sidhuvud:</span><span class="sxs-lookup"><span data-stu-id="deb40-800">The following describes the ICMPv4 header format:</span></span>

|<span data-ttu-id="deb40-801">Rubrik fält</span><span class="sxs-lookup"><span data-stu-id="deb40-801">Header Field</span></span> |<span data-ttu-id="deb40-802">Syfte</span><span class="sxs-lookup"><span data-stu-id="deb40-802">Purpose</span></span> |
|---|---|
|<span data-ttu-id="deb40-803">**Typ**</span><span class="sxs-lookup"><span data-stu-id="deb40-803">**Type**</span></span> |<span data-ttu-id="deb40-804">Det här fältet anger ICMPv4-meddelandet (bitar 31-24).</span><span class="sxs-lookup"><span data-stu-id="deb40-804">This field specifies the ICMPv4 message (bits 31-24).</span></span> <span data-ttu-id="deb40-805">De vanligaste är:</span><span class="sxs-lookup"><span data-stu-id="deb40-805">The most common are:</span></span><br /><span data-ttu-id="deb40-806">-0: eko svar</span><span class="sxs-lookup"><span data-stu-id="deb40-806">-  0: Echo Reply</span></span><br /><span data-ttu-id="deb40-807">-3: det går inte att hitta målet</span><span class="sxs-lookup"><span data-stu-id="deb40-807">- 3: Destination Unreachable</span></span><br /><span data-ttu-id="deb40-808">-8: ekobegäran</span><span class="sxs-lookup"><span data-stu-id="deb40-808">- 8: Echo Request</span></span><br /><span data-ttu-id="deb40-809">-11: tiden överskreds</span><span class="sxs-lookup"><span data-stu-id="deb40-809">- 11: Time Exceeded</span></span><br /><span data-ttu-id="deb40-810">-12: parameter problem</span><span class="sxs-lookup"><span data-stu-id="deb40-810">- 12: Parameter Problem</span></span> |
|<span data-ttu-id="deb40-811">**Kod**</span><span class="sxs-lookup"><span data-stu-id="deb40-811">**Code**</span></span> |<span data-ttu-id="deb40-812">Det här fältet är Sammanhangs beroende av typ fältet (bitar 23-16).</span><span class="sxs-lookup"><span data-stu-id="deb40-812">This field is context specific on the type field (bits 23-16).</span></span> <span data-ttu-id="deb40-813">För en ekobegäran eller svara har koden värdet noll.</span><span class="sxs-lookup"><span data-stu-id="deb40-813">For an echo request or reply the code is set to zero.</span></span>|
|<span data-ttu-id="deb40-814">**Lastning**</span><span class="sxs-lookup"><span data-stu-id="deb40-814">**Checksum**</span></span> |<span data-ttu-id="deb40-815">Det här fältet innehåller 16-bitars kontroll summa för den enda komplement summan av ICMPv4-meddelandet, inklusive hela det ICMPv4-sidhuvudet som börjar med fältet typ.</span><span class="sxs-lookup"><span data-stu-id="deb40-815">This field contains the 16-bit checksum of the one's complement sum of the ICMPv4 message including the entire the ICMPv4 header starting with the Type field.</span></span> <span data-ttu-id="deb40-816">Innan du genererar kontroll summan rensas fältet kontroll summa.</span><span class="sxs-lookup"><span data-stu-id="deb40-816">Before generating the checksum, the checksum field is cleared.</span></span>|
|<span data-ttu-id="deb40-817">**Fastställa**</span><span class="sxs-lookup"><span data-stu-id="deb40-817">**Identification**</span></span> | <span data-ttu-id="deb40-818">Det här fältet innehåller ett ID-värde som identifierar värden. en värd ska använda det ID som extraheras från en EKOBEGÄRAN i eko svaret (bitar 31-16).</span><span class="sxs-lookup"><span data-stu-id="deb40-818">This field contains an ID value identifying the host; a host should use the ID extracted from an ECHO request in the ECHO REPLY (bits 31-16).</span></span>|
|<span data-ttu-id="deb40-819">**Sekvensnummer**</span><span class="sxs-lookup"><span data-stu-id="deb40-819">**Sequence number**</span></span> |<span data-ttu-id="deb40-820">Det här fältet innehåller ett ID-värde; en värd ska använda det ID som extraheras från en EKOBEGÄRAN i eko svaret (bitar 31-16).</span><span class="sxs-lookup"><span data-stu-id="deb40-820">This field contains an ID value; a host should use the ID extracted from an ECHO request in the ECHO REPLY (bits 31-16).</span></span> <span data-ttu-id="deb40-821">Till skillnad från fältet identifierare kommer det här värdet att ändras i en efterföljande ekobegäran från samma värd (bitar 15-0).</span><span class="sxs-lookup"><span data-stu-id="deb40-821">Unlike the identifier field, this value will change in a subsequent Echo request from the same host (bits 15-0).</span></span>|

### <a name="icmpv4-echo-response"></a><span data-ttu-id="deb40-822">ICMPv4 eko-svar</span><span class="sxs-lookup"><span data-stu-id="deb40-822">ICMPv4 Echo Response</span></span>    
<span data-ttu-id="deb40-823">Ett ping-svar är en annan typ av ICMP-meddelanden som genereras internt av ICMP-komponenten som svar på en extern ping-begäran.</span><span class="sxs-lookup"><span data-stu-id="deb40-823">A ping response is another type of ICMP message that is generated internally by the ICMP component in response to an external ping request.</span></span> <span data-ttu-id="deb40-824">Utöver bekräftelsen innehåller ping-svaret även en kopia av de användar data som angavs i ping-begäran.</span><span class="sxs-lookup"><span data-stu-id="deb40-824">In addition to acknowledgement, the ping response also contains a copy of the user data supplied in the ping request.</span></span>

### <a name="icmpv4-error-messages"></a><span data-ttu-id="deb40-825">ICMPv4-fel meddelanden</span><span class="sxs-lookup"><span data-stu-id="deb40-825">ICMPv4 Error Messages</span></span>   
<span data-ttu-id="deb40-826">Följande ICMPv4-fel meddelanden stöds i NetX Duo:</span><span class="sxs-lookup"><span data-stu-id="deb40-826">The following ICMPv4 error messages are supported in NetX Duo:</span></span> 
- <span data-ttu-id="deb40-827">Det går inte att hitta målet</span><span class="sxs-lookup"><span data-stu-id="deb40-827">Destination Unreachable</span></span> 
- <span data-ttu-id="deb40-828">Tiden överskrider</span><span class="sxs-lookup"><span data-stu-id="deb40-828">Time Exceed</span></span> 
- <span data-ttu-id="deb40-829">Parameter problem</span><span class="sxs-lookup"><span data-stu-id="deb40-829">Parameter Problem</span></span>

## <a name="internet-group-management-protocol-igmp"></a><span data-ttu-id="deb40-830">Internet Grupphanteringsprotokoll (IGMP)</span><span class="sxs-lookup"><span data-stu-id="deb40-830">Internet Group Management Protocol (IGMP)</span></span>

<span data-ttu-id="deb40-831">IGMP (Internet Group Management Protocol) tillhandahåller en enhet för att kommunicera med sina grannar och dess routrar som den avser att ta emot, eller ansluta till, en IPv4-multicast-grupp (RFC 1112 och RFC 2236).</span><span class="sxs-lookup"><span data-stu-id="deb40-831">The Internet Group Management Protocol (IGMP) provides a device to communicate with its neighbors and its routers that it intends to receive, or join, an IPv4 multicast group (RFC 1112 and RFC 2236).</span></span> <span data-ttu-id="deb40-832">En multicast-grupp är i princip en dynamisk uppsättning nätverks medlemmar och representeras av en klass D IP-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-832">A multicast group is basically a dynamic collection of network members and is represented by a Class D IP address.</span></span> <span data-ttu-id="deb40-833">Medlemmar i multicast-gruppen kan lämna när som helst och nya medlemmar kan gå med i taget.</span><span class="sxs-lookup"><span data-stu-id="deb40-833">Members of the multicast group may leave at any time, and new members may join at any time.</span></span> <span data-ttu-id="deb40-834">Den samordning som används för att ansluta till och lämna gruppen är ansvaret för IGMP.</span><span class="sxs-lookup"><span data-stu-id="deb40-834">The coordination involved in joining and leaving the group is the responsibility of IGMP.</span></span>

> [!NOTE]
> <span data-ttu-id="deb40-835">*IGMP är endast utformat för IPv4-multicast-grupper. Det kan inte användas i IPv6-nätverket.*</span><span class="sxs-lookup"><span data-stu-id="deb40-835">*IGMP is designed only for IPv4 multicast groups. It cannot be used on the IPv6 network.*</span></span>

### <a name="igmp-enable"></a><span data-ttu-id="deb40-836">Aktivera IGMP</span><span class="sxs-lookup"><span data-stu-id="deb40-836">IGMP Enable</span></span>     
<span data-ttu-id="deb40-837">Innan en multicasting-aktivitet kan ske i NetX Duo måste programmet anropa tjänsten ***nx_igmp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="deb40-837">Before any multicasting activity can take place in NetX Duo, the application must call the ***nx_igmp_enable*** service.</span></span> <span data-ttu-id="deb40-838">Den här tjänsten utför grundläggande IGMP-initiering som förberedelse för multicast-begäranden.</span><span class="sxs-lookup"><span data-stu-id="deb40-838">This service performs basic IGMP initialization in preparation for multicast requests.</span></span>

### <a name="multicast-ipv4-addressing"></a><span data-ttu-id="deb40-839">Multicast-IPv4-adressering</span><span class="sxs-lookup"><span data-stu-id="deb40-839">Multicast IPv4 Addressing</span></span>  
<span data-ttu-id="deb40-840">Som tidigare nämnts är multicast-adresser faktiskt klass D IP-adresser som visas i [bild 4](#ipv4-addresses).</span><span class="sxs-lookup"><span data-stu-id="deb40-840">As mentioned previously, multicast addresses are actually Class D IP addresses as shown in [Figure 4](#ipv4-addresses).</span></span> <span data-ttu-id="deb40-841">De nedre 28 bitarna i klass D-adressen motsvarar multicast-gruppens ID.</span><span class="sxs-lookup"><span data-stu-id="deb40-841">The lower 28-bits of the Class D address correspond to the multicast group ID.</span></span> <span data-ttu-id="deb40-842">Det finns en serie fördefinierade multicast-adresser. men *alla värd adresser* (244.0.0.1) är särskilt viktiga för IGMP-bearbetning.</span><span class="sxs-lookup"><span data-stu-id="deb40-842">There are a series of pre-defined multicast addresses; however, the *all hosts address* (244.0.0.1) is particularly important to IGMP processing.</span></span> <span data-ttu-id="deb40-843">*Adressen alla värdar* används av routrar för att fråga alla multicast-medlemmar att rapportera om vilka multicast-grupper de tillhör.</span><span class="sxs-lookup"><span data-stu-id="deb40-843">The *all hosts address* is used by routers to query all multicast members to report on which multicast groups they belong to.</span></span>  

### <a name="physical-address-mapping-in-ipv4"></a><span data-ttu-id="deb40-844">Fysisk adress mappning i IPv4</span><span class="sxs-lookup"><span data-stu-id="deb40-844">Physical Address Mapping in IPv4</span></span>
<span data-ttu-id="deb40-845">Klass D multicast-adresser mappas direkt till fysiska Ethernet-adresser som sträcker sig från 01.00.5 e. 00.00.00 till 01.00.5 e. 7f. AA. AA.</span><span class="sxs-lookup"><span data-stu-id="deb40-845">Class D multicast addresses map directly to physical Ethernet addresses ranging from 01.00.5e.00.00.00 through 01.00.5e.7f.ff.ff.</span></span> <span data-ttu-id="deb40-846">De lägre 23 bitarna av IP-multicast-adress kartan direkt till de lägre 23 bitarna av Ethernet-adressen.</span><span class="sxs-lookup"><span data-stu-id="deb40-846">The lower 23 bits of the IP multicast address map directly to the lower 23 bits of the Ethernet address.</span></span>

### <a name="multicast-group-join"></a><span data-ttu-id="deb40-847">Anslutning till multicast-grupp</span><span class="sxs-lookup"><span data-stu-id="deb40-847">Multicast Group Join</span></span>
<span data-ttu-id="deb40-848">Program som behöver ansluta till en viss multicast-grupp kan göra detta genom att anropa tjänsten ***nx_igmp_multicast_join*** .</span><span class="sxs-lookup"><span data-stu-id="deb40-848">Applications that need to join a particular multicast group may do so by calling the ***nx_igmp_multicast_join*** service.</span></span> <span data-ttu-id="deb40-849">Den här tjänsten håller reda på antalet begär Anden att ansluta till den här multicast-gruppen.</span><span class="sxs-lookup"><span data-stu-id="deb40-849">This service keeps track of the number of requests to join this multicast group.</span></span> <span data-ttu-id="deb40-850">Om det här är det första programmet requestto ansluter till multicast-gruppen skickas en IGMP-rapport ut från det primära nätverket som anger att den här värdens avsikt att ansluta till gruppen.</span><span class="sxs-lookup"><span data-stu-id="deb40-850">If this is the first application requestto join the multicast group, an IGMP report is sent out on the primary network indicating this host's intention to join the group.</span></span> <span data-ttu-id="deb40-851">Därefter anropas nätverks driv rutinen för att ställa in för att lyssna efter paket med Ethernet-adressen för den här multicast-gruppen.</span><span class="sxs-lookup"><span data-stu-id="deb40-851">Next, the network driver is called to set up for listening for packets with the Ethernet address for this multicast group.</span></span>

<span data-ttu-id="deb40-852">Om multicast-gruppen är tillgänglig via ett visst gränssnitt i ett multihome-system måste programmet använda tjänsten \***nx_igmp_multicast_interface_join** _ i stället för _ *_nx_igmp_multicast_join_* \*, som är begränsad till multicast-grupper i det primära nätverket.</span><span class="sxs-lookup"><span data-stu-id="deb40-852">In a multihome system, if the multicast group is accessible via a specific interface, application shall use the service ***nx_igmp_multicast_interface_join** _ instead of _*_nx_igmp_multicast_join_\*\*, which is limited to multicast groups on the primary network.</span></span>

### <a name="multicast-group-leave"></a><span data-ttu-id="deb40-853">Lämna multicast-grupp</span><span class="sxs-lookup"><span data-stu-id="deb40-853">Multicast Group Leave</span></span>   
<span data-ttu-id="deb40-854">Program som måste lämna en tidigare ansluten multicast-grupp kan göra det genom att anropa tjänsten ***nx_igmp_multicast_leave*** .</span><span class="sxs-lookup"><span data-stu-id="deb40-854">Applications that need to leave a previously joined multicast group may do so by calling the ***nx_igmp_multicast_leave*** service.</span></span> <span data-ttu-id="deb40-855">Den här tjänsten minskar det interna antalet som är associerat med hur många gånger gruppen anslöts.</span><span class="sxs-lookup"><span data-stu-id="deb40-855">This service reduces the internal count associated with how many times the group was joined.</span></span> <span data-ttu-id="deb40-856">Om det inte finns några väntande kopplings begär Anden för en grupp, anropas nätverks driv rutinen för att inaktivera lyssning av paket med den här multicast-gruppens Ethernet-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-856">If there are no outstanding join requests for a group, the network driver is called to disable listening for packets with this multicast group's Ethernet address.</span></span>

### <a name="multicast-loopback"></a><span data-ttu-id="deb40-857">Multicast-loopback</span><span class="sxs-lookup"><span data-stu-id="deb40-857">Multicast Loopback</span></span>    
<span data-ttu-id="deb40-858">Ett program kan vilja ta emot multicast-trafik som härstammar från en av källorna på samma nod.</span><span class="sxs-lookup"><span data-stu-id="deb40-858">An application may wish to receive multicast traffic originated from one of the sources on the same node.</span></span> <span data-ttu-id="deb40-859">För detta krävs att loopback aktive ras av IP-multicast-komponenten med hjälp av tjänsten ***nx_igmp_loopback_enable***.</span><span class="sxs-lookup"><span data-stu-id="deb40-859">This requires the IP multicast component to have loopback enabled by using the service ***nx_igmp_loopback_enable***.</span></span>

### <a name="igmp-report-message"></a><span data-ttu-id="deb40-860">IGMP-rapport meddelande</span><span class="sxs-lookup"><span data-stu-id="deb40-860">IGMP Report Message</span></span>      
<span data-ttu-id="deb40-861">När programmet ansluter till en multicast-grupp skickas ett IGMP-rapport meddelande via nätverket för att indikera värddatorns avsikt att ansluta till en viss multicast-grupp.</span><span class="sxs-lookup"><span data-stu-id="deb40-861">When the application joins a multicast group, an IGMP report message is sent via the network to indicate the host's intention to join a particular multicast group.</span></span> <span data-ttu-id="deb40-862">Formatet på IGMP-rapportens meddelande visas i bild 8.</span><span class="sxs-lookup"><span data-stu-id="deb40-862">The format of the IGMP report message is shown in Figure 8.</span></span> <span data-ttu-id="deb40-863">Multicast-gruppadressen används för både grupp meddelandet i IGMP-rapport meddelandet och mål-IP-adressen.</span><span class="sxs-lookup"><span data-stu-id="deb40-863">The multicast group address is used for both the group message in the IGMP report message and the destination IP address.</span></span>

<span data-ttu-id="deb40-864">I bilden ovan (bild 8) innehåller IGMP-huvudet ett fält av version/typ, maximalt svar</span><span class="sxs-lookup"><span data-stu-id="deb40-864">In the figure above (Figure 8), the IGMP header contains a version/type field, maximum response</span></span>

![Diagram över ett IGMP-rapport meddelande.](./media/user-guide/image17.jpg)

<span data-ttu-id="deb40-866">**FIGUR 8. IGMP-rapport meddelande**</span><span class="sxs-lookup"><span data-stu-id="deb40-866">**FIGURE 8. IGMP Report Message**</span></span>

<span data-ttu-id="deb40-867">tid, fält för kontroll summa och adress fält för multicast-grupp.</span><span class="sxs-lookup"><span data-stu-id="deb40-867">time, a checksum field, and a multicast group address field.</span></span> <span data-ttu-id="deb40-868">För IGMPv1-meddelanden är fältet maximal svars tid alltid inställt på noll, eftersom detta inte är en del av IGMPv1-protokollet.</span><span class="sxs-lookup"><span data-stu-id="deb40-868">For IGMPv1 messages, the Maximum Response Time field is always set to zero, as this is not part of the IGMPv1 protocol.</span></span> <span data-ttu-id="deb40-869">Fältet Max svars tid anges när värden får ett IGMP-meddelande av typen fråga och rensas när en värd får ett annat värde för rapport typ meddelandet som definieras av IGMPv2-protokollet.</span><span class="sxs-lookup"><span data-stu-id="deb40-869">The Maximum Response Time field is set when the host receives a Query type IGMP message and cleared when a host receives another host's Report type message as defined by the IGMPv2 protocol.</span></span>

<span data-ttu-id="deb40-870">I följande avsnitt beskrivs IGMP-huvud formatet:</span><span class="sxs-lookup"><span data-stu-id="deb40-870">The following describes the IGMP header format:</span></span>

|<span data-ttu-id="deb40-871">Rubrik fält</span><span class="sxs-lookup"><span data-stu-id="deb40-871">Header Field</span></span>|<span data-ttu-id="deb40-872">Syfte</span><span class="sxs-lookup"><span data-stu-id="deb40-872">Purpose</span></span>|
|---|---|
|<span data-ttu-id="deb40-873">**Version**</span><span class="sxs-lookup"><span data-stu-id="deb40-873">**Version**</span></span> |<span data-ttu-id="deb40-874">Det här fältet anger IGMP-versionen (bitar 31-28).</span><span class="sxs-lookup"><span data-stu-id="deb40-874">This field specifies the IGMP version (bits 31- 28).</span></span>|
|<span data-ttu-id="deb40-875">**Typ**</span><span class="sxs-lookup"><span data-stu-id="deb40-875">**Type**</span></span> |<span data-ttu-id="deb40-876">Det här fältet anger typen av IGMP-meddelande (bitar 27 -24).</span><span class="sxs-lookup"><span data-stu-id="deb40-876">This field specifies the type of IGMP message (bits 27 -24).</span></span>|
|<span data-ttu-id="deb40-877">**Maximal svars tid**</span><span class="sxs-lookup"><span data-stu-id="deb40-877">**Maximum Response Time**</span></span> |<span data-ttu-id="deb40-878">Används inte i IGMP v1.</span><span class="sxs-lookup"><span data-stu-id="deb40-878">Not used in IGMP v1.</span></span> <span data-ttu-id="deb40-879">I IGMP v2 fungerar det här fältet som maximal svars tid.</span><span class="sxs-lookup"><span data-stu-id="deb40-879">In IGMP v2 this field serves as the maximum response time.</span></span>|
|<span data-ttu-id="deb40-880">**Lastning**</span><span class="sxs-lookup"><span data-stu-id="deb40-880">**Checksum**</span></span> |<span data-ttu-id="deb40-881">Det här fältet innehåller 16-bitars kontroll summa för den enda komplement summan av IGMP-meddelandet som börjar med IGMP-versionen (bitar 0-15)</span><span class="sxs-lookup"><span data-stu-id="deb40-881">This field contains the 16-bit checksum of the one's complement sum of the IGMP message starting with the IGMP version (bits 0-15)</span></span>|
|<span data-ttu-id="deb40-882">**Grupp adress**</span><span class="sxs-lookup"><span data-stu-id="deb40-882">**Group Address**</span></span> |<span data-ttu-id="deb40-883">32-bitars klass D grupp IP-adress</span><span class="sxs-lookup"><span data-stu-id="deb40-883">32-bit class D group IP address</span></span>|

<span data-ttu-id="deb40-884">IGMP-rapport meddelanden skickas också som svar på IGMP-frågemeddelanden som skickas av en multicast-router.</span><span class="sxs-lookup"><span data-stu-id="deb40-884">IGMP report messages are also sent in response to IGMP query messages sent by a multicast router.</span></span> <span data-ttu-id="deb40-885">Multicast-routrar skickar regelbundet frågemeddelanden ut för att se vilka värdar som fortfarande kräver grupp medlemskap.</span><span class="sxs-lookup"><span data-stu-id="deb40-885">Multicast routers periodically send query messages out to see which hosts still require group membership.</span></span> <span data-ttu-id="deb40-886">Fråga meddelanden har samma format som IGMP-rapport meddelandet som visas i bild 8.</span><span class="sxs-lookup"><span data-stu-id="deb40-886">Query messages have the same format as the IGMP Report message shown in Figure 8.</span></span> <span data-ttu-id="deb40-887">De enda skillnaderna är att IGMP-typen är lika med 1 och att grupp adress fältet är inställt på 0.</span><span class="sxs-lookup"><span data-stu-id="deb40-887">The only differences are the IGMP type is equal to 1 and the group address field is set to 0.</span></span> <span data-ttu-id="deb40-888">IGMP-frågemeddelanden skickas till IP-adressen *alla värdar* av multicast-routern.</span><span class="sxs-lookup"><span data-stu-id="deb40-888">IGMP Query messages are sent to the *all hosts* IP address by the multicast router.</span></span> <span data-ttu-id="deb40-889">En värd som fortfarande vill behålla grupp medlemskapet svarar genom att skicka ett annat IGMP-rapport meddelande.</span><span class="sxs-lookup"><span data-stu-id="deb40-889">A host that still wishes to maintain group membership responds by sending another IGMP Report message.</span></span>

> [!NOTE]
> <span data-ttu-id="deb40-890">*Alla meddelanden i TCP/IP-implementeringen förväntas vara i **big endian** format. I det här formatet finns de mest signifikanta byten av ordet på den lägsta byte-adressen.*</span><span class="sxs-lookup"><span data-stu-id="deb40-890">*All messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="igmp-statistics-and-errors"></a><span data-ttu-id="deb40-891">IGMP-statistik och fel</span><span class="sxs-lookup"><span data-stu-id="deb40-891">IGMP Statistics and Errors</span></span>    
<th><p><span data-ttu-id="deb40-892">Om den är aktive rad håller NetX Duo IGMP-programvaran reda på flera statistik och fel som kan vara användbara för programmet.</span><span class="sxs-lookup"><span data-stu-id="deb40-892">If enabled, the NetX Duo IGMP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="deb40-893">Följande statistik och fel rapporter underhålls för varje IP-IGMP-bearbetning:</span><span class="sxs-lookup"><span data-stu-id="deb40-893">The following statistics and error reports are maintained for each IP's IGMP processing:</span></span> 

- <span data-ttu-id="deb40-894">Totalt antal skickade IGMP-rapporter</span><span class="sxs-lookup"><span data-stu-id="deb40-894">Total IGMP Reports Sent</span></span> 
- <span data-ttu-id="deb40-895">Totalt antal mottagna IGMP-frågor</span><span class="sxs-lookup"><span data-stu-id="deb40-895">Total IGMP Queries Received</span></span> 
- <span data-ttu-id="deb40-896">Totalt antal fel i IGMP-kontrollsumma</span><span class="sxs-lookup"><span data-stu-id="deb40-896">Total IGMP Checksum Errors</span></span> 
- <span data-ttu-id="deb40-897">Totalt antal IGMP-aktuella grupper anslutna</span><span class="sxs-lookup"><span data-stu-id="deb40-897">Total IGMP Current Groups Joined</span></span> 

<span data-ttu-id="deb40-898">Alla dessa statistik-och fel rapporter är tillgängliga för programmet med tjänsten ***nx_igmp_info_get***.</span><span class="sxs-lookup"><span data-stu-id="deb40-898">All these statistics and error reports are available to the application with the ***nx_igmp_info_get*** service.</span></span> 

### <a name="multicast-without-igmp"></a><span data-ttu-id="deb40-899">Multicast utan IGMP</span><span class="sxs-lookup"><span data-stu-id="deb40-899">Multicast without IGMP</span></span>  
<span data-ttu-id="deb40-900">Program som förväntar sig IPv4-multicast-trafik kan ansluta till en multicast-gruppadress utan att anropa IGMP-meddelanden med hjälp av tjänsten ***nx_ipv4_multicast_interface_join***.</span><span class="sxs-lookup"><span data-stu-id="deb40-900">Application expecting IPv4 multicast traffic can join a multicast group address without invoking IGMP messages by using the service ***nx_ipv4_multicast_interface_join***.</span></span> <span data-ttu-id="deb40-901">Den här tjänsten instruerar IPv4-lagret och den underliggande gränssnitts driv rutinen att acceptera paket från den angivna IPv4-multicast-adressen.</span><span class="sxs-lookup"><span data-stu-id="deb40-901">This service instructs the IPv4 layer and the underlying interface driver to accept packets from the designated IPv4 multicast address.</span></span> <span data-ttu-id="deb40-902">Det finns dock inga IGMP-grupphanterings meddelanden som skickas eller bearbetas för den här gruppen.</span><span class="sxs-lookup"><span data-stu-id="deb40-902">However there is no IGMP group management messages being sent or processed for this group.</span></span>

<span data-ttu-id="deb40-903">Programmet vill inte längre ta emot trafik från gruppen kan använda tjänsten ***nx_ipv4_multicast_interface_leave.***</span><span class="sxs-lookup"><span data-stu-id="deb40-903">Application no longer wish to receive traffic from the group can use the service ***nx_ipv4_multicast_interface_leave.***</span></span>

## <a name="ipv6-in-netx-duo"></a><span data-ttu-id="deb40-904">IPv6 i NetX Duo</span><span class="sxs-lookup"><span data-stu-id="deb40-904">IPv6 in NetX Duo</span></span>

### <a name="ipv6-addresses"></a><span data-ttu-id="deb40-905">IPv6-adresser</span><span class="sxs-lookup"><span data-stu-id="deb40-905">IPv6 Addresses</span></span>   
<span data-ttu-id="deb40-906">IPv6-adresser är 128 bitar.</span><span class="sxs-lookup"><span data-stu-id="deb40-906">IPv6 addresses are 128 bits.</span></span> <span data-ttu-id="deb40-907">Arkitekturen i IPv6-adressen beskrivs i RFC 4291.</span><span class="sxs-lookup"><span data-stu-id="deb40-907">The architecture of IPv6 address is described in RFC 4291.</span></span> <span data-ttu-id="deb40-908">Adressen är indelad i ett prefix som innehåller de mest signifikanta bitarna och en värd adress som innehåller de lägre bitarna.</span><span class="sxs-lookup"><span data-stu-id="deb40-908">The address is divided into a prefix containing the most significant bits and a host address containing the lower bits.</span></span> <span data-ttu-id="deb40-909">Prefixet anger typ av adress och är ungefär samma som nätverks adressen i IPv4-nätverket.</span><span class="sxs-lookup"><span data-stu-id="deb40-909">The prefix indicates the type of address and is roughly the equivalent of the network address in IPv4 network.</span></span>

<span data-ttu-id="deb40-910">IPv6 har tre typer av adress specifikationer: unicast, anycast (stöds inte i NetX Duo) och multicast.</span><span class="sxs-lookup"><span data-stu-id="deb40-910">IPv6 has three types of address specifications: unicast, anycast (not supported in NetX Duo), and multicast.</span></span> <span data-ttu-id="deb40-911">Unicast-adresser är de IP-adresser som identifierar en speciell värd på Internet.</span><span class="sxs-lookup"><span data-stu-id="deb40-911">Unicast addresses are those IP addresses that identify a specific host on the Internet.</span></span> <span data-ttu-id="deb40-912">Unicast-adresser kan vara antingen en källa eller en mål-IP-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-912">Unicast addresses can be either a source or a destination IP address.</span></span> <span data-ttu-id="deb40-913">Multicast-adresser anger en dynamisk grupp värdar på Internet.</span><span class="sxs-lookup"><span data-stu-id="deb40-913">Multicast addresses specify a dynamic group of hosts on the Internet.</span></span> <span data-ttu-id="deb40-914">Medlemmar i multicast-gruppen kan ansluta till och lämna när de vill.</span><span class="sxs-lookup"><span data-stu-id="deb40-914">Members of the multicast group may join and leave whenever they wish.</span></span>

<span data-ttu-id="deb40-915">IPv6 har inte motsvarigheten till IPv4-broadcast-mekanismen.</span><span class="sxs-lookup"><span data-stu-id="deb40-915">IPv6 does not have the equivalent of the IPv4 broadcast mechanism.</span></span> <span data-ttu-id="deb40-916">Möjligheten att skicka ett paket till alla värdar kan uppnås genom att skicka ett paket till den länk lokala alla värdarna multicast-gruppen.</span><span class="sxs-lookup"><span data-stu-id="deb40-916">The ability to send a packet to all hosts can be achieved by sending a packet to the link-local all hosts multicast group.</span></span>

<span data-ttu-id="deb40-917">IPv6 använder multicast-adresser för att utföra identifiering av grannar, routerupptäckt och tillstånds lösa automatiska konfigurations procedurer.</span><span class="sxs-lookup"><span data-stu-id="deb40-917">IPv6 utilizes multicast addresses to perform Neighbor Discovery, Router Discovery, and Stateless Address Auto Configuration procedures.</span></span>

<span data-ttu-id="deb40-918">Det finns två typer av IPv6 unicast-adresser: länka lokala adresser, vanligt vis konstruerade genom att kombinera det välkända länk lokala prefixet med gränssnittets MAC-adress och globala IP-adresser, som även har prefixet och värd-ID-delen.</span><span class="sxs-lookup"><span data-stu-id="deb40-918">There are two types of IPv6 unicast addresses: link local addresses, typically constructed by combining the well-known link local prefix with the interface MAC address, and global IP addresses, which also has the prefix portion and the host ID portion.</span></span> <span data-ttu-id="deb40-919">En global adress kan konfigureras manuellt eller via den autonoma adress konfigurationen eller DHCPv6.</span><span class="sxs-lookup"><span data-stu-id="deb40-919">A global address may be configured manually, or through the Stateless Address Autoconfiguration or DHCPv6.</span></span> <span data-ttu-id="deb40-920">NetX Duo stöder både länk lokal adress och global adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-920">NetX Duo supports both link local address and global address.</span></span>

<span data-ttu-id="deb40-921">För att kunna hantera både IPv4-och IPv6-format tillhandahåller NetX Duo en ny datatyp, NXD_ADDRESS, för att tillhandahålla IPv4-och IPv6-adresser.</span><span class="sxs-lookup"><span data-stu-id="deb40-921">To accommodate both IPv4 and IPv6 formats, NetX Duo provides a new data type, NXD_ADDRESS, for holding IPv4 and IPv6 addresses.</span></span> <span data-ttu-id="deb40-922">Definitionen av den här strukturen visas nedan.</span><span class="sxs-lookup"><span data-stu-id="deb40-922">The definition of this structure is shown below.</span></span> <span data-ttu-id="deb40-923">Adress fältet är en union av IPv4-och IPv6-adresser.</span><span class="sxs-lookup"><span data-stu-id="deb40-923">The address field is a union of IPv4 and IPv6 addresses.</span></span>

```c
typedef struct NXD_ADDRESS_STRUCT
{
    ULONG nxd_ip_version;
    union
    {
        ULONG v4;
        ULONG v6[4];
    } nxd_ip_address;
} NXD_ADDRESS;
```

<span data-ttu-id="deb40-924">Det första elementet *nxd_ip_version* i NXD_ADDRESS-strukturen anger IPv4-eller IPv6-version.</span><span class="sxs-lookup"><span data-stu-id="deb40-924">In the NXD_ADDRESS structure, the first element, *nxd_ip_version*, indicates IPv4 or IPv6 version.</span></span> <span data-ttu-id="deb40-925">De värden som stöds är antingen NX_IP_VERSION_V4 eller NX_IP_VERSION_V6.</span><span class="sxs-lookup"><span data-stu-id="deb40-925">Supported values are either NX_IP_VERSION_V4 or NX_IP_VERSION_V6.</span></span> <span data-ttu-id="deb40-926">*nxd_ip_version* anger vilket fält i *nxd_ip_address* union som ska användas som IP-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-926">*nxd_ip_version* indicates which field in the *nxd_ip_address* union to use as the IP address.</span></span> <span data-ttu-id="deb40-927">NetX Duo API-tjänster tar vanligt vis en pekare till NXD_ADDRESS Structure as indataargumentet i stället för IP-adressen ULONG (32 bitar).</span><span class="sxs-lookup"><span data-stu-id="deb40-927">NetX Duo API services typically take a pointer to NXD_ADDRESS structure as input argument in lieu of the ULONG (32 bit) IP address.</span></span>

### <a name="link-local-addresses"></a><span data-ttu-id="deb40-928">Länka lokala adresser</span><span class="sxs-lookup"><span data-stu-id="deb40-928">Link Local Addresses</span></span>     
<span data-ttu-id="deb40-929">En länk lokal adress är bara giltig i det lokala nätverket.</span><span class="sxs-lookup"><span data-stu-id="deb40-929">A link-local address is only valid on the local network.</span></span> <span data-ttu-id="deb40-930">En enhet kan skicka och ta emot paket till en annan enhet i samma nätverk när en giltig länk lokal adress har tilldelats till den.</span><span class="sxs-lookup"><span data-stu-id="deb40-930">A device can send and receive packets to another device on the same network after a valid link local address is assigned to it.</span></span> <span data-ttu-id="deb40-931">Ett program tilldelar en länk lokal adress genom att anropa NetX Duo-tjänsten ***nxd_ipv6_address_set*** med parametern prefixlängd inställd på 10.</span><span class="sxs-lookup"><span data-stu-id="deb40-931">An application assigns a link-local address by calling the NetX Duo service ***nxd_ipv6_address_set***, with the prefix length parameter set to 10.</span></span> <span data-ttu-id="deb40-932">Programmet kan ange en länk lokal adress till tjänsten, eller så kan den bara använda NX_NULL som länk lokal adress och tillåta NetX Duo att skapa en länk lokal adress baserat på enhetens MAC-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-932">The application may supply a link-local address to the service, or it may simply use NX_NULL as the link-local address and allow NetX Duo to construct a link-local address based on the device's MAC address.</span></span>

<span data-ttu-id="deb40-933">I följande exempel instruerar NetX Duo att konfigurera den länk lokala adressen med prefixlängden 10 på den primära enheten (index 0) med MAC-adressen:</span><span class="sxs-lookup"><span data-stu-id="deb40-933">The following example instructs NetX Duo to configure the link-local address with a prefix length of 10 on the primary device (index 0) using its MAC address:</span></span>

```c
nxd_ipv6_address_set(ip_ptr, 0, NX_NULL, 10, NX_NULL);
```
<span data-ttu-id="deb40-934">I exemplet ovan, om MAC-adressen för gränssnittet är 54:32:10:1A: BC: 67, är motsvarande länk lokal adress:</span><span class="sxs-lookup"><span data-stu-id="deb40-934">In the example above, if the MAC address of the interface is 54:32:10:1A:BC:67, the corresponding link-local address would be:</span></span>

```c
FE80::5632:10FF:FE1A:BC67
```
<span data-ttu-id="deb40-935">Observera att värd-ID-delen av IPv6-adressen (**5632:10FF: FE1A: BC67**) består av Mac-adressen på 6 byte, med följande ändringar:</span><span class="sxs-lookup"><span data-stu-id="deb40-935">Note that the host ID portion of the IPv6 address (**5632:10FF:FE1A:BC67**) is made up of the 6-byte MAC address, with the following modifications:</span></span>

- <span data-ttu-id="deb40-936">**0xFFFE** infogade mellan byte 3 och byte 4 i Mac-adressen</span><span class="sxs-lookup"><span data-stu-id="deb40-936">**0xFFFE** inserted between byte 3 and byte 4 of the MAC address</span></span>
- <span data-ttu-id="deb40-937">Den andra lägsta biten i den första byten av MAC-adressen (U/L-biten) har angetts till 1</span><span class="sxs-lookup"><span data-stu-id="deb40-937">Second lowest bit of the first byte of the MAC address (U/L bit) is set to 1</span></span>

<span data-ttu-id="deb40-938">Se RFC 2464 (överföring av IPv6-paket över Ethernet-nätverk) för mer information om hur du skapar värd delen av en IPv6-adress från dess gränssnitts-MAC-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-938">Refer to RFC 2464 (Transmission of IPv6 Packets over Ethernet Network) for more information on how to construct the host portion of an IPv6 address from its interface MAC address.</span></span>

<span data-ttu-id="deb40-939">Det finns några särskilda multicast-adresser för att skicka multicast-meddelanden till en eller flera värdar i IPv6:</span><span class="sxs-lookup"><span data-stu-id="deb40-939">There are a few special multicast addresses for sending multicast messages to one or more hosts in IPv6:</span></span>

| <span data-ttu-id="deb40-940">Group</span><span class="sxs-lookup"><span data-stu-id="deb40-940">Group</span></span>  | <span data-ttu-id="deb40-941">Adress</span><span class="sxs-lookup"><span data-stu-id="deb40-941">Address</span></span>   | <span data-ttu-id="deb40-942">Description</span><span class="sxs-lookup"><span data-stu-id="deb40-942">Description</span></span>  |
|---|---|---|
|<span data-ttu-id="deb40-943">Gruppen alla noder</span><span class="sxs-lookup"><span data-stu-id="deb40-943">All nodes group</span></span> |<span data-ttu-id="deb40-944">**FF02:: 1**</span><span class="sxs-lookup"><span data-stu-id="deb40-944">**FF02::1**</span></span> |<span data-ttu-id="deb40-945">Alla värdar i det lokala nätverket</span><span class="sxs-lookup"><span data-stu-id="deb40-945">All hosts on the local network</span></span>|
|<span data-ttu-id="deb40-946">Gruppen alla routrar</span><span class="sxs-lookup"><span data-stu-id="deb40-946">All routers group</span></span> |<span data-ttu-id="deb40-947">**FF02:: 2**</span><span class="sxs-lookup"><span data-stu-id="deb40-947">**FF02::2**</span></span> |<span data-ttu-id="deb40-948">Alla routrar i det lokala nätverket</span><span class="sxs-lookup"><span data-stu-id="deb40-948">All routers on the local network</span></span>|
|<span data-ttu-id="deb40-949">Anropad nod</span><span class="sxs-lookup"><span data-stu-id="deb40-949">Solicited-node</span></span> |<span data-ttu-id="deb40-950">**FF02:: 1: FF00:0/104**</span><span class="sxs-lookup"><span data-stu-id="deb40-950">**FF02::1:FF00:0/104**</span></span> |<span data-ttu-id="deb40-951">Förklaras nedan</span><span class="sxs-lookup"><span data-stu-id="deb40-951">Explained below</span></span>|

<span data-ttu-id="deb40-952">En begärd nod-multicast-adress riktar sig till vissa värdar på den lokala länken i stället för alla IPv6-värdar.</span><span class="sxs-lookup"><span data-stu-id="deb40-952">A solicited-node multicast address targets specific hosts on the local link rather than all the IPv6 hosts.</span></span> <span data-ttu-id="deb40-953">Det består av prefixet **FF02:: 1: ff00:0/104**, som är 104 bitar och de sista 24 bitarna i mål-IPv6-adressen.</span><span class="sxs-lookup"><span data-stu-id="deb40-953">It consists of the prefix **FF02::1:FF00:0/104**, which is 104 bits and the last 24-bits of the target IPv6 address.</span></span> <span data-ttu-id="deb40-954">Till exempel är en IPv6-adress **205B: 209D: D028:: F058: D1C8:1024** har en solicitednode multicast-adress för adress **FF02:: 1: FFC8:1024**.</span><span class="sxs-lookup"><span data-stu-id="deb40-954">For example, an IPv6 address **205B:209D:D028::F058:D1C8:1024** has a solicitednode multicast address of address **FF02::1:FFC8:1024**.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="deb40-955">*Den dubbla kolon notationen visar att de mellanliggande bitarna bara är nollor. **FF02:: 1: ff00:0/104** helt expanderat ser ut som* **FF02:0000:0000:0000:0000:0,001: ff00:0000**</span><span class="sxs-lookup"><span data-stu-id="deb40-955">*The double colon notation indicates the intervening bits are all zeroes. **FF02::1:FF00:0/104** fully expanded looks like* **FF02:0000:0000:0000:0000:0001:FF00:0000**</span></span>

### <a name="global-addresses"></a><span data-ttu-id="deb40-956">Globala adresser</span><span class="sxs-lookup"><span data-stu-id="deb40-956">Global Addresses</span></span>    
<span data-ttu-id="deb40-957">Ett exempel på en global IPv6-adress är **2001:0123:4567:89AB: CDEF:: 1** netx Duo lagrar IPv6-adresser i NXD_ADDRESS-strukturen.</span><span class="sxs-lookup"><span data-stu-id="deb40-957">An example of an IPv6 global address is **2001:0123:4567:89AB:CDEF::1** NetX Duo stores IPv6 addresses in the NXD_ADDRESS structure.</span></span> <span data-ttu-id="deb40-958">I exemplet nedan innehåller NXD_ADDRESS variabeln **global_ipv6_address** en IPv6-adress för unicast.</span><span class="sxs-lookup"><span data-stu-id="deb40-958">In the example below, the NXD_ADDRESS variable **global_ipv6_address** contains a unicast IPv6 address.</span></span> <span data-ttu-id="deb40-959">I följande exempel demonstreras en NetX Duo-enhet som skapar en speciell IPv6-global adress för den primära enheten:</span><span class="sxs-lookup"><span data-stu-id="deb40-959">The following example demonstrates a NetX Duo device creating a specific IPv6 global address for its primary device:</span></span>

```c
NXD_ADDRESS global_ipv6_address;
UINT        primary_interface_index = 0;

global_ipv6_address.nxd_ip_version = NX_IP_VERSION_V6;
global_ipv6_address.nxd_ip_address.v6[0] = 0x20010123;
global_ipv6_address.nxd_ip_address.v6[1] = 0x456789AB;
global_ipv6_address.nxd_ip_address.v6[2] = 0xCDEF0000;
global_ipv6_address.nxd_ip_address.v6[3] = 0x00000001;

status = nxd_ipv6_address_set(
            &ip_0,
            primary_interface_index,
            &global_ipv6_address,
            64,
            NX_NULL);
```
<span data-ttu-id="deb40-960">Observera att prefixet för den här IPv6-adressen är **2001:0123:4567:89AB**, som är 64 bitar långt och är en vanlig prefixlängd för globala unicast IPv6-adresser på Ethernet.</span><span class="sxs-lookup"><span data-stu-id="deb40-960">Note that the prefix of this IPv6 address is **2001:0123:4567:89AB**, which is 64 bits long and is a common prefix length for global unicast IPv6 addresses on Ethernet.</span></span>

<span data-ttu-id="deb40-961">NXD_ADDRESSs strukturen innehåller också IPv4-adresser.</span><span class="sxs-lookup"><span data-stu-id="deb40-961">The NXD_ADDRESS structure also holds IPv4 addresses.</span></span> <span data-ttu-id="deb40-962">En IP-adress för **192.1.168.10** (**0xC001A80A**) som lagras i global_ipv4_address skulle ha följande minnes-layout:</span><span class="sxs-lookup"><span data-stu-id="deb40-962">An IP address of **192.1.168.10** (**0xC001A80A**) stored in global_ipv4_address would have the following memory layout:</span></span>

|<span data-ttu-id="deb40-963">Fält</span><span class="sxs-lookup"><span data-stu-id="deb40-963">Field</span></span> |<span data-ttu-id="deb40-964">Värde</span><span class="sxs-lookup"><span data-stu-id="deb40-964">Value</span></span> |
|---|---|
|<span data-ttu-id="deb40-965">global_ipv4_address global_ipv4_address.nxd_ip_version</span><span class="sxs-lookup"><span data-stu-id="deb40-965">global_ipv4_address.nxd_ip_version</span></span> |<span data-ttu-id="deb40-966">NX_IP_VERSION_V4</span><span class="sxs-lookup"><span data-stu-id="deb40-966">NX_IP_VERSION_V4</span></span>|
|<span data-ttu-id="deb40-967">global_ipv4_address global_ipv4_address.nxd_ip_address. v4</span><span class="sxs-lookup"><span data-stu-id="deb40-967">global_ipv4_address.nxd_ip_address.v4</span></span> |<span data-ttu-id="deb40-968">0xC001A80A</span><span class="sxs-lookup"><span data-stu-id="deb40-968">0xC001A80A</span></span>|

<span data-ttu-id="deb40-969">När ett program skickar en adress till NetX Duo-tjänster, måste fältet *nxd_ip_version* ange rätt IP-version för lämplig paket hantering.</span><span class="sxs-lookup"><span data-stu-id="deb40-969">When an application passes an address to NetX Duo services, the *nxd_ip_version* field must specify the correct IP version for proper packet handling.</span></span>

<span data-ttu-id="deb40-970">För att vara bakåtkompatibla med befintliga NetX-program stöder NetX Duo alla NetX-tjänster.</span><span class="sxs-lookup"><span data-stu-id="deb40-970">To be backward compatible with existing NetX applications, NetX Duo supports all NetX services.</span></span> <span data-ttu-id="deb40-971">Internt konverterar NetX Duo IPv4-adress typen ULONG till data typen NXD_ADDRESS innan den vidarebefordras till den faktiska NetX Duo-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="deb40-971">Internally, NetX Duo converts the IPv4 address type ULONG to an NXD_ADDRESS data type before forwarding it to the actual NetX Duo service.</span></span>

<span data-ttu-id="deb40-972">I följande exempel illustreras likheten och skillnaderna mellan tjänsterna i NetX och NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="deb40-972">The following example illustrates the similarity and the differences between services in NetX and NetX Duo.</span></span>

```c
/* Make a connection to the destination IPv4 address
   192.1.168.12 through an already created TCP socket bound
   to the well known HTTP port number 80. */

global_ipv4_address.nxd_ip_version = NX_IP_VERSION_V4;
global_ipv4_address.nxd_ip_address.v4 = 0xC001A80C;

nxd_tcp_client_socket_connect(&tcp_socket,
                              &global_ipv4_address,
                              port_number,
                              NX_WAIT_FOREVER);
```

<span data-ttu-id="deb40-973">Följande är motsvarande NetX-API:</span><span class="sxs-lookup"><span data-stu-id="deb40-973">The following is the equivalent NetX API:</span></span>

```c
ULONG         server_ip = 0xC001A80C;
NX_TCP_SOCKET tcp_socket;
UINT          port_number = 80;

nx_tcp_client_socket_connect(&tcp_socket,
                             server_ip,
                             port_number,
                             NX_WAIT_FOREVER); 
```

> [!IMPORTANT]
> <span data-ttu-id="deb40-974">*Programutvecklare uppmuntras att använda NXD-versionen av dessa API: er*.</span><span class="sxs-lookup"><span data-stu-id="deb40-974">*Application developers are encouraged to use the nxd version of these APIs*.</span></span>

### <a name="ipv6-default-routers"></a><span data-ttu-id="deb40-975">IPv6-standardroutrar</span><span class="sxs-lookup"><span data-stu-id="deb40-975">IPv6 Default Routers</span></span>    
<span data-ttu-id="deb40-976">IPv6 använder en standard router för att vidarebefordra paket till offlink-mål.</span><span class="sxs-lookup"><span data-stu-id="deb40-976">IPv6 uses a default router to forward packets to offlink destinations.</span></span> <span data-ttu-id="deb40-977">NetX Duo-tjänsten ***nxd_ipv6_default_router_add*** gör det möjligt för ett program att lägga till en IPv6-router i tabellen default router.</span><span class="sxs-lookup"><span data-stu-id="deb40-977">The NetX Duo service ***nxd_ipv6_default_router_add*** enables an application to add an IPv6 router to the default router table.</span></span> <span data-ttu-id="deb40-978">Se kapitel 4 "Beskrivning av tjänster" för fler standard router tjänster som erbjuds av NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="deb40-978">See Chapter 4 "Description of Services" for more default router services offered by NetX Duo.</span></span>  

<span data-ttu-id="deb40-979">Vid vidarebefordring av IPv6-paket kontrollerar NetX Duo först om paket målet är på länk.</span><span class="sxs-lookup"><span data-stu-id="deb40-979">When forwarding IPv6 packets, NetX Duo first checks if the packet destination is on-link.</span></span> <span data-ttu-id="deb40-980">Om inte, kontrollerar NetX Duo standardroutningstabell för en giltig router för att vidarebefordra off-Link-paketet till.</span><span class="sxs-lookup"><span data-stu-id="deb40-980">If not, NetX Duo checks the default routing table for a valid router to forward the off-link packet to.</span></span>  

<span data-ttu-id="deb40-981">Om du vill ta bort en router från IPv6-tabellen Standard router, måste programmet använda tjänsten \***nxd_ipv6_default_router_delete** _.</span><span class="sxs-lookup"><span data-stu-id="deb40-981">To remove a router from the IPv6 default router table, application shall use the service \***nxd_ipv6_default_router_delete** _.</span></span> <span data-ttu-id="deb40-982">Om du vill hämta poster i IPv6-tabellen Standard router använder du tjänsten _ *_nxd_ipv6_default_router_entry_get_* \*.</span><span class="sxs-lookup"><span data-stu-id="deb40-982">To obtain entries of the IPv6 default router table, use the service _\*_nxd_ipv6_default_router_entry_get_\*\*.</span></span>

### <a name="ipv6-header"></a><span data-ttu-id="deb40-983">IPv6-sidhuvud</span><span class="sxs-lookup"><span data-stu-id="deb40-983">IPv6 Header</span></span>    
<span data-ttu-id="deb40-984">IPv6-huvudet har ändrats från IPv4-huvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-984">The IPv6 header has been modified from the IPv4 header.</span></span> <span data-ttu-id="deb40-985">När ett paket allokeras anger anroparen program protokollet (t. ex. UDP, TCP), buffertstorlek i byte och hopp gräns.</span><span class="sxs-lookup"><span data-stu-id="deb40-985">When allocating a packet, the caller specifies the application protocol (e.g., UDP, TCP), buffer size in bytes, and hop limit.</span></span>   

<span data-ttu-id="deb40-986">Bild 9 visar IPv6-huvudets format och tabellen innehåller rubrik komponenterna.</span><span class="sxs-lookup"><span data-stu-id="deb40-986">Figure 9 shows the format of the IPv6 header and the table lists the header components.</span></span>

![Diagram över IPv6-huvudets format.](./media/user-guide/image18.png)

<span data-ttu-id="deb40-988">**BILD 9. IPv6-huvud format**</span><span class="sxs-lookup"><span data-stu-id="deb40-988">**FIGURE 9. IPv6 Header Format**</span></span>

|<span data-ttu-id="deb40-989">IP-huvud</span><span class="sxs-lookup"><span data-stu-id="deb40-989">IP header</span></span> | <span data-ttu-id="deb40-990">Syfte</span><span class="sxs-lookup"><span data-stu-id="deb40-990">Purpose</span></span> |
|---|---|
|<span data-ttu-id="deb40-991">Version</span><span class="sxs-lookup"><span data-stu-id="deb40-991">Version</span></span> |<span data-ttu-id="deb40-992">4-bitars fält för IP-version.</span><span class="sxs-lookup"><span data-stu-id="deb40-992">4-bit field for IP version.</span></span> <span data-ttu-id="deb40-993">För IPv6-nätverk måste värdet i det här fältet vara 6; För IPv4-nätverk måste det vara 4.</span><span class="sxs-lookup"><span data-stu-id="deb40-993">For IPv6 networks, the value in this field must be 6; For IPv4 networks it must be 4.</span></span>|
|<span data-ttu-id="deb40-994">Trafikklass</span><span class="sxs-lookup"><span data-stu-id="deb40-994">Traffic Class</span></span> |<span data-ttu-id="deb40-995">8-bitars fält som lagrar information om trafik klass.</span><span class="sxs-lookup"><span data-stu-id="deb40-995">8-bit field that stores the traffic class information.</span></span> <span data-ttu-id="deb40-996">Det här fältet används inte av NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="deb40-996">This field is not used by NetX Duo.</span></span>|
|<span data-ttu-id="deb40-997">Flödes etikett</span><span class="sxs-lookup"><span data-stu-id="deb40-997">Flow Label</span></span> |<span data-ttu-id="deb40-998">20-bitars fält för att unikt identifiera flödet, om det finns något, som ett paket är associerat med.</span><span class="sxs-lookup"><span data-stu-id="deb40-998">20-bit field to uniquely identify the flow, if any, that a packet is associated with.</span></span> <span data-ttu-id="deb40-999">Värdet noll anger att paketet inte tillhör ett visst flöde.</span><span class="sxs-lookup"><span data-stu-id="deb40-999">A value of zero indicates the packet does not belong to a particular flow.</span></span> <span data-ttu-id="deb40-1000">Det här fältet ersätter *TOS*-fältet i IPv4.</span><span class="sxs-lookup"><span data-stu-id="deb40-1000">This field replaces the *TOS* field in IPv4.</span></span>|
|<span data-ttu-id="deb40-1001">Nytto last längd</span><span class="sxs-lookup"><span data-stu-id="deb40-1001">Payload Length</span></span> |<span data-ttu-id="deb40-1002">16-bitars fält som visar mängden data i byte för IPv6-paketet som följer IPv6-bas huvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1002">16-bit field indicating the amount of data in bytes of the IPv6 packet following the IPv6 base header.</span></span> <span data-ttu-id="deb40-1003">Detta inkluderar alla inkapslade protokoll huvud och data.</span><span class="sxs-lookup"><span data-stu-id="deb40-1003">This includes all encapsulated protocol header and data.</span></span>|
|<span data-ttu-id="deb40-1004">Nästa sidhuvud</span><span class="sxs-lookup"><span data-stu-id="deb40-1004">Next Header</span></span> | <span data-ttu-id="deb40-1005">8-bitars fält som anger vilken typ av tilläggs rubrik som följer IPv6-bas rubriken.</span><span class="sxs-lookup"><span data-stu-id="deb40-1005">8-bit field indicating the type of the extension header that follows the IPv6 base header.</span></span> <span data-ttu-id="deb40-1006">Det här fältet ersätter *protokoll* fältet i IPv4.</span><span class="sxs-lookup"><span data-stu-id="deb40-1006">This field replaces the *Protocol* field in IPv4.</span></span>|
|<span data-ttu-id="deb40-1007">Hopp gräns</span><span class="sxs-lookup"><span data-stu-id="deb40-1007">Hop Limit</span></span> |<span data-ttu-id="deb40-1008">8-bitars fält som begränsar antalet routrar som paketet tillåts att gå igenom.</span><span class="sxs-lookup"><span data-stu-id="deb40-1008">8-bit field that limits the number of routers the packet is allowed to go through.</span></span> <span data-ttu-id="deb40-1009">Det här fältet ersätter *TTL*-fältet i IPv4.</span><span class="sxs-lookup"><span data-stu-id="deb40-1009">This field replaces the *TTL* field in IPv4.</span></span>|
|<span data-ttu-id="deb40-1010">Käll adress</span><span class="sxs-lookup"><span data-stu-id="deb40-1010">Source Address</span></span> |<span data-ttu-id="deb40-1011">128-bitars fält som lagrar avsändarens IPv6-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-1011">128-bit field that stores the IPv6 address of the sender.</span></span>|
|<span data-ttu-id="deb40-1012">Mål adress</span><span class="sxs-lookup"><span data-stu-id="deb40-1012">Destination Address</span></span> |<span data-ttu-id="deb40-1013">128-bitars fält som Sores IPv6-adressen till målet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1013">128-bit field that sores the IPv6 address of the destination.</span></span>|

### <a name="enabling-ipv6-in-netx-duo"></a><span data-ttu-id="deb40-1014">Aktivera IPv6 i NetX Duo</span><span class="sxs-lookup"><span data-stu-id="deb40-1014">Enabling IPv6 in NetX Duo</span></span>    
<span data-ttu-id="deb40-1015">Som standard är IPv6 aktiverat i NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="deb40-1015">By default IPv6 is enabled in NetX Duo.</span></span> <span data-ttu-id="deb40-1016">IPv6-tjänster är aktiverade i NetX Duo om det konfigurerbara alternativet \***NX_DISABLE_IPV6** _ i _nx_user. h \* inte har definierats.</span><span class="sxs-lookup"><span data-stu-id="deb40-1016">IPv6 services are enabled in NetX Duo if the configurable option ***NX_DISABLE_IPV6** _ in _nx_user.h* is not defined.</span></span> <span data-ttu-id="deb40-1017">Om ***NX_DISABLE_IPV6*** har definierats kommer netx Duo endast att erbjuda IPv4-tjänster och alla IPv6-relaterade moduler och tjänster är inte inbyggda i netx Duo-biblioteket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1017">If ***NX_DISABLE_IPV6*** is defined, NetX Duo will only offer IPv4 services, and all the IPv6-related modules and services are not built into NetX Duo library.</span></span>

<span data-ttu-id="deb40-1018">Följande tjänst tillhandahålls för program för att konfigurera enhetens IPv6-adress: ***nxd_ipv6_address_set***</span><span class="sxs-lookup"><span data-stu-id="deb40-1018">The following service is provided for applications to configure the device IPv6 address: ***nxd_ipv6_address_set***</span></span>

<span data-ttu-id="deb40-1019">Förutom att manuellt ange enhetens IPv6-adresser, kan systemet även använda automatisk adress konfiguration med tillstånd.</span><span class="sxs-lookup"><span data-stu-id="deb40-1019">In addition to manually setting the device's IPv6 addresses, the system may also use Stateless Address Autoconfiguration.</span></span> <span data-ttu-id="deb40-1020">Om du vill använda det här alternativet måste programmet anropa \***nxd_ipv6_enable** _ för att kunna starta IPv6-tjänsterna på enheten.</span><span class="sxs-lookup"><span data-stu-id="deb40-1020">To use this option, the application must call \***nxd_ipv6_enable** _ to start IPv6 services on the device.</span></span> <span data-ttu-id="deb40-1021">Dessutom måste ICMPv6-tjänster startas genom att anropa _*_nxd_icmp_enable_*_, vilket gör att netx Duo kan utföra tjänster som routermeddelanden, Neighbor Discovery och dubblettidentifiering.</span><span class="sxs-lookup"><span data-stu-id="deb40-1021">In addition, ICMPv6 services must be started by calling _*_nxd_icmp_enable_*_, which enables NetX Duo to perform services such as Router Solicitation, Neighbor Discovery, and Duplicate Address Detection.</span></span> <span data-ttu-id="deb40-1022">Observera att _*_nx_icmp_enable_*_ endast startar ICMP för IPv4-tjänster.</span><span class="sxs-lookup"><span data-stu-id="deb40-1022">Note that _*_nx_icmp_enable_*_ only starts ICMP for IPv4 services.</span></span> <span data-ttu-id="deb40-1023">_*_nxd_icmp_enable_*_ startar ICMP-tjänster för både IPv4 och IPv6.</span><span class="sxs-lookup"><span data-stu-id="deb40-1023">_*_nxd_icmp_enable_*_ starts ICMP services for both IPv4 and IPv6.</span></span> <span data-ttu-id="deb40-1024">Om systemet inte behöver ICMPv6-tjänster kan du använda _ *_nx_icmp_enable_*\* så att modulen ICMPv6 inte är länkad till systemet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1024">If the system does not need ICMPv6 services, then _ *_nx_icmp_enable_*\* can be used so the ICMPv6 module is not linked into the system.</span></span>

<span data-ttu-id="deb40-1025">I följande exempel visas en typisk NetX Duo IPv6-initierings procedur.</span><span class="sxs-lookup"><span data-stu-id="deb40-1025">The following example shows a typical NetX Duo IPv6 initialization procedure.</span></span>

```c
/* Assume ip_0 has been created and IPv4 services (such as ARP,
   ICMP, have been enabled. */
#define SECONDARY_INTERFACE 1

/* Enable IPv6 */
status = nxd_ipv6_enable(&ip_0);

if(status != NX_SUCCESS)
{
    /* nxd_ipv6_enable failed. */
}

/* Enable ICMPv6 */
status = nxd_icmp_enable(&ip_0);
if(status != NX_SUCCESS)
{
    /* nxd_icmp_enable failed. */
}

/* Configure the link local address on the primary interface. */
status = nxd_ipv6_address_set(&ip_0, 0, NX_NULL, 10, NX_NULL);

/* Configure ip_0 primary interface global address. */
ip_address.nxd_ip_version = NX_IP_VERSION_V6
ip_address.nxd_ip_address.v6[0] = 0x20010db8;
ip_address.nxd_ip_address.v6[1] = 0x0000f101;
ip_address.nxd_ip_address.v6[2] = 0;
ip_address.nxd_ip_address.v6[3] = 0x202;

/* Configure global address of the primary interface. */
status = nxd_ipv6_address_set(&ip_0, SECONDARY_INTERFACE,
                              &ip_address, 64, NX_NULL);
```                              

<span data-ttu-id="deb40-1026">Protokoll på övre nivå (t. ex. TCP och UDP) kan aktive ras antingen före eller efter att IPv6 startar.</span><span class="sxs-lookup"><span data-stu-id="deb40-1026">Upper layer protocols (such as TCP and UDP) can be enabled either before or after IPv6 starts.</span></span>

> [!IMPORTANT]  
> <span data-ttu-id="deb40-1027">*IPv6-tjänster är bara tillgängliga när IP-tråd har initierats och enheten är aktive rad.*</span><span class="sxs-lookup"><span data-stu-id="deb40-1027">*IPv6 services are available only after IP thread is initialized and the device is enabled.*</span></span>

<span data-ttu-id="deb40-1028">När gränssnittet har Aktiver ATS (det vill säga att gränssnitts enhetens driv rutin är redo att skicka och ta emot data och en giltig länk lokal adress har hämtats) kan enheten erhålla globala IPv6-adresser med någon av följande metoder:</span><span class="sxs-lookup"><span data-stu-id="deb40-1028">After the interface is enabled (i.e.,the interface device driver is ready to send and receive data, and a valid link local address has been obtained), the device may obtain global IPv6 addresses by one of the these methods:</span></span>

- <span data-ttu-id="deb40-1029">Automatisk konfiguration av autonoma adresser;</span><span class="sxs-lookup"><span data-stu-id="deb40-1029">Stateless Address Auto Configuration;</span></span>  
- <span data-ttu-id="deb40-1030">Manuell konfiguration av IPv6-adress;</span><span class="sxs-lookup"><span data-stu-id="deb40-1030">Manual IPv6 address configuration;</span></span>  
- <span data-ttu-id="deb40-1031">Adress konfiguration via DHCPv6 (med valfritt DHCPv6-paket)</span><span class="sxs-lookup"><span data-stu-id="deb40-1031">Address configuration via DHCPv6 (with optional DHCPv6 package)</span></span>

<span data-ttu-id="deb40-1032">De första två metoderna beskrivs nedan.</span><span class="sxs-lookup"><span data-stu-id="deb40-1032">The first two methods are described below.</span></span> <span data-ttu-id="deb40-1033">Den tredje metoden (DHCPv6) beskrivs i DHCP-paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1033">The 3rd method (DHCPv6) is described in the DHCP package.</span></span>

### <a name="stateless-address-autoconfiguration-using-router-solicitation"></a><span data-ttu-id="deb40-1034">Automatisk adress konfiguration med router-inbjudning</span><span class="sxs-lookup"><span data-stu-id="deb40-1034">Stateless Address Autoconfiguration Using Router Solicitation</span></span>      
<span data-ttu-id="deb40-1035">NetX Duo-enheter kan konfigurera sina gränssnitt automatiskt när de ansluts till ett IPv6-nätverk med en router som tillhandahåller prefixs information.</span><span class="sxs-lookup"><span data-stu-id="deb40-1035">NetX Duo devices can configure their interfaces automatically when connected to an IPv6 network with a router that supplies prefix information.</span></span> <span data-ttu-id="deb40-1036">Enheter som kräver tillstånds lös automatisk adress konfiguration skickar RS-meddelanden (router inbjudningar).</span><span class="sxs-lookup"><span data-stu-id="deb40-1036">Devices that require Stateless Address Autoconfiguration send out router solicitation (RS) messages.</span></span> <span data-ttu-id="deb40-1037">Routrar i nätverket svarar med meddelanden om begärd router-annonsering (RA).</span><span class="sxs-lookup"><span data-stu-id="deb40-1037">Routers on the network respond with solicited router advertisement (RA) messages.</span></span> <span data-ttu-id="deb40-1038">RA-meddelanden annonserar prefix som identifierar de nätverks adresser som är associerade med en länk.</span><span class="sxs-lookup"><span data-stu-id="deb40-1038">RA messages advertise prefixes that identify the network addresses associated with a link.</span></span> <span data-ttu-id="deb40-1039">Enheter genererar sedan en unik identifierare för nätverket som enheten är ansluten till.</span><span class="sxs-lookup"><span data-stu-id="deb40-1039">Devices then generate a unique identifier for the network the device is attached to.</span></span> <span data-ttu-id="deb40-1040">Adressen skapas genom att kombinera prefixet och dess unika identifierare.</span><span class="sxs-lookup"><span data-stu-id="deb40-1040">The address is formed by combining the prefix and its unique identifier.</span></span> <span data-ttu-id="deb40-1041">På det här sättet när du tar emot RA-meddelanden genererar värdarna sin IP-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-1041">In this manner on receiving the RA messages, hosts generate their IP address.</span></span> <span data-ttu-id="deb40-1042">Routrar kan också skicka regelbundna oönskade RA-meddelanden.</span><span class="sxs-lookup"><span data-stu-id="deb40-1042">Routers may also send periodic unsolicited RA messages.</span></span> 

> [!WARNING]
> <span data-ttu-id="deb40-1043">*Netx Duo gör det möjligt för ett program att aktivera eller inaktivera tillstånds lös automatisk adress konfiguration vid körning. Om du vill aktivera den här funktionen måste NetX Duo-biblioteket kompileras med **NX_IPV6_STATELESS_AUTOCONFIG_CONTROL** definierat. När den här funktionen är aktive rad kan program använda **nxd_ipv6_stateless_address_autoconfigure_enable** och **nxd_ipv6_stateless_address_autocofigure_disable** för att aktivera eller inaktivera IPv6-tillstånds lös adress automatisk konfiguration*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1043">*NetX Duo allows an application to enable or disable Stateless Address Autoconfiguration at run time. To enable this feature, NetX Duo library must be compiled with **NX_IPV6_STATELESS_AUTOCONFIG_CONTROL** defined. Once this feature is enabled, applications may use **nxd_ipv6_stateless_address_autoconfigure_enable** and **nxd_ipv6_stateless_address_autocofigure_disable** to enable or disable IPv6 stateless address autoconfiguration*.</span></span>

### <a name="manual-ipv6-address-configuration"></a><span data-ttu-id="deb40-1044">Manuell konfiguration av IPv6-adress</span><span class="sxs-lookup"><span data-stu-id="deb40-1044">Manual IPv6 Address Configuration</span></span>     
<span data-ttu-id="deb40-1045">Om en specifik IPv6-adress behövs kan programmet använda ***nxd_ipv6_address_set*** för att manuellt konfigurera en IPv6-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-1045">If a specific IPv6 address is needed, the application may use ***nxd_ipv6_address_set*** to manually configure an IPv6 address.</span></span> <span data-ttu-id="deb40-1046">Ett nätverks gränssnitt kan ha flera IPv6-adresser.</span><span class="sxs-lookup"><span data-stu-id="deb40-1046">A network interface may have multiple IPv6 addresses.</span></span> <span data-ttu-id="deb40-1047">Tänk dock på att det totala antalet IPv6-adresser i ett system, antingen erhållna genom tillstånds lös adress konfiguration eller genom manuell konfiguration, inte överskrider ***NX_MAX_IPV6_ADDRESSES***.</span><span class="sxs-lookup"><span data-stu-id="deb40-1047">However keep in mind that the total number of IPv6 addresses in a system, either obtained through Stateless Address Autoconfiguration, or through the Manual Configuration, cannot exceed ***NX_MAX_IPV6_ADDRESSES***.</span></span>

<span data-ttu-id="deb40-1048">I följande exempel visas hur du manuellt konfigurerar en global adress på det primära gränssnittet (enhet 0) i ip_0:</span><span class="sxs-lookup"><span data-stu-id="deb40-1048">The following example illustrates how to manually configure a global address on the primary interface (device 0) in ip_0:</span></span>

```c
NXD_ADDRESS global_address;
global_address.nxd_ip_version = NX_IP_VERSION_V6;
global_address.nxd_ip_address.v6[0] = 0x20010000;
global_address.nxd_ip_address.v6[1] = 0x00000000;
global_address.nxd_ip_address.v6[2] = 0x00000000;
global_address.nxd_ip_address.v6[3] = 0x0000ABCD;
```

<span data-ttu-id="deb40-1049">Värden anropar sedan följande NetX Duo-tjänst för att tilldela adressen som global IP-adress:</span><span class="sxs-lookup"><span data-stu-id="deb40-1049">The host then calls the following NetX Duo service to assign this address as its global IP address:</span></span>

```c
status = nxd_ipv6_address_set(&ip_0, 0,  
                              &global_address, 64
                              NX_NULL);
```

### <a name="duplicate-address-detection-dad"></a><span data-ttu-id="deb40-1050">Duplicerad adress identifiering (pappa)</span><span class="sxs-lookup"><span data-stu-id="deb40-1050">Duplicate Address Detection (DAD)</span></span>    
<span data-ttu-id="deb40-1051">När ett system har konfigurerat IPv6-adressen markeras adressen som *preliminär*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1051">After a system configures its IPv6 address, the address is marked as *TENTATIVE*.</span></span> <span data-ttu-id="deb40-1052">Om duplicerad adress identifiering (pappa), som beskrivs i RFC 4862, är aktive rad, skickar NetX Duo automatiskt grann Inbjudnings meddelanden (NS) med den här preliminära adressen som mål.</span><span class="sxs-lookup"><span data-stu-id="deb40-1052">If Duplicate Address Detection (DAD), described in RFC 4862, is enabled, NetX Duo automatically sends neighbor solicitation (NS) messages with this tentative address as the destination.</span></span> <span data-ttu-id="deb40-1053">Om inga värdar i nätverket svarar på dessa NS-meddelanden inom en viss tids period, antas adressen vara unik på den lokala länken och dess tillstånds överföring till ett giltigt tillstånd.</span><span class="sxs-lookup"><span data-stu-id="deb40-1053">If no hosts on the network respond to these NS messages within a given period of time, the address is assumed to be unique on the local link, and its state transits to the VALID state.</span></span> <span data-ttu-id="deb40-1054">I det här läget kan programmet börja använda den här IP-adressen för kommunikation.</span><span class="sxs-lookup"><span data-stu-id="deb40-1054">At this point the application may start using this IP address for communication.</span></span>  

<span data-ttu-id="deb40-1055">Pappa-funktionen är en del av modulen ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="deb40-1055">The DAD functionality is part of the ICMPv6 module.</span></span> <span data-ttu-id="deb40-1056">Programmet måste därför aktivera ICMPv6-tjänster innan en nyligen konfigurerad adress kan gå igenom pappa-processen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1056">Therefore, the application must enable ICMPv6 services before a newly configured address can go through the DAD process.</span></span> <span data-ttu-id="deb40-1057">Du kan också stänga av pappa-processen genom att definiera ***NX_DISABLE_IPV6_DAD** _ alternativ i versions miljön netx Duo Library (definieras som _*_nx_user. h_\*_).</span><span class="sxs-lookup"><span data-stu-id="deb40-1057">Alternatively, the DAD process may be turned off by defining ***NX_DISABLE_IPV6_DAD** _ option in the NetX Duo library build environment (defined as _*_nx_user.h_\*_).</span></span> <span data-ttu-id="deb40-1058">Under pappa-processen bestämmer _*_NX_IPV6_DAD_TRANSMITS_*_ -parametern antalet ns-meddelanden som skickats av netx Duo utan att ta emot något svar för att avgöra om adressen är unik.</span><span class="sxs-lookup"><span data-stu-id="deb40-1058">During the DAD process, the _*_NX_IPV6_DAD_TRANSMITS_*_ parameter determines the number of NS messages sent by NetX Duo without receiving a response to determine that the address is unique.</span></span> <span data-ttu-id="deb40-1059">Som standard och rekommenderas av RFC 4862, _ *_NX_IPV6_DAD_TRANSMITS_*\* anges till 3.</span><span class="sxs-lookup"><span data-stu-id="deb40-1059">By default and recommended by RFC 4862, _ *_NX_IPV6_DAD_TRANSMITS_*\* is set at 3.</span></span> <span data-ttu-id="deb40-1060">Om du anger den här symbolen till noll inaktive ras pappa.</span><span class="sxs-lookup"><span data-stu-id="deb40-1060">Setting this symbol to zero effectively disables DAD.</span></span>

<span data-ttu-id="deb40-1061">Om ICMPv6 eller pappa inte är aktiverat när programmet tilldelar en IPv6-adress, utförs inte pappa och NetX Duo anger statusen för IPv6-adressen till giltig omedelbart.</span><span class="sxs-lookup"><span data-stu-id="deb40-1061">If ICMPv6 or DAD is not enabled at the time the application assigns an IPv6 address, DAD is not performed and NetX Duo sets the state of the IPv6 address to VALID immediately.</span></span>

<span data-ttu-id="deb40-1062">NetX Duo kan inte kommunicera med IPv6-nätverket förrän dess länk lokala och/eller globala adress är giltiga.</span><span class="sxs-lookup"><span data-stu-id="deb40-1062">NetX Duo cannot communicate on the IPv6 network until its link local and/or global address is valid.</span></span> <span data-ttu-id="deb40-1063">När en giltig adress har erhållits försöker NetX Duo matcha mål adressen för ett inkommande paket mot en av dess konfigurerade IPv6-adress eller en aktive rad multicast-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-1063">After a valid address is obtained, NetX Duo attempts to match the destination address of an incoming packet against one of its configured IPv6 address or an enabled multicast address.</span></span> <span data-ttu-id="deb40-1064">Om inga matchningar hittas ignoreras paketet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1064">If no matches are found, the packet is dropped.</span></span> 

> [!WARNING]  
> <span data-ttu-id="deb40-1065">\* Under pappa-processen definieras antalet pappa NS-paket som ska överföras av \***NX_IPV6_DAD_TRANSMITS**_, som är standardvärdet 3, och som standard är det en sekund fördröjning mellan varje far ns-meddelande som skickas. I ett system med pappa aktiverat efter att en IPv6-adress har tilldelats (och förutsatt att detta inte är en duplicerad adress), är det cirka 3 sekunder innan IP-adressen är i ett giltigt tillstånd och är klar för kommunikation._</span><span class="sxs-lookup"><span data-stu-id="deb40-1065">\*During the DAD process, the number of DAD NS packets to be transmitted is defined by \***NX_IPV6_DAD_TRANSMITS**_, which defaults to 3, and by default there is a one second delay between each DAD NS message is sent. Therefore, in a system with DAD enabled, after an IPv6 address is assigned (and assuming this is not a duplicated address), there is approximately 3 seconds delay before the IP address is in a VALID state and is ready for communication._</span></span>

<span data-ttu-id="deb40-1066">Program kanske vill få meddelanden när IPv6-adresser i systemet ändras.</span><span class="sxs-lookup"><span data-stu-id="deb40-1066">Applications may want to receive notifications when IPv6 addresses in the system are changed.</span></span> <span data-ttu-id="deb40-1067">Om du vill aktivera funktionen ändrings meddelande för IPv6-adress måste NetX Duo-biblioteket skapas med symbolen **NX_ENABLE_IPV6_ADDRESS_CHANGE_NOTIFY** definierad.</span><span class="sxs-lookup"><span data-stu-id="deb40-1067">To enable the IPv6 address change notification feature, the NetX Duo library must be built with the symbol **NX_ENABLE_IPV6_ADDRESS_CHANGE_NOTIFY** defined.</span></span> <span data-ttu-id="deb40-1068">När funktionen är aktive rad kan program installera motringningsfunktionen med hjälp av tjänsten **_nxd_ipv6_address_change_notify_** .</span><span class="sxs-lookup"><span data-stu-id="deb40-1068">Once the feature is enabled, applications may install the callback function by using the **_nxd_ipv6_address_change_notify_** service.</span></span>

<span data-ttu-id="deb40-1069">När en IPv6-adress har ändrats eller blir ogiltig, anropas funktionen motringning med följande information:</span><span class="sxs-lookup"><span data-stu-id="deb40-1069">Once an IPv6 address is changed, or becomes invalid, the user-supplied callback function is invoked with the following information:</span></span>

| <span data-ttu-id="deb40-1070">Funktion</span><span class="sxs-lookup"><span data-stu-id="deb40-1070">Function</span></span>  | <span data-ttu-id="deb40-1071">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="deb40-1071">Description</span></span>  |
|---|---|
|<span data-ttu-id="deb40-1072">ip_ptr</span><span class="sxs-lookup"><span data-stu-id="deb40-1072">ip_ptr</span></span> |<span data-ttu-id="deb40-1073">Pekare till IP-instansen</span><span class="sxs-lookup"><span data-stu-id="deb40-1073">Pointer to the IP instance</span></span>|
|<span data-ttu-id="deb40-1074">interface_index</span><span class="sxs-lookup"><span data-stu-id="deb40-1074">interface_index</span></span> |<span data-ttu-id="deb40-1075">Indexera det nätverks gränssnitt som denna IPv6-adress är associerad med</span><span class="sxs-lookup"><span data-stu-id="deb40-1075">Index to the network interface that this IPv6 address is associated with</span></span>
|<span data-ttu-id="deb40-1076">ipv6_addr_index</span><span class="sxs-lookup"><span data-stu-id="deb40-1076">ipv6_addr_index</span></span> |<span data-ttu-id="deb40-1077">Index till IPv6-adress tabellen</span><span class="sxs-lookup"><span data-stu-id="deb40-1077">Index to the IPv6 address table</span></span>|
|<span data-ttu-id="deb40-1078">ipv6_address</span><span class="sxs-lookup"><span data-stu-id="deb40-1078">ipv6_address</span></span> |<span data-ttu-id="deb40-1079">Pekare till IPv6-adressen, i form av en matris med fyra ULONG-heltal.</span><span class="sxs-lookup"><span data-stu-id="deb40-1079">Pointer to the IPv6 address, in the form of an array of four ULONG integers.</span></span> <span data-ttu-id="deb40-1080">Pv6-adresser presenteras i värdens byte ordning.</span><span class="sxs-lookup"><span data-stu-id="deb40-1080">Pv6 addresses are presented in host byte order.</span></span>|

### <a name="ipv6-multicast-support-in-netx-duo"></a><span data-ttu-id="deb40-1081">Stöd för IPv6-multicast i NetX Duo</span><span class="sxs-lookup"><span data-stu-id="deb40-1081">IPv6 Multicast Support In NetX Duo</span></span>      
<span data-ttu-id="deb40-1082">Multicast-adresser anger en dynamisk grupp värdar på Internet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1082">Multicast addresses specify a dynamic group of hosts on the Internet.</span></span> <span data-ttu-id="deb40-1083">Medlemmar i multicast-gruppen kan ansluta till och lämna när de vill.</span><span class="sxs-lookup"><span data-stu-id="deb40-1083">Members of the multicast group may join and leave whenever they wish.</span></span> <span data-ttu-id="deb40-1084">NetX Duo implementerar flera ICMPv6-protokoll, inklusive dubblettidentifiering, identifiering av grannar och routerupptäckt, som kräver IP-multicast-kapacitet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1084">NetX Duo implements several ICMPv6 protocols, including Duplicate Address Detection, Neighbor Discovery, and Router Discovery, which require IP multicast capability.</span></span> <span data-ttu-id="deb40-1085">Därför förväntar NetX Duo den underliggande driv rutinen för att stödja multicast-åtgärder.</span><span class="sxs-lookup"><span data-stu-id="deb40-1085">Therefore, NetX Duo expects the underlying device driver to support multicast operations.</span></span>

<span data-ttu-id="deb40-1086">När NetX Duo måste ansluta till eller lämna en multicast-grupp (t. ex. multicast-adress för alla noder och den *anropade nodens* multicast-adress), utfärdar den ett driv rutins kommando till enhets driv rutinen för att ansluta till eller lämna en multicast-MAC-adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-1086">When NetX Duo needs to join or leave a multicast group (such as the all-node multicast address, and the *solicited-node* multicast address), it issues a driver command to the device driver to join or leave a multicast MAC address.</span></span> <span data-ttu-id="deb40-1087">Driv rutins kommandot för att ansluta till multicast-adressen är \***NX_LINK_MULTICAST_JOIN** _ _.</span><span class="sxs-lookup"><span data-stu-id="deb40-1087">The driver command for joining the multicast address is \***NX_LINK_MULTICAST_JOIN** _.</span></span> <span data-ttu-id="deb40-1088">För att lämna en multicast-adress utfärdar NetX Duo driv rutins kommandot _ *_NX_LINK_MULTICAST_LEAVE_* \*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1088">To leave a multicast address, NetX Duo issues the driver command _\*_NX_LINK_MULTICAST_LEAVE_\*\*.</span></span> <span data-ttu-id="deb40-1089">Driv rutinen måste implementera dessa två kommandon för att ICMPv6-protokoll ska fungera korrekt.</span><span class="sxs-lookup"><span data-stu-id="deb40-1089">The device driver must implement these two commands for ICMPv6 protocols to work properly.</span></span>

<span data-ttu-id="deb40-1090">Program kan ansluta till en IPv6-multicast-grupp med hjälp av tjänsten \*\**nxd_ipv6_multicast_interface_join *.**</span><span class="sxs-lookup"><span data-stu-id="deb40-1090">Applications may join an IPv6 multicast group by using the service \***nxd_ipv6_multicast_interface_join\*.**</span></span> <span data-ttu-id="deb40-1091">Den här tjänsten registrerar multicast-adressen med IP-stacken och meddelar sedan den angivna driv rutinen för IPv6-multicast-adressen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1091">This service registers the multicast address with the IP stack, and then notifies the specified device driver of the IPv6 multicast address.</span></span> <span data-ttu-id="deb40-1092">För att lämna en multicast-grupp använder programmen tjänsten ***nxd_ipv6_multicast_interface_leave.***</span><span class="sxs-lookup"><span data-stu-id="deb40-1092">To leave a multicast group, applications use the service ***nxd_ipv6_multicast_interface_leave.***</span></span>

### <a name="neighbor-discovery-nd"></a><span data-ttu-id="deb40-1093">Neighbor Discovery (ND)</span><span class="sxs-lookup"><span data-stu-id="deb40-1093">Neighbor Discovery (ND)</span></span>    
<span data-ttu-id="deb40-1094">Neighbor Discovery är ett protokoll i IPv6-nätverk för mappning av fysiska adresser till IPv6-adresserna (global adress eller länk lokal adress).</span><span class="sxs-lookup"><span data-stu-id="deb40-1094">Neighbor Discovery is a protocol in IPv6 networks for mapping physical addresses to the IPv6 addresses (global address or link-local address).</span></span> <span data-ttu-id="deb40-1095">Den här mappningen underhålls i cacheminnet för Neighbor Discovery (ND cache).</span><span class="sxs-lookup"><span data-stu-id="deb40-1095">This mapping is maintained in the Neighbor Discovery Cache (ND Cache).</span></span> <span data-ttu-id="deb40-1096">ND-processen motsvarar ARP-processen i IPv4 och ND-cachen liknar ARP-tabellen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1096">The ND process is the equivalent of the ARP process in IPv4, and the ND Cache is similar to the ARP table.</span></span> <span data-ttu-id="deb40-1097">En IPv6-nod kan hämta grannens MAC-adress med hjälp av ND-protokollet (Neighbor Discovery).</span><span class="sxs-lookup"><span data-stu-id="deb40-1097">An IPv6 node can obtain its neighbor's MAC address using the Neighbor Discovery (ND) protocol.</span></span> <span data-ttu-id="deb40-1098">Den skickar ut ett meddelande om en grann inbjudning (NS) till multicast-adressen för den begärda noden med alla noder och väntar på ett motsvarande meddelande om grann annonsering (NA).</span><span class="sxs-lookup"><span data-stu-id="deb40-1098">It sends out a neighbor solicitation (NS) message to the all-node solicited node multicast address, and waits for a corresponding neighbor advertisement (NA) message.</span></span> <span data-ttu-id="deb40-1099">MAC-adressen som hämtas genom den här processen lagras i ND-cachen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1099">The MAC address obtained through this process is stored in the ND Cache.</span></span>

<span data-ttu-id="deb40-1100">Varje IP-instans har en ND-cache.</span><span class="sxs-lookup"><span data-stu-id="deb40-1100">Each IP instance has one ND cache.</span></span> <span data-ttu-id="deb40-1101">ND-cachen upprätthålls som en matris med poster.</span><span class="sxs-lookup"><span data-stu-id="deb40-1101">The ND Cache is maintained as an array of entries.</span></span> <span data-ttu-id="deb40-1102">Storleken på matrisen definieras vid kompileringen genom att ange alternativet \***NX_IPV6_NEIGHBOR_CACHE_SIZE** _ som i _ *_nx_user. h_* \*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1102">The size of the array is defined at compilation time by setting the option ***NX_IPV6_NEIGHBOR_CACHE_SIZE** _ which in _*_nx_user.h_\*\*.</span></span> <span data-ttu-id="deb40-1103">Observera att alla gränssnitt som är kopplade till en IP-instans delar samma ND-cache.</span><span class="sxs-lookup"><span data-stu-id="deb40-1103">Note that all interfaces attached to an IP instance share the same ND cache.</span></span>

<span data-ttu-id="deb40-1104">Hela ND-cachen är tom när NetX Duo startar.</span><span class="sxs-lookup"><span data-stu-id="deb40-1104">The entire ND Cache is empty when NetX Duo starts up.</span></span> <span data-ttu-id="deb40-1105">När systemet körs uppdaterar NetX Duo automatiskt ND-cachen, lägger till och tar bort poster enligt varje ND-protokoll.</span><span class="sxs-lookup"><span data-stu-id="deb40-1105">As the system runs, NetX Duo automatically updates the ND Cache, adding and deleting entries as per ND protocol.</span></span> <span data-ttu-id="deb40-1106">Ett program kan dock också uppdatera ND-cachen genom att manuellt lägga till och ta bort cacheposter med följande NetX Duo-tjänster:</span><span class="sxs-lookup"><span data-stu-id="deb40-1106">However, an application may also update the ND Cache by manually adding and deleting cache entries using the following NetX Duo services:</span></span>

- <span data-ttu-id="deb40-1107">***nxd_nd_cache_entry_delete***</span><span class="sxs-lookup"><span data-stu-id="deb40-1107">***nxd_nd_cache_entry_delete***</span></span>  
- <span data-ttu-id="deb40-1108">***nxd_nd_cache_entry_set***</span><span class="sxs-lookup"><span data-stu-id="deb40-1108">***nxd_nd_cache_entry_set***</span></span>   
- <span data-ttu-id="deb40-1109">***nxd_nd_cache_invalidate***</span><span class="sxs-lookup"><span data-stu-id="deb40-1109">***nxd_nd_cache_invalidate***</span></span>

<span data-ttu-id="deb40-1110">När du skickar och tar emot IPv6-paket uppdaterar NetX Duo automatiskt ND cache-tabellen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1110">When sending and receiving IPv6 packets, NetX Duo automatically updates the ND Cache table.</span></span>

## <a name="internet-control-message-protocol-in-ipv6-icmpv6"></a><span data-ttu-id="deb40-1111">Internet Control Message Protocol i IPv6 (ICMPv6)</span><span class="sxs-lookup"><span data-stu-id="deb40-1111">Internet Control Message Protocol in IPv6 (ICMPv6)</span></span>  

<span data-ttu-id="deb40-1112">Rollen som ICMPv6 i IPv6 har utökats avsevärt för att stödja IPv6-adress mappning och router-identifiering.</span><span class="sxs-lookup"><span data-stu-id="deb40-1112">The role of ICMPv6 in IPv6 has been greatly expanded to support IPv6 address mapping and router discovery.</span></span> <span data-ttu-id="deb40-1113">Dessutom har NetX Duo ICMPv6 stöd för ekobegäran och svar, ICMPv6-fel rapporter och ICMPv6-omdirigerar meddelanden.</span><span class="sxs-lookup"><span data-stu-id="deb40-1113">In addition, NetX Duo ICMPv6 supports echo request and response, ICMPv6 error reports, and ICMPv6 redirect messages.</span></span>

### <a name="icmpv6-enable"></a><span data-ttu-id="deb40-1114">ICMPv6-aktivering</span><span class="sxs-lookup"><span data-stu-id="deb40-1114">ICMPv6 Enable</span></span>    
<span data-ttu-id="deb40-1115">Innan ICMPv6-meddelanden kan bearbetas av NetX Duo måste programmet anropa tjänsten ***nxd_icmp_enable*** för att aktivera ICMPv6-bearbetning som förklarat tidigare.</span><span class="sxs-lookup"><span data-stu-id="deb40-1115">Before ICMPv6 messages can be processed by NetX Duo, the application must call the ***nxd_icmp_enable*** service to enable ICMPv6 processing as explained previously.</span></span> 

### <a name="icmpv6-messages"></a><span data-ttu-id="deb40-1116">ICMPv6-meddelanden</span><span class="sxs-lookup"><span data-stu-id="deb40-1116">ICMPv6 Messages</span></span>     
<span data-ttu-id="deb40-1117">Sidhuvud strukturen i ICMPv6 liknar ICMPv4-huvud strukturen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1117">The ICMPv6 header structure is similar to the ICMPv4 header structure.</span></span> <span data-ttu-id="deb40-1118">Som visas nedan innehåller det grundläggande ICMPv6-huvudet de tre fälten, typ, kod och kontroll summa, plus varierande längd för ICMPv6-Datadata.</span><span class="sxs-lookup"><span data-stu-id="deb40-1118">As shown below, the basic ICMPv6 header contains the three fields, type, code, and checksum, plus variable length of ICMPv6 option data.</span></span> 

![Diagram över ett grundläggande ICMPv6-huvud.](./media/user-guide/image19.png)

<span data-ttu-id="deb40-1120">**BILD 10. Grundläggande ICMPv6-huvud**</span><span class="sxs-lookup"><span data-stu-id="deb40-1120">**FIGURE 10. Basic ICMPv6 Header**</span></span>

|<span data-ttu-id="deb40-1121">Fält</span><span class="sxs-lookup"><span data-stu-id="deb40-1121">Field</span></span> |<span data-ttu-id="deb40-1122">Storlek (byte)</span><span class="sxs-lookup"><span data-stu-id="deb40-1122">Size(bytes)</span></span> |<span data-ttu-id="deb40-1123">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="deb40-1123">Description</span></span> |
|-----|-----|-----|
|     | <span data-ttu-id="deb40-1124">1</span><span class="sxs-lookup"><span data-stu-id="deb40-1124">1</span></span>   |<span data-ttu-id="deb40-1125">Identifierar typen av ICMPv6-meddelande.</span><span class="sxs-lookup"><span data-stu-id="deb40-1125">Identifies the ICMPv6 message type;</span></span> |
|     |     |<span data-ttu-id="deb40-1126">1 mål kan inte kontaktas</span><span class="sxs-lookup"><span data-stu-id="deb40-1126">1 Destination Unreachable</span></span> |
|     |     |<span data-ttu-id="deb40-1127">2 paketet är för stort</span><span class="sxs-lookup"><span data-stu-id="deb40-1127">2 Packet Too Big</span></span> |
|     |     |<span data-ttu-id="deb40-1128">3 tid överskriden</span><span class="sxs-lookup"><span data-stu-id="deb40-1128">3 Time Exceeded</span></span> |
|     |     |<span data-ttu-id="deb40-1129">4 parameter problem</span><span class="sxs-lookup"><span data-stu-id="deb40-1129">4 Parameter Problem</span></span> |
|     |     |<span data-ttu-id="deb40-1130">128 ECHO-begäran</span><span class="sxs-lookup"><span data-stu-id="deb40-1130">128 Echo Request</span></span> |
|     |     |<span data-ttu-id="deb40-1131">129 ECHO svar</span><span class="sxs-lookup"><span data-stu-id="deb40-1131">129 Echo Reply</span></span> |
|     |     |<span data-ttu-id="deb40-1132">133 router-inbjudning</span><span class="sxs-lookup"><span data-stu-id="deb40-1132">133 Router Solicitation</span></span> |
|     |     |<span data-ttu-id="deb40-1133">134 router-annonsering</span><span class="sxs-lookup"><span data-stu-id="deb40-1133">134 Router Advertisement</span></span> |
|     |     |<span data-ttu-id="deb40-1134">135 grann inbjudning</span><span class="sxs-lookup"><span data-stu-id="deb40-1134">135 Neighbor Solicitation</span></span> |
|     |     |<span data-ttu-id="deb40-1135">136 grann annonsering</span><span class="sxs-lookup"><span data-stu-id="deb40-1135">136 Neighbor Advertisement</span></span> |
|     |     |<span data-ttu-id="deb40-1136">137 omdirigera meddelande</span><span class="sxs-lookup"><span data-stu-id="deb40-1136">137 Redirect Message</span></span> |
|<span data-ttu-id="deb40-1137">Kod</span><span class="sxs-lookup"><span data-stu-id="deb40-1137">Code</span></span> | <span data-ttu-id="deb40-1138">1</span><span class="sxs-lookup"><span data-stu-id="deb40-1138">1</span></span>   |<span data-ttu-id="deb40-1139">Ytterligare kvalificerar typen av ICMPv6-meddelande.</span><span class="sxs-lookup"><span data-stu-id="deb40-1139">Further qualifies the ICMPv6 message type.</span></span> <span data-ttu-id="deb40-1140">Används vanligt vis med fel meddelanden.</span><span class="sxs-lookup"><span data-stu-id="deb40-1140">Generally used with error messages.</span></span> <span data-ttu-id="deb40-1141">Om den inte används är den inställd på noll.</span><span class="sxs-lookup"><span data-stu-id="deb40-1141">If not used, it is set to zero.</span></span> <span data-ttu-id="deb40-1142">Echo Request/Reply-och NS-meddelanden använder inte det.</span><span class="sxs-lookup"><span data-stu-id="deb40-1142">Echo request/reply and NS messages do not use it.</span></span>|
|<span data-ttu-id="deb40-1143">Kontrollsumma</span><span class="sxs-lookup"><span data-stu-id="deb40-1143">Checksum</span></span> | <span data-ttu-id="deb40-1144">2</span><span class="sxs-lookup"><span data-stu-id="deb40-1144">2</span></span> |<span data-ttu-id="deb40-1145">16-bitars kontroll Summa fält för ICMP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1145">16-bit checksum field for the ICMP Header.</span></span> <span data-ttu-id="deb40-1146">Detta är en 16-bitars komplett av hela ICMPv6-meddelandet, inklusive ICMPv6-huvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1146">This is a 16-bit complement of the entire ICMPv6 message, including the ICMPv6 header.</span></span> <span data-ttu-id="deb40-1147">Den innehåller också ett pseudo-sidhuvud för IPv6-käll adressen, mål adressen och paketets nytto last längd.</span><span class="sxs-lookup"><span data-stu-id="deb40-1147">It also includes a pseudo-header of the IPv6 source address, destination address, and packet payload length.</span></span> |

<span data-ttu-id="deb40-1148">Ett exempel på grann Inbjudnings huvud visas nedan.</span><span class="sxs-lookup"><span data-stu-id="deb40-1148">An example Neighbor Solicitation header is shown below.</span></span>

![Diagram över ett exempel på grann Inbjudnings huvud.](./media/user-guide/image20.jpg)

<span data-ttu-id="deb40-1150">**BILD 11. ICMPv6-huvud för ett grann Inbjudnings meddelande**</span><span class="sxs-lookup"><span data-stu-id="deb40-1150">**FIGURE 11. ICMPv6 Header for a Neighbor Solicitation Message**</span></span>

|<span data-ttu-id="deb40-1151">Fält</span><span class="sxs-lookup"><span data-stu-id="deb40-1151">Field</span></span> |<span data-ttu-id="deb40-1152">Storlek (byte)</span><span class="sxs-lookup"><span data-stu-id="deb40-1152">Size(bytes)</span></span> |<span data-ttu-id="deb40-1153">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="deb40-1153">Description</span></span> |
|-----|-----|-----|
|<span data-ttu-id="deb40-1154">Typ</span><span class="sxs-lookup"><span data-stu-id="deb40-1154">Type</span></span> | <span data-ttu-id="deb40-1155">1</span><span class="sxs-lookup"><span data-stu-id="deb40-1155">1</span></span>   |<span data-ttu-id="deb40-1156">Identifierar ICMPv6-meddelandets typ för grann Inbjudnings meddelanden.</span><span class="sxs-lookup"><span data-stu-id="deb40-1156">Identifies the ICMPv6 message type for neighbor solicitation messages.</span></span> <span data-ttu-id="deb40-1157">Värdet är 135.</span><span class="sxs-lookup"><span data-stu-id="deb40-1157">Value is 135.</span></span> |
|<span data-ttu-id="deb40-1158">Kod</span><span class="sxs-lookup"><span data-stu-id="deb40-1158">Code</span></span> | <span data-ttu-id="deb40-1159">1</span><span class="sxs-lookup"><span data-stu-id="deb40-1159">1</span></span>   |<span data-ttu-id="deb40-1160">Används inte.</span><span class="sxs-lookup"><span data-stu-id="deb40-1160">Not used.</span></span> <span data-ttu-id="deb40-1161">Ange värdet 0.</span><span class="sxs-lookup"><span data-stu-id="deb40-1161">Set to 0.</span></span> |
|<span data-ttu-id="deb40-1162">Kontrollsumma</span><span class="sxs-lookup"><span data-stu-id="deb40-1162">Checksum</span></span> | <span data-ttu-id="deb40-1163">2</span><span class="sxs-lookup"><span data-stu-id="deb40-1163">2</span></span>  |<span data-ttu-id="deb40-1164">16-bitars kontroll Summa fält för ICMPv6-huvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1164">16-bit checksum field for the ICMPv6 header.</span></span> |
|<span data-ttu-id="deb40-1165">Reserverat</span><span class="sxs-lookup"><span data-stu-id="deb40-1165">Reserved</span></span> | <span data-ttu-id="deb40-1166">4</span><span class="sxs-lookup"><span data-stu-id="deb40-1166">4</span></span>  |<span data-ttu-id="deb40-1167">4 reserverade byte har angetts till 0.</span><span class="sxs-lookup"><span data-stu-id="deb40-1167">4 reserved bytes set to 0.</span></span> |
|<span data-ttu-id="deb40-1168">Mål adress</span><span class="sxs-lookup"><span data-stu-id="deb40-1168">Target Address</span></span> | <span data-ttu-id="deb40-1169">16</span><span class="sxs-lookup"><span data-stu-id="deb40-1169">16</span></span>  |<span data-ttu-id="deb40-1170">IPv6-adress till målet för inbjudningen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1170">IPv6 address of target of the solicitation.</span></span> <span data-ttu-id="deb40-1171">För IPv6-adress matchning är detta den faktiska unicast-IP-adressen för enheten vars länk skikts adress måste matchas.</span><span class="sxs-lookup"><span data-stu-id="deb40-1171">For IPv6 address resolution, this is the actual unicast IP address of the device whose link layer address needs to be resolved.</span></span> |
|<span data-ttu-id="deb40-1172">Alternativ</span><span class="sxs-lookup"><span data-stu-id="deb40-1172">Options</span></span> | <span data-ttu-id="deb40-1173">Variabel</span><span class="sxs-lookup"><span data-stu-id="deb40-1173">Variable</span></span> |<span data-ttu-id="deb40-1174">Valfri information som anges av Neighbor Discovery-protokollet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1174">Optional information specified by the Neighbor Discovery Protocol.</span></span> |

### <a name="icmpv6-ping-request"></a><span data-ttu-id="deb40-1175">ICMPv6 ping-begäran</span><span class="sxs-lookup"><span data-stu-id="deb40-1175">ICMPv6 Ping Request</span></span>
<span data-ttu-id="deb40-1176">I NetX Duo-program används ***nxd_icmp_ping*** för att utfärda antingen IPv6-eller IPv4-ping-förfrågningar, baserat på den mål-IP-adress som anges i parametrarna.</span><span class="sxs-lookup"><span data-stu-id="deb40-1176">In NetX Duo applications use ***nxd_icmp_ping*** to issue either IPv6 or IPv4 ping requests, based on the destination IP address specified in the parameters.</span></span>  

### <a name="icmpv6-ping-response"></a><span data-ttu-id="deb40-1177">Ping-svar för ICMPv6</span><span class="sxs-lookup"><span data-stu-id="deb40-1177">ICMPv6 Ping Response</span></span>
<span data-ttu-id="deb40-1178">Ett ICMPv6-ping-svar är en annan typ av ICMPv6-meddelande som genereras internt av ICMPv6-komponenten som svar på en extern ICMPv6-ping-begäran.</span><span class="sxs-lookup"><span data-stu-id="deb40-1178">An ICMPv6 ping response is another type of ICMPv6 message that is generated internally by the ICMPv6 component in response to an external ICMPv6 ping request.</span></span> <span data-ttu-id="deb40-1179">I tillägg till bekräftelse innehåller ICMPv6 ping-svaret även en kopia av de användar data som angavs i ICMPv6-ping-begäran.</span><span class="sxs-lookup"><span data-stu-id="deb40-1179">In additional to acknowledgement, the ICMPv6 ping response also contains a copy of the user data supplied in the ICMPv6 ping request.</span></span>  

### <a name="thread-suspension"></a><span data-ttu-id="deb40-1180">Tråd upphängning</span><span class="sxs-lookup"><span data-stu-id="deb40-1180">Thread Suspension</span></span>
<span data-ttu-id="deb40-1181">Program trådar kan pausas vid försök att pinga en annan nätverks medlem.</span><span class="sxs-lookup"><span data-stu-id="deb40-1181">Application threads can suspend while attempting to ping another network member.</span></span> <span data-ttu-id="deb40-1182">När ett ping-svar har tagits emot får ping-svarsmeddelandet den första tråden pausad och tråden återupptas.</span><span class="sxs-lookup"><span data-stu-id="deb40-1182">After a ping response is received, the ping response message is given to the first thread suspended and that thread is resumed.</span></span> <span data-ttu-id="deb40-1183">Precis som alla NetX Duo-tjänster är det en valfri timeout att pausa vid en ping-begäran.</span><span class="sxs-lookup"><span data-stu-id="deb40-1183">Like all NetX Duo services, suspending on a ping request has an optional timeout.</span></span>  

### <a name="other-icmpv6-messages"></a><span data-ttu-id="deb40-1184">Andra ICMPv6-meddelanden</span><span class="sxs-lookup"><span data-stu-id="deb40-1184">Other ICMPv6 Messages</span></span>
<span data-ttu-id="deb40-1185">ICMPv6-meddelanden krävs för följande funktioner:</span><span class="sxs-lookup"><span data-stu-id="deb40-1185">ICMPv6 messages are required for the following features:</span></span>  

- <span data-ttu-id="deb40-1186">Identifiering av grannar</span><span class="sxs-lookup"><span data-stu-id="deb40-1186">Neighbor Discovery</span></span>  
- <span data-ttu-id="deb40-1187">Automatisk adress konfiguration för tillstånd</span><span class="sxs-lookup"><span data-stu-id="deb40-1187">Stateless Address Autoconfiguration</span></span> 
- <span data-ttu-id="deb40-1188">Routerupptäckt</span><span class="sxs-lookup"><span data-stu-id="deb40-1188">Router Discovery</span></span> 
- <span data-ttu-id="deb40-1189">Identifiering av grann tillgänglighet</span><span class="sxs-lookup"><span data-stu-id="deb40-1189">Neighbor Unreachability Detection</span></span>  

### <a name="neighbor-unreachability-router-and-prefix-discovery"></a><span data-ttu-id="deb40-1190">Grannen kan inte kontaktas, router-och prefix identifiering</span><span class="sxs-lookup"><span data-stu-id="deb40-1190">Neighbor Unreachability, Router and Prefix Discovery</span></span>    
<span data-ttu-id="deb40-1191">Identifiering av grannars tillgänglighet, routerupptäckt och identifiering av prefix baseras på Neighbor Discovery-protokollet och beskrivs nedan.</span><span class="sxs-lookup"><span data-stu-id="deb40-1191">Neighbor Unreachability Detection, Router Discovery, and Prefix Discovery are based on the Neighbor Discovery protocol and are described below.</span></span> 

<span data-ttu-id="deb40-1192">***Identifiering av grann tillgänglighet:*** En IPv6-enhet söker igenom den angränsande identifierings-cachen (ND) för mål länk skikt adressen när du vill skicka ett paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1192">***Neighbor Unreachability Detection:*** An IPv6 device searches its Neighbor Discovery (ND) Cache for the destination link layer address when it wishes to send a packet.</span></span> <span data-ttu-id="deb40-1193">Det omedelbara målet, som ibland kallas "nästa hopp", kan vara den faktiska destinationen på samma länk, eller så kan det vara en router om målet är av länken.</span><span class="sxs-lookup"><span data-stu-id="deb40-1193">The immediate destination, sometimes referred to as the 'next hop,' may be the actual destination on the same link or it may be a router if the destination is off link.</span></span> <span data-ttu-id="deb40-1194">En ND cache-post innehåller status för en grannens tillgänglighet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1194">An ND cache entry contains the status on a neighbor's reachability.</span></span>

<span data-ttu-id="deb40-1195">En NÅBAR status anger att grannen betraktas som nåbar.</span><span class="sxs-lookup"><span data-stu-id="deb40-1195">A REACHABLE status indicates the neighbor is considered reachable.</span></span> <span data-ttu-id="deb40-1196">Det går att få åtkomst till en granne om den nyligen har fått en bekräftelse på att paket som skickats till grannen har tagits emot.</span><span class="sxs-lookup"><span data-stu-id="deb40-1196">A neighbor is reachable if it has recently received confirmation that packets sent to the neighbor have been received.</span></span> <span data-ttu-id="deb40-1197">Bekräftelse i NetX Duo tar emot ett NA-meddelande från grannen som svar på ett NS-meddelande som skickats av NetX Duo-enheten.</span><span class="sxs-lookup"><span data-stu-id="deb40-1197">Confirmation in NetX Duo take the form of receiving an NA message from the neighbor in response to an NS message sent by the NetX Duo device.</span></span> <span data-ttu-id="deb40-1198">NetX Duo kommer också att ändra status för grannens status till att kunna UPPNÅs om programmet anropar NetX Duo-tjänsten ***nxd_nd_cache_entry_set*** att ange en cachepost manuellt.</span><span class="sxs-lookup"><span data-stu-id="deb40-1198">NetX Duo will also change the state of the neighbor status to REACHABLE if the application calls the NetX Duo service ***nxd_nd_cache_entry_set*** to manually enter a cache record.</span></span>

<span data-ttu-id="deb40-1199">***Routerupptäckt:*** En IPv6-enhet använder en router för att vidarebefordra alla paket som är avsedda för av länk destinationer.</span><span class="sxs-lookup"><span data-stu-id="deb40-1199">***Router Discovery:*** An IPv6 device uses a router to forward all packets intended for off link destinations.</span></span> <span data-ttu-id="deb40-1200">Den kan också använda information som skickas av routern, till exempel meddelanden om routerannonsering (RA) för att konfigurera dess globala IPv6-adresser.</span><span class="sxs-lookup"><span data-stu-id="deb40-1200">It may also use information sent by the router, such as router advertisement (RA) messages, to configure its global IPv6 addresses.</span></span>

<span data-ttu-id="deb40-1201">En enhet i nätverket kan initiera identifierings processen för routern genom att skicka ett RS-meddelande (router inbjudningar) till multicast-adressen all router (FF01:: 2).</span><span class="sxs-lookup"><span data-stu-id="deb40-1201">A device on the network may initiate the Router Discovery process by sending a router solicitation (RS) message to the all-router multicast address (FF01::2).</span></span> <span data-ttu-id="deb40-1202">Eller så kan den vänta på multicast-adressen för alla noder (FF:: 1) för en periodisk RA från routrarna.</span><span class="sxs-lookup"><span data-stu-id="deb40-1202">Or it can wait on the all-node multicast address (FF::1) for a periodic RA from the routers.</span></span>

<span data-ttu-id="deb40-1203">Ett RA-meddelande innehåller prefixs information för att konfigurera en IPv6-adress för nätverket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1203">An RA message contains the prefix information for configuring an IPv6 address for that network.</span></span> <span data-ttu-id="deb40-1204">I NetX Duo är Routerinbjudning aktiverat som standard och kan inaktive ras genom att ställa in konfigurations alternativet \***NX_DISABLE_ICMPV6_ROUTER_SOLICITATION** _ i _ *_nx_user. h_* \*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1204">In NetX Duo, router solicitation is by default enabled and can be disabled by setting the configuration option ***NX_DISABLE_ICMPV6_ROUTER_SOLICITATION** _ in _*_nx_user.h_\*\*.</span></span> <span data-ttu-id="deb40-1205">Se konfigurations alternativ i kapitlet "installera och använda NetX Duo" för mer information om att ställa in parametrar för router-inbjudningar.</span><span class="sxs-lookup"><span data-stu-id="deb40-1205">See Configuration Options in the "Installation and Use of NetX Duo" chapter for more details on setting Router Solicitation parameters.</span></span> 

<span data-ttu-id="deb40-1206">***Prefix identifiering***: en IPv6-enhet använder prefix identifiering för att lära sig vilka mål värdar som är tillgängliga direkt utan att gå via en router.</span><span class="sxs-lookup"><span data-stu-id="deb40-1206">***Prefix Discovery***: An IPv6 device uses prefix discovery to learn which target hosts are accessible directly without going through a router.</span></span> <span data-ttu-id="deb40-1207">Den här informationen görs tillgänglig för IPv6-enheten från RA-meddelanden från routern.</span><span class="sxs-lookup"><span data-stu-id="deb40-1207">This information is made available to the IPv6 device from RA messages from the router.</span></span> <span data-ttu-id="deb40-1208">IPv6-enheten lagrar prefixlängden i en tabell med prefix.</span><span class="sxs-lookup"><span data-stu-id="deb40-1208">The IPv6 device stores the prefix information in a prefix table.</span></span> <span data-ttu-id="deb40-1209">Prefixet som identifieras matchar ett prefix från tabellen IPv6-enhets prefix till en mål adress.</span><span class="sxs-lookup"><span data-stu-id="deb40-1209">Prefix discovery is matching a prefix from the IPv6 device prefix table to a target address.</span></span> <span data-ttu-id="deb40-1210">Ett prefix matchar en mål adress om alla bitar i prefixet matchar de mest signifikanta bitarna i mål adressen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1210">A prefix matches a target address if all the bits in the prefix match the most significant bits of the target address.</span></span> <span data-ttu-id="deb40-1211">Om fler än ett prefix täcker en adress väljs det längsta prefixet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1211">If more than one prefix covers an address, the longest prefix is selected.</span></span>

### <a name="icmpv6-error-messages"></a><span data-ttu-id="deb40-1212">Fel meddelanden för ICMPv6</span><span class="sxs-lookup"><span data-stu-id="deb40-1212">ICMPv6 Error Messages</span></span>    
<span data-ttu-id="deb40-1213">Följande ICMPv6-fel meddelanden stöds i NetX Duo:</span><span class="sxs-lookup"><span data-stu-id="deb40-1213">The following ICMPv6 error messages are supported in NetX Duo:</span></span>  

- <span data-ttu-id="deb40-1214">Det går inte att hitta målet</span><span class="sxs-lookup"><span data-stu-id="deb40-1214">Destination Unreachable</span></span>  
- <span data-ttu-id="deb40-1215">Paketet är för stort</span><span class="sxs-lookup"><span data-stu-id="deb40-1215">Packet Too Big</span></span>  
- <span data-ttu-id="deb40-1216">Tiden överskrider</span><span class="sxs-lookup"><span data-stu-id="deb40-1216">Time Exceed</span></span>  
- <span data-ttu-id="deb40-1217">Parameter problem</span><span class="sxs-lookup"><span data-stu-id="deb40-1217">Parameter Problem</span></span>  

## <a name="user-datagram-protocol-udp"></a><span data-ttu-id="deb40-1218">UDP (User Datagram Protocol)</span><span class="sxs-lookup"><span data-stu-id="deb40-1218">User Datagram Protocol (UDP)</span></span>

<span data-ttu-id="deb40-1219">UDP (User Datagram Protocol) ger den enklaste formen av data överföring mellan nätverks medlemmar (RFC 768).</span><span class="sxs-lookup"><span data-stu-id="deb40-1219">The User Datagram Protocol (UDP) provides the simplest form of data transfer between network members (RFC 768).</span></span> <span data-ttu-id="deb40-1220">UDP-datapaket skickas från en nätverks medlem till en annan på bästa möjliga sätt. Det finns alltså ingen inbyggd mekanism för bekräftelse av paket mottagaren.</span><span class="sxs-lookup"><span data-stu-id="deb40-1220">UDP data packets are sent from one network member to another in a best effort fashion; i.e., there is no built-in mechanism for acknowledgement by the packet recipient.</span></span> <span data-ttu-id="deb40-1221">Att skicka ett UDP-paket kräver dessutom inte att någon anslutning upprättas i förväg.</span><span class="sxs-lookup"><span data-stu-id="deb40-1221">In addition, sending a UDP packet does not require any connection to be established in advance.</span></span> <span data-ttu-id="deb40-1222">Därför är det mycket effektivt att överföra UDP-paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1222">Because of this, UDP packet transmission is very efficient.</span></span>

<span data-ttu-id="deb40-1223">För utvecklare som migrerar sina NetX-program till NetX Duo finns det bara några få grundläggande ändringar i UDP-funktioner mellan NetX och NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="deb40-1223">For developers migrating their NetX applications to NetX Duo there are only a few basic changes in UDP functionality between NetX and NetX Duo.</span></span> <span data-ttu-id="deb40-1224">Detta beror på att IPv6 främst berör det underliggande IP-lagret.</span><span class="sxs-lookup"><span data-stu-id="deb40-1224">This is because IPv6 is primarily concerned with the underlying IP layer.</span></span> <span data-ttu-id="deb40-1225">Alla NetX Duo UDP-tjänster kan användas för antingen IPv4-eller IPv6-anslutning.</span><span class="sxs-lookup"><span data-stu-id="deb40-1225">All NetX Duo UDP services can be used for either IPv4 or IPv6 connectivity.</span></span>

### <a name="udp-header"></a><span data-ttu-id="deb40-1226">UDP-huvud</span><span class="sxs-lookup"><span data-stu-id="deb40-1226">UDP Header</span></span>       
<span data-ttu-id="deb40-1227">UDP placerar ett enkelt paket huvud framför programmets data vid överföring och tar bort ett liknande UDP-huvud från paketet vid mottagning innan ett mottaget UDP-paket levereras till programmet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1227">UDP places a simple packet header in front of the application's data on transmission, and removes a similar UDP header from the packet on reception before delivering a received UDP packet to the application.</span></span> <span data-ttu-id="deb40-1228">UDP använder IP-protokollet för att skicka och ta emot paket, vilket innebär att det finns ett IP-huvud framför UDP-huvudet när paketet är i nätverket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1228">UDP utilizes the IP protocol for sending and receiving packets, which means there is an IP header in front of the UDP header when the packet is on the network.</span></span> <span data-ttu-id="deb40-1229">Bild 12 visar UDP-huvudets format.</span><span class="sxs-lookup"><span data-stu-id="deb40-1229">Figure 12 shows the format of the UDP header.</span></span>

![Diagram över UDP-huvudformatet.](./media/user-guide/image21.png)

### <a name="figure-12-udp-header"></a><span data-ttu-id="deb40-1231">FIGUR 12.</span><span class="sxs-lookup"><span data-stu-id="deb40-1231">FIGURE 12.</span></span> <span data-ttu-id="deb40-1232">UDP-huvud</span><span class="sxs-lookup"><span data-stu-id="deb40-1232">UDP Header</span></span>

> [!NOTE]
> <span data-ttu-id="deb40-1233">*Alla rubriker i UDP/IP-implementeringen förväntas vara i **big endian** format. I det här formatet finns de mest signifikanta byten av ordet på den lägsta byte-adressen.*</span><span class="sxs-lookup"><span data-stu-id="deb40-1233">*All headers in the UDP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

<span data-ttu-id="deb40-1234">I följande avsnitt beskrivs UDP-huvudets format:</span><span class="sxs-lookup"><span data-stu-id="deb40-1234">The following describes the UDP header format:</span></span>

|<span data-ttu-id="deb40-1235">Rubrik fält</span><span class="sxs-lookup"><span data-stu-id="deb40-1235">Header Field</span></span> |<span data-ttu-id="deb40-1236">Syfte</span><span class="sxs-lookup"><span data-stu-id="deb40-1236">Purpose</span></span> |
|---|---|
|<span data-ttu-id="deb40-1237">**16-bitars käll port nummer**</span><span class="sxs-lookup"><span data-stu-id="deb40-1237">**16-bit source port number**</span></span> |<span data-ttu-id="deb40-1238">Det här fältet innehåller porten som UDP-paketet skickas från.</span><span class="sxs-lookup"><span data-stu-id="deb40-1238">This field contains the port on which the UDP packet is being sent from.</span></span> <span data-ttu-id="deb40-1239">Giltiga UDP-portar sträcker sig från 1 till 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="deb40-1239">Valid UDP ports range from 1 through 0xFFFF.</span></span> |
|<span data-ttu-id="deb40-1240">**16-bitars mål port nummer**</span><span class="sxs-lookup"><span data-stu-id="deb40-1240">**16-bit destination port number**</span></span> |<span data-ttu-id="deb40-1241">Det här fältet innehåller den UDP-port som paketet skickas till.</span><span class="sxs-lookup"><span data-stu-id="deb40-1241">This field contains the UDP port to which the packet is being sent to.</span></span> <span data-ttu-id="deb40-1242">Giltiga UDP-portar sträcker sig från 1 till 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="deb40-1242">Valid UDP ports range from 1 through 0xFFFF.</span></span> |
|<span data-ttu-id="deb40-1243">**16-bitars UDP-längd**</span><span class="sxs-lookup"><span data-stu-id="deb40-1243">**16-bit UDP length**</span></span> |<span data-ttu-id="deb40-1244">Det här fältet innehåller antalet byte i UDP-paketet, inklusive storleken på UDP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1244">This field contains the number of bytes in the UDP packet, including the size of the UDP header.</span></span> |
|<span data-ttu-id="deb40-1245">**16-bitars UDP-kontrollsumma**</span><span class="sxs-lookup"><span data-stu-id="deb40-1245">**16-bit UDP checksum**</span></span> |<span data-ttu-id="deb40-1246">Det här fältet innehåller 16-bitars kontroll summa för paketet, inklusive UDP-huvudet, paket data området och pseudo-IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1246">This field contains the 16-bit checksum for the packet, including the UDP header, the packet data area, and the pseudo IP header.</span></span> |

### <a name="udp-enable"></a><span data-ttu-id="deb40-1247">Aktivera UDP</span><span class="sxs-lookup"><span data-stu-id="deb40-1247">UDP Enable</span></span>   
<span data-ttu-id="deb40-1248">Innan överföring av UDP-paket är möjligt måste programmet först aktivera UDP genom att anropa tjänsten ***nx_udp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="deb40-1248">Before UDP packet transmission is possible, the application must first enable UDP by calling the ***nx_udp_enable*** service.</span></span> <span data-ttu-id="deb40-1249">När det har Aktiver ATS är programmet fritt att skicka och ta emot UDP-paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1249">After enabled, the application is free to send and receive UDP packets.</span></span>  

### <a name="udp-socket-create"></a><span data-ttu-id="deb40-1250">Skapa UDP-socket</span><span class="sxs-lookup"><span data-stu-id="deb40-1250">UDP Socket Create</span></span>    
<span data-ttu-id="deb40-1251">UDP-Sockets skapas antingen under initieringen eller under körningen av program trådar.</span><span class="sxs-lookup"><span data-stu-id="deb40-1251">UDP sockets are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="deb40-1252">Den första typen av tjänst, Time to Live och Receive Queue djup definieras av tjänsten ***nx_udp_socket_create*** .</span><span class="sxs-lookup"><span data-stu-id="deb40-1252">The initial type of service, time to live, and receive queue depth are defined by the ***nx_udp_socket_create*** service.</span></span> <span data-ttu-id="deb40-1253">Det finns ingen gräns för antalet UDP-socketar i ett program.</span><span class="sxs-lookup"><span data-stu-id="deb40-1253">There are no limits on the number of UDP sockets in an application.</span></span>

### <a name="udp-checksum"></a><span data-ttu-id="deb40-1254">UDP-kontrollsumma</span><span class="sxs-lookup"><span data-stu-id="deb40-1254">UDP Checksum</span></span>   
<span data-ttu-id="deb40-1255">IPv6-protokollet kräver en beräkning av kontroll summa för UDP-huvud på paket data, men i IPv4-protokollet är det valfritt.</span><span class="sxs-lookup"><span data-stu-id="deb40-1255">IPv6 protocol requires a UDP header checksum computation on packet data, whereas in the IPv4 protocol it is optional.</span></span>  

<span data-ttu-id="deb40-1256">UDP anger en komplett 16-bitars kontroll summa som täcker IP-pseudo-huvudet (som består av käll-IP-adressen, målets IP-adress och protokoll/längd-IP-adress), UDP-huvudet och UDP-paketets data.</span><span class="sxs-lookup"><span data-stu-id="deb40-1256">UDP specifies a one's complement 16-bit checksum that covers the IP pseudo header (consisting of the source IP address, destination IP address, and the protocol/length IP word), the UDP header, and the UDP packet data.</span></span> <span data-ttu-id="deb40-1257">De enda skillnaderna mellan kontroll summor för IPv4-och IPv6-paket huvud är att käll-och mål-IP-adresserna är 32 bitar i IPv4 medan de är 128 bitar i IPv6.</span><span class="sxs-lookup"><span data-stu-id="deb40-1257">The only differences between IPv4 and IPv6 UDP packet header checksums is that the source and destination IP addresses are 32 bit in IPv4 while in IPv6 they are 128 bit.</span></span> <span data-ttu-id="deb40-1258">Om den beräknade UDP-kontrollsumman är 0 lagras den som alla (0xFFFF).</span><span class="sxs-lookup"><span data-stu-id="deb40-1258">If the calculated UDP checksum is 0, it is stored as all ones (0xFFFF).</span></span> <span data-ttu-id="deb40-1259">Om inaktive ring av UDP-kontrollsumma är inaktive rad placeras noll i fältet UDP-kontrollsumma för att indikera att kontroll summan inte har beräknats.</span><span class="sxs-lookup"><span data-stu-id="deb40-1259">If the sending socket has the UDP checksum logic disabled, a zero is placed in the UDP checksum field to indicate the checksum was not calculated.</span></span>

<span data-ttu-id="deb40-1260">Om UDP-kontrollsumma inte matchar den beräknade kontroll summan av mottagaren, ignoreras UDP-paketet helt enkelt.</span><span class="sxs-lookup"><span data-stu-id="deb40-1260">If the UDP checksum does not match the computed checksum by the receiver, the UDP packet is simply discarded.</span></span>

<span data-ttu-id="deb40-1261">I IPv4-nätverket är UDP-kontrollsumma valfri.</span><span class="sxs-lookup"><span data-stu-id="deb40-1261">On the IPv4 network, UDP checksum is optional.</span></span> <span data-ttu-id="deb40-1262">NetX Duo gör det möjligt för ett program att aktivera eller inaktivera beräkning av UDP-kontrollsumma per socket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1262">NetX Duo allows an application to enable or disable UDP checksum calculation on a per-socket basis.</span></span> <span data-ttu-id="deb40-1263">Som standard är logiken för kontroll summa för UDP aktiverat.</span><span class="sxs-lookup"><span data-stu-id="deb40-1263">By default, the UDP socket checksum logic is enabled.</span></span> <span data-ttu-id="deb40-1264">Programmet kan inaktivera logik för kontroll summa för en viss UDP-socket genom att anropa tjänsten \***nx_udp_socket_checksum_disable** _.</span><span class="sxs-lookup"><span data-stu-id="deb40-1264">The application can disable checksum logic for a particular UDP socket by calling the \***nx_udp_socket_checksum_disable** _ service.</span></span> <span data-ttu-id="deb40-1265">I IPv6-nätverket är dock kontroll summan av UDP obligatorisk.</span><span class="sxs-lookup"><span data-stu-id="deb40-1265">On the IPv6 network, however, UDP checksum is mandatory.</span></span> <span data-ttu-id="deb40-1266">Därför kommer tjänsten _ *_nx_udp_socket_checksum_disable_*\* inte att inaktivera logik för kontroll summa för UDP när ett paket skickas via IPv6-nätverket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1266">Therefore, the service _ *_nx_udp_socket_checksum_disable_*\* would not disable UDP checksum logic when sending a packet through the IPv6 network.</span></span>

<span data-ttu-id="deb40-1267">Vissa Ethernet-styrenheter kan generera UDP-kontrollsumma i farten.</span><span class="sxs-lookup"><span data-stu-id="deb40-1267">Certain Ethernet controllers are able to generate the UDP checksum on the fly.</span></span> <span data-ttu-id="deb40-1268">Om systemet kan använda beräknings funktionen för maskin varu kontroll summa kan NetX Duo-biblioteket skapas utan logik för kontroll summa.</span><span class="sxs-lookup"><span data-stu-id="deb40-1268">If the system is able to use hardware checksum computation feature, the NetX Duo library can be built without the checksum logic.</span></span> <span data-ttu-id="deb40-1269">Om du vill inaktivera kontroll summa för UDP-programvara måste NetX Duo-biblioteket vara byggt med följande symboler: ***NX_DISABLE_UDP_TX_CHECKSUM** _ och _*_NX_DISABLE_UDP_RX_CHECKSUM_\*_ (beskrivs i kapitel två).</span><span class="sxs-lookup"><span data-stu-id="deb40-1269">To disable UDP software checksum, the NetX Duo library must be built with the following symbols defined: ***NX_DISABLE_UDP_TX_CHECKSUM** _ and _*_NX_DISABLE_UDP_RX_CHECKSUM_\*_ (described in Chapter two).</span></span> <span data-ttu-id="deb40-1270">Konfigurations alternativen tar bort UDP-kontrollsumma från NetX Duo helt och hållet, samtidigt som du anropar tjänsten _ *_nx_udp_socket_checksum_disable_*\* så att programmet kan inaktivera bearbetning av IPv4 UDP-kontrollsumma per socket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1270">The configuration options remove UDP checksum logic from NetX Duo entirely, while calling the _ *_nx_udp_socket_checksum_disable_*\* service allows the application to disable IPv4 UDP checksum processing on a per socket basis.</span></span>

### <a name="udp-ports-and-binding"></a><span data-ttu-id="deb40-1271">UDP-portar och bindning</span><span class="sxs-lookup"><span data-stu-id="deb40-1271">UDP Ports and Binding</span></span>      
<span data-ttu-id="deb40-1272">En UDP-port är en logisk slut punkt i UDP-protokollet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1272">A UDP port is a logical end point in the UDP protocol.</span></span> <span data-ttu-id="deb40-1273">Det finns 65 535 giltiga portar i UDP-komponenten för NetX Duo, mellan 1 och 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="deb40-1273">There are 65,535 valid ports in the UDP component of NetX Duo, ranging from 1 through 0xFFFF.</span></span> <span data-ttu-id="deb40-1274">Om du vill skicka eller ta emot UDP-data måste programmet först skapa en UDP-socket och sedan binda den till en önskad port.</span><span class="sxs-lookup"><span data-stu-id="deb40-1274">To send or receive UDP data, the application must first create a UDP socket, then bind it to a desired port.</span></span> <span data-ttu-id="deb40-1275">När du har bundit en UDP-socket till en port kan programmet skicka och ta emot data på denna socket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1275">After binding a UDP socket to a port, the application may send and receive data on that socket.</span></span>

### <a name="udp-fast-pathtrade"></a><span data-ttu-id="deb40-1276">Snabb sökväg för UDP&trade;</span><span class="sxs-lookup"><span data-stu-id="deb40-1276">UDP Fast Path&trade;</span></span>   
<span data-ttu-id="deb40-1277">Snabb sökvägen för UDP &trade; är namnet på en låg paket väg genom netx Duo UDP-implementeringen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1277">The UDP Fast Path&trade; is the name for a low packet overhead path through the NetX Duo UDP implementation.</span></span> <span data-ttu-id="deb40-1278">Att skicka ett UDP-paket kräver bara några funktions anrop: ***nx_udp_socket_send** _, _*_nx_ip_packet_send_\*_ och det eventuella anropet till nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1278">Sending a UDP packet requires just a few function calls: ***nx_udp_socket_send** _, _*_nx_ip_packet_send_\*_, and the eventual call to the network driver.</span></span> <span data-ttu-id="deb40-1279">_*_nx_udp_socket_send_*_ är tillgängligt i netx Duo för befintliga netx-program och gäller endast för IPv4-paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1279">_*_nx_udp_socket_send_*_ is available in NetX Duo for existing NetX applications and is only applicable for IPv4 packets.</span></span> <span data-ttu-id="deb40-1280">Den bästa metoden är dock att använda _ *_nxd_udp_socket_send_*\* tjänsten som diskuteras nedan.</span><span class="sxs-lookup"><span data-stu-id="deb40-1280">The preferred method, however, is to use _ *_nxd_udp_socket_send_*\* service discussed below.</span></span> <span data-ttu-id="deb40-1281">Vid mottagning av UDP-paket placeras UDP-paketet antingen på lämplig UDP socket Receive-kö eller levereras till en inaktive rad program tråd i ett enda funktions anrop från nätverks driv Rutinens mottagnings bearbetning.</span><span class="sxs-lookup"><span data-stu-id="deb40-1281">On UDP packet reception, the UDP packet is either placed on the appropriate UDP socket receive queue or delivered to a suspended application thread in a single function call from the network driver's receive interrupt processing.</span></span> <span data-ttu-id="deb40-1282">Den här mycket optimerade logiken för att skicka och ta emot UDP-paket är grunden för en snabb väg teknik för UDP.</span><span class="sxs-lookup"><span data-stu-id="deb40-1282">This highly optimized logic for sending and receiving UDP packets is the essence of UDP Fast Path technology.</span></span>  

### <a name="udp-packet-send"></a><span data-ttu-id="deb40-1283">Skicka UDP-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1283">UDP Packet Send</span></span>    
<span data-ttu-id="deb40-1284">Att skicka UDP-data via IPv6 eller IPv4-nätverk kan enkelt utföras genom att anropa funktionen \***nxd_udp_socket_send** _.</span><span class="sxs-lookup"><span data-stu-id="deb40-1284">Sending UDP data over IPv6 or IPv4 networks is easily accomplished by calling the \***nxd_udp_socket_send** _ function.</span></span> <span data-ttu-id="deb40-1285">Anroparen måste ange IP-versionen i fältet _nx_ip_version \* i NXD_ADDRESS pekarpost-parametern.</span><span class="sxs-lookup"><span data-stu-id="deb40-1285">The caller must set the IP version in the _nx_ip_version\* field of the NXD_ADDRESS pointer parameter.</span></span> <span data-ttu-id="deb40-1286">NetX Duo avgör den bästa käll adressen för överförda UDP-paket baserat på IPv4/IPv6-adress för målet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1286">NetX Duo will determine the best source address for transmitted UDP packets based on the destination IPv4/IPv6 address.</span></span> <span data-ttu-id="deb40-1287">Den här tjänsten placerar ett UDP-huvud framför paket data och skickar det till nätverket med en intern IP-sändnings rutin.</span><span class="sxs-lookup"><span data-stu-id="deb40-1287">This service places a UDP header in front of the packet data and sends it out onto the network using an internal IP send routine.</span></span> <span data-ttu-id="deb40-1288">Det finns ingen tråd Inskjutning vid sändning av UDP-paket eftersom alla UDP-paketfiltrering bearbetas omedelbart.</span><span class="sxs-lookup"><span data-stu-id="deb40-1288">There is no thread suspension on sending UDP packets because all UDP packet transmissions are processed immediately.</span></span> 

<span data-ttu-id="deb40-1289">För multicast-eller broadcast-mål ska programmet ange vilken käll-IP-adress som ska användas om NetX Duo-enheten har flera IP-adresser att välja mellan.</span><span class="sxs-lookup"><span data-stu-id="deb40-1289">For multicast or broadcast destinations, the application should specify the source IP address to use if the NetX Duo device has multiple IP addresses to choose from.</span></span> <span data-ttu-id="deb40-1290">Detta kan göras med tjänsterna ***nxd_udp_socket_source_send.***</span><span class="sxs-lookup"><span data-stu-id="deb40-1290">This can be done with the services ***nxd_udp_socket_source_send.***</span></span>

> [!IMPORTANT]    
> <span data-ttu-id="deb40-1291">*Om **nx_udp_socket_send** används för att överföra multicast-eller broadcast-paket används IP-adressen för det första aktiverade gränssnittet som käll adress*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1291">*If **nx_udp_socket_send** is used for transmitting multicast or broadcast packets, the IP address of the first enabled interface is used as source address*.</span></span>

> [!NOTE] 
> <span data-ttu-id="deb40-1292">*Om logics kontroll summa för UDP är aktive rad för denna socket utförs åtgärden för kontroll summa i kontexten för den anropande tråden, utan att blockera åtkomst till UDP-eller IP-datastrukturerna*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1292">*If UDP checksum logic is enabled for this socket, the checksum operation is performed in the context of the calling thread, without blocking access to the UDP or IP data structures*.</span></span> 

> [!WARNING]    
> <span data-ttu-id="deb40-1293">*De UDP-nyttolaster som finns i NX_PACKETs strukturen bör finnas på ett långt ord. Programmet måste lämna tillräckligt med utrymme mellan lägga-pekaren och data start pekaren för NetX Duo för att placera både UDP-, IP-och fysiska medie huvudena*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1293">*The UDP payload data residing in the NX_PACKET structure should reside on a long-word boundary. The application needs to leave sufficient space between the prepend pointer and the data start pointer for NetX Duo to place the UDP, IP, and physical media headers*.</span></span>

### <a name="udp-packet-receive"></a><span data-ttu-id="deb40-1294">Mottagning av UDP-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1294">UDP Packet Receive</span></span>    
<span data-ttu-id="deb40-1295">Program trådar kan ta emot UDP-paket från en viss socket genom att anropa ***nx_udp_socket_receive***.</span><span class="sxs-lookup"><span data-stu-id="deb40-1295">Application threads may receive UDP packets from a particular socket by calling ***nx_udp_socket_receive***.</span></span> <span data-ttu-id="deb40-1296">Funktionen Receive Receive levererar det äldsta paketet i socketens mottagnings kön.</span><span class="sxs-lookup"><span data-stu-id="deb40-1296">The socket receive function delivers the oldest packet on the socket's receive queue.</span></span> <span data-ttu-id="deb40-1297">Om det inte finns några paket i mottagnings kön kan den anropande tråden skjuta upp (med en valfri tids gräns) tills ett paket tas emot.</span><span class="sxs-lookup"><span data-stu-id="deb40-1297">If there are no packets on the receive queue, the calling thread can suspend (with an optional timeout) until a packet arrives.</span></span>

<span data-ttu-id="deb40-1298">Bearbetningen av UDP Receive-paket (som vanligt vis anropas från nätverks driv Rutinens avbrotts hanterare) är ansvarig för att antingen placera paketet på UDP-socketens mottagnings kö eller leverera den till den första pausade tråden för ett paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1298">The UDP receive packet processing (usually called from the network driver's receive interrupt handler) is responsible for either placing the packet on the UDP socket's receive queue or delivering it to the first suspended thread waiting for a packet.</span></span> <span data-ttu-id="deb40-1299">Om paketet är i kö, kontrollerar Receive-bearbetningen även det maximala mottagnings ködjup som är associerat med socketen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1299">If the packet is queued, the receive processing also checks the maximum receive queue depth associated with the socket.</span></span> <span data-ttu-id="deb40-1300">Om det nyligen köade paketet överskrider ködjup, ignoreras det äldsta paketet i kön.</span><span class="sxs-lookup"><span data-stu-id="deb40-1300">If this newly queued packet exceeds the queue depth, the oldest packet in the queue is discarded.</span></span>

### <a name="udp-receive-notify"></a><span data-ttu-id="deb40-1301">Mottagnings meddelande för UDP</span><span class="sxs-lookup"><span data-stu-id="deb40-1301">UDP Receive Notify</span></span>   
<span data-ttu-id="deb40-1302">Om program tråden behöver bearbeta mottagna data från fler än en socket ska funktionen ***nx_udp_socket_receive_notify*** användas.</span><span class="sxs-lookup"><span data-stu-id="deb40-1302">If the application thread needs to process received data from more than one socket, the ***nx_udp_socket_receive_notify*** function should be used.</span></span> <span data-ttu-id="deb40-1303">Den här funktionen registrerar en motringnings funktion för mottagnings paket för socketen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1303">This function registers a receive packet callback function for the socket.</span></span> <span data-ttu-id="deb40-1304">När ett paket tas emot på socketen körs motringningsfunktionen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1304">Whenever a packet is received on the socket, the callback function is executed.</span></span>

<span data-ttu-id="deb40-1305">Innehållet i motringningsfunktionen är applicationspecific; Det skulle dock förmodligen innehålla logik för att informera bearbetnings tråden att ett paket nu är tillgängligt på motsvarande socket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1305">The contents of the callback function is applicationspecific; however, it would most likely contain logic to inform the processing thread that a packet is now available on the corresponding socket.</span></span>

### <a name="peer-address-and-port"></a><span data-ttu-id="deb40-1306">Peer-adress och port</span><span class="sxs-lookup"><span data-stu-id="deb40-1306">Peer Address and Port</span></span>   
<span data-ttu-id="deb40-1307">Vid mottagning av ett UDP-paket kan programmet hitta avsändarens IP-adress och port nummer med hjälp av tjänsten ***nx_udp_packet_info_extract***.</span><span class="sxs-lookup"><span data-stu-id="deb40-1307">On receiving a UDP packet, application may find the sender's IP address and port number by using the service ***nx_udp_packet_info_extract***.</span></span> <span data-ttu-id="deb40-1308">Vid lyckad återgång tillhandahåller den här tjänsten information om avsändarens IP-adress, avsändarens port nummer och det lokala gränssnitt som paketet togs emot via.</span><span class="sxs-lookup"><span data-stu-id="deb40-1308">On successful return, this service provides information on the sender's IP address, sender's port number, and the local interface through which the packet was received.</span></span>  

### <a name="thread-suspension"></a><span data-ttu-id="deb40-1309">Tråd upphängning</span><span class="sxs-lookup"><span data-stu-id="deb40-1309">Thread Suspension</span></span>   
<span data-ttu-id="deb40-1310">Som tidigare nämnts kan program trådar pausa vid försök att ta emot ett UDP-paket på en viss UDP-port.</span><span class="sxs-lookup"><span data-stu-id="deb40-1310">As mentioned previously, application threads can suspend while attempting to receive a UDP packet on a particular UDP port.</span></span> <span data-ttu-id="deb40-1311">När ett paket har mottagits på den porten, tilldelas den första tråden inaktive rad och tråden återupptas sedan.</span><span class="sxs-lookup"><span data-stu-id="deb40-1311">After a packet is received on that port, it is given to the first thread suspended and that thread is then resumed.</span></span> <span data-ttu-id="deb40-1312">En valfri timeout är tillgänglig när du pausar ett UDP-paket, en funktion som är tillgänglig för de flesta NetX Duo-tjänster.</span><span class="sxs-lookup"><span data-stu-id="deb40-1312">An optional timeout is available when suspending on a UDP receive packet, a feature available for most NetX Duo services.</span></span>  

### <a name="udp-socket-statistics-and-errors"></a><span data-ttu-id="deb40-1313">Statistik och fel för UDP-socket</span><span class="sxs-lookup"><span data-stu-id="deb40-1313">UDP Socket Statistics and Errors</span></span>     
<span data-ttu-id="deb40-1314">Om den här inställningen är aktive rad håller NetX Duo UDP socket-programvaran reda på flera statistik och fel som kan vara användbara för programmet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1314">If enabled, the NetX Duo UDP socket software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="deb40-1315">Följande statistik och fel rapporter upprätthålls för varje IP/UDP-instans:</span><span class="sxs-lookup"><span data-stu-id="deb40-1315">The following statistics and error reports are maintained for each IP/UDP instance:</span></span>

- <span data-ttu-id="deb40-1316">Totalt antal skickade UDP-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1316">Total UDP Packets Sent</span></span>  
- <span data-ttu-id="deb40-1317">Totalt antal skickade UDP-byte</span><span class="sxs-lookup"><span data-stu-id="deb40-1317">Total UDP Bytes Sent</span></span>  
- <span data-ttu-id="deb40-1318">Totalt antal mottagna UDP-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1318">Total UDP Packets Received</span></span>   
- <span data-ttu-id="deb40-1319">Totalt antal mottagna UDP-byte</span><span class="sxs-lookup"><span data-stu-id="deb40-1319">Total UDP Bytes Received</span></span>  
- <span data-ttu-id="deb40-1320">Totalt antal ogiltiga UDP-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1320">Total UDP Invalid Packets</span></span>  
- <span data-ttu-id="deb40-1321">Totalt antal mottagna UDP-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1321">Total UDP Receive Packets Dropped</span></span>  
- <span data-ttu-id="deb40-1322">Totalt antal UDP mottagnings kontroll Summa fel</span><span class="sxs-lookup"><span data-stu-id="deb40-1322">Total UDP Receive Checksum Errors</span></span>  
- <span data-ttu-id="deb40-1323">Skickade UDP-socket-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1323">UDP Socket Packets Sent</span></span>  
- <span data-ttu-id="deb40-1324">Skickade UDP-socket-byte</span><span class="sxs-lookup"><span data-stu-id="deb40-1324">UDP Socket Bytes Sent</span></span>  
- <span data-ttu-id="deb40-1325">Mottagna UDP-socket-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1325">UDP Socket Packets Received</span></span>   
- <span data-ttu-id="deb40-1326">Mottagna UDP-socket byte</span><span class="sxs-lookup"><span data-stu-id="deb40-1326">UDP Socket Bytes Received</span></span>  
- <span data-ttu-id="deb40-1327">Köade UDP-socket-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1327">UDP Socket Packets Queued</span></span>  
- <span data-ttu-id="deb40-1328">Mottagna paket för UDP-socket tas bort</span><span class="sxs-lookup"><span data-stu-id="deb40-1328">UDP Socket Receive Packets Dropped</span></span>  
- <span data-ttu-id="deb40-1329">Fel vid kontroll summa för UDP-socket</span><span class="sxs-lookup"><span data-stu-id="deb40-1329">UDP Socket Checksum Errors</span></span>  

<span data-ttu-id="deb40-1330">Alla dessa statistik-och fel rapporter är tillgängliga för programmet med \***nx_udp_info_get** _-tjänsten för UDP-amassed över alla UDP-socketar och _ \*_nx_udp_socket_info_get_\*\*-tjänsten för UDP-statistik på den angivna UDP-socketen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1330">All these statistics and error reports are available to the application with the ***nx_udp_info_get** _ service for UDP statistics amassed over all UDP sockets, and the _ *_nx_udp_socket_info_get_** service for UDP statistics on the specified UDP socket.</span></span>

### <a name="udp-socket-control-block-nx_udp_socket"></a><span data-ttu-id="deb40-1331">UDP socket Control Block NX_UDP_SOCKET</span><span class="sxs-lookup"><span data-stu-id="deb40-1331">UDP Socket Control Block NX_UDP_SOCKET</span></span>
<span data-ttu-id="deb40-1332">Egenskaperna för varje UDP-socket finns i det associerade NX_UDP_SOCKET kontroll blocket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1332">The characteristics of each UDP socket are found in the associated NX_UDP_SOCKET control block.</span></span> <span data-ttu-id="deb40-1333">Den innehåller användbar information, till exempel länken till IP-datastrukturen, nätverks gränssnittet för att skicka och ta emot sökvägar, den kopplade porten och kön för mottagnings paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1333">It contains useful information such as the link to the IP data structure, the network interface for the sending and receiving paths, the bound port, and the receive packet queue.</span></span> <span data-ttu-id="deb40-1334">Den här strukturen definieras i filen ***nx_api. h*** .</span><span class="sxs-lookup"><span data-stu-id="deb40-1334">This structure is defined in the ***nx_api.h*** file.</span></span>

## <a name="transmission-control-protocol-tcp"></a><span data-ttu-id="deb40-1335">Transmission Control Protocol (TCP)</span><span class="sxs-lookup"><span data-stu-id="deb40-1335">Transmission Control Protocol (TCP)</span></span>

<span data-ttu-id="deb40-1336">Transmission Control Protocol (TCP) ger tillförlitlig data överföring mellan två nätverks medlemmar (RFC 793).</span><span class="sxs-lookup"><span data-stu-id="deb40-1336">The Transmission Control Protocol (TCP) provides reliable stream data transfer between two network members (RFC 793).</span></span> <span data-ttu-id="deb40-1337">Alla data som skickas från en nätverks medlem verifieras och bekräftas av den mottagande medlemmen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1337">All data sent from one network member are verified and acknowledged by the receiving member.</span></span> <span data-ttu-id="deb40-1338">Dessutom måste de två medlemmarna ha upprättat en anslutning före en data överföring.</span><span class="sxs-lookup"><span data-stu-id="deb40-1338">In addition, the two members must have established a connection prior to any data transfer.</span></span> <span data-ttu-id="deb40-1339">Allt detta resulterar i tillförlitlig data överföring. Det kräver dock betydligt mer belastning än den tidigare beskrivna UDP-dataöverföringen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1339">All this results in reliable data transfer; however, it does require substantially more overhead than the previously described UDP data transfer.</span></span>

<span data-ttu-id="deb40-1340">Om inget annat anges sker inga ändringar i API-tjänsterna för TCP-protokollet mellan NetX och NetX Duo, eftersom IPv6 främst berör det underliggande IP-skiktet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1340">Except where noted, there are no changes in TCP protocol API services between NetX and NetX Duo because IPv6 is primarily concerned with the underlying IP layer.</span></span> <span data-ttu-id="deb40-1341">Alla NetX Duo TCP-tjänster kan användas för antingen IPv4-eller IPv6-anslutningar.</span><span class="sxs-lookup"><span data-stu-id="deb40-1341">All NetX Duo TCP services can be used for either IPv4 or IPv6 connections.</span></span>

### <a name="tcp-header"></a><span data-ttu-id="deb40-1342">TCP-huvud</span><span class="sxs-lookup"><span data-stu-id="deb40-1342">TCP Header</span></span>   
<span data-ttu-id="deb40-1343">Vid överföring placeras TCP-huvud framför data från användaren.</span><span class="sxs-lookup"><span data-stu-id="deb40-1343">On transmission, TCP header is placed in front of the data from the user.</span></span> <span data-ttu-id="deb40-1344">Vid mottagning tas TCP-huvud bort från det inkommande paketet, och endast de användar data som är tillgängliga för programmet lämnas kvar.</span><span class="sxs-lookup"><span data-stu-id="deb40-1344">On reception, TCP header is removed from the incoming packet, leaving only the user data available to the application.</span></span> <span data-ttu-id="deb40-1345">TCP använder IP-protokollet för att skicka och ta emot paket, vilket innebär att det finns ett IP-huvud framför TCP-huvudet när paketet är i nätverket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1345">TCP utilizes the IP protocol to send and receive packets, which means there is an IP header in front of the TCP header when the packet is on the network.</span></span> <span data-ttu-id="deb40-1346">Bild 13 visar formatet för TCP-sidhuvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1346">Figure 13 shows the format of the TCP header.</span></span>

![Diagram över TCP-huvudformatet.](./media/user-guide/image22.png)

### <a name="figure-13-tcp-header"></a><span data-ttu-id="deb40-1348">FIGUR 13.</span><span class="sxs-lookup"><span data-stu-id="deb40-1348">FIGURE 13.</span></span> <span data-ttu-id="deb40-1349">TCP-huvud</span><span class="sxs-lookup"><span data-stu-id="deb40-1349">TCP Header</span></span>

<span data-ttu-id="deb40-1350">I följande avsnitt beskrivs formatet TCP-huvud:</span><span class="sxs-lookup"><span data-stu-id="deb40-1350">The following describes the TCP header format:</span></span>

|<span data-ttu-id="deb40-1351">Rubrik &nbsp; fält</span><span class="sxs-lookup"><span data-stu-id="deb40-1351">Header&nbsp;Field</span></span> |<span data-ttu-id="deb40-1352">Syfte</span><span class="sxs-lookup"><span data-stu-id="deb40-1352">Purpose</span></span> |
|------|------|
| <span data-ttu-id="deb40-1353">**16-bitars käll port nummer**</span><span class="sxs-lookup"><span data-stu-id="deb40-1353">**16-bit source port number**</span></span> | <span data-ttu-id="deb40-1354">Det här fältet innehåller den port som TCP-paketet skickas till.</span><span class="sxs-lookup"><span data-stu-id="deb40-1354">This field contains the port the TCP packet is being sent out on.</span></span> <span data-ttu-id="deb40-1355">Giltiga TCP-portar är mellan 1 och 0Xffffffff.</span><span class="sxs-lookup"><span data-stu-id="deb40-1355">Valid TCP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="deb40-1356">**16-bitars målport**</span><span class="sxs-lookup"><span data-stu-id="deb40-1356">**16-bit destination port**</span></span> | <span data-ttu-id="deb40-1357">Det här fältet innehåller TCP-porten som paketet skickas till.</span><span class="sxs-lookup"><span data-stu-id="deb40-1357">This field contains the TCP port the packet is being sent to.</span></span> <span data-ttu-id="deb40-1358">Giltiga TCP-portar är mellan 1 och 0Xffffffff.</span><span class="sxs-lookup"><span data-stu-id="deb40-1358">Valid TCP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="deb40-1359">**32-bitars sekvensnummer**</span><span class="sxs-lookup"><span data-stu-id="deb40-1359">**32-bit sequence number**</span></span> | <span data-ttu-id="deb40-1360">Det här fältet innehåller sekvensnumret för data som skickas från det här slutet av anslutningen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1360">This field contains the sequence number for data sent from this end of the connection.</span></span> <span data-ttu-id="deb40-1361">Den ursprungliga sekvensen upprättas under den inledande anslutnings ordningen mellan två TCP-noder.</span><span class="sxs-lookup"><span data-stu-id="deb40-1361">The original sequence is established during the initial connection sequence between two TCP nodes.</span></span> <span data-ttu-id="deb40-1362">Varje data överföring från den punkten resulterar i en ökning av sekvensnumret med antalet byte som skickats.</span><span class="sxs-lookup"><span data-stu-id="deb40-1362">Every data transfer from that point results in an increment of the sequence number by the amount bytes sent.</span></span> |
| <span data-ttu-id="deb40-1363">**32-bitars bekräftelse nummer**</span><span class="sxs-lookup"><span data-stu-id="deb40-1363">**32-bit acknowledgement number**</span></span> | <span data-ttu-id="deb40-1364">Det här fältet innehåller det ordnings nummer som motsvarar den sista mottagna byte som togs emot av anslutningen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1364">This field contains the sequence number corresponding to the last byte received by this side of the connection.</span></span> <span data-ttu-id="deb40-1365">Detta används för att avgöra om data som skickats tidigare har tagits emot av den andra änden av anslutningen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1365">This is used to determine whether or not data previously sent has successfully been received by the other end of the connection.</span></span> |
| <span data-ttu-id="deb40-1366">**4-bitars rubrik längd**</span><span class="sxs-lookup"><span data-stu-id="deb40-1366">**4-bit header length**</span></span> | <span data-ttu-id="deb40-1367">Det här fältet innehåller antalet 32-bitars ord i TCP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1367">This field contains the number of 32-bit words in the TCP header.</span></span> <span data-ttu-id="deb40-1368">Om det inte finns några alternativ i TCP-huvudet är det här fältet 5.</span><span class="sxs-lookup"><span data-stu-id="deb40-1368">If no options are present in the TCP header, this field is 5.</span></span> |
| <span data-ttu-id="deb40-1369">**6-bitars kod bitar**</span><span class="sxs-lookup"><span data-stu-id="deb40-1369">**6-bit code bits**</span></span> |<span data-ttu-id="deb40-1370">Det här fältet innehåller sex olika kod bitar som används för att ange olika kontroll information som är associerad med anslutningen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1370">This field contains the six different code bits used to indicate various control information associated with the connection.</span></span> <span data-ttu-id="deb40-1371">Kontroll bitarna definieras enligt följande: <br \> -URG (21): brådskande data preset<br \> -ack (20): bekräftelse numret är giltigt<br \> -PSH (19): hantera dessa data direkt<br-20-25 \> (18): Återställ anslutningen<br \> -syn (17): synkronisera sekvensnumret (används för att upprätta anslutning) <br \> -räntetrans (16): avsändaren har slutförts med överföring (används för att stänga anslutningen)</span><span class="sxs-lookup"><span data-stu-id="deb40-1371">The control bits are defined as follows:<br \> - URG (21): Urgent data presen<br \> - ACK (20): Acknowledgement number is valid<br \> - PSH (19): Handle this data immediately<br \> - RST (18): Reset the connection<br \> - SYN (17): Synchronize sequence numbers (used to establish connection)<br \> - FIN (16): Sender is finished with transmit (used to close connection)</span></span> |
|<span data-ttu-id="deb40-1372">**16-bitars fönster**</span><span class="sxs-lookup"><span data-stu-id="deb40-1372">**16-bit window**</span></span> |<span data-ttu-id="deb40-1373">Det här fältet används för flödes kontroll.</span><span class="sxs-lookup"><span data-stu-id="deb40-1373">This field is used for flow control.</span></span> <span data-ttu-id="deb40-1374">Det innehåller mängden byte som socketen kan ta emot för närvarande.</span><span class="sxs-lookup"><span data-stu-id="deb40-1374">It contains the amount of bytes the socket can currently receive.</span></span> <span data-ttu-id="deb40-1375">Detta används i princip för flödes kontroll.</span><span class="sxs-lookup"><span data-stu-id="deb40-1375">This basically is used for flow control.</span></span> <span data-ttu-id="deb40-1376">Avsändaren ansvarar för att se till att de data som skickas får plats i mottagarens annonserade fönster.</span><span class="sxs-lookup"><span data-stu-id="deb40-1376">The sender is responsible for making sure the data to send will fit into the receiver's advertised window.</span></span> |
|<span data-ttu-id="deb40-1377">**16-bitars TCP-kontrollsumma**</span><span class="sxs-lookup"><span data-stu-id="deb40-1377">**16-bit TCP checksum**</span></span> |<span data-ttu-id="deb40-1378">Det här fältet innehåller 16-bitars kontroll summa för paketet, inklusive TCP-huvud, paket data området och pseudo-IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1378">This field contains the 16-bit checksum for the packet including the TCP header, the packet data area, and the pseudo IP header.</span></span> |
|<span data-ttu-id="deb40-1379">**16-bitars brådskande pekare**</span><span class="sxs-lookup"><span data-stu-id="deb40-1379">**16-bit urgent pointer**</span></span> |<span data-ttu-id="deb40-1380">Det här fältet innehåller den positiva förskjutningen för den senaste byten av brådskande data.</span><span class="sxs-lookup"><span data-stu-id="deb40-1380">This field contains the positive offset of the last byte of the urgent data.</span></span> <span data-ttu-id="deb40-1381">Det här fältet är endast giltigt om URG-kodfragmentet har angetts i huvudet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1381">This field is only valid if the URG code bit is set in the header.</span></span> |

> [!NOTE]  
> <span data-ttu-id="deb40-1382">*Alla rubriker i TCP/IP-implementeringen förväntas vara i **big endian** format. I det här formatet finns de mest signifikanta byten av ordet på den lägsta byte-adressen*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1382">*All headers in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address*.</span></span>

### <a name="tcp-enable"></a><span data-ttu-id="deb40-1383">TCP-aktivering</span><span class="sxs-lookup"><span data-stu-id="deb40-1383">TCP Enable</span></span>       
<span data-ttu-id="deb40-1384">Innan TCP-anslutningar och paket överföring är möjliga måste programmet först aktivera TCP genom att anropa tjänsten ***nx_tcp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="deb40-1384">Before TCP connections and packet transmissions are possible, the application must first enable TCP by calling the ***nx_tcp_enable*** service.</span></span> <span data-ttu-id="deb40-1385">När det har Aktiver ATS är programmet tillgängligt för att få åtkomst till alla TCP-tjänster.</span><span class="sxs-lookup"><span data-stu-id="deb40-1385">After enabled, the application is free to access all TCP services.</span></span>  

### <a name="tcp-socket-create"></a><span data-ttu-id="deb40-1386">Skapa TCP-socket</span><span class="sxs-lookup"><span data-stu-id="deb40-1386">TCP Socket Create</span></span>    
<span data-ttu-id="deb40-1387">TCP-Sockets skapas antingen under initieringen eller under körningen av program trådar.</span><span class="sxs-lookup"><span data-stu-id="deb40-1387">TCP sockets are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="deb40-1388">Den första typen av tjänst, tid till Live och fönster storlek definieras av tjänsten ***nx_tcp_socket_create*** .</span><span class="sxs-lookup"><span data-stu-id="deb40-1388">The initial type of service, time to live, and window size are defined by the ***nx_tcp_socket_create*** service.</span></span> <span data-ttu-id="deb40-1389">Det finns ingen gräns för antalet TCP-Sockets i ett program.</span><span class="sxs-lookup"><span data-stu-id="deb40-1389">There are no limits on the number of TCP sockets in an application.</span></span>  

### <a name="tcp-checksum"></a><span data-ttu-id="deb40-1390">TCP-kontrollsumma</span><span class="sxs-lookup"><span data-stu-id="deb40-1390">TCP Checksum</span></span>     
<span data-ttu-id="deb40-1391">TCP anger en komplett 16-bitars kontroll summa som täcker IP-pseudo-sidhuvudet (som består av käll-IP-adressen, målets IP-adress och protokoll/längd-IP-adress), TCP-huvudet och TCP-paketets data.</span><span class="sxs-lookup"><span data-stu-id="deb40-1391">TCP specifies a one's complement 16-bit checksum that covers the IP pseudo header, (consisting of the source IP address, destination IP address, and the protocol/length IP word), the TCP header, and the TCP packet data.</span></span> <span data-ttu-id="deb40-1392">Den enda skillnaden mellan IPv4-och IPv6-paketets kontroll summor är att käll-och mål-IP-adresserna är 32 bitar i IPv4 och 128 bitar i IPv6.</span><span class="sxs-lookup"><span data-stu-id="deb40-1392">The only difference between IPv4 and IPv6 TCP packet header checksums is that the source and destination IP addresses are 32 bit in IPv4 and 128 bit in IPv6.</span></span> 

<span data-ttu-id="deb40-1393">Vissa nätverks styrenheter kan utföra beräkning av TCP-kontrollsumma och verifiering i maskin vara.</span><span class="sxs-lookup"><span data-stu-id="deb40-1393">Certain network controllers are able to perform TCP checksum computation and validation in hardware.</span></span> <span data-ttu-id="deb40-1394">För sådana system kan program använda sig av logik för maskin varu kontroll så mycket som möjligt för att minska körnings belastningen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1394">For such systems, applications may want to use hardware checksum logic as much as possible to reduce runtime overhead.</span></span> <span data-ttu-id="deb40-1395">Program kan inaktivera beräknings logiken för TCP-kontrollsumma från NetX Duo-biblioteket helt vid Bygg tiden genom att definiera \***NX_DISABLE_TCP_TX_CHECKSUM** _ och _ *_NX_DISABLE_TCP_RX_CHECKSUM_* \*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1395">Applications may disable TCP checksum computation logic from the NetX Duo library altogether at build time by defining ***NX_DISABLE_TCP_TX_CHECKSUM** _ and _*_NX_DISABLE_TCP_RX_CHECKSUM_\*\*.</span></span> <span data-ttu-id="deb40-1396">På så sätt kompileras inte TCP-kontrollsummats kod i.</span><span class="sxs-lookup"><span data-stu-id="deb40-1396">This way, the TCP checksum code is not compiled in.</span></span> <span data-ttu-id="deb40-1397">En bör dock vara försiktig om det valfria NetX Duo-paketet är installerat och TCP-anslutningen kan behöva passera via en säker kanal.</span><span class="sxs-lookup"><span data-stu-id="deb40-1397">However one should exercise caution if the optional NetX Duo IPsec package is installed, and the TCP connection may need to traverse through a secure channel.</span></span> <span data-ttu-id="deb40-1398">I det här fallet är data i paket som tillhör TCP-anslutningen redan krypterade och de flesta moduler för maskin varu-TCP-kontrollsumma som finns i nätverks driv rutinen kan inte generera korrekt kontroll Summa värde från den krypterade TCP-nyttolasten.</span><span class="sxs-lookup"><span data-stu-id="deb40-1398">In this case, data in packets belonging to the TCP connection is already encrypted, and most hardware TCP checksum modules present in the network driver are unable to generate correct checksum value from the encrypted TCP payload.</span></span>

<span data-ttu-id="deb40-1399">För att lösa det här problemet måste programmet behålla logiken för kontroll summa för att vara tillgänglig i biblioteket och använda funktionen gränssnitts funktion.</span><span class="sxs-lookup"><span data-stu-id="deb40-1399">To address this issue, application shall keep the TCP checksum logic available in the library and use the interface capability feature.</span></span> <span data-ttu-id="deb40-1400">Med funktionen gränssnitts kapacitet aktive rad vet TCP-modulen hur TCP-kontrollsumma hanteras korrekt om driv rutinen också kan beräkna kontroll summan:</span><span class="sxs-lookup"><span data-stu-id="deb40-1400">With interface capability feature enabled, the TCP module knows how to properly handle the TCP checksum if the driver is also able to compute the checksum value:</span></span>

1) <span data-ttu-id="deb40-1401">Om TCP-paketet inte omfattas av IPsec-processen kan maskin varan för nätverks gränssnittet beräkna kontroll summan.</span><span class="sxs-lookup"><span data-stu-id="deb40-1401">If the TCP packet is not subject to IPsec process, the network interface hardware is able to compute the checksum.</span></span> <span data-ttu-id="deb40-1402">Därför försöker inte TCP-modulen beräkna kontroll summan.</span><span class="sxs-lookup"><span data-stu-id="deb40-1402">Therefore the TCP module does not attempt to compute the checksum;</span></span>

2) <span data-ttu-id="deb40-1403">Om IPsec-paketet är installerat och TCP-paketet omfattas av IPsec-processen beräknar TCP-modulen kontroll summor i program vara innan paketet skickas till IPsec-lagret.</span><span class="sxs-lookup"><span data-stu-id="deb40-1403">If IPsec package is installed, and the TCP packet is subject to IPsec process, the TCP module computes checksum in software before sending the packet to IPsec layer.</span></span>

### <a name="tcp-port"></a><span data-ttu-id="deb40-1404">TCP-port</span><span class="sxs-lookup"><span data-stu-id="deb40-1404">TCP Port</span></span>     
<span data-ttu-id="deb40-1405">En TCP-port är en logisk anslutnings punkt i TCP-protokollet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1405">A TCP port is a logical connection point in the TCP protocol.</span></span> <span data-ttu-id="deb40-1406">Det finns 65 535 giltiga portar i TCP-komponenten för NetX Duo, mellan 1 och 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="deb40-1406">There are 65,535 valid ports in the TCP component of NetX Duo, ranging from 1 through 0xFFFF.</span></span> <span data-ttu-id="deb40-1407">Till skillnad från UDP där data från en port kan skickas till en annan målport, är en TCP-port ansluten till en annan angiven TCP-port, och endast när den här anslutningen upprättas kan all data överföring ske, och endast mellan de två portarna som utgör anslutningen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1407">Unlike UDP in which data from one port can be sent to any other destination port, a TCP port is connected to another specific TCP port, and only when this connection is established can any data transfer take place—and only between the two ports making up the connection.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="deb40-1408">*TCP-portar är helt åtskilda från UDP-portar, t. ex. UDP-port nummer 1 har ingen relation till TCP-port nummer 1*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1408">*TCP ports are completely separate from UDP ports; e.g., UDP port number 1 has no relation to TCP port number 1*.</span></span>

### <a name="client-server-model"></a><span data-ttu-id="deb40-1409">Client-Server modell</span><span class="sxs-lookup"><span data-stu-id="deb40-1409">Client-Server Model</span></span>     
<span data-ttu-id="deb40-1410">Om du vill använda TCP för data överföring måste du först upprätta en anslutning mellan de två TCP-socketarna.</span><span class="sxs-lookup"><span data-stu-id="deb40-1410">To use TCP for data transfer, a connection must first be established between the two TCP sockets.</span></span> <span data-ttu-id="deb40-1411">Upprättandet av anslutningen görs på en klient-server.</span><span class="sxs-lookup"><span data-stu-id="deb40-1411">The establishment of the connection is done in a client-server fashion.</span></span> <span data-ttu-id="deb40-1412">Klient sidan av anslutningen är den sida som initierar anslutningen, medan Server sidan bara väntar på klient anslutnings begär Anden innan bearbetningen görs.</span><span class="sxs-lookup"><span data-stu-id="deb40-1412">The client side of the connection is the side that initiates the connection, while the server side simply waits for client connection requests before any processing is done.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="deb40-1413">*För multihome-enheter bestämmer netx Duo automatiskt käll adressen som ska användas för anslutningen och nästa hopp adress baserat på anslutningens mål-IP-adress. Eftersom TCP är begränsat till att skicka paket till unicast-mål adresser (t. ex. icke-broadcast), kräver NetX Duo inte något "tips" för att välja källans IPv6-adress*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1413">*For multihome devices, NetX Duo automatically determines the source address to use for the connection, and the next hop address based on the destination IP address of the connection. Because TCP is limited to sending packets to unicast (e.g.nonbroadcast) destination addresses, NetX Duo does not require a "hint" for choosing the source IPv6 address*.</span></span>

### <a name="tcp-socket-state-machine"></a><span data-ttu-id="deb40-1414">TCP socket State Machine</span><span class="sxs-lookup"><span data-stu-id="deb40-1414">TCP Socket State Machine</span></span>      
<span data-ttu-id="deb40-1415">Anslutningen mellan två TCP-Sockets (en klient och en server) är komplex och hanteras på ett sätt som är en tillstånds dator.</span><span class="sxs-lookup"><span data-stu-id="deb40-1415">The connection between two TCP sockets (one client and one server) is complex and is managed in a state machine manner.</span></span> <span data-ttu-id="deb40-1416">Varje TCP-socket startar i ett stängt tillstånd.</span><span class="sxs-lookup"><span data-stu-id="deb40-1416">Each TCP socket starts in a CLOSED state.</span></span> <span data-ttu-id="deb40-1417">Via anslutnings händelser varje Sockets tillstånds dator migreras till ett etablerat tillstånd, vilket är den mängd data överföringen i TCP äger rum.</span><span class="sxs-lookup"><span data-stu-id="deb40-1417">Through connection events each socket's state machine migrates into the ESTABLISHED state, which is where the bulk of the data transfer in TCP takes place.</span></span> <span data-ttu-id="deb40-1418">När en sida av anslutningen inte längre vill skicka data, kopplas den bort.</span><span class="sxs-lookup"><span data-stu-id="deb40-1418">When one side of the connection no longer wishes to send data, it disconnects.</span></span> <span data-ttu-id="deb40-1419">När den andra sidan kopplas från återgår TCP-socketen till stängt tillstånd.</span><span class="sxs-lookup"><span data-stu-id="deb40-1419">After the other side disconnects, eventually the TCP socket returns to the CLOSED state.</span></span> <span data-ttu-id="deb40-1420">Den här processen upprepas varje gång en TCP-klient och Server upprättar och stänger en anslutning.</span><span class="sxs-lookup"><span data-stu-id="deb40-1420">This process repeats each time a TCP client and server establish and close a connection.</span></span> <span data-ttu-id="deb40-1421">Bild 14 visar de olika tillstånden för datorn för TCP-tillstånd.</span><span class="sxs-lookup"><span data-stu-id="deb40-1421">Figure 14 shows the various states of the TCP state machine.</span></span>

### <a name="tcp-client-connection"></a><span data-ttu-id="deb40-1422">TCP-klient anslutning</span><span class="sxs-lookup"><span data-stu-id="deb40-1422">TCP Client Connection</span></span>       
<span data-ttu-id="deb40-1423">Som tidigare nämnts, initierar klient sidan av TCP-anslutningen en anslutningsbegäran till en TCP-server.</span><span class="sxs-lookup"><span data-stu-id="deb40-1423">As mentioned previously, the client side of the TCP connection initiates a connection request to a TCP server.</span></span> <span data-ttu-id="deb40-1424">Innan en anslutningsbegäran kan göras måste TCP aktive ras på klientens IP-instans.</span><span class="sxs-lookup"><span data-stu-id="deb40-1424">Before a connection request can be made, TCP must be enabled on the client IP instance.</span></span> <span data-ttu-id="deb40-1425">Dessutom måste klienten TCP-socketen sedan skapas med \***nx_tcp_socket_create** _-tjänsten och vara kopplad till en port via tjänsten _ \*_nx_tcp_client_socket_bind_\*\*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1425">In addition, the client TCP socket must next be created with the ***nx_tcp_socket_create** _ service and bound to a port via the _ *_nx_tcp_client_socket_bind_** service.</span></span>

<span data-ttu-id="deb40-1426">När klient-socketen är kopplad, används tjänsten ***nxd_tcp_client_socket_connect*** för att upprätta en anslutning till en TCP-server.</span><span class="sxs-lookup"><span data-stu-id="deb40-1426">After the client socket is bound, the ***nxd_tcp_client_socket_connect*** service is used to establish a connection with a TCP server.</span></span> <span data-ttu-id="deb40-1427">Observera att socketen måste vara i stängt tillstånd för att ett anslutnings försök ska kunna initieras.</span><span class="sxs-lookup"><span data-stu-id="deb40-1427">Note the socket must be in a CLOSED state to initiate a connection attempt.</span></span> <span data-ttu-id="deb40-1428">Upprättandet av anslutningen börjar med NetX Duo som utfärdar ett SYN paket och väntar sedan på ett SYN ACK-paket tillbaka från servern, vilket innebär att anslutningsbegäran tas emot.</span><span class="sxs-lookup"><span data-stu-id="deb40-1428">Establishing the connection starts with NetX Duo issuing a SYN packet and then waiting for a SYN ACK packet back from the server, which signifies acceptance of the connection request.</span></span> <span data-ttu-id="deb40-1429">När SYN ACK tar emot svarar NetX Duo med ett ACK-paket och höjer upp klientens socket till tillståndet etablerad.</span><span class="sxs-lookup"><span data-stu-id="deb40-1429">After the SYN ACK is received, NetX Duo responds with an ACK packet and promotes the client socket to the ESTABLISHED state.</span></span>

![Diagram över tillstånden för TCP-tillstånds datorn.](./media/user-guide/image24.png)   

<span data-ttu-id="deb40-1431">**BILD 14. Tillstånd för TCP-tillstånds dator**</span><span class="sxs-lookup"><span data-stu-id="deb40-1431">**FIGURE 14. States of the TCP State Machine**</span></span>


> [!WARNING]
> <span data-ttu-id="deb40-1432">*Program bör använda **Nxd_tcp_client_socket_connect** för IPv4-och IPv6 TCP-anslutningar. Program kan fortfarande använda **nx_tcp_client_socket_connect** för IPv4 TCP-anslutningar, men utvecklare uppmuntras att använda **nxd_tcp_client_socket_connect** eftersom **nx_tcp_client_socket_connect** slutligen kommer att bli föråldrad*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1432">*Applications should use **nxd_tcp_client_socket_connect** for either IPv4 and IPv6 TCP connections. Applications can still use **nx_tcp_client_socket_connect** for IPv4 TCP connections, but developers are encouraged to use **nxd_tcp_client_socket_connect** since **nx_tcp_client_socket_connect** will eventually be deprecated*.</span></span>

<span data-ttu-id="deb40-1433">*På samma sätt fungerar **nxd_tcp_socket_peer_info_get** med antingen IPv4-eller IPv6 TCP-anslutningar. **Nx_tcp_socket_peer_info_get** är dock fortfarande tillgängligt för äldre program. Utvecklare uppmanas att använda **nxd_tcp_socket_peer_info_get** framåt*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1433">*Similarly, **nxd_tcp_socket_peer_info_get** works with either IPv4 or IPv6 TCP connections. However, **nx_tcp_socket_peer_info_get** is still available for legacy applications. Developers are encouraged to use **nxd_tcp_socket_peer_info_get** going forward*.</span></span>

### <a name="tcp-client-disconnection"></a><span data-ttu-id="deb40-1434">TCP-klient från koppling</span><span class="sxs-lookup"><span data-stu-id="deb40-1434">TCP Client Disconnection</span></span>    
<span data-ttu-id="deb40-1435">Att stänga anslutningen uppnås genom att anropa ***nx_tcp_socket_disconnect***.</span><span class="sxs-lookup"><span data-stu-id="deb40-1435">Closing the connection is accomplished by calling ***nx_tcp_socket_disconnect***.</span></span> <span data-ttu-id="deb40-1436">Om ingen uppskjutning har angetts skickar klient-socketen ett för-paket till Server-socketen och placerar socketen i stängt tillstånd.</span><span class="sxs-lookup"><span data-stu-id="deb40-1436">If no suspension is specified, the client socket sends a RST packet to the server socket and places the socket in the CLOSED state.</span></span> <span data-ttu-id="deb40-1437">Annars, om en SUS Pension begärs, utförs det fullständiga TCP-från kopplings protokollet enligt följande:</span><span class="sxs-lookup"><span data-stu-id="deb40-1437">Otherwise, if a suspension is requested, the full TCP disconnect protocol is performed, as follows:</span></span> 

- <span data-ttu-id="deb40-1438">Om servern tidigare initierade en från kopplings förfrågan (klient-socketen redan har tagit emot ett RÄNTETRANS-paket, svarat på en ACK och är i nära VÄNTe läge), höjer NetX Duo klientens TCP socket-tillstånd till det senaste bekräftelse stadiet och skickar ett RÄNTETRANS-paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1438">If the server previously initiated a disconnect request (the client socket has already received a FIN packet, responded with an ACK, and is in the CLOSE WAIT state), NetX Duo promotes the client TCP socket state to the LAST ACK state and sends a FIN packet.</span></span> <span data-ttu-id="deb40-1439">Den väntar sedan på en bekräftelse från servern innan du slutför från kopplingen och anger det stängda läget.</span><span class="sxs-lookup"><span data-stu-id="deb40-1439">It then waits for an ACK from the server before completing the disconnect and entering the CLOSED state.</span></span>

- <span data-ttu-id="deb40-1440">Om klienten å andra sidan är den första för att initiera en från kopplings förfrågan (servern har inte kopplats från och socketen fortfarande är i det tillstånd som har ETABLERATs), skickar NetX Duo ett RÄNTETRANS-paket för att initiera från kopplingen och väntar på att ta emot en FIN och en bekräftelse från servern innan du slutför från kopplingen och placera socketen i ett stängt tillstånd.</span><span class="sxs-lookup"><span data-stu-id="deb40-1440">If on the other hand, the client is the first to initiate a disconnect request (the server has not disconnected and the socket is still in the ESTABLISHED state), NetX Duo sends a FIN packet to initiate the disconnect and waits to receive a FIN and an ACK from the server before completing the disconnect and placing the socket in a CLOSED state.</span></span>

<span data-ttu-id="deb40-1441">Om det fortfarande finns paket i kön för överföring av socket, pausar NetX Duo under den angivna tids gränsen för att tillåta att paketen kan bekräftas.</span><span class="sxs-lookup"><span data-stu-id="deb40-1441">If there are still packets on the socket transmit queue, NetX Duo suspends for the specified timeout to allow the packets to be acknowledged.</span></span> <span data-ttu-id="deb40-1442">Om tids gränsen går ut tömmer NetX Duo överförings kön för klientens socket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1442">If the timeout expires, NetX Duo empties the transmit queue of the client socket.</span></span> 

<span data-ttu-id="deb40-1443">Programmet anropar ***nx_tcp_client_socket_unbind*** för att frigöra porten från klientens socket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1443">To unbind the port from the client socket, the application calls ***nx_tcp_client_socket_unbind***.</span></span> <span data-ttu-id="deb40-1444">Socketen måste vara i ett stängt tillstånd eller vid från koppling (t. ex. VÄNTe läge VÄNTe tid) innan porten släpps. annars returneras ett fel.</span><span class="sxs-lookup"><span data-stu-id="deb40-1444">The socket must be in a CLOSED state or in the process of disconnecting (i.e., TIMED WAIT state) before the port is released; otherwise, an error is returned.</span></span>

<span data-ttu-id="deb40-1445">Slutligen, om programmet inte längre behöver klient-socketen, anropar den ***nx_tcp_socket_delete*** för att ta bort socketen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1445">Finally, if the application no longer needs the client socket, it calls ***nx_tcp_socket_delete*** to delete the socket.</span></span>

### <a name="tcp-server-connection"></a><span data-ttu-id="deb40-1446">Anslutning till TCP-server</span><span class="sxs-lookup"><span data-stu-id="deb40-1446">TCP Server Connection</span></span>      
<span data-ttu-id="deb40-1447">Server sidan av en TCP-anslutning är passiv; servern väntar alltså på att en klient ska initiera anslutningsbegäran.</span><span class="sxs-lookup"><span data-stu-id="deb40-1447">The server side of a TCP connection is passive; i.e., the server waits for a client to initiate connection request.</span></span> <span data-ttu-id="deb40-1448">Om du vill acceptera en klient anslutning måste TCP först vara aktiverat på IP-instansen genom att anropa tjänsten \***nx_tcp_enable** _.</span><span class="sxs-lookup"><span data-stu-id="deb40-1448">To accept a client connection, TCP must first be enabled on the IP instance by calling the service \***nx_tcp_enable** _.</span></span> <span data-ttu-id="deb40-1449">Därefter måste programmet skapa en TCP-socket med hjälp av _ \*_nx_tcp_socket_create_\*\*-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="deb40-1449">Next, the application must create a TCP socket using the _ *_nx_tcp_socket_create_*\* service.</span></span>  

<span data-ttu-id="deb40-1450">Server-socketen måste också konfigureras för att lyssna efter anslutnings begär Anden.</span><span class="sxs-lookup"><span data-stu-id="deb40-1450">The server socket must also be set up for listening for connection requests.</span></span> <span data-ttu-id="deb40-1451">Detta uppnås med hjälp av tjänsten ***nx_tcp_server_socket_listen*** .</span><span class="sxs-lookup"><span data-stu-id="deb40-1451">This is achieved by using the ***nx_tcp_server_socket_listen*** service.</span></span> <span data-ttu-id="deb40-1452">Den här tjänsten placerar serverns socket i LYSSNINGs tillstånd och binder den angivna Server porten till socketen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1452">This service places the server socket in the LISTEN state and binds the specified server port to the socket.</span></span>

> [!NOTE] 
> <span data-ttu-id="deb40-1453">*Om du vill ange en utgångs rutin för socket-motringning anger programmet lämplig motringning för argumentet tcp_listen_callback i **nx_tcp_server_socket_listens** tjänsten. Den här program återanrops funktionen körs sedan av NetX Duo när en ny anslutning begärs på den här Server porten. Bearbetningen i återanropet är under program kontroll.*</span><span class="sxs-lookup"><span data-stu-id="deb40-1453">*To set a socket listen callback routine the application specifies the appropriate callback function for the tcp_listen_callback argument of the **nx_tcp_server_socket_listen** service. This application callback function is then executed by NetX Duo whenever a new connection is requested on this server port. The processing in the callback is under application control.*</span></span>

<span data-ttu-id="deb40-1454">För att godkänna förfrågningar om klient anslutning anropar programmet \***nx_tcp_server_socket_accept** _-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="deb40-1454">To accept client connection requests, the application calls the \***nx_tcp_server_socket_accept** _ service.</span></span> <span data-ttu-id="deb40-1455">Server-socketen måste antingen vara i ett LYSSNINGs tillstånd eller tillstånd som tagits emot (dvs. servern är i LYSSNINGs tillståndet och har tagit emot ett SYN paket från en klient som begär en anslutning) för att anropa tjänsten accept.</span><span class="sxs-lookup"><span data-stu-id="deb40-1455">The server socket must either be in a LISTEN state or a SYN RECEIVED state (i.e., the server is in the LISTEN state and has received a SYN packet from a client requesting a connection) to call the accept service.</span></span> <span data-ttu-id="deb40-1456">En lyckad retur status från _ *_nx_tcp_server_socket_accept_*\* anger att anslutningen har kon figurer ATS och att serverns socket har tillståndet etablerad.</span><span class="sxs-lookup"><span data-stu-id="deb40-1456">A successful return status from _ *_nx_tcp_server_socket_accept_*\* indicates the connection has been set up and the server socket is in the ESTABLISHED state.</span></span>

<span data-ttu-id="deb40-1457">När Server-socketen har en giltig anslutning, köas ytterligare klient anslutnings begär anden till det djup som anges av *listen_queue_size, som skickas till*  \* **nx_tcp_server_socket_listen** _-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="deb40-1457">After the server socket has a valid connection, additional client connection requests are queued up to the depth specified by the *listen_queue_size, passed into the* \***nx_tcp_server_socket_listen** _ service.</span></span> <span data-ttu-id="deb40-1458">För att kunna bearbeta efterföljande anslutningar på en server port måste programmet anropa _ *_nx_tcp_server_socket_relisten_*\* med en tillgänglig socket (t. ex. en socket i ett stängt tillstånd).</span><span class="sxs-lookup"><span data-stu-id="deb40-1458">In order to process subsequent connections on a server port, the application must call _ *_nx_tcp_server_socket_relisten_*\* with an available socket (i.e., a socket in a CLOSED state).</span></span> <span data-ttu-id="deb40-1459">Observera att samma server-socket kan användas om den tidigare anslutningen som är associerad med socketen nu är slutförd och socketen är i stängt tillstånd.</span><span class="sxs-lookup"><span data-stu-id="deb40-1459">Note that the same server socket could be used if the previous connection associated with the socket is now finished and the socket is in the CLOSED state.</span></span>

### <a name="tcp-server-disconnection"></a><span data-ttu-id="deb40-1460">AvAnslutning av TCP-server</span><span class="sxs-lookup"><span data-stu-id="deb40-1460">TCP Server Disconnection</span></span>     
<span data-ttu-id="deb40-1461">Att stänga anslutningen uppnås genom att anropa ***nx_tcp_socket_disconnect***.</span><span class="sxs-lookup"><span data-stu-id="deb40-1461">Closing the connection is accomplished by calling ***nx_tcp_socket_disconnect***.</span></span> <span data-ttu-id="deb40-1462">Om ingen uppskjutning har angetts skickar Server-socketen ett för-paket till klientens socket och placerar socketen i stängt tillstånd.</span><span class="sxs-lookup"><span data-stu-id="deb40-1462">If no suspension is specified, the server socket sends a RST packet to the client socket and places the socket in the CLOSED state.</span></span> <span data-ttu-id="deb40-1463">Annars, om en SUS Pension begärs, utförs det fullständiga TCP-från kopplings protokollet enligt följande:</span><span class="sxs-lookup"><span data-stu-id="deb40-1463">Otherwise, if a suspension is requested, the full TCP disconnect protocol is performed, as follows:</span></span>

- <span data-ttu-id="deb40-1464">Om klienten tidigare initierade en från kopplings förfrågan (Server-socketen redan har tagit emot ett RÄNTETRANS-paket, svarat på en ACK och är i nära VÄNTe läge), höjer NetX Duo TCP-socketen till det senaste bekräftelse stadiet och skickar ett RÄNTETRANS-paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1464">If the client previously initiated a disconnect request (the server socket has already received a FIN packet, responded with an ACK, and is in the CLOSE WAIT state), NetX Duo promotes the TCP socket state to the LAST ACK state and sends a FIN packet.</span></span> <span data-ttu-id="deb40-1465">Den väntar sedan på en bekräftelse från klienten innan du slutför från kopplingen och anger det stängda läget.</span><span class="sxs-lookup"><span data-stu-id="deb40-1465">It then waits for an ACK from the client before  completing the disconnect and entering the CLOSED state.</span></span>

- <span data-ttu-id="deb40-1466">Om servern å andra sidan är den första att initiera en från kopplings förfrågan (klienten har inte kopplats från och att socketen fortfarande är i det tillstånd som har ETABLERATs), skickar NetX Duo ett RÄNTETRANS-paket för att initiera från kopplingen och väntar på att ta emot en FIN och en bekräftelse från klienten innan du slutför från kopplingen och placera socketen i ett stängt tillstånd.</span><span class="sxs-lookup"><span data-stu-id="deb40-1466">If on the other hand, the server is the first to initiate a disconnect request (the client has not disconnected and the socket is still in the ESTABLISHED state), NetX Duo sends a FIN packet to initiate the disconnect and waits to receive a FIN and an ACK from the client before completing the disconnect and placing the socket in a CLOSED state.</span></span>

<span data-ttu-id="deb40-1467">Om det fortfarande finns paket i kön för överföring av socket, pausar NetX Duo under den angivna tids gränsen för att tillåta att dessa paket bekräftas.</span><span class="sxs-lookup"><span data-stu-id="deb40-1467">If there are still packets on the socket transmit queue, NetX Duo suspends for the specified timeout to allow those packets to be acknowledged.</span></span> <span data-ttu-id="deb40-1468">Om tids gränsen går ut tömmer NetX Duo Server-socketens överförings kön.</span><span class="sxs-lookup"><span data-stu-id="deb40-1468">If the timeout expires, NetX Duo flushes the transmit queue of the server socket.</span></span>

<span data-ttu-id="deb40-1469">När från kopplings bearbetningen har slutförts och Server-socketen är i stängt tillstånd måste programmet anropa tjänsten \***nx_tcp_server_socket_unaccept** _ för att avsluta associationen mellan denna socket och Server porten.</span><span class="sxs-lookup"><span data-stu-id="deb40-1469">After the disconnect processing is complete and the server socket is in the CLOSED state, the application must call the \***nx_tcp_server_socket_unaccept** _ service to end the association of this socket with the server port.</span></span> <span data-ttu-id="deb40-1470">OBS! den här tjänsten måste anropas av programmet även om _*_nx_tcp_socket_disconnect_*_ eller _*_nx_tcp_server_socket_accept_*_ returnera en fel status.</span><span class="sxs-lookup"><span data-stu-id="deb40-1470">Note this service must be called by the application even if _*_nx_tcp_socket_disconnect_*_ or _*_nx_tcp_server_socket_accept_*_ return an error status.</span></span> <span data-ttu-id="deb40-1471">När _*_nx_tcp_server_socket_unaccept_*_ returnerar kan socketen användas som en klient eller Server-socket, eller till och med tas bort om den inte längre behövs.</span><span class="sxs-lookup"><span data-stu-id="deb40-1471">After the _*_nx_tcp_server_socket_unaccept_*_ returns, the socket can be used as a client or server socket, or even deleted if it is no longer needed.</span></span> <span data-ttu-id="deb40-1472">Om du vill acceptera en annan klient anslutning på samma server port bör du anropa tjänsten _ *_nx_tcp_server_socket_relisten_*\* på denna socket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1472">If accepting another client connection on the same server port is desired, the _ *_nx_tcp_server_socket_relisten_*\* service should be called on this socket.</span></span>

<span data-ttu-id="deb40-1473">Följande kod segment illustrerar sekvensen av anrop en typisk TCP-server använder:</span><span class="sxs-lookup"><span data-stu-id="deb40-1473">The following code segment illustrates the sequence of calls a typical TCP server uses:</span></span>

```c
/* Set up a previously created TCP socket to
   listen on port 12 */
nx_tcp_server_socket_listen()

/* Loop to make a (another) connection. */
while(1)
{
    /* Wait for a client socket connection request
       for 100 ticks. */
    nx_tcp_server_socket_accept();

    /* (Send and receive TCP messages with the TCP
       client) */

    /* Disconnect the server socket. */
    nx_tcp_socket_disconnect();

    /* Remove this server socket from listening on
       the port. */
    nx_tcp_server_socket_unaccept(&server_socket);
    /* Set up server socket to relisten on the
       same port for the next client. */
    nx_tcp_server_socket_relisten();
}
```

### <a name="mss-validation"></a><span data-ttu-id="deb40-1474">MSS-verifiering</span><span class="sxs-lookup"><span data-stu-id="deb40-1474">MSS Validation</span></span>      
<span data-ttu-id="deb40-1475">Maximal segment storlek (MSS) är den maximala mängden byte som en TCP-värd kan ta emot utan att fragmenteras av det underliggande IP-lagret.</span><span class="sxs-lookup"><span data-stu-id="deb40-1475">The Maximum Segment Size (MSS) is the maximum amount of bytes a TCP host can receive without being fragmented by the underlying IP layer.</span></span> <span data-ttu-id="deb40-1476">Under fasen för etablering av TCP-anslutningar, avslutar båda sina egna TCP-MSS-värden, så att avsändaren inte skickar ett TCP-datasegment som är större än mottagarens MSS.</span><span class="sxs-lookup"><span data-stu-id="deb40-1476">During TCP connection establishment phase, both ends exchanges its own TCP MSS value, so that the sender does not send a TCP data segment that is larger than the receiver's MSS.</span></span> <span data-ttu-id="deb40-1477">Med NetX Duo TCP-modulen kan du välja att validera dess peers annonserade MSS-värde innan du upprättar en anslutning.</span><span class="sxs-lookup"><span data-stu-id="deb40-1477">NetX Duo TCP module will optionally validate its peer's advertised MSS value before establishing a connection.</span></span> <span data-ttu-id="deb40-1478">Som standard ger NetX Duo ingen sådan kontroll.</span><span class="sxs-lookup"><span data-stu-id="deb40-1478">By default NetX Duo does not enable such a check.</span></span> <span data-ttu-id="deb40-1479">Program som vill utföra MSS-verifieringen måste definiera ***NX_ENABLE_TCP_MSS_CHECK** _ när du skapar netx Duo-biblioteket och det minsta värdet måste definieras i _*_NX_TCP_MSS_MINIMUM_\*_.</span><span class="sxs-lookup"><span data-stu-id="deb40-1479">Applications wishing to perform MSS validation shall define ***NX_ENABLE_TCP_MSS_CHECK** _ when building the NetX Duo library, and the minimum value shall be defined in _*_NX_TCP_MSS_MINIMUM_\*_.</span></span> <span data-ttu-id="deb40-1480">Inkommande TCP-anslutningar med MSS-värden under _ *_NX_TCP_MSS_MINIMUM_*\* ignoreras.</span><span class="sxs-lookup"><span data-stu-id="deb40-1480">Incoming TCP connections with MSS values below _ *_NX_TCP_MSS_MINIMUM_*\* are dropped.</span></span>

### <a name="stop-listening-on-a-server-port"></a><span data-ttu-id="deb40-1481">Stoppa lyssning på en server port</span><span class="sxs-lookup"><span data-stu-id="deb40-1481">Stop Listening on a Server Port</span></span>    
<span data-ttu-id="deb40-1482">Om programmet inte längre vill lyssna efter klient anslutnings begär Anden på en server port som tidigare angavs av ett anrop till tjänsten \***nx_tcp_server_socket_listen** _, anropar programmet bara tjänsten _ \*_nx_tcp_server_socket_unlisten_\*\*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1482">If the application no longer wishes to listen for client connection requests on a server port that was previously specified by a call to the ***nx_tcp_server_socket_listen** _ service, the application simply calls the _ *_nx_tcp_server_socket_unlisten_** service.</span></span> <span data-ttu-id="deb40-1483">Den här tjänsten placerar en socket i väntan på en anslutning tillbaka i stängt tillstånd och släpper alla paket med köade klient anslutnings begär Anden.</span><span class="sxs-lookup"><span data-stu-id="deb40-1483">This service places any socket waiting for a connection back in the CLOSED state and releases any queued client connection request packets.</span></span> 

### <a name="tcp-window-size"></a><span data-ttu-id="deb40-1484">TCP-fönster storlek</span><span class="sxs-lookup"><span data-stu-id="deb40-1484">TCP Window Size</span></span>   
<span data-ttu-id="deb40-1485">Under både installationen och data överförings faserna i anslutningen, rapporterar varje port mängden data som kan hanteras, vilket kallas dess fönster storlek.</span><span class="sxs-lookup"><span data-stu-id="deb40-1485">During both the setup and data transfer phases of the connection, each port reports the amount of data it can handle, which is called its window size.</span></span> <span data-ttu-id="deb40-1486">När data tas emot och bearbetas justeras den här fönstrets storlek dynamiskt.</span><span class="sxs-lookup"><span data-stu-id="deb40-1486">As data are received and processed, this window size is adjusted dynamically.</span></span> <span data-ttu-id="deb40-1487">I TCP kan en sändare bara skicka en mängd data som passar i mottagarens fönster.</span><span class="sxs-lookup"><span data-stu-id="deb40-1487">In TCP, a sender can only send an amount of data that fits into the receiver's window.</span></span> <span data-ttu-id="deb40-1488">I själva verket ger fönster storleken flödes kontroll för data överföring i varje riktning i anslutningen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1488">In essence, the window size provides flow control for data transfer in each direction of the connection.</span></span>   

### <a name="tcp-packet-send"></a><span data-ttu-id="deb40-1489">Skicka TCP-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1489">TCP Packet Send</span></span>     
<span data-ttu-id="deb40-1490">Det är enkelt att skicka TCP-data genom att anropa funktionen ***nx_tcp_socket_send*** .</span><span class="sxs-lookup"><span data-stu-id="deb40-1490">Sending TCP data is easily accomplished by calling the ***nx_tcp_socket_send*** function.</span></span> <span data-ttu-id="deb40-1491">Om storleken på de data som överförs är större än MSS-värdet för socketen eller den aktuella peer-mottagande fönster storlek, beroende på vilket som är mindre, är TCP Internal Logic carves av data som passar i min (MSS, peer Receive-fönster) för överföring.</span><span class="sxs-lookup"><span data-stu-id="deb40-1491">If the size of the data being transmitted is larger than the MSS value of the socket or the current peer receive window size, whichever is smaller, TCP internal logic carves off the data that fits into min (MSS, peer receive Window) for transmission.</span></span> <span data-ttu-id="deb40-1492">Den här tjänsten skapar sedan ett TCP-huvud framför paketet (inklusive beräkning av kontroll summa).</span><span class="sxs-lookup"><span data-stu-id="deb40-1492">This service then builds a TCP header in front of the packet (including the checksum calculation).</span></span> <span data-ttu-id="deb40-1493">Om mottagarens fönster storlek inte är noll, skickar anroparen lika mycket data som det kan fylla i mottagarens fönster storlek.</span><span class="sxs-lookup"><span data-stu-id="deb40-1493">If the receiver's window size is not zero, the caller will send as much data as it can to fill up the receiver window size.</span></span> <span data-ttu-id="deb40-1494">Om mottagnings fönstret blir noll kan anroparen pausa och vänta tills mottagarens fönster storlek ökar tillräckligt för att det här paketet ska skickas.</span><span class="sxs-lookup"><span data-stu-id="deb40-1494">If the receive window becomes zero, the caller may suspend and wait for the receiver's window size to increase enough for this packet to be sent.</span></span> <span data-ttu-id="deb40-1495">Vid en specifik tidpunkt kan flera trådar pausas vid försök att skicka data via samma socket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1495">At any given time, multiple threads may suspend while trying to send data through the same socket.</span></span> 

> [!WARNING]  
> <span data-ttu-id="deb40-1496">*De TCP-data som finns i NX_PACKETs strukturen bör finnas på en lång ord linje. Dessutom måste det finnas tillräckligt med utrymme mellan lägga-pekaren och data start pekaren för att placera rubrikerna TCP, IP och fysisk media*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1496">*The TCP data residing in the NX_PACKET structure should reside on a long-word boundary. In addition, there needs to be sufficient space between the prepend pointer and the data start pointer to place the TCP, IP, and physical media headers*.</span></span>

### <a name="tcp-packet-retransmit"></a><span data-ttu-id="deb40-1497">Återsändning av TCP-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1497">TCP Packet Retransmit</span></span>      
<span data-ttu-id="deb40-1498">Tidigare skickade TCP-paket som faktiskt lagrats internt tills en ACK returneras från den andra sidan av anslutningen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1498">Previously transmitted TCP packets sent actually stored internally until an ACK is returned from the other side of the connection.</span></span> <span data-ttu-id="deb40-1499">Om överförda data inte har bekräftats inom tids gränsen, skickas det lagrade paketet igen och nästa timeout-period anges.</span><span class="sxs-lookup"><span data-stu-id="deb40-1499">If transmitted data is not acknowledged within the timeout period, the stored packet is re-sent and the next timeout period is set.</span></span> <span data-ttu-id="deb40-1500">När en ACK tas emot släpps slutligen alla paket som omfattas av bekräftelse numret i den interna överförings kön.</span><span class="sxs-lookup"><span data-stu-id="deb40-1500">When an ACK is received, all packets covered by the acknowledgement number in the internal transmit queue are finally released.</span></span>  

> [!WARNING]   
> <span data-ttu-id="deb40-1501">*Programmet får inte återanvända paketet eller ändra paketets innehåll efter nx_tcp_socket_send () returnerar NX_SUCCESS. Det överförda paketet släpps slutligen av NetX Duo intern bearbetning när data har bekräftats av den andra parten*.</span><span class="sxs-lookup"><span data-stu-id="deb40-1501">*Application shall not reuse the packet or alter the contents of the packet after nx_tcp_socket_send() returns with NX_SUCCESS. The transmitted packet is eventually released by NetX Duo internal processing after the data is acknowledged by the other end*.</span></span>

### <a name="tcp-keepalive"></a><span data-ttu-id="deb40-1502">TCP keepalive</span><span class="sxs-lookup"><span data-stu-id="deb40-1502">TCP Keepalive</span></span>     
<span data-ttu-id="deb40-1503">TCP keepalive-funktionen gör det möjligt för en socket att identifiera om dess peer-kopplas bort utan korrekt avslutning (t. ex. om motparten har kraschat) eller för att förhindra vissa nätverks övervaknings anläggningar att avsluta en anslutning under långa perioder av inaktivitet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1503">TCP Keepalive feature allows a socket to detect whether or not its peer disconnects without proper termination (for example, the peer crashed), or to prevent certain network monitoring facilities to terminate a connection for long periods of idle.</span></span> <span data-ttu-id="deb40-1504">TCP keepalive fungerar genom att regelbundet skicka en TCP-ram utan data, och sekvensnumret anges till ett lägre värde än det aktuella sekvensnumret.</span><span class="sxs-lookup"><span data-stu-id="deb40-1504">TCP Keepalive works by periodically sending a TCP frame with no data, and the sequence number set to one less than the current sequence number.</span></span> <span data-ttu-id="deb40-1505">När en sådan TCP keepalive-ram tas emot, kan mottagaren, om den fortfarande är aktiv, svara med ett ACK-värde för det aktuella sekvensnumret.</span><span class="sxs-lookup"><span data-stu-id="deb40-1505">On receiving such TCP Keepalive frame, the recipient, if still alive, responses with an ACK for its current sequence number.</span></span> <span data-ttu-id="deb40-1506">Detta slutför keepalive-transaktionen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1506">This completes the keepalive transaction.</span></span>  

<span data-ttu-id="deb40-1507">Som standard är keepalive-funktionen inte aktive rad.</span><span class="sxs-lookup"><span data-stu-id="deb40-1507">By default the keepalive feature is not enabled.</span></span> <span data-ttu-id="deb40-1508">Om du vill använda den här funktionen måste NetX Duo-biblioteket skapas med \***NX_ENABLE_TCP_KEEPALIVE** _ definierade.</span><span class="sxs-lookup"><span data-stu-id="deb40-1508">To use this feature, NetX Duo library must be built with \***NX_ENABLE_TCP_KEEPALIVE** _ defined.</span></span> <span data-ttu-id="deb40-1509">Symbolen _ *_NX_TCP_KEEPALIVE_INITIAL_*\* anger antalet sekunder av inaktivitet innan keepalive-ramen initieras.</span><span class="sxs-lookup"><span data-stu-id="deb40-1509">The symbol _ *_NX_TCP_KEEPALIVE_INITIAL_*\* specifies the number of seconds of inactivity before the keepalive frame is initiated.</span></span>  

### <a name="tcp-packet-receive"></a><span data-ttu-id="deb40-1510">Mottagning av TCP-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1510">TCP Packet Receive</span></span>   
<span data-ttu-id="deb40-1511">TCP Receive-paketets bearbetning (anropas från IP-hjälpens tråd) ansvarar för hantering av olika anslutnings-och från kopplings åtgärder samt överföring av bekräftelse bearbetning.</span><span class="sxs-lookup"><span data-stu-id="deb40-1511">The TCP receive packet processing (called from the IP helper thread) is responsible for handling various connection and disconnection actions as well as transmit acknowledge processing.</span></span> <span data-ttu-id="deb40-1512">Dessutom ansvarar TCP Receive Packet-bearbetningen för att placera paket med ta emot data på rätt TCP-Sockets mottagande kö eller leverera paketet till den första pausade tråden som väntar på ett paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1512">In addition, the TCP receive packet processing is responsible for placing packets with receive data on the appropriate TCP socket's receive queue or delivering the packet to the first suspended thread waiting for a packet.</span></span>

### <a name="tcp-receive-notify"></a><span data-ttu-id="deb40-1513">TCP Receive-avisering</span><span class="sxs-lookup"><span data-stu-id="deb40-1513">TCP Receive Notify</span></span>     
<span data-ttu-id="deb40-1514">Om program tråden behöver bearbeta mottagna data från fler än en socket ska funktionen ***nx_tcp_socket_receive_notify*** användas.</span><span class="sxs-lookup"><span data-stu-id="deb40-1514">If the application thread needs to process received data from more than one socket, the ***nx_tcp_socket_receive_notify*** function should be used.</span></span> <span data-ttu-id="deb40-1515">Den här funktionen registrerar en motringnings funktion för mottagnings paket för socketen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1515">This function registers a receive packet callback function for the socket.</span></span> <span data-ttu-id="deb40-1516">När ett paket tas emot på socketen körs motringningsfunktionen.</span><span class="sxs-lookup"><span data-stu-id="deb40-1516">Whenever a packet is received on the socket, the callback function is executed.</span></span>  

<span data-ttu-id="deb40-1517">Innehållet i motringningsfunktionen är applicationspecific; funktionen skulle dock förmodligen innehålla logik för att informera bearbetnings tråden att ett paket är tillgängligt på motsvarande socket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1517">The contents of the callback function are applicationspecific; however, the function would most likely contain logic to inform the processing thread that a packet is available on the corresponding socket.</span></span> 

### <a name="thread-suspension"></a><span data-ttu-id="deb40-1518">Tråd upphängning</span><span class="sxs-lookup"><span data-stu-id="deb40-1518">Thread Suspension</span></span>      
<span data-ttu-id="deb40-1519">Som tidigare nämnts kan program trådar pausa vid försök att ta emot data från en viss TCP-port.</span><span class="sxs-lookup"><span data-stu-id="deb40-1519">As mentioned previously, application threads can suspend while attempting to receive data from a particular TCP port.</span></span> <span data-ttu-id="deb40-1520">När ett paket har mottagits på den porten, tilldelas den första tråden inaktive rad och tråden återupptas sedan.</span><span class="sxs-lookup"><span data-stu-id="deb40-1520">After a packet is received on that port, it is given to the first thread suspended and that thread is then resumed.</span></span> <span data-ttu-id="deb40-1521">En valfri timeout är tillgänglig när du pausar ett TCP Receive-paket, en funktion som är tillgänglig för de flesta NetX Duo-tjänster.</span><span class="sxs-lookup"><span data-stu-id="deb40-1521">An optional timeout is available when suspending on a TCP receive packet, a feature available for most NetX Duo services.</span></span>  

<span data-ttu-id="deb40-1522">Tråd upphängning är också tillgängligt för anslutning (både klient och Server), klient bindning och från kopplings tjänster.</span><span class="sxs-lookup"><span data-stu-id="deb40-1522">Thread suspension is also available for connection (both client and server), client binding, and disconnection services.</span></span>  

### <a name="tcp-socket-statistics-and-errors"></a><span data-ttu-id="deb40-1523">TCP-socket statistik och fel</span><span class="sxs-lookup"><span data-stu-id="deb40-1523">TCP Socket Statistics and Errors</span></span>     
<span data-ttu-id="deb40-1524">Om den här inställningen är aktive rad håller NetX Duo TCP socket-programvaran reda på flera statistik och fel som kan vara användbara för programmet.</span><span class="sxs-lookup"><span data-stu-id="deb40-1524">If enabled, the NetX Duo TCP socket software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="deb40-1525">Följande statistik och fel rapporter underhålls för varje IP/TCP-instans:</span><span class="sxs-lookup"><span data-stu-id="deb40-1525">The following statistics and error reports are maintained for each IP/TCP instance:</span></span>   

- <span data-ttu-id="deb40-1526">Totalt antal skickade TCP-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1526">Total TCP Packets Sent</span></span>  
- <span data-ttu-id="deb40-1527">Totalt antal skickade TCP-byte</span><span class="sxs-lookup"><span data-stu-id="deb40-1527">Total TCP Bytes Sent</span></span>  
- <span data-ttu-id="deb40-1528">Totalt antal mottagna TCP-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1528">Total TCP Packets Received</span></span>   
- <span data-ttu-id="deb40-1529">Totalt antal mottagna TCP-byte</span><span class="sxs-lookup"><span data-stu-id="deb40-1529">Total TCP Bytes Received</span></span>   
- <span data-ttu-id="deb40-1530">Totalt antal ogiltiga TCP-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1530">Total TCP Invalid Packets</span></span>   
- <span data-ttu-id="deb40-1531">Totalt antal borttagna TCP-mottagna paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1531">Total TCP Receive Packets Dropped</span></span>    
- <span data-ttu-id="deb40-1532">Totalt antal fel i TCP Receive-kontrollsumma</span><span class="sxs-lookup"><span data-stu-id="deb40-1532">Total TCP Receive Checksum Errors</span></span>   
- <span data-ttu-id="deb40-1533">Totalt antal TCP-anslutningar</span><span class="sxs-lookup"><span data-stu-id="deb40-1533">Total TCP Connections</span></span>   
- <span data-ttu-id="deb40-1534">Totalt antal TCP-anslutningar</span><span class="sxs-lookup"><span data-stu-id="deb40-1534">Total TCP Disconnections</span></span>   
- <span data-ttu-id="deb40-1535">Totalt antal borttagna TCP-anslutningar</span><span class="sxs-lookup"><span data-stu-id="deb40-1535">Total TCP Connections Dropped</span></span>    
- <span data-ttu-id="deb40-1536">Totalt antal återsändningar av TCP-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1536">Total TCP Packet Retransmits</span></span>   
- <span data-ttu-id="deb40-1537">Skickade TCP-socket-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1537">TCP Socket Packets Sent</span></span>   
- <span data-ttu-id="deb40-1538">Skickade TCP-socket-byte</span><span class="sxs-lookup"><span data-stu-id="deb40-1538">TCP Socket Bytes Sent</span></span>   
- <span data-ttu-id="deb40-1539">Mottagna TCP-socket-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1539">TCP Socket Packets Received</span></span>   
- <span data-ttu-id="deb40-1540">Mottagna TCP-socket-byte</span><span class="sxs-lookup"><span data-stu-id="deb40-1540">TCP Socket Bytes Received</span></span>   
- <span data-ttu-id="deb40-1541">Återsändning av TCP-socket-paket</span><span class="sxs-lookup"><span data-stu-id="deb40-1541">TCP Socket Packet Retransmits</span></span>    
- <span data-ttu-id="deb40-1542">TCP-socket-paket i kö</span><span class="sxs-lookup"><span data-stu-id="deb40-1542">TCP Socket Packets Queued</span></span>    
- <span data-ttu-id="deb40-1543">Fel vid kontroll summa för TCP-socket</span><span class="sxs-lookup"><span data-stu-id="deb40-1543">TCP Socket Checksum Errors</span></span>    
- <span data-ttu-id="deb40-1544">TCP-socket-tillstånd</span><span class="sxs-lookup"><span data-stu-id="deb40-1544">TCP Socket State</span></span>    
- <span data-ttu-id="deb40-1545">Djup i överförings kön för TCP-socket</span><span class="sxs-lookup"><span data-stu-id="deb40-1545">TCP Socket Transmit Queue Depth</span></span>    
- <span data-ttu-id="deb40-1546">Överförings fönster storlek för TCP-socket</span><span class="sxs-lookup"><span data-stu-id="deb40-1546">TCP Socket Transmit Window Size</span></span>    
- <span data-ttu-id="deb40-1547">TCP-Sockets mottagnings fönster storlek</span><span class="sxs-lookup"><span data-stu-id="deb40-1547">TCP Socket Receive Window Size</span></span>    

<span data-ttu-id="deb40-1548">Alla dessa statistik-och fel rapporter är tillgängliga för programmet med \***nx_tcp_info_get** _-tjänsten för total TCP-statistik och _ \*_nx_tcp_socket_info_get_\*\*-tjänsten för TCP-statistik per socket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1548">All these statistics and error reports are available to the application with the ***nx_tcp_info_get** _ service for total TCP statistics and the _ *_nx_tcp_socket_info_get_** service for TCP statistics per socket.</span></span>

### <a name="tcp-socket-control-block-nx_tcp_socket"></a><span data-ttu-id="deb40-1549">TCP socket Control Block NX_TCP_SOCKET</span><span class="sxs-lookup"><span data-stu-id="deb40-1549">TCP Socket Control Block NX_TCP_SOCKET</span></span>      
<span data-ttu-id="deb40-1550">Egenskaperna för varje TCP-socket finns i det associerade *NX_TCP_SOCKET* kontroll blocket som innehåller användbar information, till exempel länken till IP-datastrukturen, nätverks anslutnings gränssnittet, den bundna porten och kön för mottagnings paket.</span><span class="sxs-lookup"><span data-stu-id="deb40-1550">The characteristics of each TCP socket are found in the associated *NX_TCP_SOCKET* control block, which contains useful information such as the link to the IP data structure, the network connection interface, the bound port, and the receive packet queue.</span></span> <span data-ttu-id="deb40-1551">Den här strukturen definieras i filen ***nx_api. h*** .</span><span class="sxs-lookup"><span data-stu-id="deb40-1551">This structure is defined in the ***nx_api.h*** file.</span></span>