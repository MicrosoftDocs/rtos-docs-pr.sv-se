---
title: Kapitel 1 – en introduktion till nätverks adress Översättning
description: IP Network Address Translation (NAT) utvecklades ursprungligen för att lösa problemet med ett begränsat antal Internet IPv4-adresser.
author: philmea
ms.author: philmea
ms.date: 07/14/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 3d01aa6f68e21ea82f65a59a19c4f5c7958a6b92
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 03/22/2021
ms.locfileid: "104825869"
---
# <a name="chapter-1---an-introduction-to-network-address-translation"></a><span data-ttu-id="6dc35-103">Kapitel 1 – en introduktion till nätverks adress Översättning</span><span class="sxs-lookup"><span data-stu-id="6dc35-103">Chapter 1 - An introduction to Network Address Translation</span></span>

## <a name="the-need-for-network-address-translation"></a><span data-ttu-id="6dc35-104">Behovet av nätverks adress Översättning</span><span class="sxs-lookup"><span data-stu-id="6dc35-104">The Need for Network Address Translation</span></span>

<span data-ttu-id="6dc35-105">IP Network Address Translation (NAT) utvecklades ursprungligen för att lösa problemet med ett begränsat antal Internet IPv4-adresser.</span><span class="sxs-lookup"><span data-stu-id="6dc35-105">IP Network Address Translation (NAT) was originally developed to solve the problem of a limited number of Internet IPv4 addresses.</span></span> <span data-ttu-id="6dc35-106">Behovet av NAT uppstår när flera enheter behöver åtkomst till Internet, men endast en IPv4-Internet adress tilldelas av Internet leverantören.</span><span class="sxs-lookup"><span data-stu-id="6dc35-106">The need for NAT arises when multiple devices need to access the Internet but only one IPv4 Internet address is assigned by the Internet Service Provider (ISP).</span></span>

<span data-ttu-id="6dc35-107">Det finns även andra fördelar med att använda NAT.</span><span class="sxs-lookup"><span data-stu-id="6dc35-107">There are other benefits of using NAT as well.</span></span> <span data-ttu-id="6dc35-108">Nätverks sto pol Ogin utanför den lokala domänen kan ändras på många sätt.</span><span class="sxs-lookup"><span data-stu-id="6dc35-108">Network topology outside the local domain can change in many ways.</span></span> <span data-ttu-id="6dc35-109">Kunder kan ändra leverantörer, företagets ben kan omorganiseras, eller så kan leverantörer sammanfogas eller delas.</span><span class="sxs-lookup"><span data-stu-id="6dc35-109">Customers may change providers, company backbones may be reorganized, or providers may merge or split.</span></span> <span data-ttu-id="6dc35-110">När den externa miljön ändras måste även adress tilldelningar för värdar inom den lokala domänen ändras så att de återspeglar dessa externa ändringar.</span><span class="sxs-lookup"><span data-stu-id="6dc35-110">Whenever the external topology changes, address assignments for hosts within the local domain must also change to reflect these external changes.</span></span> <span data-ttu-id="6dc35-111">Ändringar av den här typen kan vara dolda från användare i domänen genom att centralisera ändringar till en router med en enda adress översättning.</span><span class="sxs-lookup"><span data-stu-id="6dc35-111">Changes of this type can be hidden from users within the domain by centralizing changes to a single address translation router.</span></span> <span data-ttu-id="6dc35-112">NAT ger åtkomst för lokala värdar till det offentliga Internet och skyddar dem från direkt åtkomst från utsidan.</span><span class="sxs-lookup"><span data-stu-id="6dc35-112">NAT enables access for local hosts to the public Internet and protects them from direct access from the outside.</span></span> <span data-ttu-id="6dc35-113">Organisationer med en nätverks konfiguration främst för intern användning, med ett behov av tillfällig extern åtkomst är lämpliga kandidater för det här schemat.</span><span class="sxs-lookup"><span data-stu-id="6dc35-113">Organizations with a network setup predominantly for internal use, with a need for occasional external access are good candidates for this scheme.</span></span>

## <a name="basic-nat-and-network-address-port-translation"></a><span data-ttu-id="6dc35-114">Grundläggande NAT-och nätverks adress port Översättning</span><span class="sxs-lookup"><span data-stu-id="6dc35-114">Basic NAT and Network Address Port Translation</span></span>

<span data-ttu-id="6dc35-115">En NAT-aktiverad router installeras mellan det offentliga nätverket och det privata nätverket.</span><span class="sxs-lookup"><span data-stu-id="6dc35-115">A NAT-enabled router is installed between the public network and the private network.</span></span> <span data-ttu-id="6dc35-116">Den NAT-aktiverade routerns roll är att översätta mellan interna privata IPv4-adresser och den tilldelade offentliga IPv4-adressen, så alla enheter i det privata nätverket kan dela samma offentliga IPv4-adress.</span><span class="sxs-lookup"><span data-stu-id="6dc35-116">The role of the NAT-enabled router is to translate between the internal private IPv4 addresses and the assigned public IPv4 address, so all the devices on the private network are able to share the same public IPv4 address.</span></span>

<span data-ttu-id="6dc35-117">I den grundläggande implementeringen av NAT äger NAT-routern en eller flera globalt registrerade IP-adresser som skiljer sig från sin egen IP-adress.</span><span class="sxs-lookup"><span data-stu-id="6dc35-117">In the basic implementation of NAT, the NAT router ‘owns’ one or more globally registered IP addresses different from its own IP address.</span></span> <span data-ttu-id="6dc35-118">Dessa globala adresser är tillgängliga för att tilldelas värdar i det privata nätverket antingen statiskt eller dynamiskt.</span><span class="sxs-lookup"><span data-stu-id="6dc35-118">These global addresses are available to assign to hosts on its private network either statically or dynamically.</span></span> <span data-ttu-id="6dc35-119">NAPT, eller nätverks adress port översättning, är en variant av grundläggande NAT, där Network Address Translation utökas till att inkludera en "transport"-identifierare.</span><span class="sxs-lookup"><span data-stu-id="6dc35-119">NAPT, or Network Address Port Translation, is a variation of basic NAT, where network address translation is extended to include a ‘transport’ identifier.</span></span> <span data-ttu-id="6dc35-120">Oftast är detta port numret för TCP-och UDP-paket och fråge-ID för ICMP-paket.</span><span class="sxs-lookup"><span data-stu-id="6dc35-120">Most typically this is the port number for TCP and UDP packets, and the Query ID for ICMP packets.</span></span>

<span data-ttu-id="6dc35-121">Anslutningar över NAT-gränser initieras vanligt vis av värdar i det privata nätverket som skickar utgående paket till en extern värd.</span><span class="sxs-lookup"><span data-stu-id="6dc35-121">Connections across the NAT boundary are typically initiated by hosts on the private network sending outbound packets to an external host.</span></span> <span data-ttu-id="6dc35-122">Dessa värdar tilldelas vanligt vis *dynamiska* (temporära) IP-adresser för det här ändamålet.</span><span class="sxs-lookup"><span data-stu-id="6dc35-122">These hosts are usually assigned *dynamic* (temporary) IP addresses for this purpose.</span></span> <span data-ttu-id="6dc35-123">Det är dock också möjligt att ha anslutningar som initieras i motsatt riktning om det privata nätverket har "servrar", t. ex. HTTP-eller FTP-servrar som ska ta emot klient begär Anden från det externa nätverket.</span><span class="sxs-lookup"><span data-stu-id="6dc35-123">However, it is also possible to have connections initiated in the opposite direction if the private network has ‘servers’ e.g. HTTP or FTP servers that will accept Client requests from the external network.</span></span> <span data-ttu-id="6dc35-124">NAT tilldelar normalt dessa lokala värdar en *statisk* (permanent) IP-adress: port.</span><span class="sxs-lookup"><span data-stu-id="6dc35-124">NAT will typically assign these local hosts a *static* (permanent) IP address:port.</span></span>

## <a name="how-network-address-translation-works"></a><span data-ttu-id="6dc35-125">Så här fungerar översättning av nätverks adresser</span><span class="sxs-lookup"><span data-stu-id="6dc35-125">How Network Address Translation Works</span></span>

<span data-ttu-id="6dc35-126">En typisk nätverks installation med en NAT-aktiverad router visas i bild 1.</span><span class="sxs-lookup"><span data-stu-id="6dc35-126">A typical network setup with a NAT-enabled router is illustrated in Figure 1.</span></span>

![En typisk nätverks installation med en NAT-aktiverad router](media/image2.png)

<span data-ttu-id="6dc35-128">**Bild 1 – en typisk nätverks installation med en NAT-aktiverad router**</span><span class="sxs-lookup"><span data-stu-id="6dc35-128">**Figure 1 - A typical network setup with a NAT-enabled router**</span></span>

<span data-ttu-id="6dc35-129">En NAT-aktiverad router har vanligt vis två nätverks gränssnitt.</span><span class="sxs-lookup"><span data-stu-id="6dc35-129">A NAT-enabled router typically has two network interfaces.</span></span> <span data-ttu-id="6dc35-130">Ett gränssnitt är anslutet till det offentliga Internet. den andra är ansluten till det privata nätverket.</span><span class="sxs-lookup"><span data-stu-id="6dc35-130">One interface is connected to the public Internet; the other is connected to the private network.</span></span> <span data-ttu-id="6dc35-131">En typisk router i den här konfigurationen ansvarar för att dirigera IP-datagram mellan det privata nätverket och det offentliga nätverket baserat på målets IP-adress.</span><span class="sxs-lookup"><span data-stu-id="6dc35-131">A typical router in this setup is responsible for routing IP datagrams between the private network and the public network based on destination IP address.</span></span> <span data-ttu-id="6dc35-132">En NAT-aktiverad router utför adress översättning innan ett IPv4-datagram dirigeras mellan det offentliga och det privata gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="6dc35-132">A NAT-enabled router performs address translation before routing an IPv4 datagram between the public and the private interface.</span></span> <span data-ttu-id="6dc35-133">En översättning upprättas för varje TCP-eller UDP-session, baserat på den interna käll adressen, käll port numret och den externa mål adressen och mål Port numret.</span><span class="sxs-lookup"><span data-stu-id="6dc35-133">A translation is established for each TCP or UDP session, based the internal source address, source port number, and external destination address and destination port number.</span></span> <span data-ttu-id="6dc35-134">För ICMP-ekobegäran och svar på svar används ICMP-fråge-ID i stället för port numret.</span><span class="sxs-lookup"><span data-stu-id="6dc35-134">For ICMP echo request and response datagram, the ICMP query ID is used instead of the port number.</span></span>

<span data-ttu-id="6dc35-135">För att illustrera en typisk implementering av översättning av nätverks adresser, låt oss ta en nätverks konfiguration i bild 2.</span><span class="sxs-lookup"><span data-stu-id="6dc35-135">To illustrate a typical implementation of Network Address Translation, let us consider a network setup in Figure 2.</span></span>

![En typisk implementering av NAT (Network Address Translation)](media/image3.png)

<span data-ttu-id="6dc35-137">**Bild 2 – en typisk implementering av NAT (Network Address Translation)**</span><span class="sxs-lookup"><span data-stu-id="6dc35-137">**Figure 2 - A typical implementation of Network Address Translation**</span></span>

<span data-ttu-id="6dc35-138">I det här scenariot ansluter NAT-routern det privata nätverket till vänster och det offentliga nätverket till höger.</span><span class="sxs-lookup"><span data-stu-id="6dc35-138">In this scenario, the NAT router connects the private network to the left, and the public network to the right.</span></span> <span data-ttu-id="6dc35-139">Vi antar att IP-adressen för NAT-routerns gränssnitt är 202.151.25.14; i det privata nätverks gränssnittet använder NAT-routern IP-192.168.1.254.</span><span class="sxs-lookup"><span data-stu-id="6dc35-139">Let’s assume on the public network side, the NAT router interface IP address is 202.151.25.14; on the private network interface, the NAT router uses the IP address 192.168.1.254.</span></span> <span data-ttu-id="6dc35-140">En nod i det privata nätverket initierar en TCP-anslutning till en webb server på Internet.</span><span class="sxs-lookup"><span data-stu-id="6dc35-140">A node on the private network initiates a TCP connection with a web server on the Internet.</span></span>

<span data-ttu-id="6dc35-141">Bild 3 visar en övergripande vy över översättnings processen för nätverks adresser.</span><span class="sxs-lookup"><span data-stu-id="6dc35-141">Figure 3 shows a high-level view of the Network Address Translation process.</span></span>

![En övergripande översikt över processen för översättning av nätverks adresser](media/image4.png)

<span data-ttu-id="6dc35-143">**Bild 3 – en övergripande översikt över processen för översättning av nätverks adresser**</span><span class="sxs-lookup"><span data-stu-id="6dc35-143">**Figure 3 - A high-level view of the Network Address Translation process**</span></span>

1. <span data-ttu-id="6dc35-144">Klienten skickar ett TCP-SYN-meddelande till webb servern.</span><span class="sxs-lookup"><span data-stu-id="6dc35-144">Client transmits a TCP SYN message to the web server.</span></span> <span data-ttu-id="6dc35-145">Avsändar adressen är 192.168.1.15, port nummer 6732; mål adressen är 128.15.54.3, port nummer 80.</span><span class="sxs-lookup"><span data-stu-id="6dc35-145">The sender address is 192.168.1.15, port number 6732; the destination address is 128.15.54.3, port number 80.</span></span>
1. <span data-ttu-id="6dc35-146">Paketet från klienten tas emot på det privata nätverks gränssnittet av NAT-routern.</span><span class="sxs-lookup"><span data-stu-id="6dc35-146">The packet from the Client is received on the private network interface by the NAT router.</span></span> <span data-ttu-id="6dc35-147">Regeln för utgående trafik gäller för paketet: avsändarens (klientens) adress översätts till NAT-routerns offentliga IP-202.15.25.14 och avsändar port numret översätts till TCP-port nummer 2015 i det offentliga gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="6dc35-147">The outbound traffic rule applies to the packet: the sender’s (Client’s) address is translated to the NAT router’s public IP address 202.15.25.14, and sender (Client) source port number is translated to the TCP port number 2015 on the public interface.</span></span>
1. <span data-ttu-id="6dc35-148">Paketet skickas sedan via Internet och når slutligen mål värden 128.15.54.3.</span><span class="sxs-lookup"><span data-stu-id="6dc35-148">The packet is then transmitted over the Internet and ultimately reaches its destination host 128.15.54.3.</span></span> <span data-ttu-id="6dc35-149">Observera att på mottagar sidan, baserat på IP-skiktets käll adress och port numret för TCP-skiktet, verkar paketet ha sitt ursprung från 202.151.24.14, port nummer 2015.</span><span class="sxs-lookup"><span data-stu-id="6dc35-149">Notice that on the receiving side, based on the IP layer source address and TCP layer port number, the packet appears to have originated from 202.151.24.14, port number 2015.</span></span>
   <span data-ttu-id="6dc35-150">Bild 4 visar NAT-processen på RETUR Sök vägen.</span><span class="sxs-lookup"><span data-stu-id="6dc35-150">Figure 4 shows the NAT process on the return path.</span></span>

   ![NAT-process på RETUR Sök vägen](media/image5.png)

   <span data-ttu-id="6dc35-152">**Bild 4 – NAT-process på RETUR Sök vägen**</span><span class="sxs-lookup"><span data-stu-id="6dc35-152">**Figure 4 - NAT process on the return path**</span></span>
1. <span data-ttu-id="6dc35-153">I det här scenariot skickar Internet Host-128.15.54.3 ett svars paket med NAT-routerns Internet adress som mål.</span><span class="sxs-lookup"><span data-stu-id="6dc35-153">In this scenario, the Internet host 128.15.54.3 sends a response packet with the NAT router’s Internet address as its destination.</span></span>
1. <span data-ttu-id="6dc35-154">Paketet når NAT-routern.</span><span class="sxs-lookup"><span data-stu-id="6dc35-154">The packet reaches the NAT router.</span></span> <span data-ttu-id="6dc35-155">Eftersom det här är ett bebindt paket gäller de inbounda översättnings reglerna: mål adressen ändras tillbaka till den ursprungliga avsändarens (klient) IP-adress: 192.168.1.15, målport nummer 6732.</span><span class="sxs-lookup"><span data-stu-id="6dc35-155">Since this is an in-bound packet, the in-bound translation rules apply: the destination address is changed back to the original sender’s (Client’s) IP address: 192.168.1.15, destination port number 6732.</span></span>
1. <span data-ttu-id="6dc35-156">Paketet vidarebefordras sedan till klienten via gränssnittet som är anslutet till det interna nätverket.</span><span class="sxs-lookup"><span data-stu-id="6dc35-156">The packet is then forwarded to the Client through the interface that is connected to the internal network.</span></span>

<span data-ttu-id="6dc35-157">På detta sätt exponeras inte Internet nätverks adressen och port numret för avsändaren för andra värdar på det offentliga Internet.</span><span class="sxs-lookup"><span data-stu-id="6dc35-157">In this manner the internet network address and port number of the sender is not exposed to other hosts on the public Internet.</span></span>

## <a name="netx-duo-nat-features"></a><span data-ttu-id="6dc35-158">NetX Duo NAT-funktioner</span><span class="sxs-lookup"><span data-stu-id="6dc35-158">NetX Duo NAT Features</span></span>

<span data-ttu-id="6dc35-159">När NAT-instansen skapas med *nx_nat_create* -anrop skapas NAT-tabellen översättning.</span><span class="sxs-lookup"><span data-stu-id="6dc35-159">When the NAT instance is created using *nx_nat_create* call, the NAT translation table is created.</span></span>

```C
UINT nx_nat_create(NX_NAT_DEVICE *nat_ptr, NX_IP *ip_ptr,
    UINT global_interface_index,
    VOID *dynamic_cache_memory,
    UINT dynamic_cache_size);
```

<span data-ttu-id="6dc35-160">För att hålla koll på nätverks adress översättningarna för alla aktiva anslutningar mellan lokala och externa nätverk, upprätthåller den NetX Duo NAT-aktiverade routern en översättnings tabell med information om varje privat värd anslutning som innefattar käll-och mål-IP-adress och port nummer.</span><span class="sxs-lookup"><span data-stu-id="6dc35-160">To keep track of the network address translations for all active connections between local and external networks, the NetX Duo NAT-enabled router maintains a translation table with information about each private host connection which includes source and destination IP address and port number.</span></span>

<span data-ttu-id="6dc35-161">Platsen för översättnings tabellen ("cache") anges med dynamic_cache_memory-pekaren.</span><span class="sxs-lookup"><span data-stu-id="6dc35-161">The location of this translation table (“cache”) is set with the dynamic_cache_memory pointer.</span></span> <span data-ttu-id="6dc35-162">Det här området måste vara 4 byte-justerat buffertutrymme.</span><span class="sxs-lookup"><span data-stu-id="6dc35-162">This area must be a 4 byte aligned buffer space.</span></span> <span data-ttu-id="6dc35-163">Storleken på tabellen (eller antalet poster) bestäms genom att den cachelagrade cachestorleken divideras dynamic_cache_size av storleken på en tabell post i NAT.</span><span class="sxs-lookup"><span data-stu-id="6dc35-163">The size of the table (or number of entries) is determined by dividing the cache size dynamic_cache_size by the size of a NAT table entry.</span></span> <span data-ttu-id="6dc35-164">Tabellen måste vara tillräckligt stor för det minimala antalet poster som anges av **NX_NAT_MIN_ENTRY_COUNT som definieras i *nx_nat. h*. Standardvärdet är 3.**</span><span class="sxs-lookup"><span data-stu-id="6dc35-164">The table must be large enough for the minimal number of entries specified by **NX_NAT_MIN_ENTRY_COUNT which is defined in *nx_nat.h*. The default value is 3.**</span></span>

<span data-ttu-id="6dc35-165">Tids gränsen för alla dynamiska poster i översättnings tabellen NetX Duo NAT initieras till NX_NAT_ENTRY_RESPONSE_TIMEOUT som definieras i *nx_nat. h*.</span><span class="sxs-lookup"><span data-stu-id="6dc35-165">The timeout for all dynamic entries in the NetX Duo NAT translation table are initialized to NX_NAT_ENTRY_RESPONSE_TIMEOUT which is defined in *nx_nat.h*.</span></span> <span data-ttu-id="6dc35-166">Standardvärdet är 4 minuter (eller 240 system Tick för en 100 mHz-processor) enligt rekommendationerna i RFC 2663.</span><span class="sxs-lookup"><span data-stu-id="6dc35-166">The default value is 4 minutes (or 240 system ticks for a 100 mHz processor) as recommended by RFC 2663.</span></span> <span data-ttu-id="6dc35-167">Varje gång NetX Duo NAT tar emot eller skickar ett paket som matchar en dynamisk post i tabellen återställs tids gränsen för posten till NX_NAT_ENTRY_RESPONSE_TIMEOUT.</span><span class="sxs-lookup"><span data-stu-id="6dc35-167">Each time NetX Duo NAT receives or sends a packet matching a dynamic entry in the table it resets that entry’s time out to NX_NAT_ENTRY_RESPONSE_TIMEOUT.</span></span> <span data-ttu-id="6dc35-168">När du söker i tabellen kommer även NetX Duo NAT att kontrol lera tabellen för utgångna poster och ta bort dem.</span><span class="sxs-lookup"><span data-stu-id="6dc35-168">When searching the table, NetX Duo NAT will also check the table for expired entries and delete them.</span></span>

<span data-ttu-id="6dc35-169">Om du vill skapa inkommande poster som statiska i tabellen, t. ex. för servrar i det lokala nätverket, tillhandahåller NetX Duo NAT *nx_nat_inbound_entry_create* -tjänsten.</span><span class="sxs-lookup"><span data-stu-id="6dc35-169">To create inbound entries as static in the table e.g. for servers on the local network, NetX Duo NAT provides the *nx_nat_inbound_entry_create* service.</span></span> <span data-ttu-id="6dc35-170">Om en tabell post definierar den lokala värd anslutningen som statisk upphör den aldrig att gälla.</span><span class="sxs-lookup"><span data-stu-id="6dc35-170">If a table entry defines the local host connection as static, it never expires.</span></span>

```C
UINT nx_nat_inbound_entry_create(NX_NAT_DEVICE *nat_ptr,
    NX_NAT_TRANSLATION_ENTRY *entry_ptr,
    ULONG local_ip_address, USHORT external_port,
    USHORT local_port, UCHAR protocol);
```

<span data-ttu-id="6dc35-171">Den här tjänsten beskrivs i detalj i [kapitel 4 – Beskrivning av tjänster](chapter4.md)</span><span class="sxs-lookup"><span data-stu-id="6dc35-171">This service is described in more detail in [Chapter 4 - Description of Services](chapter4.md)</span></span>

<span data-ttu-id="6dc35-172">Om översättnings tabellen är full och det inte går att lägga till fler poster under körningen, kommer NetX Duo NAT att meddela NAT-programmet med en cache-fullständig motringning om en är registrerad hos NAT-instansen.</span><span class="sxs-lookup"><span data-stu-id="6dc35-172">During runtime, if the translation table is full and no more entries can be added, NetX Duo NAT will notify the NAT application with a cache full callback if one is registered with the NAT instance.</span></span> <span data-ttu-id="6dc35-173">Detta görs med hjälp av tjänsten *nx_nat_cache_notify_set* :</span><span class="sxs-lookup"><span data-stu-id="6dc35-173">This is done using the *nx_nat_cache_notify_set* service:</span></span>

```C
UINT nx_nat_cache_notify_set(NX_NAT_DEVICE *nat_ptr,
    VOID (*cache_full_notify_cb)(NX_NAT_DEVICE *nat_ptr));
```

<span data-ttu-id="6dc35-174">Se [kapitel 4 – Beskrivning av tjänster](chapter4.md) för mer information om den här tjänsten.</span><span class="sxs-lookup"><span data-stu-id="6dc35-174">See [Chapter 4 - Description of Services](chapter4.md) for more details about this service.</span></span>

## <a name="nat-packet-processing-in-netx-duo"></a><span data-ttu-id="6dc35-175">Bearbetning av NAT-paket i NetX Duo</span><span class="sxs-lookup"><span data-stu-id="6dc35-175">NAT Packet Processing in NetX Duo</span></span>

<span data-ttu-id="6dc35-176">NetX Duo NAT är avsett att användas på en IPv4-router.</span><span class="sxs-lookup"><span data-stu-id="6dc35-176">NetX Duo NAT is intended for use on an IPv4 router.</span></span> <span data-ttu-id="6dc35-177">För att NAT ska fungera måste NetX Duo konfigureras för att vidarebefordra paket till NAT-servern.</span><span class="sxs-lookup"><span data-stu-id="6dc35-177">For NAT to work, NetX Duo must be configured for forwarding packets to the NAT server.</span></span> <span data-ttu-id="6dc35-178">Mer information om hur du gör detta finns i kapitel 2 på NetX Duo NAT-installation.</span><span class="sxs-lookup"><span data-stu-id="6dc35-178">See Chapter 2 on NetX Duo NAT installation for how to do so.</span></span> <span data-ttu-id="6dc35-179">NAT-servern anger sedan om den kommer att förbruka (försöker vidarebefordra) paketet till en värd i något av dess nätverk.</span><span class="sxs-lookup"><span data-stu-id="6dc35-179">The NAT server then indicates if it will ‘consume’ (attempt to forward) the packet to a host on either of its networks.</span></span> <span data-ttu-id="6dc35-180">Om det inte kommer att använda paketet returneras paketet till NetX Duo för att bearbeta paketet som vanligt.</span><span class="sxs-lookup"><span data-stu-id="6dc35-180">If it will not consume the packet, the packet is ‘returned’ to NetX Duo to process the packet as it normally would.</span></span>

<span data-ttu-id="6dc35-181">När NAT-servern tar emot ett paket för att vidarebefordra från NetX Duo fastställer det om paketet är inkommande eller utgående.</span><span class="sxs-lookup"><span data-stu-id="6dc35-181">When the NAT server receives a packet to forward from NetX Duo, it determines if the packet is inbound or outbound.</span></span>

<span data-ttu-id="6dc35-182">För utgående paket kontrollerar NAT-servern paketets IP-rubriks käll adress och port.</span><span class="sxs-lookup"><span data-stu-id="6dc35-182">For outbound packets, the NAT server checks the packet IP header source address and port.</span></span> <span data-ttu-id="6dc35-183">Om översättnings tabellen inte innehåller någon post för ett paket som tidigare har skickats av denna värd för samma mål, kommer NAT att skapa en ny post som innehåller en unik IP-adress för global Källa: port för anslutningen och ändra paket rubrikerna med den nya IP-adressen: port innan du skickar den till det externa nätverket.</span><span class="sxs-lookup"><span data-stu-id="6dc35-183">If the translation table does not contain an entry for a packet previously sent by this host for the same destination, NAT will create a new entry which will contain a unique global source IP address:port for the connection, and modify the packet headers with this new IP address:port before sending it onto the external network.</span></span>

<span data-ttu-id="6dc35-184">För inkommande paket söker NAT-servern efter en tidigare post i översättnings tabellen med en extern IP-adress: port som matchar paket målets IP-adress: port.</span><span class="sxs-lookup"><span data-stu-id="6dc35-184">For inbound packets, the NAT server looks for a previous entry in its translation table with an external IP address: port matching the packet destination IP address: port.</span></span> <span data-ttu-id="6dc35-185">Om ingen matchning hittas, ignoreras paketet om inte mål adressen: port är den externa adressen för servern i det lokala nätverket.</span><span class="sxs-lookup"><span data-stu-id="6dc35-185">If no match is found, it will discard the packet unless the destination address: port is the external address for server on the local network.</span></span> <span data-ttu-id="6dc35-186">Om den hittar en matchning ersätter den paket huvudets externa mål-IP-adress: port med den privata IP-adressen: port och skicka paketet till det lokala nätverket till den avsedda privata värden.</span><span class="sxs-lookup"><span data-stu-id="6dc35-186">If it does find a match, it will replace the packet header’s external destination IP address: port with the private IP address: port and send the packet onto the local network to the intended private host.</span></span>

<span data-ttu-id="6dc35-187">NetX Duo NAT använder en mängd TCP-, UDP-och ICMP-förflyttningsverktyget för att skapa unik lokal adress: port anslutningar för lokala värdar som ansluter med externa värdar.</span><span class="sxs-lookup"><span data-stu-id="6dc35-187">NetX Duo NAT uses a range of TCP, UDP and ICMP translation ports for creating unique local address: port connections for local hosts connecting with outside hosts.</span></span> <span data-ttu-id="6dc35-188">Följande användar konfigurerbara alternativ, definierade i *nx_nat. h,* definierar intervallet för varje protokoll:</span><span class="sxs-lookup"><span data-stu-id="6dc35-188">The following user configurable options, defined in *nx_nat.h,* define the range for each protocol:</span></span>

```C
NX_NAT_START_TCP_PORT

NX_NAT_END_TCP_PORT

NX_NAT_START_UDP_PORT

NX_NAT_END_UDP_PORT

NX_NAT_START_ICMP_QUERY_ID

NX_NAT_END_ICMP_QUERY_ID
```

## <a name="nat-requirements-and-constraints"></a><span data-ttu-id="6dc35-189">NAT-krav och begränsningar</span><span class="sxs-lookup"><span data-stu-id="6dc35-189">NAT Requirements and Constraints</span></span>

<span data-ttu-id="6dc35-190">NetX Duo NAT kräver NetX Duo 5,8 eller senare.</span><span class="sxs-lookup"><span data-stu-id="6dc35-190">NetX Duo NAT requires NetX Duo 5.8 or later.</span></span> <span data-ttu-id="6dc35-191">NAT-programmet kräver att en enskild IP-instans skapas och ett gränssnitt till det interna och externa fysiska nätverket.</span><span class="sxs-lookup"><span data-stu-id="6dc35-191">The NAT application requires creation of a single IP instance and an interface to the internal and external physical network.</span></span>

<span data-ttu-id="6dc35-192">Begränsningar</span><span class="sxs-lookup"><span data-stu-id="6dc35-192">Constraints:</span></span>

- <span data-ttu-id="6dc35-193">NetX Duo NAT stöder TCP, UDP och ICMP.</span><span class="sxs-lookup"><span data-stu-id="6dc35-193">NetX Duo NAT supports TCP, UDP and ICMP.</span></span> <span data-ttu-id="6dc35-194">IGMP stöds inte.</span><span class="sxs-lookup"><span data-stu-id="6dc35-194">IGMP is not supported.</span></span>
- <span data-ttu-id="6dc35-195">NetX Duo NAT stöder inte IPv6-adressering.</span><span class="sxs-lookup"><span data-stu-id="6dc35-195">NetX Duo NAT does not support IPv6 addressing.</span></span>
- <span data-ttu-id="6dc35-196">NetX Duo NAT inkluderar inte DNS-eller DHCP-tjänster, men NetX Duo NAT kan integrera dessa tjänster med sina NAT-åtgärder.</span><span class="sxs-lookup"><span data-stu-id="6dc35-196">NetX Duo NAT does not include DNS or DHCP services, although NetX Duo NAT can integrate those services with its NAT operations.</span></span>

## <a name="rfcs-supported-by-netx-duo-nat"></a><span data-ttu-id="6dc35-197">RFC: er som stöds av NetX Duo NAT</span><span class="sxs-lookup"><span data-stu-id="6dc35-197">RFCs Supported by NetX Duo NAT</span></span>

<span data-ttu-id="6dc35-198">NetX Duo NAT-implementeringen baseras på information som presenteras i följande RFC: er:</span><span class="sxs-lookup"><span data-stu-id="6dc35-198">NetX Duo NAT implementation is based on information presented in the following RFCs:</span></span>

- <span data-ttu-id="6dc35-199">RFC 2663: terminologi och överväganden för IP-NAT (Network Address Translator)</span><span class="sxs-lookup"><span data-stu-id="6dc35-199">RFC 2663: IP Network Address Translator (NAT) Terminology and Considerations</span></span>
- <span data-ttu-id="6dc35-200">RFC 3022: traditionell IP nätverket Address Translator (traditionell NAT)</span><span class="sxs-lookup"><span data-stu-id="6dc35-200">RFC 3022: Traditional IP Netowrk Address Translator (Traditional NAT)</span></span>
- <span data-ttu-id="6dc35-201">RFC 4787: beteende krav för NAT (Network Address Translation) för unicast UDP</span><span class="sxs-lookup"><span data-stu-id="6dc35-201">RFC 4787: Network Address Translation (NAT) Behavioral Requirements for Unicast UDP</span></span>
