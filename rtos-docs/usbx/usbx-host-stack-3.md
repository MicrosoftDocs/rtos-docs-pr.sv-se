---
title: Kapitel 3 – funktionella komponenter i USBX Host stack
description: Det här kapitlet innehåller en beskrivning av USBX-stacken med hög prestanda för inbäddade USB-värdar från ett funktionellt perspektiv.
author: philmea
ms.author: philmea
ms.date: 5/19/2020
ms.service: rtos
ms.topic: article
ms.openlocfilehash: 17b8d884dd2c71d60e91f5fcec40c360060f4fe8
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 03/22/2021
ms.locfileid: "104828368"
---
# <a name="chapter-3---functional-components-of-usbx-host-stack"></a><span data-ttu-id="8c6f2-103">Kapitel 3 – funktionella komponenter i USBX Host stack</span><span class="sxs-lookup"><span data-stu-id="8c6f2-103">Chapter 3 - Functional Components of USBX Host Stack</span></span>

<span data-ttu-id="8c6f2-104">Det här kapitlet innehåller en beskrivning av USBX-stacken med hög prestanda för inbäddade USB-värdar från ett funktionellt perspektiv.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-104">This chapter contains a description of the high performance USBX embedded USB host stack from a functional perspective.</span></span>

## <a name="execution-overview"></a><span data-ttu-id="8c6f2-105">Översikt över körning</span><span class="sxs-lookup"><span data-stu-id="8c6f2-105">Execution Overview</span></span>

<span data-ttu-id="8c6f2-106">USBX består av flera komponenter:</span><span class="sxs-lookup"><span data-stu-id="8c6f2-106">USBX is composed of several components:</span></span>

- <span data-ttu-id="8c6f2-107">Initiering</span><span class="sxs-lookup"><span data-stu-id="8c6f2-107">Initialization</span></span>
- <span data-ttu-id="8c6f2-108">Program gränssnitts anrop</span><span class="sxs-lookup"><span data-stu-id="8c6f2-108">Application interface calls</span></span>
- <span data-ttu-id="8c6f2-109">Root Hub</span><span class="sxs-lookup"><span data-stu-id="8c6f2-109">Root Hub</span></span>
- <span data-ttu-id="8c6f2-110">NAV klass</span><span class="sxs-lookup"><span data-stu-id="8c6f2-110">Hub Class</span></span>
- <span data-ttu-id="8c6f2-111">Värd klasser</span><span class="sxs-lookup"><span data-stu-id="8c6f2-111">Host Classes</span></span>
- <span data-ttu-id="8c6f2-112">USB-värd, stack</span><span class="sxs-lookup"><span data-stu-id="8c6f2-112">USB Host Stack</span></span>
- <span data-ttu-id="8c6f2-113">Värd styrenhet</span><span class="sxs-lookup"><span data-stu-id="8c6f2-113">Host controller</span></span>

<span data-ttu-id="8c6f2-114">I följande diagram illustreras USBX-värds Tacken.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-114">The following diagram illustrates the USBX host stack.</span></span>

![USBX värds tack](./media/usbx-host-stack/usbx-host-stack.png)

### <a name="initialization"></a><span data-ttu-id="8c6f2-116">Initiering</span><span class="sxs-lookup"><span data-stu-id="8c6f2-116">Initialization</span></span>

<span data-ttu-id="8c6f2-117">Funktionen ***ux_system_initialize*** måste anropas för att aktivera USBX.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-117">In order to activate USBX, the function ***ux_system_initialize*** must be called.</span></span> <span data-ttu-id="8c6f2-118">Den här funktionen initierar minnes resurserna för USBX.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-118">This function initializes the memory resources of USBX.</span></span>

<span data-ttu-id="8c6f2-119">Funktionen ***ux_host_stack_initialize*** måste anropas för att aktivera USBX-värd anläggningar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-119">In order to activate USBX host facilities, the function ***ux_host_stack_initialize*** must be called.</span></span> <span data-ttu-id="8c6f2-120">Den här funktionen kommer i sin tur initiera alla resurser som används av USBX-värd stacken, till exempel ThreadX-trådar, mutexer och semaforer.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-120">This function will in turn initialize all the resources used by the USBX host stack such as ThreadX threads, mutexes, and semaphores.</span></span>

<span data-ttu-id="8c6f2-121">Det är upp till program initieringen att aktivera minst en USB-värdstyrenhet och en eller flera USB-klasser.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-121">It is up to the application initialization to activate at least one USB host controller and one or more USB classes.</span></span> <span data-ttu-id="8c6f2-122">När klasserna har registrerats till stacken och värd styrenhetens (a) initierings funktion har anropats är bussen aktiv och enhets identifieringen kan starta.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-122">When the classes have been registered to the stack and the host controller(s) initialization function has been called the bus is active and device discovery can start.</span></span> <span data-ttu-id="8c6f2-123">Om värd styrenhetens rotmål identifierar en ansluten enhet, aktive ras USB-uppräknings tråden som är ansvarig för USB-topologin och fortsätter att räkna upp enhet (er).</span><span class="sxs-lookup"><span data-stu-id="8c6f2-123">If the root hub of the host controller detects an attached device, the USB enumeration thread, in charge of the USB topology, will be wake up and proceed to enumerate the device(s).</span></span>

<span data-ttu-id="8c6f2-124">Därför är det möjligt att alla anslutna USB-enheter kanske inte har kon figurer ATS helt när värd styrenhetens initierings funktion returnerar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-124">It is possible, due to the nature of the root hub and downstream hubs, that all attached USB devices may not have been configured completely when the host controller initialization function returns.</span></span> <span data-ttu-id="8c6f2-125">Det kan ta flera sekunder att räkna upp alla USB-enheter, särskilt om det finns ett eller flera hubbar mellan rotnavet och USB-enheter.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-125">It can take several seconds to enumerate all USB devices, especially if there are one or more hubs between the root hub and USB devices.</span></span>

### <a name="application-interface-calls"></a><span data-ttu-id="8c6f2-126">Program gränssnitts anrop</span><span class="sxs-lookup"><span data-stu-id="8c6f2-126">Application Interface Calls</span></span>

<span data-ttu-id="8c6f2-127">Det finns två nivåer av API: er i USBX.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-127">There are two levels of APIs in USBX.</span></span>

- <span data-ttu-id="8c6f2-128">Stack-API: er för USB-värd</span><span class="sxs-lookup"><span data-stu-id="8c6f2-128">USB Host Stack APIs</span></span>
- <span data-ttu-id="8c6f2-129">API: er för USB-värd klass</span><span class="sxs-lookup"><span data-stu-id="8c6f2-129">USB Host Class APIs</span></span>

<span data-ttu-id="8c6f2-130">Normalt behöver ett USBX-program inte anropa någon av USB-värdens stack-API-funktioner.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-130">Normally, a USBX application should not have to call any of the USB host stack API functions.</span></span> <span data-ttu-id="8c6f2-131">De flesta program får bara åtkomst till API-funktionerna i USB-klass.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-131">Most applications will only access the USB Class API functions.</span></span>

### <a name="usb-host-stack-apis"></a><span data-ttu-id="8c6f2-132">Stack-API: er för USB-värd</span><span class="sxs-lookup"><span data-stu-id="8c6f2-132">USB Host Stack APIs</span></span>

<span data-ttu-id="8c6f2-133">API-funktionerna i värd stacken ansvarar för registreringen av USBX-komponenter (värd klasser och värd styrenheter), konfiguration av enheter och överförings begär Anden för tillgängliga enhets slut punkter.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-133">The host stack API functions are responsible for the registration of USBX components (host classes and host controllers), configuration of devices, and the transfer requests for available device endpoints.</span></span>

### <a name="usb-host-class-api"></a><span data-ttu-id="8c6f2-134">API för USB-värd klass</span><span class="sxs-lookup"><span data-stu-id="8c6f2-134">USB Host Class API</span></span>

<span data-ttu-id="8c6f2-135">Klass-API: erna är särskilt speciella för varje USB-klass.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-135">The Class APIs are very specific to each USB class.</span></span> <span data-ttu-id="8c6f2-136">De flesta vanliga API-funktioner för USB-klasser tillhandahåller tjänster som att öppna/stänga en enhet och läsa från och skriva till en enhet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-136">Most of the common API functions for USB classes provide services such as opening/closing a device and reading from and writing to a device.</span></span>

### <a name="root-hub"></a><span data-ttu-id="8c6f2-137">Root Hub</span><span class="sxs-lookup"><span data-stu-id="8c6f2-137">Root Hub</span></span>

<span data-ttu-id="8c6f2-138">Varje värd styrenhets instans har ett eller flera USB-rotnav.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-138">Each host controller instance has one or more USB root hubs.</span></span> <span data-ttu-id="8c6f2-139">Antalet rot nav bestäms antingen av styrenhetens typ eller kan hämtas genom att läsa specifika register från kontroll enheten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-139">The number of root hubs is either determined by the nature of the controller or can be retrieved by reading specific registers from the controller.</span></span>

### <a name="hub-class"></a><span data-ttu-id="8c6f2-140">NAV klass</span><span class="sxs-lookup"><span data-stu-id="8c6f2-140">Hub Class</span></span>

<span data-ttu-id="8c6f2-141">NAV klassen är ansvarig för USB-hubbar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-141">The hub class is in charge of driving USB hubs.</span></span> <span data-ttu-id="8c6f2-142">En USB-hubb kan antingen vara en fristående hubb eller som en del av en sammansatt enhet, till exempel ett tangent bord eller en övervakare.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-142">A USB hub can either be a stand-alone hub or as part of a compound device such as a keyboard or a monitor.</span></span> <span data-ttu-id="8c6f2-143">En hubb kan vara oberoende eller bussad.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-143">A hub can be self-powered or bus-powered.</span></span> <span data-ttu-id="8c6f2-144">Buss drivna nav har högst fyra underordnade portar och kan bara tillåta anslutning av enheter som antingen är självständiga eller bussbaserade enheter som använder mindre än 100mA energi.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-144">Bus-powered hubs have a maximum of four downstream ports and can only allow for the connection of devices that are either self-powered or bus-powered devices that use less than 100mA of power.</span></span> <span data-ttu-id="8c6f2-145">Hubbar kan överlappa varandra.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-145">Hubs can be cascaded.</span></span> <span data-ttu-id="8c6f2-146">Upp till fem hubbar kan vara anslutna till varandra.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-146">Up to five hubs can be connected to one another.</span></span>

### <a name="usb-host-stack"></a><span data-ttu-id="8c6f2-147">USB-värd, stack</span><span class="sxs-lookup"><span data-stu-id="8c6f2-147">USB Host Stack</span></span>

<span data-ttu-id="8c6f2-148">USB-värdstyrenheten är centerpiece för USBX.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-148">The USB host stack is the centerpiece of USBX.</span></span> <span data-ttu-id="8c6f2-149">Den har tre huvud funktioner.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-149">It has three main functions.</span></span>

- <span data-ttu-id="8c6f2-150">Hantera USB-topologin.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-150">Manage the topology of the USB.</span></span>
- <span data-ttu-id="8c6f2-151">Bind en USB-enhet till en eller flera klasser.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-151">Bind a USB device to one or more classes.</span></span>
- <span data-ttu-id="8c6f2-152">Ange ett API för klasser för att utföra förhör av enhets beskrivningar och USB-överföringar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-152">Provide an API to classes to perform device descriptor interrogation and USB transfers.</span></span>

### <a name="topology-manager"></a><span data-ttu-id="8c6f2-153">Topology Manager</span><span class="sxs-lookup"><span data-stu-id="8c6f2-153">Topology Manager</span></span>

<span data-ttu-id="8c6f2-154">Tråden för USB-stack-topologi är aktive ras när en ny enhet är ansluten eller när en enhet har kopplats från.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-154">The USB stack topology thread is awakened when a new device is connected or when a device has been disconnected.</span></span> <span data-ttu-id="8c6f2-155">Antingen rot navet eller en vanlig hubb kan du acceptera enhets anslutningar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-155">Either the root hub or a regular hub can accept device connections.</span></span> <span data-ttu-id="8c6f2-156">När en enhet har anslutits till USB-enheten hämtar Topology Manager enhets beskrivningen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-156">Once a device has been connected to the USB, the topology manager will retrieve the device descriptor.</span></span> <span data-ttu-id="8c6f2-157">Den här beskrivningen kommer att innehålla antalet möjliga konfigurationer som är tillgängliga för den här enheten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-157">This descriptor will contain the number of possible configurations available for this device.</span></span> <span data-ttu-id="8c6f2-158">De flesta enheter har bara en konfiguration.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-158">Most devices have one configuration only.</span></span> <span data-ttu-id="8c6f2-159">Vissa enheter kan användas på olika sätt beroende på vilken ström som är tillgänglig på den port där den är ansluten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-159">Some devices can operate differently according to the available power available on the port where it is connected.</span></span> <span data-ttu-id="8c6f2-160">I så fall har enheten flera konfigurationer som kan väljas beroende på tillgänglig ström.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-160">If this is the case, the device will have multiple configurations that can be selected depending on the available power.</span></span> <span data-ttu-id="8c6f2-161">När enheten har kon figurer ATS av Topology Manager, tillåts den mängden energi som anges i konfigurations beskrivningen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-161">When the device is configured by the topology manager, it is then allowed to draw the amount of power specified in its configuration descriptor.</span></span>

## <a name="usb-class-binding"></a><span data-ttu-id="8c6f2-162">Bindning av USB-klass</span><span class="sxs-lookup"><span data-stu-id="8c6f2-162">USB Class Binding</span></span>

<span data-ttu-id="8c6f2-163">När enheten har kon figurer ATS tillåter Topology Manager att klass hanteraren fortsätter enhets identifieringen genom att titta på enhets gränssnittets beskrivningar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-163">When the device is configured, the topology manager will let the class manager continue the device discovery by looking at the device interface descriptors.</span></span> <span data-ttu-id="8c6f2-164">En enhet kan ha en eller flera gränssnitts beskrivningar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-164">A device can have one or more interface descriptors.</span></span>

<span data-ttu-id="8c6f2-165">Ett gränssnitt representerar en funktion i en enhet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-165">An interface represents a function in a device.</span></span> <span data-ttu-id="8c6f2-166">Till exempel har en USB-högtalare tre gränssnitt, en för ljud uppspelning, en för ljud kontroll och en för att hantera de olika högtalar knapparna.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-166">For instance, a USB speaker has three interfaces, one for audio streaming, one for audio control, and one to manage the various speaker buttons.</span></span>

<span data-ttu-id="8c6f2-167">Klass hanteraren har två mekanismer för att ansluta enhets gränssnitten till en eller flera klasser.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-167">The class manager has two mechanisms to join the device interface(s) to one or more classes.</span></span> <span data-ttu-id="8c6f2-168">Den kan antingen använda kombinationen av ett PID/VID (produkt-ID och leverantörs-ID) som finns i gränssnitts beskrivningen eller kombinationen av klass/underklass/protokoll.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-168">It can either use the combination of a PID/VID (product ID and vendor ID) found in the interface descriptor or the combination of Class/Subclass/Protocol.</span></span>

<span data-ttu-id="8c6f2-169">PID/VID-kombinationen är giltig för gränssnitt som inte kan drivas av en generisk klass.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-169">The PID/VID combination is valid for interfaces that cannot be driven by a generic class.</span></span> <span data-ttu-id="8c6f2-170">Kombinationen klass/underklass/protokoll används av gränssnitt som tillhör en USB-IF-certifierad klass, till exempel en skrivare, hubb, lagring, ljud eller HID.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-170">The Class/Subclass/Protocol combination is used by interfaces that belong to a USB-IF certified class such as a printer, hub, storage, audio, or HID.</span></span>

<span data-ttu-id="8c6f2-171">Klass hanteraren innehåller en lista över registrerade klasser från initieringen av USBX.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-171">The class manager contains a list of registered classes from the initialization of USBX.</span></span> <span data-ttu-id="8c6f2-172">Klass hanteraren anropar varje klass en i taget tills en klass accepterar för att hantera gränssnittet för enheten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-172">The class manager will call each class one at a time until one class accepts to manage the interface for that device.</span></span> <span data-ttu-id="8c6f2-173">En klass kan bara hantera ett gränssnitt.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-173">A class can only manage one interface.</span></span> <span data-ttu-id="8c6f2-174">I exempel på USB-ljudhögtalare kommer klass hanteraren att anropa alla klasser för var och en av gränssnitten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-174">For the example of the USB audio speaker, the class manager will call all the classes for each of the interfaces.</span></span>

<span data-ttu-id="8c6f2-175">När en klass accepterar ett gränssnitt skapas en ny instans av klassen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-175">Once a class accepts an interface, a new instance of that class is created.</span></span> <span data-ttu-id="8c6f2-176">Klass hanteraren kommer sedan att söka efter standard alternativ inställningen för gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-176">The class manager will then search for the default alternate setting for the interface.</span></span> <span data-ttu-id="8c6f2-177">En enhet kan ha en eller flera alternativa inställningar för varje gränssnitt.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-177">A device may have one or more alternate settings for each interface.</span></span> <span data-ttu-id="8c6f2-178">Den alternativa inställningen 0 används som standard tills en klass bestämmer sig för att ändra den.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-178">The alternate setting 0 will be the on used by default until a class decides to change it.</span></span>

<span data-ttu-id="8c6f2-179">För standard alternativ inställningen monterar klass hanteraren alla slut punkter som ingår i den alternativa inställningen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-179">For the default alternate setting, the class manager will mount all the endpoints contained in the alternate setting.</span></span> <span data-ttu-id="8c6f2-180">Om monteringen av varje slut punkt lyckas Slutför klass hanteraren sitt jobb genom att gå tillbaka till den klass som avslutar initieringen av gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-180">If the mounting of each endpoint is successful, the class manager will complete its job by returning to the class that will finish the initialization of the interface.</span></span>

### <a name="usbx-apis"></a><span data-ttu-id="8c6f2-181">USBX-API: er</span><span class="sxs-lookup"><span data-stu-id="8c6f2-181">USBX APIs</span></span>

<span data-ttu-id="8c6f2-182">USB-stacken exporterar ett visst antal API: er för USB-klasserna för att utföra förhör på enheten och USB-överföringar på specifika slut punkter.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-182">The USB stack exports a certain number of APIs for the USB classes to perform interrogation on the device and USB transfers on specific endpoints.</span></span> <span data-ttu-id="8c6f2-183">Dessa API-funktioner beskrivs i detalj i den här referens hand boken.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-183">These API functions are described in detail in this reference manual.</span></span>

### <a name="host-controller"></a><span data-ttu-id="8c6f2-184">Värd styrenhet</span><span class="sxs-lookup"><span data-stu-id="8c6f2-184">Host Controller</span></span>

<span data-ttu-id="8c6f2-185">Värd styrenhetens driv rutin ansvarar för att köra en speciell typ av USB-styrenhet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-185">The host controller driver is responsible for driving a specific type of USB controller.</span></span> <span data-ttu-id="8c6f2-186">En USB-värdstyrenhet kan ha flera styrenheter i.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-186">A USB host controller can have multiple controllers inside.</span></span> <span data-ttu-id="8c6f2-187">Vissa Intel PC-chipset innehåller till exempel två UHCI-kontrollanter.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-187">For instance, certain Intel PC chipset contain two UHCI controllers.</span></span> <span data-ttu-id="8c6f2-188">Vissa USB 2,0-styrenheter innehåller flera instanser av en OHCI-styrenhet, förutom en instans av EHCI-styrenheten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-188">Some USB 2.0 controllers contain multiple instances of an OHCI controller in addition to one instance of the EHCI controller.</span></span>

<span data-ttu-id="8c6f2-189">Värd styrenheten hanterar bara flera instanser av samma kontrollant.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-189">The Host controller will manage multiple instance of the same controller only.</span></span> <span data-ttu-id="8c6f2-190">För att kunna driva de flesta USB 2,0-värd styrenheter måste du initiera både OCHI-styrenheten och EHCI-styrenheten under initieringen av USBX.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-190">In order to drive most USB 2.0 host controllers, it will be required to initialize both the OCHI controller and the EHCI controller during the initialization of USBX.</span></span>

<span data-ttu-id="8c6f2-191">Värd styrenheten ansvarar för att hantera följande.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-191">The host controller is responsible for managing the following.</span></span>

- <span data-ttu-id="8c6f2-192">Root Hub</span><span class="sxs-lookup"><span data-stu-id="8c6f2-192">Root Hub</span></span>
- <span data-ttu-id="8c6f2-193">Energisparfunktioner</span><span class="sxs-lookup"><span data-stu-id="8c6f2-193">Power Management</span></span>
- <span data-ttu-id="8c6f2-194">Slutpunkter</span><span class="sxs-lookup"><span data-stu-id="8c6f2-194">Endpoints</span></span>
- <span data-ttu-id="8c6f2-195">Överlåtelse</span><span class="sxs-lookup"><span data-stu-id="8c6f2-195">Transfers</span></span>

### <a name="root-hub"></a><span data-ttu-id="8c6f2-196">Root Hub</span><span class="sxs-lookup"><span data-stu-id="8c6f2-196">Root Hub</span></span>

<span data-ttu-id="8c6f2-197">Hantering av rot nav ansvarar för att starta varje styrenhets port och bestämma om en enhet har satts in eller inte.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-197">The root hub management is responsible for the powering up of each controller port and determining if there is a device inserted or not.</span></span> <span data-ttu-id="8c6f2-198">Den här funktionen används av USBX Generic root Hub för att kunna använda kontrollantens underordnade portar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-198">This functionality is used by the USBX generic root hub to interrogate the controller downstream ports.</span></span>

### <a name="power-management"></a><span data-ttu-id="8c6f2-199">Energisparfunktioner</span><span class="sxs-lookup"><span data-stu-id="8c6f2-199">Power Management</span></span>

<span data-ttu-id="8c6f2-200">Bearbetningen av energispar funktioner gör att du kan hantera PAUSE/återuppta signaler antingen i Gang-läge, vilket påverkar alla underordnade portar på samma gång, eller individuellt om kontrollanten erbjuder den här funktionen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-200">The power management processing provides for the handling of suspend/resume signals either in gang mode, therefore affecting all controller downstream ports at the same time, or individually if the controller offers this functionality.</span></span>

### <a name="endpoints"></a><span data-ttu-id="8c6f2-201">Slutpunkter</span><span class="sxs-lookup"><span data-stu-id="8c6f2-201">Endpoints</span></span>

<span data-ttu-id="8c6f2-202">Slut punkts hanteringen ger möjlighet att skapa eller destruera fysiska slut punkter till kontrollanten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-202">The endpoint management provides for the creation or destruction of physical endpoints to the controller.</span></span> <span data-ttu-id="8c6f2-203">De fysiska slut punkterna är minnes enheter som tolkas av kontrollanten om styrenheten stöder Master DMA eller som är skrivna i kontrollanten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-203">The physical endpoints are memory entities that are parsed by the controller if the controller supports master DMA or that are written in the controller.</span></span> <span data-ttu-id="8c6f2-204">De fysiska slut punkterna innehåller transaktions information som ska utföras av kontrollanten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-204">The physical endpoints contain transactions information to be performed by the controller.</span></span>

### <a name="transfers"></a><span data-ttu-id="8c6f2-205">Överlåtelse</span><span class="sxs-lookup"><span data-stu-id="8c6f2-205">Transfers</span></span>

<span data-ttu-id="8c6f2-206">Överförings hantering tillhandahåller en klass för att utföra en transaktion på varje slut punkt som har skapats.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-206">Transfer management provides for a class to perform a transaction on each of the endpoints that have been created.</span></span> <span data-ttu-id="8c6f2-207">Varje logisk slut punkt innehåller en komponent som kallas ÖVERFÖRINGs förfrågan för USB-överförings begär Anden.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-207">Each logical endpoint contains a component called TRANSFER REQUEST for USB transfer requests.</span></span> <span data-ttu-id="8c6f2-208">ÖVERFÖRINGSBEGÄRAN används av stacken för att beskriva transaktionen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-208">The TRANSFER REQUEST is used by the stack to describe the transaction.</span></span> <span data-ttu-id="8c6f2-209">Denna ÖVERFÖRINGSBEGÄRAN skickas sedan till stacken och till kontrollanten, som kan dela upp den i flera under transaktioner beroende på funktionerna i kontrollanten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-209">This TRANSFER REQUEST is then passed to the stack and to the controller, which may divide it into several sub transactions depending on the capabilities of the controller.</span></span>

## <a name="usb-device-framework"></a><span data-ttu-id="8c6f2-210">Ramverk för USB-enhet</span><span class="sxs-lookup"><span data-stu-id="8c6f2-210">USB Device Framework</span></span>

<span data-ttu-id="8c6f2-211">En USB-enhet representeras av ett träd med beskrivningar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-211">A USB device is represented by a tree of descriptors.</span></span> <span data-ttu-id="8c6f2-212">Det finns sex huvud typer av beskrivningar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-212">There are six main types of descriptors.</span></span>

- <span data-ttu-id="8c6f2-213">Enhets beskrivningar</span><span class="sxs-lookup"><span data-stu-id="8c6f2-213">Device descriptors</span></span>
- <span data-ttu-id="8c6f2-214">Konfigurations beskrivningar</span><span class="sxs-lookup"><span data-stu-id="8c6f2-214">Configuration descriptors</span></span>
- <span data-ttu-id="8c6f2-215">Gränssnitts beskrivningar</span><span class="sxs-lookup"><span data-stu-id="8c6f2-215">Interface descriptors</span></span>
- <span data-ttu-id="8c6f2-216">Slut punkts beskrivningar</span><span class="sxs-lookup"><span data-stu-id="8c6f2-216">Endpoint descriptors</span></span>
- <span data-ttu-id="8c6f2-217">Sträng beskrivningar</span><span class="sxs-lookup"><span data-stu-id="8c6f2-217">String descriptors</span></span>
- <span data-ttu-id="8c6f2-218">Funktionella beskrivare</span><span class="sxs-lookup"><span data-stu-id="8c6f2-218">Functional descriptors</span></span>

<span data-ttu-id="8c6f2-219">En USB-enhet kan ha en mycket enkel beskrivning och ser ut så här.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-219">A USB device may have a very simple description and looks like this.</span></span>
<span data-ttu-id="8c6f2-220">![Enkel USB-enhet](./media/usbx-host-stack/usb-device-simple.png)</span><span class="sxs-lookup"><span data-stu-id="8c6f2-220">![Simple USB device](./media/usbx-host-stack/usb-device-simple.png)</span></span>

<span data-ttu-id="8c6f2-221">I bilden ovan har enheten bara en konfiguration.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-221">In the above illustration, the device has only one configuration.</span></span> <span data-ttu-id="8c6f2-222">Ett enda gränssnitt är kopplat till den här konfigurationen, vilket indikerar att enheten bara har en funktion och bara har en slut punkt.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-222">A single interface is attached to this configuration, indicating that the device has only one function, and it has one endpoint only.</span></span> <span data-ttu-id="8c6f2-223">Kopplad till enhets beskrivningen är en sträng beskrivning som ger en synlig identifiering av enheten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-223">Attached to the device descriptor is a string descriptor providing a visible identification of the device.</span></span>

<span data-ttu-id="8c6f2-224">En enhet kan dock vara mer komplex och kan visas på följande sätt.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-224">However, a device may be more complex and may appear as follows.</span></span>

![Komplex USB-enhet](./media/usbx-host-stack/usb-device-complex.png)

<span data-ttu-id="8c6f2-226">I bilden ovan har enheten två konfigurations beskrivningar kopplade till enhets beskrivningen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-226">In the above illustration, the device has two configuration descriptors attached to the device descriptor.</span></span> <span data-ttu-id="8c6f2-227">Den här enheten kan indikera att den har två energi lägen eller kan drivas av antingen standard klasser eller egna klasser.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-227">This device may indicate that it has two power modes or can be driven by either standard classes or proprietary classes.</span></span>

<span data-ttu-id="8c6f2-228">Kopplade till den första konfigurationen är två gränssnitt som indikerar att enheten har två logiska funktioner.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-228">Attached to the first configuration are two interfaces indicating that the device has two logical functions.</span></span> <span data-ttu-id="8c6f2-229">Den första funktionen har 3 slut punkts beskrivningar och en funktionell beskrivning.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-229">The first function has 3 endpoint descriptors and a functional descriptor.</span></span> <span data-ttu-id="8c6f2-230">Den funktionella beskrivningen kan användas av den klass som ansvarar för att köra gränssnittet för att få ytterligare information om det här gränssnittet som normalt inte hittas av en allmän beskrivning.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-230">The functional descriptor may be used by the class responsible to drive the interface to obtain further information about this interface normally not found by a generic descriptor.</span></span>

### <a name="device-descriptors"></a><span data-ttu-id="8c6f2-231">Enhets beskrivningar</span><span class="sxs-lookup"><span data-stu-id="8c6f2-231">Device Descriptors</span></span>

<span data-ttu-id="8c6f2-232">Varje USB-enhet har en enda enhets beskrivning.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-232">Each USB device has one single device descriptor.</span></span> <span data-ttu-id="8c6f2-233">Den här beskrivningen innehåller enhets identifieringen, antalet konfigurationer som stöds och egenskaperna för den standard kontroll slut punkt som används för att konfigurera enheten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-233">This descriptor contains the device identification, the number of configurations supported, and the characteristics of the default control endpoint used for configuring the device.</span></span>

| <span data-ttu-id="8c6f2-234">Offset</span><span class="sxs-lookup"><span data-stu-id="8c6f2-234">Offset</span></span> | <span data-ttu-id="8c6f2-235">Fält</span><span class="sxs-lookup"><span data-stu-id="8c6f2-235">Field</span></span>              | <span data-ttu-id="8c6f2-236">Storlek</span><span class="sxs-lookup"><span data-stu-id="8c6f2-236">Size</span></span> | <span data-ttu-id="8c6f2-237">Värde</span><span class="sxs-lookup"><span data-stu-id="8c6f2-237">Value</span></span>    | <span data-ttu-id="8c6f2-238">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="8c6f2-238">Description</span></span>                             |
| ------ | ------------------ | ---- | -------- | --------------------------------------- |
| <span data-ttu-id="8c6f2-239">0</span><span class="sxs-lookup"><span data-stu-id="8c6f2-239">0</span></span>      | <span data-ttu-id="8c6f2-240">BLength</span><span class="sxs-lookup"><span data-stu-id="8c6f2-240">BLength</span></span>            | <span data-ttu-id="8c6f2-241">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-241">1</span></span>    | <span data-ttu-id="8c6f2-242">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-242">Number</span></span>   | <span data-ttu-id="8c6f2-243">Storlek på den här beskrivningen i byte</span><span class="sxs-lookup"><span data-stu-id="8c6f2-243">Size of this descriptor in bytes</span></span> |
| <span data-ttu-id="8c6f2-244">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-244">1</span></span>      | <span data-ttu-id="8c6f2-245">bDescriptorType</span><span class="sxs-lookup"><span data-stu-id="8c6f2-245">bDescriptorType</span></span>    | <span data-ttu-id="8c6f2-246">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-246">1</span></span>    | <span data-ttu-id="8c6f2-247">Konstant</span><span class="sxs-lookup"><span data-stu-id="8c6f2-247">Constant</span></span> | <span data-ttu-id="8c6f2-248">ENHETs beskrivnings typ</span><span class="sxs-lookup"><span data-stu-id="8c6f2-248">DEVICE Descriptor Type</span></span> |
| <span data-ttu-id="8c6f2-249">2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-249">2</span></span>      | <span data-ttu-id="8c6f2-250">bcdUSB</span><span class="sxs-lookup"><span data-stu-id="8c6f2-250">bcdUSB</span></span>             | <span data-ttu-id="8c6f2-251">2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-251">2</span></span>    | <span data-ttu-id="8c6f2-252">BCD</span><span class="sxs-lookup"><span data-stu-id="8c6f2-252">BCD</span></span>      | <span data-ttu-id="8c6f2-253">Versions nummer för USB-specifikation i BinaryCoded dec</span><span class="sxs-lookup"><span data-stu-id="8c6f2-253">USB Specification Release Number in BinaryCoded Dec</span></span><br /><span data-ttu-id="8c6f2-254">Exempel: 2,10 motsvarar 0x210.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-254">Example: 2.10 is equivalent to 0x210.</span></span> <span data-ttu-id="8c6f2-255">I det här fältet identifieras versionen av USB-specifikationen att enheten och dess beskrivningar är kompatibla med.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-255">This field identifies the release of the USB Specification that the device and its descriptors are compliant with.</span></span> |
| <span data-ttu-id="8c6f2-256">4</span><span class="sxs-lookup"><span data-stu-id="8c6f2-256">4</span></span>      | <span data-ttu-id="8c6f2-257">bDeviceClass</span><span class="sxs-lookup"><span data-stu-id="8c6f2-257">bDeviceClass</span></span>       | <span data-ttu-id="8c6f2-258">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-258">1</span></span>    | <span data-ttu-id="8c6f2-259">Klass</span><span class="sxs-lookup"><span data-stu-id="8c6f2-259">Class</span></span>    | <span data-ttu-id="8c6f2-260">Klass kod (tilldelad av USB-IF).</span><span class="sxs-lookup"><span data-stu-id="8c6f2-260">Class code (assigned by USB-IF).</span></span><br /><span data-ttu-id="8c6f2-261">Om det här fältet återställs till 0, anger varje gränssnitt i en konfiguration sin egen klass information och de olika gränssnitten fungerar oberoende av varandra.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-261">If this field is reset to 0, each interface within a configuration specifies its own class information and the various interfaces operate independently.</span></span><br /><span data-ttu-id="8c6f2-262">Om det här fältet är inställt på ett värde mellan 1 och 0xFE, stöder enheten olika klass specifikationer på olika gränssnitt och gränssnitten kanske inte fungerar separat.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-262">If this field is set to a value between 1 and 0xFE, the device supports different class specifications on different interfaces and the interfaces may not operate independently.</span></span> <span data-ttu-id="8c6f2-263">Det här värdet identifierar den klass definition som används för de aggregerade gränssnitten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-263">This value identifies the class definition used for the aggregate interfaces.</span></span><br /><span data-ttu-id="8c6f2-264">Om det här fältet är inställt på 0xFF är enhets klassen leverantörsspecifik.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-264">If this field is set to 0xFF, the device class is vendor specific.</span></span> |
| <span data-ttu-id="8c6f2-265">5</span><span class="sxs-lookup"><span data-stu-id="8c6f2-265">5</span></span>      | <span data-ttu-id="8c6f2-266">bDeviceSubClass</span><span class="sxs-lookup"><span data-stu-id="8c6f2-266">bDeviceSubClass</span></span>    | <span data-ttu-id="8c6f2-267">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-267">1</span></span>    | <span data-ttu-id="8c6f2-268">Underklass</span><span class="sxs-lookup"><span data-stu-id="8c6f2-268">SubClass</span></span> | <span data-ttu-id="8c6f2-269">Underklassens kod (tilldelad av USB-IF).</span><span class="sxs-lookup"><span data-stu-id="8c6f2-269">Subclass code (assigned by USB-IF).</span></span><br /><span data-ttu-id="8c6f2-270">Dessa koder är kvalificerade med värdet för fältet bDeviceClass.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-270">These codes are qualified by the value of the bDeviceClass field.</span></span> <span data-ttu-id="8c6f2-271">Om fältet bDeviceClass återställs till 0 måste det här fältet också återställas till 0.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-271">If the bDeviceClass field is reset to 0, this field must also be reset to 0.</span></span> <span data-ttu-id="8c6f2-272">Om fältet bDeviceClass inte är inställt på 0xFF, är alla värden reserverade för tilldelning av USB.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-272">If the bDeviceClass field is not set to 0xFF, all values are reserved for assignment by USB.</span></span> |
| <span data-ttu-id="8c6f2-273">6</span><span class="sxs-lookup"><span data-stu-id="8c6f2-273">6</span></span>      | <span data-ttu-id="8c6f2-274">bDeviceProtocol</span><span class="sxs-lookup"><span data-stu-id="8c6f2-274">bDeviceProtocol</span></span>    | <span data-ttu-id="8c6f2-275">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-275">1</span></span>    | <span data-ttu-id="8c6f2-276">Protokoll</span><span class="sxs-lookup"><span data-stu-id="8c6f2-276">Protocol</span></span> | <span data-ttu-id="8c6f2-277">Protokoll kod (tilldelad av USB-IF).</span><span class="sxs-lookup"><span data-stu-id="8c6f2-277">Protocol code (assigned by USB-IF).</span></span><br /><span data-ttu-id="8c6f2-278">Dessa koder kvalificeras av värdet för bDeviceClass och bDeviceSubClass-fälten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-278">These codes are qualified by the value of the bDeviceClass and the bDeviceSubClass fields.</span></span> <span data-ttu-id="8c6f2-279">Om en enhet har stöd för klassbaserade protokoll på enhets nivå i stället för ett gränssnitt, identifierar den här koden de protokoll som enheten använder enligt specifikationen i enhets klassen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-279">If a device supports class-specific protocols on a device basis as opposed to an interface basis, this code identifies the protocols that the device uses as defined by the specification of the device class.</span></span> <span data-ttu-id="8c6f2-280">Om det här fältet återställs till 0 använder enheten inte klassbaserade protokoll på en enhets nivå.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-280">If this field is reset to 0, the device does not use class specific protocols on a device basis.</span></span><br /><span data-ttu-id="8c6f2-281">Det kan dock använda klassbaserade protokoll på ett gränssnitt.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-281">However, it may use class specific protocols on an interface basis.</span></span><br /><span data-ttu-id="8c6f2-282">Om det här fältet är inställt på 0xFF använder enheten ett leverantörsspecifika protokoll på enhets nivå.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-282">If this field is set to 0xFF, the device uses a vendor specific protocol on a device basis.</span></span> |
| <span data-ttu-id="8c6f2-283">7</span><span class="sxs-lookup"><span data-stu-id="8c6f2-283">7</span></span>      | <span data-ttu-id="8c6f2-284">bMaxPacketSize0</span><span class="sxs-lookup"><span data-stu-id="8c6f2-284">bMaxPacketSize0</span></span>    | <span data-ttu-id="8c6f2-285">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-285">1</span></span>    | <span data-ttu-id="8c6f2-286">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-286">Number</span></span>   | <span data-ttu-id="8c6f2-287">Maximal paket storlek för slut punkt noll (endast byte storlekar på 8, 16, 32 eller 64 är giltiga)</span><span class="sxs-lookup"><span data-stu-id="8c6f2-287">Maximum packet size for endpoint zero (only byte sizes of 8, 16, 32, or 64 are valid)</span></span> |
| <span data-ttu-id="8c6f2-288">8</span><span class="sxs-lookup"><span data-stu-id="8c6f2-288">8</span></span>      | <span data-ttu-id="8c6f2-289">idVendor</span><span class="sxs-lookup"><span data-stu-id="8c6f2-289">idVendor</span></span>           | <span data-ttu-id="8c6f2-290">2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-290">2</span></span>    | <span data-ttu-id="8c6f2-291">ID</span><span class="sxs-lookup"><span data-stu-id="8c6f2-291">ID</span></span>       | <span data-ttu-id="8c6f2-292">Leverantörs-ID (tilldelat av USB-IF)</span><span class="sxs-lookup"><span data-stu-id="8c6f2-292">Vendor ID (assigned by USB-IF)</span></span> |
| <span data-ttu-id="8c6f2-293">10</span><span class="sxs-lookup"><span data-stu-id="8c6f2-293">10</span></span>     | <span data-ttu-id="8c6f2-294">idProduct</span><span class="sxs-lookup"><span data-stu-id="8c6f2-294">idProduct</span></span>          | <span data-ttu-id="8c6f2-295">2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-295">2</span></span>    | <span data-ttu-id="8c6f2-296">ID</span><span class="sxs-lookup"><span data-stu-id="8c6f2-296">ID</span></span>       | <span data-ttu-id="8c6f2-297">Produkt-ID (tilldelat av tillverkaren)</span><span class="sxs-lookup"><span data-stu-id="8c6f2-297">Product ID (assigned by the Manufacturer)</span></span> |
| <span data-ttu-id="8c6f2-298">12</span><span class="sxs-lookup"><span data-stu-id="8c6f2-298">12</span></span>     | <span data-ttu-id="8c6f2-299">bcdDevice</span><span class="sxs-lookup"><span data-stu-id="8c6f2-299">bcdDevice</span></span>          | <span data-ttu-id="8c6f2-300">2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-300">2</span></span>    | <span data-ttu-id="8c6f2-301">BCD</span><span class="sxs-lookup"><span data-stu-id="8c6f2-301">BCD</span></span>      | <span data-ttu-id="8c6f2-302">Enhets versions nummer i binärt kodad decimal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-302">Device release number in binary-coded decimal</span></span> |
| <span data-ttu-id="8c6f2-303">14</span><span class="sxs-lookup"><span data-stu-id="8c6f2-303">14</span></span>     | <span data-ttu-id="8c6f2-304">iManufacturer</span><span class="sxs-lookup"><span data-stu-id="8c6f2-304">iManufacturer</span></span>      | <span data-ttu-id="8c6f2-305">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-305">1</span></span>    | <span data-ttu-id="8c6f2-306">Index</span><span class="sxs-lookup"><span data-stu-id="8c6f2-306">Index</span></span>    | <span data-ttu-id="8c6f2-307">Index för sträng beskrivning som beskriver tillverkare</span><span class="sxs-lookup"><span data-stu-id="8c6f2-307">Index of string descriptor describing manufacturer</span></span> |
| <span data-ttu-id="8c6f2-308">15</span><span class="sxs-lookup"><span data-stu-id="8c6f2-308">15</span></span>     | <span data-ttu-id="8c6f2-309">iProduct</span><span class="sxs-lookup"><span data-stu-id="8c6f2-309">iProduct</span></span>           | <span data-ttu-id="8c6f2-310">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-310">1</span></span>    | <span data-ttu-id="8c6f2-311">Index</span><span class="sxs-lookup"><span data-stu-id="8c6f2-311">Index</span></span>    | <span data-ttu-id="8c6f2-312">Index för sträng beskrivning som beskriver produkten</span><span class="sxs-lookup"><span data-stu-id="8c6f2-312">Index of string descriptor describing product</span></span> |
| <span data-ttu-id="8c6f2-313">16</span><span class="sxs-lookup"><span data-stu-id="8c6f2-313">16</span></span>     | <span data-ttu-id="8c6f2-314">iSerialNumbe</span><span class="sxs-lookup"><span data-stu-id="8c6f2-314">iSerialNumbe</span></span>       | <span data-ttu-id="8c6f2-315">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-315">1</span></span>    | <span data-ttu-id="8c6f2-316">Index</span><span class="sxs-lookup"><span data-stu-id="8c6f2-316">Index</span></span>    | <span data-ttu-id="8c6f2-317">Index för sträng beskrivning som beskriver enhetens serie nummer</span><span class="sxs-lookup"><span data-stu-id="8c6f2-317">Index of string descriptor describing the device's serial number</span></span> |
| <span data-ttu-id="8c6f2-318">17</span><span class="sxs-lookup"><span data-stu-id="8c6f2-318">17</span></span>     | <span data-ttu-id="8c6f2-319">bNumConfigurations</span><span class="sxs-lookup"><span data-stu-id="8c6f2-319">bNumConfigurations</span></span> | <span data-ttu-id="8c6f2-320">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-320">1</span></span>    | <span data-ttu-id="8c6f2-321">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-321">Number</span></span>   | <span data-ttu-id="8c6f2-322">Antal möjliga konfigurationer</span><span class="sxs-lookup"><span data-stu-id="8c6f2-322">Number of possible configurations</span></span> |

<span data-ttu-id="8c6f2-323">USBX definierar en USB-enhets Beskrivning enligt följande:</span><span class="sxs-lookup"><span data-stu-id="8c6f2-323">USBX defines a USB device descriptor as follows:</span></span>

```c
typedef struct UX_DEVICE_DESCRIPTOR_STRUCT
{
    UINT      bLength;
    UINT      bDescriptorType;
    USHORT    bcdUSB;
    UINT      bDeviceClass;
    UINT      bDeviceSubClass;
    UINT      bDeviceProtocol;
    UINT      bMaxPacketSize0;
    USHORT    idVendor;
    USHORT    idProduct;
    USHORT    bcdDevice;
    UINT      iManufacturer;
    UINT      iProduct;
    UINT      iSerialNumber;
    UINT      bNumConfigurations;
} UX_DEVICE_DESCRIPTOR;
```

<span data-ttu-id="8c6f2-324">Beskrivningen av USB-enheten är en del av en enhets behållare som beskrivs som:</span><span class="sxs-lookup"><span data-stu-id="8c6f2-324">The USB device descriptor is part of a device container described as:</span></span>

```c
typedef struct UX_DEVICE_STRUCT
{
    ULONG ux_device_handle;
    ULONG ux_device_type;
    ULONG ux_device_state;
    ULONG ux_device_address;
    ULONG ux_device_speed;
    ULONG ux_device_port_location;
    ULONG ux_device_max_power;
    ULONG ux_device_power_source;
    UINT ux_device_current_configuration;

    TX_SEMAPHORE ux_device_protection_semaphore;
    struct UX_DEVICE_STRUCT *ux_device_parent; 
    struct UX_HOST_CLASS_STRUCT *ux_device_class; 
    VOID *ux_device_class_instance;
    struct UX_HCD_STRUCT *ux_device_hcd;
    struct UX_CONFIGURATION_STRUCT *ux_device_first_configuration; 
    struct UX_DEVICE_STRUCT *ux_device_next_device;
    struct UX_DEVICE_DESCRIPTOR_STRUCT ux_device_descriptor;
    struct UX_ENDPOINT_STRUCT ux_device_control_endpoint;
    struct UX_HUB_TT_STRUCT ux_device_hub_tt[UX_MAX_TT];
} UX_DEVICE;
```

- <span data-ttu-id="8c6f2-325">**ux_device_handle**: hantering av enheten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-325">**ux_device_handle**: Handle of the device.</span></span> <span data-ttu-id="8c6f2-326">Detta är vanligt vis adressen till instansen för den här strukturen för enheten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-326">This is typically the address of the instance of this structure for the device.</span></span>
- <span data-ttu-id="8c6f2-327">**ux_device_type**: föråldrat värde.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-327">**ux_device_type**: Obsolete value.</span></span> <span data-ttu-id="8c6f2-328">Outnyttja.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-328">Unused.</span></span>
- <span data-ttu-id="8c6f2-329">**ux_device_state**: enhets tillstånd, som kan ha ett av följande värden:</span><span class="sxs-lookup"><span data-stu-id="8c6f2-329">**ux_device_state**: Device State, which can have one of the following values:</span></span>
    - <span data-ttu-id="8c6f2-330">**UX_DEVICE_RESET**                0</span><span class="sxs-lookup"><span data-stu-id="8c6f2-330">**UX_DEVICE_RESET**                0</span></span>
    - <span data-ttu-id="8c6f2-331">**UX_DEVICE_ATTACHED**             1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-331">**UX_DEVICE_ATTACHED**             1</span></span>
    - <span data-ttu-id="8c6f2-332">**UX_DEVICE_ADDRESSED**            2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-332">**UX_DEVICE_ADDRESSED**            2</span></span>
    - <span data-ttu-id="8c6f2-333">**UX_DEVICE_CONFIGURED**           3</span><span class="sxs-lookup"><span data-stu-id="8c6f2-333">**UX_DEVICE_CONFIGURED**           3</span></span>
    - <span data-ttu-id="8c6f2-334">**UX_DEVICE_SUSPENDED**            4</span><span class="sxs-lookup"><span data-stu-id="8c6f2-334">**UX_DEVICE_SUSPENDED**            4</span></span>
    - <span data-ttu-id="8c6f2-335">**UX_DEVICE_RESUMED**              5</span><span class="sxs-lookup"><span data-stu-id="8c6f2-335">**UX_DEVICE_RESUMED**              5</span></span>
    - <span data-ttu-id="8c6f2-336">**UX_DEVICE_SELF_POWERED_STATE**   6</span><span class="sxs-lookup"><span data-stu-id="8c6f2-336">**UX_DEVICE_SELF_POWERED_STATE**   6</span></span>
    - <span data-ttu-id="8c6f2-337">**UX_DEVICE_SELF_POWERED_STATE**   7</span><span class="sxs-lookup"><span data-stu-id="8c6f2-337">**UX_DEVICE_SELF_POWERED_STATE**   7</span></span>
    - <span data-ttu-id="8c6f2-338">**UX_DEVICE_REMOTE_WAKEUP**        8</span><span class="sxs-lookup"><span data-stu-id="8c6f2-338">**UX_DEVICE_REMOTE_WAKEUP**        8</span></span>
    - <span data-ttu-id="8c6f2-339">**UX_DEVICE_BUS_RESET_COMPLETED**  9</span><span class="sxs-lookup"><span data-stu-id="8c6f2-339">**UX_DEVICE_BUS_RESET_COMPLETED**  9</span></span>
    - <span data-ttu-id="8c6f2-340">**UX_DEVICE_REMOVED**              10</span><span class="sxs-lookup"><span data-stu-id="8c6f2-340">**UX_DEVICE_REMOVED**              10</span></span>
    - <span data-ttu-id="8c6f2-341">**UX_DEVICE_FORCE_DISCONNECT**     11</span><span class="sxs-lookup"><span data-stu-id="8c6f2-341">**UX_DEVICE_FORCE_DISCONNECT**     11</span></span>
- <span data-ttu-id="8c6f2-342">**ux_device_address**: enhetens adress efter att kommandot **SET_ADDRESS** har godkänts (från 1 till 127).</span><span class="sxs-lookup"><span data-stu-id="8c6f2-342">**ux_device_address**: Address of the device after the **SET_ADDRESS** command has been accepted (from 1 to 127).</span></span>
- <span data-ttu-id="8c6f2-343">**ux_device_speed**: enhetens hastighet:</span><span class="sxs-lookup"><span data-stu-id="8c6f2-343">**ux_device_speed**: Speed of the device:</span></span>
    - <span data-ttu-id="8c6f2-344">**UX_LOW_SPEED_DEVICE**      0</span><span class="sxs-lookup"><span data-stu-id="8c6f2-344">**UX_LOW_SPEED_DEVICE**      0</span></span>
    - <span data-ttu-id="8c6f2-345">**UX_FULL_SPEED_DEVICE**     1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-345">**UX_FULL_SPEED_DEVICE**     1</span></span>
    - <span data-ttu-id="8c6f2-346">**UX_HIGH_SPEED_DEVICE**     2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-346">**UX_HIGH_SPEED_DEVICE**     2</span></span>
- <span data-ttu-id="8c6f2-347">**ux_device_port_location**: index för den överordnade enhetens port (rotnavet eller hubb).</span><span class="sxs-lookup"><span data-stu-id="8c6f2-347">**ux_device_port_location**: Index of the port of the parent device (root hub or hub).</span></span>
- <span data-ttu-id="8c6f2-348">**ux_device_max_power**: maximal effekt i ma som enheten kan ta i den valda konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-348">**ux_device_max_power**: Maximum power in mA that the device may take in the selected configuration.</span></span>
- <span data-ttu-id="8c6f2-349">**ux_device_power_source**: kan vara ett av följande två värden:</span><span class="sxs-lookup"><span data-stu-id="8c6f2-349">**ux_device_power_source**: Can be one of the two following values:</span></span>
    - <span data-ttu-id="8c6f2-350">**UX_DEVICE_BUS_POWERED**     1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-350">**UX_DEVICE_BUS_POWERED**     1</span></span>
    - <span data-ttu-id="8c6f2-351">**UX_DEVICE_SELF_POWERED**    2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-351">**UX_DEVICE_SELF_POWERED**    2</span></span>
- <span data-ttu-id="8c6f2-352">**ux_device_current_configuration**: index för den aktuella konfigurationen som används av den här enheten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-352">**ux_device_current_configuration**: Index of the current configuration being used by this device.</span></span>
- <span data-ttu-id="8c6f2-353">**ux_device_parent**: enhets container pekare för den överordnade enheten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-353">**ux_device_parent**: Device container pointer of the parent of this device.</span></span> <span data-ttu-id="8c6f2-354">Om pekaren är null är den överordnade roten i kontrollanten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-354">If the pointer is null, the parent is the root hub of the controller.</span></span>
- <span data-ttu-id="8c6f2-355">**ux_device_class**: pekar mot den typ av klass som äger den här enheten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-355">**ux_device_class**: Pointer to the class type that owns this device.</span></span>
- <span data-ttu-id="8c6f2-356">**ux_device_class_instance**: pekar mot instansen av klassen som äger den här enheten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-356">**ux_device_class_instance**: Pointer to the instance of the class that owns this device.</span></span>
- <span data-ttu-id="8c6f2-357">**ux_device_hcd**: USB-styrenhetens instans där den här enheten är ansluten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-357">**ux_device_hcd**: USB Host Controller Instance where this device is attached.</span></span>
- <span data-ttu-id="8c6f2-358">**ux_device_first_configuration**: pekar på den första konfigurations behållaren för den här enheten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-358">**ux_device_first_configuration**: Pointer to the first configuration container for this device.</span></span>
- <span data-ttu-id="8c6f2-359">**ux_device_next_device**: pekar på nästa enhet i enhets listan på någon av de bussar som identifieras av USBX.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-359">**ux_device_next_device**: Pointer to the next device in the list of device on any of the buses detected by USBX.</span></span>
- <span data-ttu-id="8c6f2-360">**ux_device_descriptor**: USB-enhets beskrivning.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-360">**ux_device_descriptor**: USB device descriptor.</span></span>
- <span data-ttu-id="8c6f2-361">**ux_device_control_endpoint**: Beskrivning av den standard kontroll slut punkt som används av enheten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-361">**ux_device_control_endpoint**: Descriptor of the default control endpoint used by this device.</span></span>
- <span data-ttu-id="8c6f2-362">**ux_device_hub_tt**: matris med hubb-TTS för enheten</span><span class="sxs-lookup"><span data-stu-id="8c6f2-362">**ux_device_hub_tt**: Array of Hub TTs for the device</span></span>

### <a name="configuration-descriptors"></a><span data-ttu-id="8c6f2-363">Konfigurations beskrivningar</span><span class="sxs-lookup"><span data-stu-id="8c6f2-363">Configuration Descriptors</span></span>

<span data-ttu-id="8c6f2-364">Konfigurations beskrivningen beskriver information om en speciell enhets konfiguration.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-364">The configuration descriptor describes information about a specific device configuration.</span></span> <span data-ttu-id="8c6f2-365">En USB-enhet kan innehålla en eller flera konfigurations beskrivningar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-365">A USB device may contain one or more configuration descriptors.</span></span> <span data-ttu-id="8c6f2-366">Fältet **bNumConfigurations** i enhets beskrivningen anger antalet konfigurations beskrivningar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-366">The **bNumConfigurations** field in the device descriptor indicates the number of configuration descriptors.</span></span> <span data-ttu-id="8c6f2-367">Beskrivningen innehåller ett **bConfigurationValue** -fält med ett värde som, när den används som en parameter i den angivna konfigurationen, gör att enheten antar den beskrivna konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-367">The descriptor contains a **bConfigurationValue** field with a value that, when used as a parameter to the Set Configuration request, causes the device to assume the described configuration.</span></span>

<span data-ttu-id="8c6f2-368">Beskrivningen beskriver antalet gränssnitt som tillhandahålls av konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-368">The descriptor describes the number of interfaces provided by the configuration.</span></span> <span data-ttu-id="8c6f2-369">Varje gränssnitt representerar en logisk funktion i enheten och kan fungera oberoende av varandra.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-369">Each interface represents a logical function within the device and may operate independently.</span></span> <span data-ttu-id="8c6f2-370">Till exempel kan en USB-ljudhögtalare ha tre gränssnitt, ett för ljud uppspelning, en för ljud kontroll och ett HID-gränssnitt för att hantera högtalarenas knappar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-370">For instance a USB audio speaker may have three interfaces, one for audio streaming, one for audio control, and one HID interface to manage the speaker's buttons.</span></span>

<span data-ttu-id="8c6f2-371">När värden utfärdar en GET_DESCRIPTOR begäran för konfigurations beskrivningen returneras alla relaterade gränssnitt och slut punkts beskrivningar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-371">When the host issues a GET_DESCRIPTOR request for the configuration descriptor, all related interface and endpoint descriptors are returned.</span></span>

| <span data-ttu-id="8c6f2-372">Offset</span><span class="sxs-lookup"><span data-stu-id="8c6f2-372">Offset</span></span> | <span data-ttu-id="8c6f2-373">Fält</span><span class="sxs-lookup"><span data-stu-id="8c6f2-373">Field</span></span>               | <span data-ttu-id="8c6f2-374">Storlek</span><span class="sxs-lookup"><span data-stu-id="8c6f2-374">Size</span></span> | <span data-ttu-id="8c6f2-375">Värde</span><span class="sxs-lookup"><span data-stu-id="8c6f2-375">Value</span></span>    | <span data-ttu-id="8c6f2-376">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="8c6f2-376">Description</span></span>                       |
| ------ | ------------------- | ---- | -------- | --------------------------------- |
| <span data-ttu-id="8c6f2-377">0</span><span class="sxs-lookup"><span data-stu-id="8c6f2-377">0</span></span>      | <span data-ttu-id="8c6f2-378">bLength</span><span class="sxs-lookup"><span data-stu-id="8c6f2-378">bLength</span></span>             | <span data-ttu-id="8c6f2-379">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-379">1</span></span>    | <span data-ttu-id="8c6f2-380">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-380">Number</span></span>   | <span data-ttu-id="8c6f2-381">Storlek på den här beskrivningen i byte.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-381">Size of this descriptor in bytes.</span></span> |
| <span data-ttu-id="8c6f2-382">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-382">1</span></span>      | <span data-ttu-id="8c6f2-383">bDescriptorType</span><span class="sxs-lookup"><span data-stu-id="8c6f2-383">bDescriptorType</span></span>     | <span data-ttu-id="8c6f2-384">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-384">1</span></span>    | <span data-ttu-id="8c6f2-385">Konstant</span><span class="sxs-lookup"><span data-stu-id="8c6f2-385">Constant</span></span> | <span data-ttu-id="8c6f2-386">KONFIGURATION</span><span class="sxs-lookup"><span data-stu-id="8c6f2-386">CONFIGURATION</span></span>                     |
| <span data-ttu-id="8c6f2-387">2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-387">2</span></span>      | <span data-ttu-id="8c6f2-388">wTotalLength</span><span class="sxs-lookup"><span data-stu-id="8c6f2-388">wTotalLength</span></span>        | <span data-ttu-id="8c6f2-389">2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-389">2</span></span>    | <span data-ttu-id="8c6f2-390">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-390">Number</span></span>   | <span data-ttu-id="8c6f2-391">Total längd på data som returneras för den här konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-391">Total length of data returned for this configuration.</span></span> <span data-ttu-id="8c6f2-392">Innehåller den sammanlagda längden på alla beskrivningar (konfiguration, gränssnitt, slut punkt och klass eller leverantörsspecifik) som returneras för den här konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-392">Includes the combined length of all descriptors (configuration, interface, endpoint, and class or vendor specific) returned for this configuration.</span></span> |
| <span data-ttu-id="8c6f2-393">4</span><span class="sxs-lookup"><span data-stu-id="8c6f2-393">4</span></span>      | <span data-ttu-id="8c6f2-394">bNumInterfaces</span><span class="sxs-lookup"><span data-stu-id="8c6f2-394">bNumInterfaces</span></span>      | <span data-ttu-id="8c6f2-395">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-395">1</span></span>    | <span data-ttu-id="8c6f2-396">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-396">Number</span></span>   | <span data-ttu-id="8c6f2-397">Antalet gränssnitt som stöds av den här konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-397">Number of interfaces supported by this configuration.</span></span> |
| <span data-ttu-id="8c6f2-398">5</span><span class="sxs-lookup"><span data-stu-id="8c6f2-398">5</span></span>      | <span data-ttu-id="8c6f2-399">bConfigurationValue</span><span class="sxs-lookup"><span data-stu-id="8c6f2-399">bConfigurationValue</span></span> | <span data-ttu-id="8c6f2-400">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-400">1</span></span>    | <span data-ttu-id="8c6f2-401">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-401">Number</span></span>   | <span data-ttu-id="8c6f2-402">Värde som ska användas som argument för att ange</span><span class="sxs-lookup"><span data-stu-id="8c6f2-402">Value to use as an argument to Set</span></span><br/><span data-ttu-id="8c6f2-403">Konfiguration för att välja den här konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-403">Configuration to select this configuration.</span></span> |
| <span data-ttu-id="8c6f2-404">6</span><span class="sxs-lookup"><span data-stu-id="8c6f2-404">6</span></span>      | <span data-ttu-id="8c6f2-405">iConfiguration</span><span class="sxs-lookup"><span data-stu-id="8c6f2-405">iConfiguration</span></span>      | <span data-ttu-id="8c6f2-406">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-406">1</span></span>    | <span data-ttu-id="8c6f2-407">Index</span><span class="sxs-lookup"><span data-stu-id="8c6f2-407">Index</span></span>    | <span data-ttu-id="8c6f2-408">Index för sträng beskrivning som beskriver den här konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-408">Index of string descriptor describing this configuration.</span></span> |
| <span data-ttu-id="8c6f2-409">7</span><span class="sxs-lookup"><span data-stu-id="8c6f2-409">7</span></span>      | <span data-ttu-id="8c6f2-410">bMAttributes</span><span class="sxs-lookup"><span data-stu-id="8c6f2-410">bMAttributes</span></span>        | <span data-ttu-id="8c6f2-411">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-411">1</span></span>    | <span data-ttu-id="8c6f2-412">Bitmappsfilen</span><span class="sxs-lookup"><span data-stu-id="8c6f2-412">Bitmap</span></span>   | <span data-ttu-id="8c6f2-413">Konfigurations egenskaper D7 Bus Powered</span><span class="sxs-lookup"><span data-stu-id="8c6f2-413">Configuration characteristics D7 Bus Powered</span></span><br /><span data-ttu-id="8c6f2-414">D6, egen strömförsörjning</span><span class="sxs-lookup"><span data-stu-id="8c6f2-414">D6 Self Powered</span></span><br /><span data-ttu-id="8c6f2-415">Fjärraktivering av D5</span><span class="sxs-lookup"><span data-stu-id="8c6f2-415">D5 Remote Wakeup</span></span><br /><span data-ttu-id="8c6f2-416">D4.. 0 reserverad (Återställ till 0)</span><span class="sxs-lookup"><span data-stu-id="8c6f2-416">D4..0 Reserved (reset to 0)</span></span><br /><span data-ttu-id="8c6f2-417">En enhets konfiguration som använder ström från bussen och en lokal källa anger både D7 och D6.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-417">A device configuration that uses power from the bus and a local source sets both D7 and D6.</span></span> <span data-ttu-id="8c6f2-418">Den faktiska ström källan vid körning kan fastställas med hjälp av enhets förfrågan för att hämta status.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-418">The actual power source at runtime may be determined using the Get Status device request.</span></span><br /><span data-ttu-id="8c6f2-419">Om en enhets konfiguration har stöd för fjärraktivering, anges D5 till 1.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-419">If a device configuration supports remote wakeup, D5 is set to 1.</span></span> |
| <span data-ttu-id="8c6f2-420">8</span><span class="sxs-lookup"><span data-stu-id="8c6f2-420">8</span></span>      | <span data-ttu-id="8c6f2-421">MaxPower</span><span class="sxs-lookup"><span data-stu-id="8c6f2-421">MaxPower</span></span>            | <span data-ttu-id="8c6f2-422">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-422">1</span></span>    | <span data-ttu-id="8c6f2-423">&</span><span class="sxs-lookup"><span data-stu-id="8c6f2-423">mA</span></span>       | <span data-ttu-id="8c6f2-424">Maximal energi förbrukning av USB-enhet från bussen i denna speciella konfiguration när enheten är fullt fungerande.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-424">Maximum power consumption of USB device from the bus in this specific configuration when the device is fully operational.</span></span><br /><span data-ttu-id="8c6f2-425">Uttryckt i 2 mA-enheter (t. ex. 50 = 100 mA).</span><span class="sxs-lookup"><span data-stu-id="8c6f2-425">Expressed in 2 mA units (e.g., 50 = 100 mA).</span></span><br /><span data-ttu-id="8c6f2-426">Obs! en enhets konfiguration rapporterar om konfigurationen är buss driven eller med egen strömförsörjning.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-426">Note: A device configuration reports whether the configuration is bus-powered or self-powered.</span></span><br /><span data-ttu-id="8c6f2-427">Enhets status rapporterar om enheten för närvarande är självständig.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-427">Device status reports whether the device is currently self-powered.</span></span> <span data-ttu-id="8c6f2-428">Om en enhet är frånkopplad från den externa ström källan uppdaterar den enhets statusen för att indikera att den inte längre är självständiga.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-428">If a device is disconnected from its external power source, it updates device status to indicate that it is no longer self-powered.</span></span> |

<span data-ttu-id="8c6f2-429">USBX definierar en beskrivning av en USB-konfiguration enligt följande.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-429">USBX defines a USB configuration descriptor as follows.</span></span>

```c
typedef struct UX_CONFIGURATION_DESCRIPTOR_STRUCT
{
    UINT bLength;
    UINT bDescriptorType;
    USHORT wTotalLength;
    UINT bNumInterfaces;
    UINT bConfigurationValue;
    UINT iConfiguration;
    UINT bmAttributes;
    UINT MaxPower;
} UX_CONFIGURATION_DESCRIPTOR;
```

<span data-ttu-id="8c6f2-430">Beskrivningen av USB-konfigurationen är en del av en konfigurations behållare som beskrivs nedan.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-430">The USB configuration descriptor is part of a configuration container described as shown below.</span></span>

```c
typedef struct UX_CONFIGURATION_STRUCT
{
    ULONG ux_configuration_handle;
    ULONG ux_configuration_state;
    struct UX_CONFIGURATION_DESCRIPTOR_STRUCT ux_configuration_descriptor;
    struct UX_INTERFACE_STRUCT *ux_configuration_first_interface;
    struct UX_CONFIGURATION_STRUCT *ux_configuration_next_configuration;
    struct UX_DEVICE_STRUCT *ux_configuration_device;
} UX_CONFIGURATION;
```

- <span data-ttu-id="8c6f2-431">**ux_configuration_handle**: hantering av konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-431">**ux_configuration_handle**: Handle of the configuration.</span></span> <span data-ttu-id="8c6f2-432">Detta är vanligt vis adressen till instansen för den här strukturen för konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-432">This is typically the address of the instance of this structure for the configuration.</span></span>
- <span data-ttu-id="8c6f2-433">**ux_configuration_state**: konfigurationens tillstånd.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-433">**ux_configuration_state**: State of the configuration.</span></span>
- <span data-ttu-id="8c6f2-434">**ux_configuration_descriptor**: USB-enhets beskrivning.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-434">**ux_configuration_descriptor**: USB device descriptor.</span></span>
- <span data-ttu-id="8c6f2-435">**ux_configuration_first_interface**: pekar mot det första gränssnittet för den här konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-435">**ux_configuration_first_interface**: Pointer to the first interface for this configuration.</span></span>
- <span data-ttu-id="8c6f2-436">**ux_configuration_next_configuration**: pekar mot nästa konfiguration för samma enhet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-436">**ux_configuration_next_configuration**: Pointer to the next configuration for the same device.</span></span>
- <span data-ttu-id="8c6f2-437">**ux_configuration_device**: pekar mot enhetens ägare av den här konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-437">**ux_configuration_device**: Pointer to the device owner of this configuration.</span></span>

### <a name="interface-descriptors"></a><span data-ttu-id="8c6f2-438">Gränssnitts beskrivningar</span><span class="sxs-lookup"><span data-stu-id="8c6f2-438">Interface Descriptors</span></span>

<span data-ttu-id="8c6f2-439">Gränssnitts beskrivningen beskriver ett speciellt gränssnitt i en konfiguration.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-439">The interface descriptor describes a specific interface within a configuration.</span></span> <span data-ttu-id="8c6f2-440">Ett gränssnitt är en logisk funktion i en USB-enhet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-440">An interface is a logical function within a USB device.</span></span> <span data-ttu-id="8c6f2-441">En konfiguration tillhandahåller ett eller flera gränssnitt, var och en med noll eller fler slut punkts beskrivningar som beskriver en unik uppsättning slut punkter i konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-441">A configuration provides one or more interfaces, each with zero or more endpoint descriptors describing a unique set of endpoints within the configuration.</span></span> <span data-ttu-id="8c6f2-442">När en konfiguration stöder fler än ett gränssnitt följer slut punkts beskrivarna för ett visst gränssnitt gränssnitts beskrivningen i de data som returneras av **GET_DESCRIPTOR** begäran för den angivna konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-442">When a configuration supports more than one interface, the endpoint descriptors for a particular interface follow the interface descriptor in the data returned by the **GET_DESCRIPTOR** request for the specified configuration.</span></span>

<span data-ttu-id="8c6f2-443">En gränssnitts Beskrivning returneras alltid som en del av en konfigurations beskrivning.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-443">An interface descriptor is always returned as part of a configuration descriptor.</span></span> <span data-ttu-id="8c6f2-444">En gränssnitts beskrivning kan inte nås direkt av en GET_DESCRIPTOR begäran.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-444">An interface descriptor cannot be directly access by a GET_DESCRIPTOR request.</span></span>

<span data-ttu-id="8c6f2-445">Ett gränssnitt kan innehålla alternativa inställningar som gör att slut punkterna och/eller deras egenskaper kan variera efter att enheten har kon figurer ATS.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-445">An interface may include alternate settings that allow the endpoints and/or their characteristics to be varied after the device has been configured.</span></span> <span data-ttu-id="8c6f2-446">Standardvärdet för ett gränssnitt är alltid alternativ noll.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-446">The default setting for an interface is always alternate setting zero.</span></span> <span data-ttu-id="8c6f2-447">En klass kan välja att ändra den aktuella alternativa inställningen för att ändra gränssnittets beteende och egenskaperna för de associerade slut punkterna.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-447">A class can select to change the current alternate setting to change the interface behavior and the characteristics of the associated endpoints.</span></span> <span data-ttu-id="8c6f2-448">SET_INTERFACE förfrågan används för att välja en alternativ inställning eller för att återgå till standardvärdet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-448">The SET_INTERFACE request is used to select an alternate setting or to return to the default setting.</span></span>

<span data-ttu-id="8c6f2-449">Med alternativa inställningar kan en del av enhets konfigurationen variera medan andra gränssnitt är i drift.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-449">Alternate settings allow a portion of the device configuration to be varied while other interfaces remain in operation.</span></span> <span data-ttu-id="8c6f2-450">Om en konfiguration har alternativa inställningar för ett eller flera av dess gränssnitt, ingår en separat gränssnitts beskrivning och dess associerade slut punkter för varje inställning.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-450">If a configuration has alternate settings for one or more of its interfaces, a separate interface descriptor and its associated endpoints are included for each setting.</span></span>

<span data-ttu-id="8c6f2-451">Om en enhets konfiguration innehåller ett enda gränssnitt med två alternativa inställningar, returnerar GET_DESCRIPTOR begäran för konfigurationen konfigurations beskrivningen, sedan gränssnitts beskrivningen med fälten **bInterfaceNumber** och **bAlternateSetting** inställd på noll och sedan slut punkts Descriptor för den inställningen följt av en annan gränssnitts beskrivning och dess associerade slut punkts beskrivningar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-451">If a device configuration contains a single interface with two alternate settings, the GET_DESCRIPTOR request for the configuration would return the configuration descriptor, then the interface descriptor with the **bInterfaceNumber** and **bAlternateSetting** fields set to zero and then the endpoint descriptors for that setting, followed by another interface descriptor and its associated endpoint descriptors.</span></span> <span data-ttu-id="8c6f2-452">Den andra gränssnitts beskrivningens **bInterfaceNumber** -fält skulle också anges till noll, men fältet **bAlternateSetting** för den andra gränssnitts beskrivningen skulle anges till 1 som anger att den här alternativa inställningen tillhör det första gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-452">The second interface descriptor's **bInterfaceNumber** field would also be set to zero, but the **bAlternateSetting** field of the second interface descriptor would be set to 1 indicating that this alternate setting belongs to the first interface.</span></span>

<span data-ttu-id="8c6f2-453">Ett gränssnitt kanske inte har några kopplade slut punkter, i vilket fallet är det bara standard kontroll punkten som är giltig för det gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-453">An interface may not have any endpoints associated with it, in which case only the default control endpoint is valid for that interface.</span></span>

<span data-ttu-id="8c6f2-454">Alternativa inställningar används huvudsakligen för att ändra den begärda bandbredden för periodiska slut punkter som är kopplade till gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-454">Alternate settings are used mainly to change the requested bandwidth for periodic endpoints associated with the interface.</span></span> <span data-ttu-id="8c6f2-455">Till exempel bör ett Stream-gränssnitt för USB-högtalare ha den första alternativa inställningen med 0 bandbredds krav på den isokrona slut punkten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-455">For example, a USB speaker streaming interface should have the first alternate setting with a 0 bandwidth demand on its isochronous endpoint.</span></span> <span data-ttu-id="8c6f2-456">Andra alternativa inställningar kan välja olika bandbredds krav beroende på hur ofta ljudet strömmas.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-456">Other alternate settings may select different bandwidth requirements depending on the audio streaming frequency.</span></span>

<span data-ttu-id="8c6f2-457">Gränssnittets USB-beskrivning är följande:</span><span class="sxs-lookup"><span data-stu-id="8c6f2-457">The USB descriptor for the interface is as follows:</span></span>

| <span data-ttu-id="8c6f2-458">Offset</span><span class="sxs-lookup"><span data-stu-id="8c6f2-458">Offset</span></span> | <span data-ttu-id="8c6f2-459">Fält</span><span class="sxs-lookup"><span data-stu-id="8c6f2-459">Field</span></span>              | <span data-ttu-id="8c6f2-460">Storlek</span><span class="sxs-lookup"><span data-stu-id="8c6f2-460">Size</span></span> | <span data-ttu-id="8c6f2-461">Värde</span><span class="sxs-lookup"><span data-stu-id="8c6f2-461">Value</span></span>     | <span data-ttu-id="8c6f2-462">Script</span><span class="sxs-lookup"><span data-stu-id="8c6f2-462">Descriptor</span></span>                              |
| ------ | ------------------ | ---- | --------- | --------------------------------------- |
| <span data-ttu-id="8c6f2-463">0</span><span class="sxs-lookup"><span data-stu-id="8c6f2-463">0</span></span>      | <span data-ttu-id="8c6f2-464">bLength</span><span class="sxs-lookup"><span data-stu-id="8c6f2-464">bLength</span></span>            | <span data-ttu-id="8c6f2-465">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-465">1</span></span>    | <span data-ttu-id="8c6f2-466">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-466">Number</span></span>    | <span data-ttu-id="8c6f2-467">Storlek på den här beskrivningen i byte.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-467">Size of this descriptor in bytes.</span></span>       |
| <span data-ttu-id="8c6f2-468">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-468">1</span></span>      | <span data-ttu-id="8c6f2-469">bDescriptorType</span><span class="sxs-lookup"><span data-stu-id="8c6f2-469">bDescriptorType</span></span>    | <span data-ttu-id="8c6f2-470">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-470">1</span></span>    | <span data-ttu-id="8c6f2-471">Konstant</span><span class="sxs-lookup"><span data-stu-id="8c6f2-471">Constant</span></span>  | <span data-ttu-id="8c6f2-472">Typ av GRÄNSSNITTs Beskrivning</span><span class="sxs-lookup"><span data-stu-id="8c6f2-472">INTERFACE Descriptor Type</span></span>               |
| <span data-ttu-id="8c6f2-473">2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-473">2</span></span>      | <span data-ttu-id="8c6f2-474">bInterfaceNumber</span><span class="sxs-lookup"><span data-stu-id="8c6f2-474">bInterfaceNumber</span></span>   | <span data-ttu-id="8c6f2-475">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-475">1</span></span>    | <span data-ttu-id="8c6f2-476">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-476">Number</span></span>    | <span data-ttu-id="8c6f2-477">Antal gränssnitt.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-477">Number of interface.</span></span> <span data-ttu-id="8c6f2-478">Nollbaserat värde som identifierar indexet i matrisen med samtidiga gränssnitt som stöds av den här konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-478">Zero-based value identifying the index in the array of concurrent interfaces supported by this configuration.</span></span> |
| <span data-ttu-id="8c6f2-479">3</span><span class="sxs-lookup"><span data-stu-id="8c6f2-479">3</span></span>      | <span data-ttu-id="8c6f2-480">bAltenateSetting</span><span class="sxs-lookup"><span data-stu-id="8c6f2-480">bAltenateSetting</span></span>   | <span data-ttu-id="8c6f2-481">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-481">1</span></span>    | <span data-ttu-id="8c6f2-482">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-482">Number</span></span>    | <span data-ttu-id="8c6f2-483">Värde som används för att välja alternativ inställning för gränssnittet som identifierades i föregående fält.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-483">Value used to select alternate setting for the interface identified in the prior field.</span></span> |
| <span data-ttu-id="8c6f2-484">4</span><span class="sxs-lookup"><span data-stu-id="8c6f2-484">4</span></span>      | <span data-ttu-id="8c6f2-485">bNumEndpoints</span><span class="sxs-lookup"><span data-stu-id="8c6f2-485">bNumEndpoints</span></span>      | <span data-ttu-id="8c6f2-486">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-486">1</span></span>    | <span data-ttu-id="8c6f2-487">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-487">Number</span></span>    | <span data-ttu-id="8c6f2-488">Antal slut punkter som används av det här gränssnittet (exklusive slut punkten noll).</span><span class="sxs-lookup"><span data-stu-id="8c6f2-488">Number of endpoints used by this interface (excluding endpoint zero).</span></span> <span data-ttu-id="8c6f2-489">Om värdet är 0, använder det här gränssnittet bara slut punkt noll.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-489">If this value is 0, this interface only uses endpoint zero.</span></span> |
| <span data-ttu-id="8c6f2-490">5</span><span class="sxs-lookup"><span data-stu-id="8c6f2-490">5</span></span>      | <span data-ttu-id="8c6f2-491">bInterfaceClass</span><span class="sxs-lookup"><span data-stu-id="8c6f2-491">bInterfaceClass</span></span>    | <span data-ttu-id="8c6f2-492">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-492">1</span></span>    | <span data-ttu-id="8c6f2-493">Klass</span><span class="sxs-lookup"><span data-stu-id="8c6f2-493">Class</span></span>     | <span data-ttu-id="8c6f2-494">Klass kod (tilldelad av USB)</span><span class="sxs-lookup"><span data-stu-id="8c6f2-494">Class code (assigned by USB)</span></span><br /><span data-ttu-id="8c6f2-495">Om det här fältet återställs till 0, tillhör inte gränssnittet någon enhets klass som har angetts för USB.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-495">If this field is reset to 0, the interface does not belong to any USB specified device class.</span></span><br /><span data-ttu-id="8c6f2-496">Om det här fältet är inställt på 0xFF, är gränssnitts klassen leverantörsspecifik.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-496">If this field is set to 0xFF, the interface class is vendor specific.</span></span><br /><span data-ttu-id="8c6f2-497">Alla andra värden är reserverade för tilldelning av USB.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-497">All other values are reserved for assignment by USB.</span></span> |
| <span data-ttu-id="8c6f2-498">6</span><span class="sxs-lookup"><span data-stu-id="8c6f2-498">6</span></span>      | <span data-ttu-id="8c6f2-499">bInterfaceSubClass</span><span class="sxs-lookup"><span data-stu-id="8c6f2-499">bInterfaceSubClass</span></span> | <span data-ttu-id="8c6f2-500">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-500">1</span></span>    | <span data-ttu-id="8c6f2-501">Underklass</span><span class="sxs-lookup"><span data-stu-id="8c6f2-501">SubClass</span></span>  | <span data-ttu-id="8c6f2-502">Underklassens kod (tilldelad av USB).</span><span class="sxs-lookup"><span data-stu-id="8c6f2-502">Subclass code (assigned by USB).</span></span><br /><span data-ttu-id="8c6f2-503">Dessa koder är kvalificerade med värdet för fältet bInterfaceClass.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-503">These codes are qualified by the value of the bInterfaceClass field.</span></span> <span data-ttu-id="8c6f2-504">Om fältet bInterfaceClass återställs till 0 måste det här fältet också återställas till 0.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-504">If the bInterfaceClass field is reset to 0, this field must also be reset to 0.</span></span> <span data-ttu-id="8c6f2-505">Om fältet bInterfaceClass inte är inställt på 0xFF, är alla värden reserverade för tilldelning av USB.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-505">If the bInterfaceClass field is not set to 0xFF, all values are reserved for assignment by USB.</span></span> |
| <span data-ttu-id="8c6f2-506">7</span><span class="sxs-lookup"><span data-stu-id="8c6f2-506">7</span></span>      | <span data-ttu-id="8c6f2-507">bInterfaceProtocol</span><span class="sxs-lookup"><span data-stu-id="8c6f2-507">bInterfaceProtocol</span></span> | <span data-ttu-id="8c6f2-508">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-508">1</span></span>    | <span data-ttu-id="8c6f2-509">Protokoll</span><span class="sxs-lookup"><span data-stu-id="8c6f2-509">Protocol</span></span>  | <span data-ttu-id="8c6f2-510">Protokoll kod (tilldelad av USB).</span><span class="sxs-lookup"><span data-stu-id="8c6f2-510">Protocol code (assigned by USB).</span></span> <span data-ttu-id="8c6f2-511">Dessa koder kvalificeras av värdet för bInterfaceClass och bInterfaceSubClass-fälten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-511">These codes are qualified by the value of the bInterfaceClass and the bInterfaceSubClass fields.</span></span> <span data-ttu-id="8c6f2-512">Om ett gränssnitt stöder landsspecifika begär Anden identifierar den här koden de protokoll som enheten använder enligt specifikationen i enhets klassen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-512">If an interface supports class-specific requests, this code identifies the protocols that the device uses as defined by the specification of the device class.</span></span><br /><span data-ttu-id="8c6f2-513">Om det här fältet återställs till 0 använder enheten inte något klass protokoll i det här gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-513">If this field is reset to 0, the device does not use a class specific protocol on this interface.</span></span> <span data-ttu-id="8c6f2-514">Om det här fältet är inställt på 0xFF använder enheten ett leverantörsspecifika protokoll för det här gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-514">If this field is set to 0xFF, the device uses a vendor specific protocol for this interface.</span></span> |
| <span data-ttu-id="8c6f2-515">8</span><span class="sxs-lookup"><span data-stu-id="8c6f2-515">8</span></span>      | <span data-ttu-id="8c6f2-516">iInterface</span><span class="sxs-lookup"><span data-stu-id="8c6f2-516">iInterface</span></span>         | <span data-ttu-id="8c6f2-517">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-517">1</span></span>    | <span data-ttu-id="8c6f2-518">Index</span><span class="sxs-lookup"><span data-stu-id="8c6f2-518">Index</span></span>     | <span data-ttu-id="8c6f2-519">Index för sträng beskrivning som beskriver det här gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-519">Index of string descriptor describing this interface.</span></span> |

<span data-ttu-id="8c6f2-520">USBX definierar en USB-gränssnitts beskrivning på följande sätt.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-520">USBX defines a USB interface descriptor as follows.</span></span>

```c
typedef struct UX_INTERFACE_DESCRIPTOR_STRUCT
{
    UINT bLength;
    UINT bDescriptorType;
    UINT bInterfaceNumber;
    UINT bAlternateSetting;
    UINT bNumEndpoints;
    UINT bInterfaceClass
    UINT bInterfaceSubClass;
    UINT bInterfaceProtocol;
    UINT iInterface;
} UX_INTERFACE_DESCRIPTOR;
```

<span data-ttu-id="8c6f2-521">USB-gränssnittets beskrivning är en del av en gränssnitts behållare som beskrivs på följande sätt.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-521">The USB interface descriptor is part of an interface container described as follows.</span></span>

```c
typedef struct UX_INTERFACE_STRUCT
{
    ULONG ux_interface_handle;
    ULONG ux_interface_state;
    ULONG ux_interface_current_alternate_setting;
    struct UX_INTERFACE_DESCRIPTOR_STRUCT ux_interface_descriptor;
    struct UX_HOST_CLASS_STRUCT    *ux_interface_class;
    VOID    *ux_interface_class_instance;
    struct UX_ENDPOINT_STRUCT    *ux_interface_first_endpoint;
    struct UX_INTERFACE_STRUCT    *ux_interface_next_interface;
    struct UX_CONFIGURATION_STRUCT    *ux_interface_configuration;
} UX_INTERFACE;
```

- <span data-ttu-id="8c6f2-522">**ux_interface_handle**: referens för gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-522">**ux_interface_handle**: Handle of the interface.</span></span> <span data-ttu-id="8c6f2-523">Detta är vanligt vis adressen till instansen av den här strukturen för gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-523">This is typically the address of the instance of this structure for the interface.</span></span>
- <span data-ttu-id="8c6f2-524">**ux_interface_state**: gränssnittets tillstånd.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-524">**ux_interface_state**: State of the interface.</span></span>
- <span data-ttu-id="8c6f2-525">**ux_interface_descriptor**: USB-gränssnittets beskrivning.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-525">**ux_interface_descriptor**: USB interface descriptor.</span></span>
- <span data-ttu-id="8c6f2-526">**ux_interface_class**: pekar mot den klass typ som äger det här gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-526">**ux_interface_class**: Pointer to the class type that owns this interface.</span></span>
- <span data-ttu-id="8c6f2-527">**ux_interface_class_instance**: pekar mot instansen av klassen som äger det här gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-527">**ux_interface_class_instance**: Pointer to the instance of the class that owns this interface.</span></span>
- <span data-ttu-id="8c6f2-528">**ux_interface_first_endpoint**: pekar mot den första slut punkten som har registrerats med det här gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-528">**ux_interface_first_endpoint**: Pointer to the first endpoint registered with this interface.</span></span>
- <span data-ttu-id="8c6f2-529">**ux_interface_next_interface**: pekar mot nästa gränssnitt som är associerat med konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-529">**ux_interface_next_interface**: Pointer to the next interface associated with the configuration.</span></span>
- <span data-ttu-id="8c6f2-530">**ux_interface_configuration**: pekar mot konfigurations ägaren för det här gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-530">**ux_interface_configuration**: Pointer to the configuration owner of this interface.</span></span>

### <a name="endpoint-descriptors"></a><span data-ttu-id="8c6f2-531">Slut punkts beskrivningar</span><span class="sxs-lookup"><span data-stu-id="8c6f2-531">Endpoint Descriptors</span></span>

<span data-ttu-id="8c6f2-532">Varje slut punkt som är associerad med ett gränssnitt har sin egen slut punkts beskrivning.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-532">Each endpoint associated with an interface has its own endpoint descriptor.</span></span> <span data-ttu-id="8c6f2-533">Den här beskrivningen innehåller den information som krävs av värd stacken för att fastställa bandbredds kraven för varje slut punkt, maximal nytto last som är associerad med slut punkten, dess periodicitet och dess riktning.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-533">This descriptor contains the information required by the host stack to determine the bandwidth requirements of each endpoint, the maximum payload associated with the endpoint, its periodicity, and its direction.</span></span> <span data-ttu-id="8c6f2-534">En slut punkts Beskrivning returneras alltid av ett GET_DESCRIPTOR-kommando för konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-534">An endpoint descriptor is always returned by a GET_DESCRIPTOR command for the configuration.</span></span>

<span data-ttu-id="8c6f2-535">Standard kontroll punkten som är associerad med enhets beskrivningen räknas inte som en del av slut punkten (erna) som är associerad med gränssnittet och som därför inte returneras i den här beskrivningen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-535">The default control endpoint associated with the device descriptor is not counted as part of the endpoint(s) associated with the interface and therefore not returned in this descriptor.</span></span>

<span data-ttu-id="8c6f2-536">När värd program varan begär en ändring av den alternativa inställningen för ett gränssnitt, ändras alla associerade slut punkter och deras USB-resurser enligt den nya alternativa inställningen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-536">When the host software requests a change of the alternate setting for an interface, all the associated endpoints and their USB resources are modified according to the new alternate setting.</span></span>

<span data-ttu-id="8c6f2-537">Förutom standard kontroll slut punkter kan slut punkter inte dela mellan gränssnitt.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-537">Except for the default control endpoints, endpoints cannot be share between interfaces.</span></span>

| <span data-ttu-id="8c6f2-538">Offset</span><span class="sxs-lookup"><span data-stu-id="8c6f2-538">Offset</span></span> | <span data-ttu-id="8c6f2-539">Fält</span><span class="sxs-lookup"><span data-stu-id="8c6f2-539">Field</span></span>            | <span data-ttu-id="8c6f2-540">Storlek</span><span class="sxs-lookup"><span data-stu-id="8c6f2-540">Size</span></span> | <span data-ttu-id="8c6f2-541">Värde</span><span class="sxs-lookup"><span data-stu-id="8c6f2-541">Value</span></span>    | <span data-ttu-id="8c6f2-542">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="8c6f2-542">Description</span></span>                       |
| ------ | ---------------- | ---- | -------- | --------------------------------- |
| <span data-ttu-id="8c6f2-543">0</span><span class="sxs-lookup"><span data-stu-id="8c6f2-543">0</span></span>      | <span data-ttu-id="8c6f2-544">bLength</span><span class="sxs-lookup"><span data-stu-id="8c6f2-544">bLength</span></span>          | <span data-ttu-id="8c6f2-545">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-545">1</span></span>    | <span data-ttu-id="8c6f2-546">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-546">Number</span></span>   | <span data-ttu-id="8c6f2-547">Storlek på den här beskrivningen i byte.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-547">Size of this descriptor in bytes.</span></span> |
| <span data-ttu-id="8c6f2-548">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-548">1</span></span>      | <span data-ttu-id="8c6f2-549">bDescriptorType</span><span class="sxs-lookup"><span data-stu-id="8c6f2-549">bDescriptorType</span></span>  | <span data-ttu-id="8c6f2-550">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-550">1</span></span>    | <span data-ttu-id="8c6f2-551">Konstant</span><span class="sxs-lookup"><span data-stu-id="8c6f2-551">Constant</span></span> | <span data-ttu-id="8c6f2-552">Typ av slut PUNKTs beskrivning.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-552">ENDPOINT Descriptor Type.</span></span> |
| <span data-ttu-id="8c6f2-553">2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-553">2</span></span>      | <span data-ttu-id="8c6f2-554">bEndpointAddress</span><span class="sxs-lookup"><span data-stu-id="8c6f2-554">bEndpointAddress</span></span> | <span data-ttu-id="8c6f2-555">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-555">1</span></span>    | <span data-ttu-id="8c6f2-556">Slutpunkt</span><span class="sxs-lookup"><span data-stu-id="8c6f2-556">Endpoint</span></span> | <span data-ttu-id="8c6f2-557">Adressen till slut punkten på USB-enheten som beskrivs i den här beskrivningen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-557">The address of the endpoint on the USB device described by this descriptor.</span></span> <span data-ttu-id="8c6f2-558">Adressen kodas enligt följande:</span><span class="sxs-lookup"><span data-stu-id="8c6f2-558">The address is encoded as follows:</span></span><br /><span data-ttu-id="8c6f2-559">Bit 3... 0: slut punkts numret</span><span class="sxs-lookup"><span data-stu-id="8c6f2-559">Bit 3...0: The endpoint number</span></span><br /><span data-ttu-id="8c6f2-560">Bit 6... 4: reserverad, Återställ till noll</span><span class="sxs-lookup"><span data-stu-id="8c6f2-560">Bit 6...4: Reserved, reset to zero</span></span><br /><span data-ttu-id="8c6f2-561">Bit 7: Direction, ignoreras för kontroll slut punkter</span><span class="sxs-lookup"><span data-stu-id="8c6f2-561">Bit 7: Direction, ignored for control endpoints</span></span><br /><span data-ttu-id="8c6f2-562">0 = slut punkt</span><span class="sxs-lookup"><span data-stu-id="8c6f2-562">0 = OUT endpoint</span></span><br /><span data-ttu-id="8c6f2-563">1 = i slut punkt</span><span class="sxs-lookup"><span data-stu-id="8c6f2-563">1 = IN endpoint</span></span> |
| <span data-ttu-id="8c6f2-564">3</span><span class="sxs-lookup"><span data-stu-id="8c6f2-564">3</span></span>      | <span data-ttu-id="8c6f2-565">bmAttributes</span><span class="sxs-lookup"><span data-stu-id="8c6f2-565">bmAttributes</span></span>     | <span data-ttu-id="8c6f2-566">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-566">1</span></span>    | <span data-ttu-id="8c6f2-567">Bitmappsfilen</span><span class="sxs-lookup"><span data-stu-id="8c6f2-567">Bitmap</span></span>   | <span data-ttu-id="8c6f2-568">I det här fältet beskrivs slutpunktens attribut när den konfigureras med hjälp av fältet **bConfigurationValue** .</span><span class="sxs-lookup"><span data-stu-id="8c6f2-568">This field describes the endpoint's attributes when it is configured using the **bConfigurationValue** field.</span></span> <span data-ttu-id="8c6f2-569">Bitar 1.. 0: överförings typ</span><span class="sxs-lookup"><span data-stu-id="8c6f2-569">Bits 1..0: Transfer Type</span></span><br /><span data-ttu-id="8c6f2-570">00 = kontroll</span><span class="sxs-lookup"><span data-stu-id="8c6f2-570">00 = Control</span></span><br /><span data-ttu-id="8c6f2-571">01 = isokrona</span><span class="sxs-lookup"><span data-stu-id="8c6f2-571">01 = Isochronous</span></span><br /><span data-ttu-id="8c6f2-572">10 = Mass</span><span class="sxs-lookup"><span data-stu-id="8c6f2-572">10 = Bulk</span></span><br /><span data-ttu-id="8c6f2-573">11 = avbrott</span><span class="sxs-lookup"><span data-stu-id="8c6f2-573">11 = Interrupt</span></span><br /><span data-ttu-id="8c6f2-574">Om inte en isokrona slut punkt är BITS 5.. 2 reserverade och måste anges till noll.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-574">If not an isochronous endpoint, bits 5..2 are reserved and must be set to zero.</span></span> <span data-ttu-id="8c6f2-575">Om den är isokrona definieras de enligt följande:</span><span class="sxs-lookup"><span data-stu-id="8c6f2-575">If isochronous, they are defined as follows:</span></span><br /><span data-ttu-id="8c6f2-576">BITS 3.. 2: typ av synkronisering</span><span class="sxs-lookup"><span data-stu-id="8c6f2-576">Bits 3..2: Synchronization Type</span></span><br /><span data-ttu-id="8c6f2-577">00 = ingen synkronisering</span><span class="sxs-lookup"><span data-stu-id="8c6f2-577">00 = No Synchronization</span></span><br /><span data-ttu-id="8c6f2-578">01 = asynkron</span><span class="sxs-lookup"><span data-stu-id="8c6f2-578">01 = Asynchronous</span></span><br /><span data-ttu-id="8c6f2-579">10 = adaptiv</span><span class="sxs-lookup"><span data-stu-id="8c6f2-579">10 = Adaptive</span></span><br /><span data-ttu-id="8c6f2-580">11 = synkron</span><span class="sxs-lookup"><span data-stu-id="8c6f2-580">11 = Synchronous</span></span><br /><span data-ttu-id="8c6f2-581">BITS 5.. 4: användnings typ</span><span class="sxs-lookup"><span data-stu-id="8c6f2-581">Bits 5..4: Usage Type</span></span><br /><span data-ttu-id="8c6f2-582">00 = data slut punkt</span><span class="sxs-lookup"><span data-stu-id="8c6f2-582">00 = Data endpoint</span></span><br /><span data-ttu-id="8c6f2-583">01 = feedback-slutpunkt</span><span class="sxs-lookup"><span data-stu-id="8c6f2-583">01 = Feedback endpoint</span></span><br /><span data-ttu-id="8c6f2-584">10 = slut punkt för implicit feedback-data</span><span class="sxs-lookup"><span data-stu-id="8c6f2-584">10 = Implicit feedback data endpoint</span></span><br /><span data-ttu-id="8c6f2-585">11 = reserverad</span><span class="sxs-lookup"><span data-stu-id="8c6f2-585">11 = Reserved</span></span> |
| <span data-ttu-id="8c6f2-586">4</span><span class="sxs-lookup"><span data-stu-id="8c6f2-586">4</span></span>      | <span data-ttu-id="8c6f2-587">wMaxPacketSize</span><span class="sxs-lookup"><span data-stu-id="8c6f2-587">wMaxPacketSize</span></span>   | <span data-ttu-id="8c6f2-588">2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-588">2</span></span>    | <span data-ttu-id="8c6f2-589">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-589">Number</span></span>   | <span data-ttu-id="8c6f2-590">Maximal paket storlek den här slut punkten kan skicka eller ta emot när den här konfigurationen är vald.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-590">Maximum packet size this endpoint is capable of sending or receiving when this configuration is selected.</span></span><br /><span data-ttu-id="8c6f2-591">För isokrona slut punkter används det här värdet för att reservera buss tiden i schemat, vilket krävs för data nytto lasterna per-(Micro).</span><span class="sxs-lookup"><span data-stu-id="8c6f2-591">For isochronous endpoints, this value is used to reserve the bus time in the schedule, required for the per-(micro)frame data payloads.</span></span> <span data-ttu-id="8c6f2-592">Denna pipe kan regelbundet använda mindre bandbredd än den reserverade.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-592">The pipe may, on an ongoing basis, actually use less bandwidth than that reserved.</span></span> <span data-ttu-id="8c6f2-593">Enheten rapporterar vid behov den faktiska bandbredden som används via dess normala, icke-USB-definierade mekanismer.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-593">The device reports, if necessary, the actual bandwidth used via its normal, non-USB defined mechanisms.</span></span><br /><span data-ttu-id="8c6f2-594">För alla slut punkter anger BITS 10.. 0 den maximala paket storleken (i byte).</span><span class="sxs-lookup"><span data-stu-id="8c6f2-594">For all endpoints, bits 10..0 specify the maximum packet size (in bytes).</span></span><br /><span data-ttu-id="8c6f2-595">För höghastighets isokrona och avbrotts slut punkter:</span><span class="sxs-lookup"><span data-stu-id="8c6f2-595">For high-speed isochronous and interrupt endpoints:</span></span><br /><span data-ttu-id="8c6f2-596">BITS 12.. 11 Ange antalet ytterligare transaktions möjligheter per mikroram: 00 = ingen (1 transaktion per mikroram)</span><span class="sxs-lookup"><span data-stu-id="8c6f2-596">Bits 12..11 specify the number of additional transaction opportunities per microframe: 00 = None (1 transaction per microframe)</span></span><br /><span data-ttu-id="8c6f2-597">01 = 1 ytterligare (2 per mikroram)</span><span class="sxs-lookup"><span data-stu-id="8c6f2-597">01 = 1 additional (2 per microframe)</span></span><br /><span data-ttu-id="8c6f2-598">10 = 2 ytterligare (3 per mikrobild)</span><span class="sxs-lookup"><span data-stu-id="8c6f2-598">10 = 2 additional (3 per microframe)</span></span><br /><span data-ttu-id="8c6f2-599">11 = reserverad</span><span class="sxs-lookup"><span data-stu-id="8c6f2-599">11 = Reserved</span></span><br /><span data-ttu-id="8c6f2-600">Bitarna 15.. 13 är reserverade och måste anges till noll.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-600">Bits 15..13 are reserved and must be set to zero.</span></span> |
| <span data-ttu-id="8c6f2-601">6</span><span class="sxs-lookup"><span data-stu-id="8c6f2-601">6</span></span>      | <span data-ttu-id="8c6f2-602">bInterval</span><span class="sxs-lookup"><span data-stu-id="8c6f2-602">bInterval</span></span>        | <span data-ttu-id="8c6f2-603">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-603">1</span></span>     | <span data-ttu-id="8c6f2-604">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-604">Number</span></span>   | <span data-ttu-id="8c6f2-605">Nummer intervall för avsöknings slut punkt för data överföringar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-605">Number interval for polling endpoint for data transfers.</span></span><br /><span data-ttu-id="8c6f2-606">Uttrycks i ramar eller mikrobild rutor beroende på enhetens drifts hastighet (t. ex. 1 millisekund eller 125 μs-enheter).</span><span class="sxs-lookup"><span data-stu-id="8c6f2-606">Expressed in frames or microframes depending on the device operating speed (i.e., either 1 millisecond or 125 µs units).</span></span><br /><span data-ttu-id="8c6f2-607">För fullständig/High-Speed isokrona slut punkter måste det här värdet vara i intervallet från 1 till 16.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-607">For full-/high-speed isochronous endpoints, this value must be in the range from 1 to 16.</span></span> <span data-ttu-id="8c6f2-608">**BInterval** används som exponent för ett 2bInterval-1-värde. t. ex. är **bInterval** 4 en period på 8 (24-1).</span><span class="sxs-lookup"><span data-stu-id="8c6f2-608">The **bInterval** is used as the exponent for a 2bInterval-1 value; e.g., a **bInterval** 4 means a period of 8 (24-1).</span></span><br /><span data-ttu-id="8c6f2-609">Värdet för det här fältet kan vara mellan 1 och 255 för avbrotts slut punkter med fullständig/Low-Speed.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-609">For full-/low-speed interrupt endpoints, the value of this field may be from 1 to 255.</span></span><br /><span data-ttu-id="8c6f2-610">För snabba avbrotts slut punkter används **bInterval** som exponent för ett 2bInterval-1-värde. t. ex. är **bInterval** 4 en period på 8 (24-1).</span><span class="sxs-lookup"><span data-stu-id="8c6f2-610">For high-speed interrupt endpoints, the **bInterval** is used as the exponent for a 2bInterval-1 value; e.g., a **bInterval** 4 means a period of 8 (24-1).</span></span> <span data-ttu-id="8c6f2-611">Värdet måste vara mellan 1 och 16.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-611">This value must be from 1 to 16.</span></span><br /><span data-ttu-id="8c6f2-612">För Mass-och kontroll slut punkter med hög hastighet anger **bInterval** den maximala NAK-frekvensen för slut punkten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-612">For high-speed bulk/control OUT endpoints, the **bInterval** specify the maximum NAK rate of the endpoint.</span></span> <span data-ttu-id="8c6f2-613">Värdet 0 anger att slut punkten aldrig NAKs.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-613">A value of 0 indicates the endpoint never NAKs.</span></span> <span data-ttu-id="8c6f2-614">Andra värden anger högst en NAK varje **bInterval** för mikrobild rutor.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-614">Other values indicate at most one NAK each **bInterval** of microframes.</span></span><br /><span data-ttu-id="8c6f2-615">Värdet måste vara mellan 0 och 255.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-615">This value must be in the range from 0 to 255.</span></span> |

<span data-ttu-id="8c6f2-616">USBX definierar en identifierare för USB-slutpunkten enligt följande:</span><span class="sxs-lookup"><span data-stu-id="8c6f2-616">USBX defines a USB endpoint descriptor as follows:</span></span>

```c
typedef struct UX_ENDPOINT_DESCRIPTOR_STRUCT
{
    UINT bLength;
    UINT bDescriptorType;
    UINT bEndpointAddress;
    UINT bmAttributes;
    USHORT wMaxPacketSize;
    UINT bInterval;
} UX_ENDPOINT_DESCRIPTOR;
```

<span data-ttu-id="8c6f2-617">USB-slutpunktens beskrivning är en del av en slut punkts behållare, som beskrivs nedan.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-617">The USB endpoint descriptor is part of an endpoint container, which is described as follows.</span></span>

```c
typedef struct UX_ENDPOINT_STRUCT {
    ULONG    ux_endpoint_handle;
    ULONG    ux_endpoint_state;
    VOID    *ux_endpoint_ed;
    struct UX_ENDPOINT_DESCRIPTOR_STRUCT    ux_endpoint_descriptor;
    struct UX_ENDPOINT_STRUCT    *ux_endpoint_next_endpoint;
    struct UX_INTERFACE_STRUCT    *ux_endpoint_interface;
    struct UX_DEVICE_STRUCT    *ux_endpoint_device;
    struct UX_TRANSFER REQUEST_STRUCT    ux_endpoint_transfer request;
} UX_ENDPOINT;

```

- <span data-ttu-id="8c6f2-618">**ux_endpoint_handle**: referens för slut punkten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-618">**ux_endpoint_handle**: Handle of the endpoint.</span></span> <span data-ttu-id="8c6f2-619">Detta är vanligt vis adressen till instansen för den här strukturen för slut punkten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-619">This is typically the address of the instance of this structure for the endpoint.</span></span>
- <span data-ttu-id="8c6f2-620">**ux_endpoint_state**: tillstånd för slut punkten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-620">**ux_endpoint_state**: State of the endpoint.</span></span>
- <span data-ttu-id="8c6f2-621">**ux_endpoint_ed**: pekar mot den fysiska slut punkten på värd styrenhets skiktet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-621">**ux_endpoint_ed**: Pointer to the physical endpoint at the host controller layer.</span></span>
- <span data-ttu-id="8c6f2-622">**ux_endpoint_descriptor**: USB-slutpunktens beskrivning.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-622">**ux_endpoint_descriptor**: USB endpoint descriptor.</span></span>
- <span data-ttu-id="8c6f2-623">**ux_endpoint_next_endpoint**: pekar mot nästa slut punkt som tillhör samma gränssnitt.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-623">**ux_endpoint_next_endpoint**: Pointer to the next endpoint that belongs to the same interface.</span></span>
- <span data-ttu-id="8c6f2-624">**ux_endpoint_interface**: pekar mot gränssnittet som äger det här slut punkts gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-624">**ux_endpoint_interface**: Pointer to the interface that owns this endpoint interface.</span></span>
- <span data-ttu-id="8c6f2-625">**ux_endpoint_device**: pekar mot behållaren för överordnad enhet.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-625">**ux_endpoint_device**: Pointer to the parent device container.</span></span>
- <span data-ttu-id="8c6f2-626">**ux_endpoint_transfer begäran**: begäran om USB-överföring som används för att skicka/ta emot data från till/från enheten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-626">**ux_endpoint_transfer request**: USB transfer request used to send/receive data from to/from the device.</span></span>

### <a name="string-descriptors"></a><span data-ttu-id="8c6f2-627">Sträng beskrivningar</span><span class="sxs-lookup"><span data-stu-id="8c6f2-627">String descriptors</span></span>

<span data-ttu-id="8c6f2-628">Sträng beskrivningar är valfria.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-628">String descriptors are optional.</span></span> <span data-ttu-id="8c6f2-629">Om en enhet inte stöder sträng beskrivningar måste alla referenser till sträng beskrivningar i enhets-, konfigurations-och gränssnitts beskrivningar återställas till noll.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-629">If a device does not support string descriptors, all references to string descriptors within device, configuration, and interface descriptors must be reset to zero.</span></span>

<span data-ttu-id="8c6f2-630">Sträng beskrivningar använder UNICODE-kodning, vilket ger stöd för flera teckenuppsättningar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-630">String descriptors use UNICODE encoding, thus allowing the support for several character sets.</span></span> <span data-ttu-id="8c6f2-631">Strängarna i en USB-enhet kan ha stöd för flera språk.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-631">The strings in a USB device may support multiple languages.</span></span> <span data-ttu-id="8c6f2-632">När en sträng Beskrivning begärs anger beställaren det önskade språket med ett språk-ID som definieras av USB-IF.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-632">When requesting a string descriptor, the requester specifies the desired language using a language ID defined by the USB-IF.</span></span> <span data-ttu-id="8c6f2-633">Listan över för närvarande definierade USB-LANGIDs finns i USBX-tillägget??.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-633">The list of currently defined USB LANGIDs can be found in the USBX appendix ??.</span></span>
<span data-ttu-id="8c6f2-634">Sträng index noll för alla språk returnerar en sträng beskrivning som innehåller en matris med två bytes LANGID-koder som stöds av enheten.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-634">String index zero for all languages returns a string descriptor that contains an array of two-byte LANGID codes supported by the device.</span></span> <span data-ttu-id="8c6f2-635">Det bör noteras att UNICODE-strängen inte är 0 avslutad.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-635">It should be noted that the UNICODE string is not 0 terminated.</span></span> <span data-ttu-id="8c6f2-636">I stället beräknas storleken på sträng mat ris genom att subtrahera två från storleken på matrisen som finns i den första byten av beskrivningen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-636">Instead, the size of the string array is computed by subtracting two from the size of the array contained in the first byte of the descriptor.</span></span>

<span data-ttu-id="8c6f2-637">USB-sträng beskrivningen 0 kodas enligt följande.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-637">The USB string descriptor 0 is encoded as follows.</span></span>

| <span data-ttu-id="8c6f2-638">Offset</span><span class="sxs-lookup"><span data-stu-id="8c6f2-638">Offset</span></span> | <span data-ttu-id="8c6f2-639">Fält</span><span class="sxs-lookup"><span data-stu-id="8c6f2-639">Field</span></span>           | <span data-ttu-id="8c6f2-640">Storlek</span><span class="sxs-lookup"><span data-stu-id="8c6f2-640">Size</span></span> | <span data-ttu-id="8c6f2-641">Värde</span><span class="sxs-lookup"><span data-stu-id="8c6f2-641">Value</span></span>    | <span data-ttu-id="8c6f2-642">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="8c6f2-642">Description</span></span>                      |
| ------ | --------------- | ---- | -------- | -------------------------------- |
| <span data-ttu-id="8c6f2-643">0</span><span class="sxs-lookup"><span data-stu-id="8c6f2-643">0</span></span>      | <span data-ttu-id="8c6f2-644">bLength</span><span class="sxs-lookup"><span data-stu-id="8c6f2-644">bLength</span></span>         | <span data-ttu-id="8c6f2-645">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-645">1</span></span>    | <span data-ttu-id="8c6f2-646">N + 2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-646">N+2</span></span>      | <span data-ttu-id="8c6f2-647">Storlek på den här beskrivningen i byte</span><span class="sxs-lookup"><span data-stu-id="8c6f2-647">Size of this descriptor in bytes</span></span> |
| <span data-ttu-id="8c6f2-648">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-648">1</span></span>      | <span data-ttu-id="8c6f2-649">bDescriptorType</span><span class="sxs-lookup"><span data-stu-id="8c6f2-649">bDescriptorType</span></span> | <span data-ttu-id="8c6f2-650">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-650">1</span></span>    | <span data-ttu-id="8c6f2-651">Konstant</span><span class="sxs-lookup"><span data-stu-id="8c6f2-651">Constant</span></span> | <span data-ttu-id="8c6f2-652">STRÄNG beskrivnings typ</span><span class="sxs-lookup"><span data-stu-id="8c6f2-652">STRING Descriptor Type</span></span>           |
| <span data-ttu-id="8c6f2-653">2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-653">2</span></span>      | <span data-ttu-id="8c6f2-654">wLANGID [0]</span><span class="sxs-lookup"><span data-stu-id="8c6f2-654">wLANGID[0]</span></span>      | <span data-ttu-id="8c6f2-655">2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-655">2</span></span>    | <span data-ttu-id="8c6f2-656">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-656">Number</span></span>   | <span data-ttu-id="8c6f2-657">LANGID-kod 0</span><span class="sxs-lookup"><span data-stu-id="8c6f2-657">LANGID code 0</span></span>                    |
| <span data-ttu-id="8c6f2-658">...</span><span class="sxs-lookup"><span data-stu-id="8c6f2-658">...</span></span>    | <span data-ttu-id="8c6f2-659">...]</span><span class="sxs-lookup"><span data-stu-id="8c6f2-659">...]</span></span>            | <span data-ttu-id="8c6f2-660">...</span><span class="sxs-lookup"><span data-stu-id="8c6f2-660">...</span></span>  | <span data-ttu-id="8c6f2-661">...</span><span class="sxs-lookup"><span data-stu-id="8c6f2-661">...</span></span>      | <span data-ttu-id="8c6f2-662">...</span><span class="sxs-lookup"><span data-stu-id="8c6f2-662">...</span></span>                              |
| <span data-ttu-id="8c6f2-663">N</span><span class="sxs-lookup"><span data-stu-id="8c6f2-663">N</span></span>      | <span data-ttu-id="8c6f2-664">wLANGID [n]</span><span class="sxs-lookup"><span data-stu-id="8c6f2-664">wLANGID[n]</span></span>      | <span data-ttu-id="8c6f2-665">2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-665">2</span></span>    | <span data-ttu-id="8c6f2-666">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-666">Number</span></span>   | <span data-ttu-id="8c6f2-667">LANGID-kod n</span><span class="sxs-lookup"><span data-stu-id="8c6f2-667">LANGID code n</span></span>                    |

<span data-ttu-id="8c6f2-668">Andra USB-strängar är kodade enligt följande.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-668">Other USB string descriptors are encoded as follows.</span></span>

| <span data-ttu-id="8c6f2-669">Offset</span><span class="sxs-lookup"><span data-stu-id="8c6f2-669">Offset</span></span> | <span data-ttu-id="8c6f2-670">Fält</span><span class="sxs-lookup"><span data-stu-id="8c6f2-670">Field</span></span>           | <span data-ttu-id="8c6f2-671">Storlek</span><span class="sxs-lookup"><span data-stu-id="8c6f2-671">Size</span></span> | <span data-ttu-id="8c6f2-672">Värde</span><span class="sxs-lookup"><span data-stu-id="8c6f2-672">Value</span></span>    | <span data-ttu-id="8c6f2-673">Beskrivning</span><span class="sxs-lookup"><span data-stu-id="8c6f2-673">Description</span></span>                      |
| ------ | --------------- | ---- | -------- | -------------------------------- |
| <span data-ttu-id="8c6f2-674">0</span><span class="sxs-lookup"><span data-stu-id="8c6f2-674">0</span></span>      | <span data-ttu-id="8c6f2-675">bLength</span><span class="sxs-lookup"><span data-stu-id="8c6f2-675">bLength</span></span>         | <span data-ttu-id="8c6f2-676">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-676">1</span></span>    | <span data-ttu-id="8c6f2-677">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-677">Number</span></span>   | <span data-ttu-id="8c6f2-678">Storlek på den här beskrivningen i byte</span><span class="sxs-lookup"><span data-stu-id="8c6f2-678">Size of this descriptor in bytes</span></span> |
| <span data-ttu-id="8c6f2-679">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-679">1</span></span>      | <span data-ttu-id="8c6f2-680">bDescriptorType</span><span class="sxs-lookup"><span data-stu-id="8c6f2-680">bDescriptorType</span></span> | <span data-ttu-id="8c6f2-681">1</span><span class="sxs-lookup"><span data-stu-id="8c6f2-681">1</span></span>    | <span data-ttu-id="8c6f2-682">Konstant</span><span class="sxs-lookup"><span data-stu-id="8c6f2-682">Constant</span></span> | <span data-ttu-id="8c6f2-683">STRÄNG beskrivnings typ</span><span class="sxs-lookup"><span data-stu-id="8c6f2-683">STRING Descriptor Type</span></span>           |
| <span data-ttu-id="8c6f2-684">2</span><span class="sxs-lookup"><span data-stu-id="8c6f2-684">2</span></span>      | <span data-ttu-id="8c6f2-685">bString</span><span class="sxs-lookup"><span data-stu-id="8c6f2-685">bString</span></span>         | <span data-ttu-id="8c6f2-686">n</span><span class="sxs-lookup"><span data-stu-id="8c6f2-686">n</span></span>    | <span data-ttu-id="8c6f2-687">Antal</span><span class="sxs-lookup"><span data-stu-id="8c6f2-687">Number</span></span>   | <span data-ttu-id="8c6f2-688">UNICODE-kodad sträng</span><span class="sxs-lookup"><span data-stu-id="8c6f2-688">UNICODE encoded string</span></span>           |

<span data-ttu-id="8c6f2-689">USBX definierar en USB-sträng med nollängd som inte är noll enligt följande:</span><span class="sxs-lookup"><span data-stu-id="8c6f2-689">USBX defines a non-zero length USB string descriptor as follows:</span></span>

```c
typedef struct UX_STRING_DESCRIPTOR_STRUCT
{
    UINT bLength;
    UINT bDescriptorType;
    USHORT bString[1];
} UX_STRING_DESCRIPTOR;
```

### <a name="functional-descriptors"></a><span data-ttu-id="8c6f2-690">Funktionella beskrivare</span><span class="sxs-lookup"><span data-stu-id="8c6f2-690">Functional Descriptors</span></span>

<span data-ttu-id="8c6f2-691">Funktionella beskrivningar kallas även för klassbaserade beskrivningar.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-691">Functional descriptors are also known as class-specific descriptors.</span></span> <span data-ttu-id="8c6f2-692">De använder normalt samma grundläggande strukturer som allmänna beskrivningar och gör att ytterligare information kan vara tillgänglig för klassen.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-692">They normally use the same basic structures as generic descriptors and allow for additional information to be available to the class.</span></span> <span data-ttu-id="8c6f2-693">Om t. ex. USB-ljudhögtalart är fallet tillåter klassbaserade beskrivningar ljud klassen att hämta för varje alternativ inställning vilken typ av ljud frekvens som stöds.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-693">For example, in the case of the USB audio speaker, class specific descriptors allow the audio class to retrieve for each alternate setting the type of audio frequency supported.</span></span>

### <a name="usbx-device-descriptor-framework-in-memory"></a><span data-ttu-id="8c6f2-694">Ramverk för USBX Device Descriptor i minnet</span><span class="sxs-lookup"><span data-stu-id="8c6f2-694">USBX Device Descriptor Framework in Memory</span></span>

<span data-ttu-id="8c6f2-695">USBX hanterar de flesta enhets beskrivningar i minnet, det vill säga alla beskrivare förutom strängen och funktions beskrivare.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-695">USBX maintains most device descriptors in memory, that is, all descriptors except the string and functional descriptors.</span></span> <span data-ttu-id="8c6f2-696">Följande diagram visar hur dessa beskrivningar lagras och är relaterade.</span><span class="sxs-lookup"><span data-stu-id="8c6f2-696">The following diagram shows how these descriptors are stored and related.</span></span>

![Ramverk för USBX Device Descriptor i minnet](./media/usbx-host-stack/usbx-device-descriptor-framework.png)
