---
title: Kapitel 1 – Introduktion till Azure återställnings tider NetX DHCP-server
description: Programmet upprättar kommunikation med sin Azure återställnings tider-NetX DHCP-server för att dynamiskt begära och erhålla en IP-adress.
author: philmea
ms.author: philmea
ms.date: 06/04/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 17438a20ad3da64c88c3d6bb19a4887c2c6e354e
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 03/22/2021
ms.locfileid: "104826793"
---
# <a name="chapter-1---introduction-to-azure-rtos-netx-dhcp-server"></a><span data-ttu-id="a8558-103">Kapitel 1 – Introduktion till Azure återställnings tider NetX DHCP-server</span><span class="sxs-lookup"><span data-stu-id="a8558-103">Chapter 1 - Introduction to Azure RTOS NetX DHCP Server</span></span>

<span data-ttu-id="a8558-104">I NetX är programmets IP-adress en av de angivna parametrarna för *nx_ip_create* tjänst anropet.</span><span class="sxs-lookup"><span data-stu-id="a8558-104">In NetX, the application's IP address is one of the supplied parameters to the *nx_ip_create* service call.</span></span> <span data-ttu-id="a8558-105">Att tillhandahålla IP-adressen innebär inget problem om IP-adressen är känd för programmet, antingen statiskt eller via användar konfiguration.</span><span class="sxs-lookup"><span data-stu-id="a8558-105">Supplying the IP address poses no problem if the IP address is known to the application, either statically or through user configuration.</span></span> <span data-ttu-id="a8558-106">Det finns dock vissa instanser där programmet inte känner till eller bryr sig om dess IP-adress.</span><span class="sxs-lookup"><span data-stu-id="a8558-106">However, there are some instances where the application doesn't know or care what its IP address is.</span></span> <span data-ttu-id="a8558-107">I sådana fall ska en noll IP-adress anges till *nx_ip_create* -funktionen och programmet upprättar kommunikation med sin Azure återställnings tider netx DHCP-server för att dynamiskt begära och erhålla en IP-adress.</span><span class="sxs-lookup"><span data-stu-id="a8558-107">In such situations, a zero IP address should be supplied to the *nx_ip_create* function and the application establishes communication with its Azure RTOS NetX DHCP server to dynamically request and obtain an IP address.</span></span>

## <a name="dynamic-ip-address-assignment"></a><span data-ttu-id="a8558-108">Dynamisk IP-adresstilldelning</span><span class="sxs-lookup"><span data-stu-id="a8558-108">Dynamic IP Address Assignment</span></span>

<span data-ttu-id="a8558-109">Den grundläggande tjänsten som används för att hämta en dynamisk IP-adress från nätverket är RARP (reversed Address Resolution Protocol).</span><span class="sxs-lookup"><span data-stu-id="a8558-109">The basic service used to obtain a dynamic IP address from the network is the Reverse Address Resolution Protocol (RARP).</span></span> <span data-ttu-id="a8558-110">Det här protokollet liknar ARP, förutom att det är utformat för att hämta en IP-adress för sig själv i stället för att hitta MAC-adressen för en annan nätverksmapp.</span><span class="sxs-lookup"><span data-stu-id="a8558-110">This protocol is similar to ARP, except it is designed to obtain an IP address for itself instead of finding the MAC address for another network node.</span></span> <span data-ttu-id="a8558-111">Lågnivå-RARP-meddelandet skickas i det lokala nätverket och det är ansvaret för att en server i nätverket ska svara med ett RARP-svar som innehåller en dynamiskt tilldelad IP-adress.</span><span class="sxs-lookup"><span data-stu-id="a8558-111">The low-level RARP message is broadcast on the local network and it is the responsibility of a server on the network to respond with an RARP response, which contains a dynamically allocated IP address.</span></span>

<span data-ttu-id="a8558-112">Även om RARP tillhandahåller en tjänst för dynamisk allokering av IP-adresser, har den flera brister.</span><span class="sxs-lookup"><span data-stu-id="a8558-112">Although RARP provides a service for dynamic allocation of IP addresses, it has several shortcomings.</span></span> <span data-ttu-id="a8558-113">De mest avbländnings bristen är att RARP endast tillhandahåller dynamisk tilldelning av IP-adressen.</span><span class="sxs-lookup"><span data-stu-id="a8558-113">The most glaring deficiency is that RARP only provides dynamic allocation of the IP address.</span></span> <span data-ttu-id="a8558-114">I de flesta situationer krävs mer information för att en enhet ska kunna delta i ett nätverk.</span><span class="sxs-lookup"><span data-stu-id="a8558-114">In most situations, more information is necessary in order for a device to properly participate on a network.</span></span> <span data-ttu-id="a8558-115">Förutom en IP-adress behöver de flesta enheter nätverks masken och gatewayens IP-adress.</span><span class="sxs-lookup"><span data-stu-id="a8558-115">In addition to an IP address, most devices need the network mask and the gateway IP address.</span></span> <span data-ttu-id="a8558-116">IP-adressen för en DNS-server och annan nätverks information kan också behövas.</span><span class="sxs-lookup"><span data-stu-id="a8558-116">The IP address of a DNS server and other network information may also be needed.</span></span> <span data-ttu-id="a8558-117">RARP har inte möjlighet att ange den här informationen.</span><span class="sxs-lookup"><span data-stu-id="a8558-117">RARP does not have the ability to provide this information.</span></span>

## <a name="rarp-alternatives"></a><span data-ttu-id="a8558-118">RARP alternativ</span><span class="sxs-lookup"><span data-stu-id="a8558-118">RARP Alternatives</span></span>

<span data-ttu-id="a8558-119">För att kunna kringgå brister i RARP utvecklade forskare en mer omfattande mekanism för allokering av IP-adresser som kallas BOOTP (Bootstrap Protocol).</span><span class="sxs-lookup"><span data-stu-id="a8558-119">In order to overcome the deficiencies of RARP, researchers developed a more comprehensive IP address allocation mechanism called the Bootstrap Protocol (BOOTP).</span></span> <span data-ttu-id="a8558-120">Det här protokollet har möjlighet att dynamiskt allokera en IP-adress och även ange ytterligare viktig nätverks information.</span><span class="sxs-lookup"><span data-stu-id="a8558-120">This protocol has the ability to dynamically allocate an IP address and also provide additional important network information.</span></span> <span data-ttu-id="a8558-121">BOOTP har dock en nackdel med att utformas för statiska nätverkskonfigurationer.</span><span class="sxs-lookup"><span data-stu-id="a8558-121">However, BOOTP has the drawback of being designed for static network configurations.</span></span> <span data-ttu-id="a8558-122">Den tillåter inte snabb eller automatisk adress tilldelning.</span><span class="sxs-lookup"><span data-stu-id="a8558-122">It does not allow for quick or automated address assignment.</span></span>

<span data-ttu-id="a8558-123">Det är här som Dynamic Host Configuration Protocol (DHCP) är mycket användbart.</span><span class="sxs-lookup"><span data-stu-id="a8558-123">This is where the Dynamic Host Configuration Protocol (DHCP) is extremely useful.</span></span> <span data-ttu-id="a8558-124">DHCP har utformats för att utöka de grundläggande funktionerna i BOOTP för att inkludera helt automatiserad allokering av IP-servrar och fullständig dynamisk IP-adressallokering genom att "leasa" en IP-adress till en klient under en angiven tids period.</span><span class="sxs-lookup"><span data-stu-id="a8558-124">DHCP is designed to extend the basic functionality of BOOTP to include completely automated IP server allocation and completely dynamic IP address allocation through "leasing" an IP address to a client for a specified period of time.</span></span> <span data-ttu-id="a8558-125">DHCP kan också konfigureras för att allokera IP-adresser på ett statiskt sätt som BOOTP.</span><span class="sxs-lookup"><span data-stu-id="a8558-125">DHCP can also be configured to allocate IP addresses in a static manner like BOOTP.</span></span>

## <a name="dhcp-messages"></a><span data-ttu-id="a8558-126">DHCP-meddelanden</span><span class="sxs-lookup"><span data-stu-id="a8558-126">DHCP Messages</span></span>

<span data-ttu-id="a8558-127">Även om DHCP avsevärt förbättrar funktionerna i BOOTP, använder DHCP samma meddelande format som BOOTP och stöder samma leverantörs alternativ som BOOTP.</span><span class="sxs-lookup"><span data-stu-id="a8558-127">Although DHCP greatly enhances the functionality of BOOTP, DHCP uses the same message format as BOOTP and supports the same vendor options as BOOTP.</span></span> <span data-ttu-id="a8558-128">För att kunna utföra sin funktion introducerar DHCP sju nya DHCP-alternativ, enligt följande:</span><span class="sxs-lookup"><span data-stu-id="a8558-128">In order to perform its function, DHCP introduces seven new DHCP-specific options, as follows:</span></span>

| <span data-ttu-id="a8558-129">Alternativ</span><span class="sxs-lookup"><span data-stu-id="a8558-129">Option</span></span>     | <span data-ttu-id="a8558-130">Värde</span><span class="sxs-lookup"><span data-stu-id="a8558-130">Value</span></span> | <span data-ttu-id="a8558-131">Ursprung</span><span class="sxs-lookup"><span data-stu-id="a8558-131">Origin</span></span>                |
| ---------- | ----- | --------------------- |
| <span data-ttu-id="a8558-132">UNDERSÖKA</span><span class="sxs-lookup"><span data-stu-id="a8558-132">DISCOVER</span></span>   | <span data-ttu-id="a8558-133">81.1</span><span class="sxs-lookup"><span data-stu-id="a8558-133">(1)</span></span>   | <span data-ttu-id="a8558-134">(skickas av DHCP-klienten)</span><span class="sxs-lookup"><span data-stu-id="a8558-134">(sent by DHCP Client)</span></span> |
| <span data-ttu-id="a8558-135">STYRELSE</span><span class="sxs-lookup"><span data-stu-id="a8558-135">OFFER</span></span>      | <span data-ttu-id="a8558-136">(2)</span><span class="sxs-lookup"><span data-stu-id="a8558-136">(2)</span></span>   | <span data-ttu-id="a8558-137">(skickas av DHCP-servern)</span><span class="sxs-lookup"><span data-stu-id="a8558-137">(sent by DHCP Server)</span></span> |
| <span data-ttu-id="a8558-138">ANMODA</span><span class="sxs-lookup"><span data-stu-id="a8558-138">REQUEST</span></span>    | <span data-ttu-id="a8558-139">3</span><span class="sxs-lookup"><span data-stu-id="a8558-139">(3)</span></span>   | <span data-ttu-id="a8558-140">(skickas av DHCP-klienten)</span><span class="sxs-lookup"><span data-stu-id="a8558-140">(sent by DHCP Client)</span></span> |
| <span data-ttu-id="a8558-141">VÄGRAR</span><span class="sxs-lookup"><span data-stu-id="a8558-141">DECLINE</span></span>    | <span data-ttu-id="a8558-142">4</span><span class="sxs-lookup"><span data-stu-id="a8558-142">(4)</span></span>   | <span data-ttu-id="a8558-143">(skickas av DHCP-klienten)</span><span class="sxs-lookup"><span data-stu-id="a8558-143">(sent by DHCP Client)</span></span> |
| <span data-ttu-id="a8558-144">Följ</span><span class="sxs-lookup"><span data-stu-id="a8558-144">ACK</span></span>        | <span data-ttu-id="a8558-145">5</span><span class="sxs-lookup"><span data-stu-id="a8558-145">(5)</span></span>   | <span data-ttu-id="a8558-146">(skickas av DHCP-servern)</span><span class="sxs-lookup"><span data-stu-id="a8558-146">(sent by DHCP Server)</span></span> |
| <span data-ttu-id="a8558-147">NACK</span><span class="sxs-lookup"><span data-stu-id="a8558-147">NACK</span></span>       | <span data-ttu-id="a8558-148">3-6</span><span class="sxs-lookup"><span data-stu-id="a8558-148">(6)</span></span>   | <span data-ttu-id="a8558-149">(skickas av DHCP-servern)</span><span class="sxs-lookup"><span data-stu-id="a8558-149">(sent by DHCP Server)</span></span> |
| <span data-ttu-id="a8558-150">LANSERING</span><span class="sxs-lookup"><span data-stu-id="a8558-150">RELEASE</span></span>    | <span data-ttu-id="a8558-151">(7)</span><span class="sxs-lookup"><span data-stu-id="a8558-151">(7)</span></span>   | <span data-ttu-id="a8558-152">(skickas av DHCP-klienten)</span><span class="sxs-lookup"><span data-stu-id="a8558-152">(sent by DHCP Client)</span></span> |
| <span data-ttu-id="a8558-153">RÄTT</span><span class="sxs-lookup"><span data-stu-id="a8558-153">INFORM</span></span>     | <span data-ttu-id="a8558-154">(8)</span><span class="sxs-lookup"><span data-stu-id="a8558-154">(8)</span></span>   | <span data-ttu-id="a8558-155">(skickas av DHCP-klienten)</span><span class="sxs-lookup"><span data-stu-id="a8558-155">(sent by DHCP Client)</span></span> |
| <span data-ttu-id="a8558-156">FORCERENEW</span><span class="sxs-lookup"><span data-stu-id="a8558-156">FORCERENEW</span></span> | <span data-ttu-id="a8558-157">1.9</span><span class="sxs-lookup"><span data-stu-id="a8558-157">(9)</span></span>   | <span data-ttu-id="a8558-158">(skickas av DHCP-klienten)</span><span class="sxs-lookup"><span data-stu-id="a8558-158">(sent by DHCP Client)</span></span> |

## <a name="dhcp-communication"></a><span data-ttu-id="a8558-159">DHCP-kommunikation</span><span class="sxs-lookup"><span data-stu-id="a8558-159">DHCP Communication</span></span>

<span data-ttu-id="a8558-160">DHCP-servern använder UDP-protokollet för att ta emot begär Anden om DHCP-klienter och överförings svar.</span><span class="sxs-lookup"><span data-stu-id="a8558-160">The DHCP Server utilizes the UDP protocol to receive DHCP Client requests and transmit responses.</span></span> <span data-ttu-id="a8558-161">Innan du använder en IP-adress skickas och tas UDP-meddelanden med DHCP-informationen genom att använda IP-broadcast-adressen 255.255.255.255.</span><span class="sxs-lookup"><span data-stu-id="a8558-161">Prior to having an IP address, UDP messages carrying the DHCP information are sent and received by utilizing the IP broadcast address of 255.255.255.255.</span></span> <span data-ttu-id="a8558-162">Men om klienten känner till adressen till DHCP-servern kan det skicka DHCP-meddelanden med unicast-meddelanden.</span><span class="sxs-lookup"><span data-stu-id="a8558-162">However, if the Client knows the address of the DHCP Server it may send DHCP messages using unicast messages.</span></span>

## <a name="dhcp-server-state-machine"></a><span data-ttu-id="a8558-163">Status dator för DHCP-server</span><span class="sxs-lookup"><span data-stu-id="a8558-163">DHCP Server State Machine</span></span>

<span data-ttu-id="a8558-164">DHCP-servern implementeras som en dator med två steg som bearbetas av en intern DHCP-tråd som skapas under *nx_dhcp_server_create* bearbetning.</span><span class="sxs-lookup"><span data-stu-id="a8558-164">The DHCP Server is implemented as a two-step state machine processed by an internal DHCP thread that is created during *nx_dhcp_server_create* processing.</span></span> <span data-ttu-id="a8558-165">Huvud tillstånden för DHCP-servern är 1) om du tar emot ett IDENTIFIERINGs meddelande från en DHCP-klient och 2) får du ett meddelande om begäran.</span><span class="sxs-lookup"><span data-stu-id="a8558-165">The main states of DHCP Server are 1) receiving a DISCOVER message from a DHCP client and 2) receiving a REQUEST message.</span></span>

<span data-ttu-id="a8558-166">Nedan visas motsvarande DHCP-klient tillstånd:</span><span class="sxs-lookup"><span data-stu-id="a8558-166">Below are the corresponding DHCP Client states:</span></span>

- <span data-ttu-id="a8558-167">**NX_DHCP_STATE_BOOT**: från och med en tidigare IP-adress</span><span class="sxs-lookup"><span data-stu-id="a8558-167">**NX_DHCP_STATE_BOOT**: Starting with a previous IP address</span></span>
- <span data-ttu-id="a8558-168">**NX_DHCP_STATE_INIT**: startar utan föregående IP-adress värde</span><span class="sxs-lookup"><span data-stu-id="a8558-168">**NX_DHCP_STATE_INIT**: Starting with no previous IP address value</span></span>
- <span data-ttu-id="a8558-169">**NX_DHCP_STATE_SELECTING**: väntar på svar från valfri DHCP-server</span><span class="sxs-lookup"><span data-stu-id="a8558-169">**NX_DHCP_STATE_SELECTING**: Waiting for a response from any DHCP server</span></span>
- <span data-ttu-id="a8558-170">**NX_DHCP_STATE_REQUESTING**: den identifierade DHCP-servern skickade begäran om IP-adress</span><span class="sxs-lookup"><span data-stu-id="a8558-170">**NX_DHCP_STATE_REQUESTING**: DHCP Server identified, IP address request sent</span></span>
- <span data-ttu-id="a8558-171">**NX_DHCP_STATE_BOUND**: IP-adresslån för DHCP har etablerats</span><span class="sxs-lookup"><span data-stu-id="a8558-171">**NX_DHCP_STATE_BOUND**: DHCP IP Address lease established</span></span>
- <span data-ttu-id="a8558-172">**NX_DHCP_STATE_RENEWING**: förnyelse tiden för DHCP IP-adresslån förflutit, förnyelse begärd</span><span class="sxs-lookup"><span data-stu-id="a8558-172">**NX_DHCP_STATE_RENEWING**: DHCP IP Address lease renewal time elapsed, renewal requested</span></span>
- <span data-ttu-id="a8558-173">**NX_DHCP_STATE_REBINDING**: Förfluten tid för DHCP IP-adresslån återbinds, förnyelse begärd</span><span class="sxs-lookup"><span data-stu-id="a8558-173">**NX_DHCP_STATE_REBINDING**: DHCP IP Address lease rebind time elapsed, renewal requested</span></span>
- <span data-ttu-id="a8558-174">**NX_DHCP_STATE_FORCERENEW**: IP-adresslån upprättas, framtvinga förnyelse av Server eller program</span><span class="sxs-lookup"><span data-stu-id="a8558-174">**NX_DHCP_STATE_FORCERENEW**: DHCP IP Address lease established, force renewal by server or by application</span></span>
- <span data-ttu-id="a8558-175">**NX_DHCP_STATE_FAILED**: ingen server hittades eller inget svar från servern togs emot</span><span class="sxs-lookup"><span data-stu-id="a8558-175">**NX_DHCP_STATE_FAILED**: No server found or no response from server received</span></span>

## <a name="dhcp-additional-parameters"></a><span data-ttu-id="a8558-176">Ytterligare DHCP-parametrar</span><span class="sxs-lookup"><span data-stu-id="a8558-176">DHCP Additional Parameters</span></span>

<span data-ttu-id="a8558-177">NetX DHCP-servern har en standard lista med alternativ parametrar som anges i det konfigurerbara alternativet NX_DHCP_DEFAULT_SERVER_OPTION_LISTin *nx_dhcp_server. h* för att tillhandahålla DHCP-klienter med gemensamma/kritiska nätverks konfigurations parametrar, t. ex. router eller Gateway-adress och DNS-server för DHCP-klienten.</span><span class="sxs-lookup"><span data-stu-id="a8558-177">The NetX DHCP Server has a default list of option parameters which is set in the configurable option NX_DHCP_DEFAULT_SERVER_OPTION_LISTin *nx_dhcp_server.h* to supply DHCP Clients with common/critical network configuration parameters e.g. router or gateway address and DNS server for the DHCP Client.</span></span>

## <a name="dhcp-rfcs"></a><span data-ttu-id="a8558-178">DHCP-rapporter</span><span class="sxs-lookup"><span data-stu-id="a8558-178">DHCP RFCs</span></span>

<span data-ttu-id="a8558-179">NetX DHCP-server är kompatibel med RFC2132, RFC2131 och relaterade RFC: er.</span><span class="sxs-lookup"><span data-stu-id="a8558-179">NetX DHCP Server is compliant with RFC2132, RFC2131, and related RFCs.</span></span>
