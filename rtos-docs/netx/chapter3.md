---
title: Kapitel 3 – funktionella komponenter i Azure återställnings tider NetX
description: Det här kapitlet innehåller en beskrivning av den högpresterande Azure-återställnings tider NetX TCP/IP-stacken från ett funktionellt perspektiv.
author: philmea
ms.author: philmea
ms.date: 05/19/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: db23aa152b2765ac7cc9be098723fc5df0947484
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 03/22/2021
ms.locfileid: "104826886"
---
# <a name="chapter-3---functional-components-of-azure-rtos-netx"></a><span data-ttu-id="d0a19-103">Kapitel 3 – funktionella komponenter i Azure återställnings tider NetX</span><span class="sxs-lookup"><span data-stu-id="d0a19-103">Chapter 3 - Functional Components of Azure RTOS NetX</span></span>

<span data-ttu-id="d0a19-104">Det här kapitlet innehåller en beskrivning av den högpresterande Azure-återställnings tider NetX TCP/IP-stacken från ett funktionellt perspektiv.</span><span class="sxs-lookup"><span data-stu-id="d0a19-104">This chapter contains a description of the high-performance Azure RTOS NetX TCP/IP stack from a functional perspective.</span></span> 

## <a name="execution-overview"></a><span data-ttu-id="d0a19-105">Översikt över körning</span><span class="sxs-lookup"><span data-stu-id="d0a19-105">Execution Overview</span></span>

<span data-ttu-id="d0a19-106">Det finns fem typer av program körningar i ett NetX-program: initiering, program gränssnitts anrop, intern IP-tråd, periodiska timers och nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-106">There are five types of program execution within a NetX application: initialization, application interface calls, internal IP thread, IP periodic timers, and the network driver.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-107">NetX kräver installation av ThreadX och beror på dess tråd körning, avbrytande, periodiska timers och ömsesidiga undantags funktioner.</span><span class="sxs-lookup"><span data-stu-id="d0a19-107">NetX requires the installation of ThreadX and depends on its thread execution, suspension, periodic timers, and mutual exclusion facilities.</span></span>

### <a name="initialization"></a><span data-ttu-id="d0a19-108">Initiering</span><span class="sxs-lookup"><span data-stu-id="d0a19-108">Initialization</span></span>

<span data-ttu-id="d0a19-109">Tjänsten \***nx_system_initialize** _ måste anropas innan någon annan netx-tjänst anropas.</span><span class="sxs-lookup"><span data-stu-id="d0a19-109">The service \***nx_system_initialize** _ must be called before any other NetX service is called.</span></span> <span data-ttu-id="d0a19-110">System initiering kan anropas antingen från ThreadX _ *_tx_application_define_*\* rutin eller från program trådar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-110">System initialization can be called either from the ThreadX _ *_tx_application_define_*\* routine or from application threads.</span></span>

<span data-ttu-id="d0a19-111">Efter \***nx_system_initialize** _ returnerar, är systemet redo att skapa paket pooler och IP-instanser.</span><span class="sxs-lookup"><span data-stu-id="d0a19-111">After \***nx_system_initialize** _ returns, the system is ready to create packet pools and IP instances.</span></span> <span data-ttu-id="d0a19-112">Eftersom det krävs en standardpool för att skapa en IP-instans måste det finnas minst en NetX-modempool innan en IP-instans skapas.</span><span class="sxs-lookup"><span data-stu-id="d0a19-112">Because creating an IP instance requires a default packet pool, at least one NetX packet pool must exist prior to creating an IP instance.</span></span> <span data-ttu-id="d0a19-113">Det går att skapa paket pooler och IP-instanser från initierings funktionen ThreadX _ *_tx_application_define_*\* och från program trådar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-113">Creating packet pools and IP instances are allowed from the ThreadX initialization function _ *_tx_application_define_*\* and from application threads.</span></span>

<span data-ttu-id="d0a19-114">Internt skapas en IP-instans i två delar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-114">Internally, creating an IP instance is accomplished in two parts.</span></span> <span data-ttu-id="d0a19-115">Den första delen görs inom kontexten för anroparen, antingen från ***tx_application_define*** eller från en program tråds kontext.</span><span class="sxs-lookup"><span data-stu-id="d0a19-115">The first part is done within the context of the caller, either from ***tx_application_define*** or from an application thread's context.</span></span> <span data-ttu-id="d0a19-116">Detta innefattar att konfigurera IP-datastrukturen och skapa olika IP-resurser, inklusive den interna IP-tråden.</span><span class="sxs-lookup"><span data-stu-id="d0a19-116">This includes setting up the IP data structure and creating various IP resources, including the internal IP thread.</span></span> <span data-ttu-id="d0a19-117">Den andra delen utförs vid den första körningen från den interna IP-tråden.</span><span class="sxs-lookup"><span data-stu-id="d0a19-117">The second part is performed during the initial execution from the internal IP thread.</span></span> <span data-ttu-id="d0a19-118">Det är här som nätverks driv rutinen, som angavs under den första delen av IP-skapandet, först anropas.</span><span class="sxs-lookup"><span data-stu-id="d0a19-118">This is where the network driver, supplied during the first part of IP creation, is first called.</span></span> <span data-ttu-id="d0a19-119">Genom att anropa nätverks driv rutinen från den interna IP-tråden kan driv rutinen utföra I/O och pausa under initierings bearbetningen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-119">Calling the network driver from the internal IP thread enables the driver to perform I/O and suspend during its initialization processing.</span></span> <span data-ttu-id="d0a19-120">När nätverks driv rutinen återgår från initierings processen slutförs IP-skapandet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-120">When the network driver returns from its initialization processing, the IP creation is complete.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-121">NetX-tjänsten **nx_ip_status_check** finns tillgänglig för att hämta information om IP-instansen och dess primära gränssnitts status.</span><span class="sxs-lookup"><span data-stu-id="d0a19-121">The NetX service **nx_ip_status_check** is available to obtain information on the IP instance and its primary interface status.</span></span> <span data-ttu-id="d0a19-122">Sådan statusinformation innehåller om länken är initierad, aktive rad och IP-adressen är löst.</span><span class="sxs-lookup"><span data-stu-id="d0a19-122">Such status information includes whether or not the link is initialized, enabled, and IP address is resolved.</span></span> <span data-ttu-id="d0a19-123">Den här informationen används för att synkronisera program trådar som behöver använda en nyligen skapad IP-instans.</span><span class="sxs-lookup"><span data-stu-id="d0a19-123">This information is used to synchronize application threads needing to use a newly created IP instance.</span></span> <span data-ttu-id="d0a19-124">För multihome-system, se "Support för multihome" nedan.</span><span class="sxs-lookup"><span data-stu-id="d0a19-124">For multihome systems, see "Multihome Support" below.</span></span> <span data-ttu-id="d0a19-125">**nx_ip_interface_status_check** finns tillgängligt för att hämta information om det angivna gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-125">**nx_ip_interface_status_check** is available to obtain information on the specified interface.</span></span>

### <a name="application-interface-calls"></a><span data-ttu-id="d0a19-126">Program gränssnitts anrop</span><span class="sxs-lookup"><span data-stu-id="d0a19-126">Application Interface Calls</span></span>

<span data-ttu-id="d0a19-127">Anrop från programmet görs i stort sett från program trådar som körs under ThreadX-återställnings tider.</span><span class="sxs-lookup"><span data-stu-id="d0a19-127">Calls from the application are largely made from application threads running under the ThreadX RTOS.</span></span> <span data-ttu-id="d0a19-128">Vissa initierings-, Create-och enable-tjänster kan dock anropas från ***tx_application_define***.</span><span class="sxs-lookup"><span data-stu-id="d0a19-128">However, some initialization, create, and enable services may be called from ***tx_application_define***.</span></span> <span data-ttu-id="d0a19-129">I avsnitten "tillåtet från" i kapitel 4 anges från vilka varje NetX-tjänst kan anropas.</span><span class="sxs-lookup"><span data-stu-id="d0a19-129">The "Allowed From" sections in Chapter 4 indicate from which each NetX service can be called.</span></span>

<span data-ttu-id="d0a19-130">För det mesta görs bearbetningen av intensiva aktiviteter, till exempel beräknings kontroll summor i den anropande trådens kontext, utan att åtkomsten till andra trådar blockeras till IP-instansen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-130">For the most part, processing intensive activities such as computing checksums is done within the calling thread's context—without blocking the access of other threads to the IP instance.</span></span> <span data-ttu-id="d0a19-131">Vid överföring utförs exempelvis beräkningen av UDP-kontrollsumma i ***nx_udp_socket_sends*** tjänsten innan den underliggande IP-Send-funktionen anropas.</span><span class="sxs-lookup"><span data-stu-id="d0a19-131">For example, on transmission, the UDP checksum calculation is performed inside the ***nx_udp_socket_send*** service, prior to calling the underlying IP send function.</span></span> <span data-ttu-id="d0a19-132">På ett mottaget paket beräknas UDP-kontrollsummaet i ***nx_udp_socket_receive*** tjänsten som körs i kontexten för program tråden.</span><span class="sxs-lookup"><span data-stu-id="d0a19-132">On a received packet, the UDP checksum is calculated in the ***nx_udp_socket_receive*** service, executed in the context of the application thread.</span></span> <span data-ttu-id="d0a19-133">Detta bidrar till att förhindra att nätverks begär Anden med högre prioritet kan stoppas på grund av bearbetning av intensiv beräkning av kontroll summa i trådar med lägre prioritet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-133">This helps prevent stalling network requests of higher-priority threads because of processing intensive checksum computation in lower-priority threads.</span></span>

<span data-ttu-id="d0a19-134">Värden, till exempel IP-adresser och port nummer, skickas till API-funktioner i värd byte ordning.</span><span class="sxs-lookup"><span data-stu-id="d0a19-134">Values, such as IP addresses and port numbers, are passed to API functions in host byte order.</span></span> <span data-ttu-id="d0a19-135">Internt lagras dessa värden i värdens byte-ordning.</span><span class="sxs-lookup"><span data-stu-id="d0a19-135">Internally these values are stored in host byte order as well.</span></span> <span data-ttu-id="d0a19-136">På så sätt kan utvecklare enkelt visa värdena via en fel sökare.</span><span class="sxs-lookup"><span data-stu-id="d0a19-136">This enables developers to easily view the values via a debugger.</span></span> <span data-ttu-id="d0a19-137">När dessa värden är programmerade i en ram för överföring, konverteras de till byte ordning för nätverk.</span><span class="sxs-lookup"><span data-stu-id="d0a19-137">When these values are programmed into a frame for transmission, they are converted to network byte order.</span></span>

### <a name="internal-ip-thread"></a><span data-ttu-id="d0a19-138">Intern IP-tråd</span><span class="sxs-lookup"><span data-stu-id="d0a19-138">Internal IP Thread</span></span>

<span data-ttu-id="d0a19-139">Som nämnts har varje IP-instans i NetX en egen tråd.</span><span class="sxs-lookup"><span data-stu-id="d0a19-139">As mentioned, each IP instance in NetX has its own thread.</span></span> <span data-ttu-id="d0a19-140">Prioriteten och stack storleken för den interna IP-tråden definieras i ***nx_ip_creates*** tjänsten.</span><span class="sxs-lookup"><span data-stu-id="d0a19-140">The priority and stack size of the internal IP thread is defined in the ***nx_ip_create*** service.</span></span> <span data-ttu-id="d0a19-141">Den interna IP-tråden skapas i ett läge som är klart att köras.</span><span class="sxs-lookup"><span data-stu-id="d0a19-141">The internal IP thread is created in a ready-to-execute mode.</span></span> <span data-ttu-id="d0a19-142">Om IP-tråden har högre prioritet än den anropande tråden kan avstängningen uppstå i IP-Create-anropet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-142">If the IP thread has a higher priority than the calling thread, preemption may occur inside the IP create call.</span></span>

<span data-ttu-id="d0a19-143">Den interna IP-trådens start punkt är den interna funktionen ***_nx_ip_thread_entry***.</span><span class="sxs-lookup"><span data-stu-id="d0a19-143">The entry point of the internal IP thread is at the internal function ***_nx_ip_thread_entry***.</span></span> <span data-ttu-id="d0a19-144">När den interna IP-tråden startas slutförs först nätverks driv Rutinens initiering, som består av tre anrop till den programspecifika nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-144">When started, the internal IP thread first completes network driver initialization, which consists of making three calls to the application-specific network driver.</span></span> <span data-ttu-id="d0a19-145">Det första anropet är att koppla nätverks driv rutinen till IP-instansen, följt av ett initierings anrop, vilket gör att nätverks driv rutinen kan gå igenom initierings processen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-145">The first call is to attach the network driver to the IP instance, followed by an initialization call, which allows the network driver to go through the initialization process.</span></span> <span data-ttu-id="d0a19-146">När nätverks driv rutinen har returnerat från initieringen (den kan stoppas under väntan på att maskin varan ska konfigureras korrekt), anropar den interna IP-tråden nätverks driv rutinen igen för att aktivera länken.</span><span class="sxs-lookup"><span data-stu-id="d0a19-146">After the network driver returns from initialization (it may suspend while waiting for the hardware to be properly set up), the internal IP thread calls the network driver again to enable the link.</span></span> 

<span data-ttu-id="d0a19-147">När nätverks driv rutinen har returnerat från länken Aktivera anrop, anger den interna IP-tråden en oändlig loop-kontroll för olika händelser som behöver bearbetas för den här IP-instansen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-147">After the network driver returns from the link enable call, the internal IP thread enters an endless loop checking for various events that need processing for this IP instance.</span></span> <span data-ttu-id="d0a19-148">Händelser som bearbetas i den här slingan är inskjuten mottagning av IP-paket, sammansättning av IP-paket, ICMP-Ping-bearbetning, IGMP-bearbetning, bearbetning av TCP-paketfiltrering, TCP-periodisk bearbetning, timeout för IP-fragment och IGMP-periodisk bearbetning.</span><span class="sxs-lookup"><span data-stu-id="d0a19-148">Events processed in this loop include deferred IP packet reception, IP packet fragment assembly, ICMP ping processing, IGMP processing, TCP packet queue processing, TCP periodic processing, IP fragment assembly timeouts, and IGMP periodic processing.</span></span> <span data-ttu-id="d0a19-149">Händelser omfattar även adress matchnings aktiviteter: ARP-paketfiltrering och regelbunden bearbetning i ARP i IP-nätverket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-149">Events also include address resolution activities: ARP packet processing and ARP periodic processing in the IP network.</span></span>

> [!NOTE]
> <span data-ttu-id="d0a19-150">*Återanrops funktionerna i NetX, inklusive lyssnings-och från koppling, anropas från den interna IP-tråden, inte den ursprungliga anropande tråden. Programmet måste ta hand om att inte pausa i någon NetX-callback-funktion.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-150">*The NetX callback functions, including listen and disconnect callbacks, are called from the internal IP thread—not the original calling thread. The application must take care not to suspend inside any NetX callback function.*</span></span>

### <a name="ip-periodic-timers"></a><span data-ttu-id="d0a19-151">Periodiska timers för IP</span><span class="sxs-lookup"><span data-stu-id="d0a19-151">IP Periodic Timers</span></span>
<span data-ttu-id="d0a19-152">Det finns två ThreadX-periodiska timers som används för varje IP-instans.</span><span class="sxs-lookup"><span data-stu-id="d0a19-152">There are two ThreadX periodic timers used for each IP instance.</span></span> <span data-ttu-id="d0a19-153">Den första är en eng-Second-timer för ARP, IGMP, TCP-tidsgräns och den också bearbetar ommonteringen av IP-fragment.</span><span class="sxs-lookup"><span data-stu-id="d0a19-153">The first one is a one-second timer for ARP, IGMP, TCP timeout, and it also drives IP fragment reassemble processing.</span></span> <span data-ttu-id="d0a19-154">Den andra timern är en 100 MS-timer för att köra timeout för TCP-omöverföring.</span><span class="sxs-lookup"><span data-stu-id="d0a19-154">The second timer is a 100ms timer to drive the TCP retransmission timeout.</span></span>

### <a name="network-driver"></a><span data-ttu-id="d0a19-155">Nätverks driv rutin</span><span class="sxs-lookup"><span data-stu-id="d0a19-155">Network Driver</span></span>
<span data-ttu-id="d0a19-156">Varje IP-instans i NetX har ett primärt gränssnitt som identifieras av den driv rutin som anges i ***nx_ip_creates*** tjänsten.</span><span class="sxs-lookup"><span data-stu-id="d0a19-156">Each IP instance in NetX has a primary interface, which is identified by its device driver specified in the ***nx_ip_create*** service.</span></span> <span data-ttu-id="d0a19-157">Nätverks driv rutinen ansvarar för hantering av olika NetX-förfrågningar, inklusive paket överföring, paket mottagning och förfrågningar om status och kontroll.</span><span class="sxs-lookup"><span data-stu-id="d0a19-157">The network driver is responsible for handling various NetX requests, including packet transmission, packet reception, and requests for status and control.</span></span>

<span data-ttu-id="d0a19-158">För ett multi-Home-system har IP-instansen flera gränssnitt, var och en med en associerad nätverks driv rutin som utför dessa uppgifter för respektive gränssnitt.</span><span class="sxs-lookup"><span data-stu-id="d0a19-158">For a multi-home system, the IP instance has multiple interfaces, each with an associated network driver that performs these tasks for the respective interface.</span></span>

<span data-ttu-id="d0a19-159">Nätverks driv rutinen måste också hantera asynkrona händelser som inträffar på mediet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-159">The network driver must also handle asynchronous events occurring on the media.</span></span> <span data-ttu-id="d0a19-160">Asynkrona händelser från mediet omfattar paket mottagning, slut för ande av paket överföring och status ändringar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-160">Asynchronous events from the media include packet reception, packet transmission completion, and status changes.</span></span> <span data-ttu-id="d0a19-161">NetX tillhandahåller nätverks driv rutinen med flera åtkomst funktioner för att hantera olika händelser.</span><span class="sxs-lookup"><span data-stu-id="d0a19-161">NetX provides the network driver with several access functions to handle various events.</span></span> <span data-ttu-id="d0a19-162">Dessa funktioner är utformade för att anropas från Interrupt Service Routine delen av nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-162">These functions are designed to be called from the interrupt service routine portion of the network driver.</span></span> <span data-ttu-id="d0a19-163">För IP-nätverk bör nätverks driv rutinen vidarebefordra alla ARP-paket som tas emot till \***_nx_arp_packet_deferred_receive** _ intern funktion.</span><span class="sxs-lookup"><span data-stu-id="d0a19-163">For IP networks, the network driver should forward all ARP packets received to the \***_nx_arp_packet_deferred_receive** _ internal function.</span></span> <span data-ttu-id="d0a19-164">Alla RARP-paket ska vidarebefordras till _ *_ _nx_rarp_packet_deferred_receive_* _ intern funktion.</span><span class="sxs-lookup"><span data-stu-id="d0a19-164">All RARP packets should be forwarded to _ *_ _nx_rarp_packet_deferred_receive_* _ internal function.</span></span> <span data-ttu-id="d0a19-165">Det finns två alternativ för IP-paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-165">There are two options for IP packets.</span></span> <span data-ttu-id="d0a19-166">Om snabb sändning av IP-paket krävs ska inkommande IP-paket vidarebefordras till _ *_ _nx_ip_packet_receive_* _ för omedelbar bearbetning.</span><span class="sxs-lookup"><span data-stu-id="d0a19-166">If fast dispatch of IP packets is required, incoming IP packets should be forwarded to _ *_ _nx_ip_packet_receive_* _ for immediate processing.</span></span> <span data-ttu-id="d0a19-167">Detta förbättrar prestandan i NetX i hanteringen av IP-paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-167">This greatly improves NetX performance in handling IP packets.</span></span> <span data-ttu-id="d0a19-168">Annars bör nätverks driv rutinen vidarebefordra IP-paket till _ \* _ _nx_ip_packet_deferred_receive_\* \*.</span><span class="sxs-lookup"><span data-stu-id="d0a19-168">Otherwise, the network driver should forward IP packets to _\*_ _nx_ip_packet_deferred_receive_\*\*.</span></span> <span data-ttu-id="d0a19-169">Den här tjänsten placerar IP-paketet i den uppskjutna bearbetnings kön där den hanteras av den interna IP-tråden, vilket resulterar i minst mängden ISR-bearbetnings tid.</span><span class="sxs-lookup"><span data-stu-id="d0a19-169">This service places the IP packet in the deferred processing queue where it is then handled by the internal IP thread, which results in the least amount of ISR processing time.</span></span>

<span data-ttu-id="d0a19-170">Nätverks driv rutinen kan också skjuta upp avbrott-bearbetningen så att den inte går att använda i kontexten för IP-tråden.</span><span class="sxs-lookup"><span data-stu-id="d0a19-170">The network driver can also defer interrupt processing to run out of the context of the IP thread.</span></span> <span data-ttu-id="d0a19-171">I det här läget måste ISR Spara nödvändig information, anropa den interna funktionen ***_nx_ip_driver_deferred_processing*** och bekräfta avbrotts styrenheten.</span><span class="sxs-lookup"><span data-stu-id="d0a19-171">In this mode, the ISR shall save the necessary information, call the internal function ***_nx_ip_driver_deferred_processing***, and acknowledge the interrupt controller.</span></span> <span data-ttu-id="d0a19-172">Den här tjänsten meddelar IP-tråden att schemalägga ett återanrop till enhets driv rutinen för att slutföra bearbetningen av händelsen som orsakar avbrottet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-172">This service notifies IP thread to schedule a callback to the device driver to complete the processing of the event that causes the interrupt.</span></span>

<span data-ttu-id="d0a19-173">Vissa nätverks styrenheter kan utföra beräkning och validering av kontroll summa för TCP/IP-huvud i maskin vara, utan att ta upp värdefulla processor resurser.</span><span class="sxs-lookup"><span data-stu-id="d0a19-173">Some network controllers are capable of performing TCP/IP header checksum computation and validation in hardware, without taking up valuable CPU resources.</span></span> <span data-ttu-id="d0a19-174">För att kunna dra nytta av funktionen för maskin varu kapacitet tillhandahåller NetX alternativ för att aktivera eller inaktivera olika beräkningar av program kontroll summor vid kompilering, samt aktivera eller inaktivera beräkning av kontroll Summa vid körning.</span><span class="sxs-lookup"><span data-stu-id="d0a19-174">To take advantage of the hardware capability feature, NetX provides options to enable or disable various software checksum computation at compilation time, as well as turning on or off checksum computation at run time.</span></span> <span data-ttu-id="d0a19-175">Mer detaljerad information om hur du skriver NetX-nätverks driv rutiner finns i "[kapitel 5 netx Network Drivers](chapter5.md)".</span><span class="sxs-lookup"><span data-stu-id="d0a19-175">See "[Chapter 5 NetX Network Drivers](chapter5.md)" for more detailed information on writing NetX network drivers.</span></span>

### <a name="multihome-support"></a><span data-ttu-id="d0a19-176">Support för multihome</span><span class="sxs-lookup"><span data-stu-id="d0a19-176">Multihome Support</span></span>
<span data-ttu-id="d0a19-177">NetX stöder system som är anslutna till flera fysiska enheter som använder en enda IP-instans.</span><span class="sxs-lookup"><span data-stu-id="d0a19-177">NetX supports systems connected to multiple physical devices using a single IP instance.</span></span> <span data-ttu-id="d0a19-178">Varje fysiskt gränssnitt tilldelas ett gränssnitts kontroll block i IP-instansen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-178">Each physical interface is assigned to an interface control block in the IP instance.</span></span> <span data-ttu-id="d0a19-179">Program som vill använda ett hem system måste definiera värdet för **NX_MAX_PHSYCIAL_INTERFACES** till antalet fysiska enheter som är anslutna till systemet och återskapa netx-biblioteket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-179">Applications wishing to use a multihome system must define the value for **NX_MAX_PHSYCIAL_INTERFACES** to the number of physical devices attached to the system, and rebuild NetX library.</span></span> <span data-ttu-id="d0a19-180">Som standard **NX_MAX_PHYSICAL_INTERFACES** har angetts till ett, skapar du ett gränssnitts kontroll block i IP-instansen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-180">By default **NX_MAX_PHYSICAL_INTERFACES** is set to one, creating one interface control block in the IP instance.</span></span>

<span data-ttu-id="d0a19-181">NetX-programmet skapar en enskild IP-instans för den primära enheten med hjälp av tjänsten \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="d0a19-181">The NetX application creates a single IP instance for the primary device using the \***nx_ip_create** _ service.</span></span> <span data-ttu-id="d0a19-182">För varje ytterligare nätverks enheter ansluter programmet enheten till IP-instansen med hjälp av tjänsten _ \*_nx_ip_interface_attach_\*\*.</span><span class="sxs-lookup"><span data-stu-id="d0a19-182">For each additional network devices, the application attaches the device to the IP instance using the _ *_nx_ip_interface_attach_*\* service.</span></span>

<span data-ttu-id="d0a19-183">Varje nätverks gränssnitts struktur innehåller en delmängd av nätverksinformation om det nätverks gränssnitt som finns i IP Control-blocket, inklusive IP-adress för gränssnitt, nätmask, IP-MTU-storlek och adress information för MAC-lager.</span><span class="sxs-lookup"><span data-stu-id="d0a19-183">Each network interface structure contains a subset of network information about the network interface that is contained in the IP control block, including interface IP address, subnet mask, IP MTU size, and MAC-layer address information.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-184">*NetX med stöd för multihome är bakåtkompatibel med tidigare versioner av NetX. Tjänster som inte har uttryckligen gränssnitts information som standard till den primära nätverks enheten.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-184">*NetX with multihome support is backward compatible with earlier versions of NetX. Services that do not take explicit interface information default to the primary network device.*</span></span>

<span data-ttu-id="d0a19-185">Det primära gränssnittet har index noll i listan över IP-instanser.</span><span class="sxs-lookup"><span data-stu-id="d0a19-185">The primary interface has index zero in the IP instance list.</span></span> <span data-ttu-id="d0a19-186">Varje efterföljande enhet som är kopplad till IP-instansen tilldelas nästa index.</span><span class="sxs-lookup"><span data-stu-id="d0a19-186">Each subsequent device attached to the IP instance is assigned the next index.</span></span>

<span data-ttu-id="d0a19-187">Alla de övre skikt protokoll tjänsterna för vilka IP-instansen är aktive rad, inklusive TCP, UDP, ICMP och IGMP, är tillgängliga för alla anslutna enheter.</span><span class="sxs-lookup"><span data-stu-id="d0a19-187">All upper layer protocol services for which the IP instance is enabled, including TCP, UDP, ICMP, and IGMP, are available to all the attached devices.</span></span>

<span data-ttu-id="d0a19-188">I de flesta fall kan NetX avgöra den bästa käll adressen som ska användas vid överföring av ett paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-188">In most cases, NetX can determine the best source address to use when transmitting a packet.</span></span> <span data-ttu-id="d0a19-189">Käll adress valet baseras på mål adressen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-189">The source address selection is based on the destination address.</span></span> <span data-ttu-id="d0a19-190">NetX Services tillhandahålls för att tillåta att program anger en speciell käll adress som ska användas, i de fall där den lämpligaste orsaken inte kan fastställas av mål adressen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-190">NetX services are provided to allow applications to specify a specific source address to use, in cases where the most suitable one cannot be determined by the destination address.</span></span> <span data-ttu-id="d0a19-191">Ett exempel skulle finnas i ett hem system, ett program måste skicka ett paket till en IP-broadcast eller multicast-mål adresser.</span><span class="sxs-lookup"><span data-stu-id="d0a19-191">An example would be in a multihome system, an application needs to send a packet to an IP broadcast or multicast destination addresses.</span></span>

<span data-ttu-id="d0a19-192">Tjänster som är specifika för att utveckla program med fler Hem nätverk är följande:</span><span class="sxs-lookup"><span data-stu-id="d0a19-192">Services specifically for developing multihome applications include the following:</span></span>

<span data-ttu-id="d0a19-193">*nx_igmp_multicast_interface_join nx_ip_driver_interface_direct_command nx_ip_interface_address_get nx_ip_interface_address_set nx_ip_interface_attach nx_ip_interface_info_get nx_ip_interface_status_check nx_ip_raw_packet_interface_send nx_udp_socket_interface_send*</span><span class="sxs-lookup"><span data-stu-id="d0a19-193">*nx_igmp_multicast_interface_join nx_ip_driver_interface_direct_command nx_ip_interface_address_get nx_ip_interface_address_set nx_ip_interface_attach nx_ip_interface_info_get nx_ip_interface_status_check nx_ip_raw_packet_interface_send nx_udp_socket_interface_send*</span></span>

<span data-ttu-id="d0a19-194">Dessa tjänster förklaras i detalj i "[kapitel 4 – Beskrivning av Azure återställnings tider netx-tjänster](chapter4.md)".</span><span class="sxs-lookup"><span data-stu-id="d0a19-194">These services are explained in greater detail in "[Chapter 4 - Description of Azure RTOS NetX Services](chapter4.md)".</span></span>

### <a name="loopback-interface"></a><span data-ttu-id="d0a19-195">Loopback-gränssnitt</span><span class="sxs-lookup"><span data-stu-id="d0a19-195">Loopback Interface</span></span>
<span data-ttu-id="d0a19-196">Loopback-gränssnittet är ett särskilt nätverks gränssnitt utan en fysisk länk som är kopplad till.</span><span class="sxs-lookup"><span data-stu-id="d0a19-196">The loopback interface is a special network interface without an physical link attached to.</span></span> <span data-ttu-id="d0a19-197">Loopback-gränssnittet gör att program kan kommunicera med IP loopback-adressen 127.0.0.1</span><span class="sxs-lookup"><span data-stu-id="d0a19-197">The loopback interface allows applications to communicate using the IP loopback address 127.0.0.1</span></span>

<span data-ttu-id="d0a19-198">Om du vill använda ett logiskt loopback-gränssnitt ser du till att alternativet konfigurerbar ***NX_DISABLE_LOOPBACK_INTERFACE*** inte har angetts.</span><span class="sxs-lookup"><span data-stu-id="d0a19-198">To utilize a logical loopback interface, ensure the configurable option ***NX_DISABLE_LOOPBACK_INTERFACE*** is not set.</span></span>

### <a name="interface-control-blocks"></a><span data-ttu-id="d0a19-199">Gränssnitts kontroll block</span><span class="sxs-lookup"><span data-stu-id="d0a19-199">Interface Control Blocks</span></span>
<span data-ttu-id="d0a19-200">Antalet gränssnitts kontroll block i IP-instansen är antalet fysiska gränssnitt (definieras med \***NX_MAX_PHYSICAL_INTERFACES** _) plus loopback-gränssnittet om det är aktiverat.</span><span class="sxs-lookup"><span data-stu-id="d0a19-200">The number of interface control blocks in the IP instance is the number of physical interfaces (defined by \***NX_MAX_PHYSICAL_INTERFACES** _) plus the loopback interface if it is enabled.</span></span> <span data-ttu-id="d0a19-201">Det totala antalet gränssnitt definieras i _ *_NX_MAX_IP_INTERFACES_* \*.</span><span class="sxs-lookup"><span data-stu-id="d0a19-201">The total number of interfaces is defined in _\*_NX_MAX_IP_INTERFACES_\*\*.</span></span>

## <a name="protocol-layering"></a><span data-ttu-id="d0a19-202">Protokoll skikt</span><span class="sxs-lookup"><span data-stu-id="d0a19-202">Protocol Layering</span></span>

<span data-ttu-id="d0a19-203">TCP/IP som implementeras av NetX är ett lager protokoll, vilket innebär att mer komplexa protokoll skapas ovanpå enklare underliggande protokoll.</span><span class="sxs-lookup"><span data-stu-id="d0a19-203">The TCP/IP implemented by NetX is a layered protocol, which means more complex protocols are built on top of simpler underlying protocols.</span></span> <span data-ttu-id="d0a19-204">I TCP/IP finns det lägsta skikt protokollet på *länk skiktet* och hanteras av nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-204">In TCP/ IP, the lowest layer protocol is at the *link Layer* and is handled by the network driver.</span></span> <span data-ttu-id="d0a19-205">Den här nivån är normalt riktad mot Ethernet, men det kan också vara fiber, seriellt eller praktiskt taget valfritt fysiskt medium.</span><span class="sxs-lookup"><span data-stu-id="d0a19-205">This level is typically targeted towards Ethernet, but it could also be fiber, serial, or virtually any physical media.</span></span>

<span data-ttu-id="d0a19-206">Ovanpå länk skiktet finns *nätverks skiktet*.</span><span class="sxs-lookup"><span data-stu-id="d0a19-206">On top of the link layer is the *Network layer*.</span></span> <span data-ttu-id="d0a19-207">I TCP/IP är detta IP-adressen, som i princip ansvarar för att skicka och ta emot enkla paket, på bästa möjliga sätt i hela nätverket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-207">In TCP/IP, this is the IP, which is basically responsible for sending and receiving simple packets, in a best-effort manner, across the network.</span></span> <span data-ttu-id="d0a19-208">Hanterings typ protokoll som ICMP och IGMP kategoriseras vanligt vis som nätverks lager, även om de förlitar sig på IP för att skicka och ta emot.</span><span class="sxs-lookup"><span data-stu-id="d0a19-208">Management type protocols like ICMP and IGMP are typically also categorized as network layers, even though they rely on IP for sending and receiving.</span></span>

<span data-ttu-id="d0a19-209">*Transport lagret* vilar ovanpå nätverks nivån.</span><span class="sxs-lookup"><span data-stu-id="d0a19-209">The *Transport layer* rests on top of the network layer.</span></span> <span data-ttu-id="d0a19-210">Det här lagret ansvarar för att hantera data flödet mellan värdar i nätverket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-210">This layer is responsible for managing the flow of data between hosts on the network.</span></span> <span data-ttu-id="d0a19-211">Det finns två typer av transport tjänster som stöds av NetX: UDP och TCP.</span><span class="sxs-lookup"><span data-stu-id="d0a19-211">There are two types of transport services supported by NetX: UDP and TCP.</span></span> <span data-ttu-id="d0a19-212">UDP-tjänsterna ger dig bästa möjliga sändning och mottagning av data mellan två värdar på ett anslutnings effektivt sätt, medan TCP tillhandahåller Reliable anslutningsorienterade tjänster mellan två värd enheter.</span><span class="sxs-lookup"><span data-stu-id="d0a19-212">UDP services provide best-effort sending and receiving of data between two hosts in a connectionless manner, while TCP provides reliable connection-oriented service between two host entities.</span></span>

<span data-ttu-id="d0a19-213">Skiktning visas i de faktiska nätverks data paketen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-213">This layering is reflected in the actual network data packets.</span></span> <span data-ttu-id="d0a19-214">Varje lager i TCP/IP innehåller ett block med information som kallas rubrik.</span><span class="sxs-lookup"><span data-stu-id="d0a19-214">Each layer in TCP/IP contains a block of information called a header.</span></span> <span data-ttu-id="d0a19-215">Den här metoden för omgivande data (och eventuellt protokoll information) med en rubrik kallas vanligt vis för data inkapsling.</span><span class="sxs-lookup"><span data-stu-id="d0a19-215">This technique of surrounding data (and possibly protocol information) with a header is typically called data encapsulation.</span></span> <span data-ttu-id="d0a19-216">Bild 1 visar ett exempel på NetX-skiktning och bild 2 visar den resulterande data inkapslingen för UDP-data som skickas.</span><span class="sxs-lookup"><span data-stu-id="d0a19-216">Figure 1 shows an example of NetX layering and Figure 2 shows the resulting data encapsulation for UDP data being sent.</span></span>

![Protokoll skikt](./media/user-guide/protocol-layering.png)

<span data-ttu-id="d0a19-218">**BILD 1. Protokoll skikt**</span><span class="sxs-lookup"><span data-stu-id="d0a19-218">**FIGURE 1. Protocol Layering**</span></span>

![UDP-inkapsling](./media/user-guide/udp-data-encapsulation.png)

<span data-ttu-id="d0a19-220">**BILD 2. UDP-inkapsling**</span><span class="sxs-lookup"><span data-stu-id="d0a19-220">**FIGURE 2. UDP Data Encapsulation**</span></span>

## <a name="packet-pools"></a><span data-ttu-id="d0a19-221">Paket pooler</span><span class="sxs-lookup"><span data-stu-id="d0a19-221">Packet Pools</span></span>

<span data-ttu-id="d0a19-222">Att allokera paket på ett snabbt och entydigt sätt är alltid en utmaning i real tids nätverks program.</span><span class="sxs-lookup"><span data-stu-id="d0a19-222">Allocating packets in a fast and deterministic manner is always a challenge in real-time networking applications.</span></span> <span data-ttu-id="d0a19-223">Med detta i åtanke ger NetX möjlighet att skapa och hantera flera pooler med nätverks paket med fast storlek.</span><span class="sxs-lookup"><span data-stu-id="d0a19-223">With this in mind, NetX provides the ability to create and manage multiple pools of fixed-size network packets.</span></span>

<span data-ttu-id="d0a19-224">Eftersom NetX paket består av minnes block med fast storlek, finns det aldrig några interna fragmenterings problem.</span><span class="sxs-lookup"><span data-stu-id="d0a19-224">Because NetX packet pools consist of fixed-size memory blocks, there are never any internal fragmentation problems.</span></span> <span data-ttu-id="d0a19-225">Fragmenteringen orsakar naturligtvis att beteendet är icke deterministiskt.</span><span class="sxs-lookup"><span data-stu-id="d0a19-225">Of course, fragmentation causes behavior that is inherently nondeterministic.</span></span>

<span data-ttu-id="d0a19-226">Dessutom är tiden som krävs för att allokera och frigöra ett NetX paket belopp till enkel manipulering av länkade listor.</span><span class="sxs-lookup"><span data-stu-id="d0a19-226">In addition, the time required to allocate and free a NetX packet amounts to simple linked-list manipulation.</span></span> <span data-ttu-id="d0a19-227">Paket tilldelningen och avallokeringen görs dessutom på huvud sidan i listan över tillgängliga.</span><span class="sxs-lookup"><span data-stu-id="d0a19-227">Furthermore, packet allocation and deallocation is done at the head of the available list.</span></span> <span data-ttu-id="d0a19-228">Detta ger snabbast möjlig länkad List bearbetning.</span><span class="sxs-lookup"><span data-stu-id="d0a19-228">This provides the fastest possible linked list processing.</span></span>

<span data-ttu-id="d0a19-229">Brist på flexibilitet är vanligt vis den huvudsakliga nack delen med paket med fast storlek.</span><span class="sxs-lookup"><span data-stu-id="d0a19-229">Lack of flexibility is typically the main drawback of fixed-size packet pools.</span></span> <span data-ttu-id="d0a19-230">Att fastställa den optimala paket nytto Last storleken som även hanterar det värsta inkommande paketet är en svår uppgift.</span><span class="sxs-lookup"><span data-stu-id="d0a19-230">Determining the optimal packet payload size that also handles the worst-case incoming packet is a difficult task.</span></span> <span data-ttu-id="d0a19-231">NetX paket löser det här problemet med en valfri funktion som kallas *paket länkning*.</span><span class="sxs-lookup"><span data-stu-id="d0a19-231">NetX packets address this problem with an optional feature called *packet chaining*.</span></span> <span data-ttu-id="d0a19-232">Ett faktiskt nätverks paket kan skapas för en eller flera NetX-paket som är länkade till varandra.</span><span class="sxs-lookup"><span data-stu-id="d0a19-232">An actual network packet can be made of one or more NetX packets linked together.</span></span> <span data-ttu-id="d0a19-233">Dessutom upprätthåller paket huvudet en pekare överst i paketet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-233">In addition, the packet header maintains a pointer to the top of the packet.</span></span> <span data-ttu-id="d0a19-234">När ytterligare protokoll läggs till flyttas den här pekaren bara baklänges och det nya sidhuvudet skrivs direkt framför data.</span><span class="sxs-lookup"><span data-stu-id="d0a19-234">As additional protocols are added, this pointer is simply moved backwards and the new header is written directly in front of the data.</span></span> <span data-ttu-id="d0a19-235">Utan flexibel paket teknik skulle stacken behöva allokera en annan buffert och kopiera data till en ny buffert med det nya sidhuvudet, vilket är bearbetnings intensiv.</span><span class="sxs-lookup"><span data-stu-id="d0a19-235">Without the flexible packet technology, the stack would have to allocate another buffer and copy the data into a new buffer with the new header, which is processing intensive.</span></span>

<span data-ttu-id="d0a19-236">Eftersom varje paketets nytto Last storlek har åtgärd ATS för en viss modempool, kräver program data som är större än nytto Last storleken flera paket sammankopplade.</span><span class="sxs-lookup"><span data-stu-id="d0a19-236">Since each packet payload size is fixed for a given packet pool, application data larger than the payload size  requires multiple packets chained together.</span></span> <span data-ttu-id="d0a19-237">När du fyller ett paket med användar data måste programmet använda tjänsten ***nx_packet_data_append***.</span><span class="sxs-lookup"><span data-stu-id="d0a19-237">When filling a packet with user data, the application must use the service ***nx_packet_data_append***.</span></span> <span data-ttu-id="d0a19-238">Den här tjänsten flyttar program data till ett paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-238">This service moves application data into a packet.</span></span> <span data-ttu-id="d0a19-239">I situationer där ett paket inte är tillräckligt för att lagra användar data allokeras ytterligare paket för att lagra användar data.</span><span class="sxs-lookup"><span data-stu-id="d0a19-239">In situations where a packet is not enough to hold user data, additional packets are allocated to store user data.</span></span> <span data-ttu-id="d0a19-240">Om du vill använda paket länkning måste driv rutinen kunna ta emot eller överföra från kedjade paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-240">To use packet chaining, the driver must be able to receive into or transmit from chained packets.</span></span>

<span data-ttu-id="d0a19-241">Varje NetX Packet-pool är en offentlig resurs.</span><span class="sxs-lookup"><span data-stu-id="d0a19-241">Each NetX packet memory pool is a public resource.</span></span> <span data-ttu-id="d0a19-242">NetX placerar inga begränsningar för hur Packet-pooler används.</span><span class="sxs-lookup"><span data-stu-id="d0a19-242">NetX places no constraints on how packet pools are used.</span></span>

### <a name="packet-pool-memory-area"></a><span data-ttu-id="d0a19-243">Minnes området för paket pool</span><span class="sxs-lookup"><span data-stu-id="d0a19-243">Packet Pool Memory Area</span></span>
<span data-ttu-id="d0a19-244">Minnes området för Packet-poolen anges när den skapas.</span><span class="sxs-lookup"><span data-stu-id="d0a19-244">The memory area for the packet pool is specified during creation.</span></span> <span data-ttu-id="d0a19-245">Precis som andra minnes områden för ThreadX-och NetX-objekt kan det finnas var som helst i mål adress utrymmet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-245">Like other memory areas for ThreadX and NetX objects, it can be located anywhere in the target's address space.</span></span> <span data-ttu-id="d0a19-246">Detta är en viktig funktion på grund av den stora flexibiliteten ger programmet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-246">This is an important feature because of the considerable flexibility it gives the application.</span></span> <span data-ttu-id="d0a19-247">Anta till exempel att en kommunikations produkt har ett höghastighets minnes utrymme för nätverks buffertar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-247">For example, suppose that a communication product has a high-speed memory area for network buffers.</span></span> <span data-ttu-id="d0a19-248">Det här minnes området används enkelt genom att göra det till en NetX Packet-pool.</span><span class="sxs-lookup"><span data-stu-id="d0a19-248">This memory area is easily utilized by making it into a NetX packet memory pool.</span></span>

### <a name="creating-packet-pools"></a><span data-ttu-id="d0a19-249">Skapa paket pooler</span><span class="sxs-lookup"><span data-stu-id="d0a19-249">Creating Packet Pools</span></span>
<span data-ttu-id="d0a19-250">Paket pooler skapas antingen under initieringen eller under körningen av program trådar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-250">Packet pools are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="d0a19-251">Det finns ingen gräns för antalet paket minnes pooler i ett NetX program.</span><span class="sxs-lookup"><span data-stu-id="d0a19-251">There are no limits on the number of packet memory pools in a NetX application.</span></span>

### <a name="packet-header-nx_packet"></a><span data-ttu-id="d0a19-252">Paket huvud NX_PACKET</span><span class="sxs-lookup"><span data-stu-id="d0a19-252">Packet Header NX_PACKET</span></span>
<span data-ttu-id="d0a19-253">Som standard placerar NetX paket rubriken omedelbart före paketets nytto Last-sektion.</span><span class="sxs-lookup"><span data-stu-id="d0a19-253">By default, NetX places the packet header immediately before the packet payload area.</span></span> <span data-ttu-id="d0a19-254">Paketets minnes uppsättning är i princip en serie paket – huvuden som följs omedelbart av paketets nytto Last.</span><span class="sxs-lookup"><span data-stu-id="d0a19-254">The packet memory pool is basically a series of packets—headers followed immediately by the packet payload.</span></span> <span data-ttu-id="d0a19-255">Paket huvudet (***NX_PACKET***) och poolens layout visas i bild 3.</span><span class="sxs-lookup"><span data-stu-id="d0a19-255">The packet header (***NX_PACKET***) and the layout of the packet pool are pictured in Figure 3.</span></span>

<span data-ttu-id="d0a19-256">För nätverks enhets driv rutin som kan utföra kostnads kopierings åtgärder är vanligt vis start adressen för paketets nytto Last i DMA-logiken.</span><span class="sxs-lookup"><span data-stu-id="d0a19-256">For network devices driver that are able to perform zero copy operations, typically the starting address of the packet payload area is programmed into the DMA logic.</span></span> <span data-ttu-id="d0a19-257">Vissa DMA-motorer har justerings krav på nytto lasts ytan.</span><span class="sxs-lookup"><span data-stu-id="d0a19-257">Certain DMA engines have alignment requirement on the payload area.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-258">\* Nätverks driv rutinen måste anropa \***nx_packet_transmit_release** _-funktionen när överföring av ett paket är slutförd.</span><span class="sxs-lookup"><span data-stu-id="d0a19-258">\*The network driver to must call the \***nx_packet_transmit_release** _ function when the transmission of a packet is complete.</span></span> <span data-ttu-id="d0a19-259">Den här funktionen kontrollerar att paketet inte ingår i en kö för TCP-utdata innan den faktiskt placeras i den tillgängliga poolen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-259">This function checks to make sure the packet is not part of a TCP output queue before it is actually placed back in the available pool.</span></span> <span data-ttu-id="d0a19-260">Om du inte anropar den här funktionen kan det leda till oförutsägbara behavior._</span><span class="sxs-lookup"><span data-stu-id="d0a19-260">Failure to call this function can result in unpredictable behavior._</span></span>

![Layout för paket huvud och adresspool](./media/user-guide/packet-header-packet-pool-layout.png)

<span data-ttu-id="d0a19-262">**BILD 3. Layout för paket huvud och adresspool**</span><span class="sxs-lookup"><span data-stu-id="d0a19-262">**FIGURE 3. Packet Header and Packet Pool Layout**</span></span>

<span data-ttu-id="d0a19-263">Fälten i paket rubriken definieras enligt följande tabell.</span><span class="sxs-lookup"><span data-stu-id="d0a19-263">The fields of the packet header are defined as shown in the following table.</span></span> <span data-ttu-id="d0a19-264">Observera att den här tabellen inte är en omfattande lista över alla medlemmar i *NX_PACKETs* strukturen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-264">Note that this table is not a comprehensive list of all the members in the *NX_PACKET* structure.</span></span>

| <span data-ttu-id="d0a19-265">Paket huvud</span><span class="sxs-lookup"><span data-stu-id="d0a19-265">Packet header</span></span>          | <span data-ttu-id="d0a19-266">Syfte</span><span class="sxs-lookup"><span data-stu-id="d0a19-266">Purpose</span></span>                                                                                                                                                                                                                                                                                                                            |
|------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="d0a19-267">*nx_packet_pool_owner*</span><span class="sxs-lookup"><span data-stu-id="d0a19-267">*nx_packet_pool_owner*</span></span>   | <span data-ttu-id="d0a19-268">Det här fältet pekar på den modempool som äger det aktuella paketet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-268">This field points to the packet pool that owns this particular packet.</span></span> <span data-ttu-id="d0a19-269">När paketet släpps släpps det till den här poolen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-269">When the packet is released, it is released to this particular pool.</span></span> <span data-ttu-id="d0a19-270">Med poolen ägarskap i varje paket är det möjligt för ett datagram att spänna över flera paket från flera paket pooler.</span><span class="sxs-lookup"><span data-stu-id="d0a19-270">With the pool ownership inside each packet, it is possible for a datagram to span multiple packets from multiple packet pools.</span></span>                                                         |
| <span data-ttu-id="d0a19-271">*nx_packet_next*</span><span class="sxs-lookup"><span data-stu-id="d0a19-271">*nx_packet_next*</span></span>         | <span data-ttu-id="d0a19-272">Det här fältet pekar på nästa paket inom samma ram.</span><span class="sxs-lookup"><span data-stu-id="d0a19-272">This field points to the next packet within the same frame.</span></span> <span data-ttu-id="d0a19-273">Om värdet är NULL finns det inga ytterligare paket som är en del av ramen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-273">If NULL, there are no additional packets that are part of the frame.</span></span> |
| <span data-ttu-id="d0a19-274">*nx_packet_last*</span><span class="sxs-lookup"><span data-stu-id="d0a19-274">*nx_packet_last*</span></span>         | <span data-ttu-id="d0a19-275">Det här fältet pekar på det sista paketet i samma nätverks paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-275">This field points to the last packet within the same network packet.</span></span> <span data-ttu-id="d0a19-276">Om värdet är NULL representerar det här paketet hela nätverks paketet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-276">If NULL, this packet represents the entire network packet.</span></span>  |
| <span data-ttu-id="d0a19-277">*nx_packet_length*</span><span class="sxs-lookup"><span data-stu-id="d0a19-277">*nx_packet_length*</span></span>       | <span data-ttu-id="d0a19-278">Det här fältet innehåller det totala antalet byte i hela nätverks paketet, inklusive summan av alla byte i alla paket som sammankopplas tillsammans med den *nx_packet_next* medlemmen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-278">This field contains the total number of bytes in the entire network packet, including the total of all bytes in all packets chained together by the *nx_packet_next* member.</span></span> |
| <span data-ttu-id="d0a19-279">*nx_packet_ip_interface*</span><span class="sxs-lookup"><span data-stu-id="d0a19-279">*nx_packet_ip_interface*</span></span> | <span data-ttu-id="d0a19-280">Det här fältet är gränssnitts kontroll blocket som tilldelas paketet när det tas emot av gränssnitts driv rutinen och av NetX för utgående paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-280">This field is the interface control block which is assigned to the packet when it is received by the interface driver, and by NetX for outgoing packets.</span></span> <span data-ttu-id="d0a19-281">Ett gränssnitts kontroll block beskriver gränssnittet, t. ex. nätverks adress, MAC-adress, IP-adress och gränssnitts status, till exempel länk aktiverat och fysisk mappning krävs.</span><span class="sxs-lookup"><span data-stu-id="d0a19-281">An interface control block describes the interface e.g. network address, MAC address, IP address and interface status such as link enabled and physical mapping required.</span></span> |
| <span data-ttu-id="d0a19-282">*nx_packet_data_start*</span><span class="sxs-lookup"><span data-stu-id="d0a19-282">*nx_packet_data_start*</span></span>   | <span data-ttu-id="d0a19-283">Det här fältet pekar på början av det fysiska nytto Last området för det här paketet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-283">This field points to the start of the physical payload area of this packet.</span></span> <span data-ttu-id="d0a19-284">Det behöver inte omedelbart följa NX_PACKETs huvudet, men det är standardvärdet för tjänsten ***nx_packet_pool_create*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-284">It does not have to be immediately following the NX_PACKET header, but that is the default for the ***nx_packet_pool_create*** service.</span></span> |
| <span data-ttu-id="d0a19-285">*nx_packet_data_end*</span><span class="sxs-lookup"><span data-stu-id="d0a19-285">*nx_packet_data_end*</span></span>     | <span data-ttu-id="d0a19-286">Det här fältet pekar på slutet av det fysiska nytto Last området för det här paketet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-286">This field points to the end of the physical payload area of this packet.</span></span> <span data-ttu-id="d0a19-287">Skillnaden mellan det här fältet och fältet nx_packet_data_start representerar nytto lastens storlek.</span><span class="sxs-lookup"><span data-stu-id="d0a19-287">The difference between this field and the nx_packet_data_start field represents the payload size.</span></span> |
| <span data-ttu-id="d0a19-288">*nx_packet_prepend_ptr*</span><span class="sxs-lookup"><span data-stu-id="d0a19-288">*nx_packet_prepend_ptr*</span></span>  | <span data-ttu-id="d0a19-289">Det här fältet pekar på platsen där paket data, antingen protokoll huvud eller faktiska data, läggs till framför befintliga paket data (om sådana finns) i paketets nytto Last område.</span><span class="sxs-lookup"><span data-stu-id="d0a19-289">This field points to the location of where packet data, either protocol header or actual data, is added in front of the existing packet data (if any) in the packet payload area.</span></span> <span data-ttu-id="d0a19-290">Det måste vara större än eller lika med platsen för *nx_packet_data_start* pekare och mindre än eller lika med *nx_packet_append_ptrs* pekaren.</span><span class="sxs-lookup"><span data-stu-id="d0a19-290">It must be greater than or equal to the *nx_packet_data_start* pointer location and less than or equal to the *nx_packet_append_ptr* pointer.</span></span>  <span data-ttu-id="d0a19-291">*Av prestanda skäl förutsätter NetX att när paketet skickas till NetX-tjänster för överföring, pekar lägga pekar på lång Word-justerad adress.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-291">*For performance reasons, NetX assumes that when the packet is passed into NetX services for transmission, the prepend pointer points to long word aligned address.*</span></span> |
| <span data-ttu-id="d0a19-292">*nx_packet_append_ptr*</span><span class="sxs-lookup"><span data-stu-id="d0a19-292">*nx_packet_append_ptr*</span></span>    | <span data-ttu-id="d0a19-293">Det här fältet pekar på slutet av de data som för närvarande finns i paketets nytto Last område.</span><span class="sxs-lookup"><span data-stu-id="d0a19-293">This field points to the end of the data currently in the packet payload area.</span></span> <span data-ttu-id="d0a19-294">Det måste ligga mellan minnes platsen som *nx_packet_prepend_ptr* och *nx_packet_data_end*.</span><span class="sxs-lookup"><span data-stu-id="d0a19-294">It must be in between the memory location pointed to by *nx_packet_prepend_ptr* and *nx_packet_data_end*.</span></span> <span data-ttu-id="d0a19-295">Skillnaden mellan det här fältet och fältet *nx_packet_prepend_ptr* representerar mängden data i det här paketet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-295">The difference between this field and the *nx_packet_prepend_ptr* field represents the amount of data in this packet.</span></span> |
| <span data-ttu-id="d0a19-296">*nx_packet_fragment_next*</span><span class="sxs-lookup"><span data-stu-id="d0a19-296">*nx_packet_fragment_next*</span></span> | <span data-ttu-id="d0a19-297">Det här fältet används för att lagra fragmenterade paket tills hela paketet kan sammanställas igen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-297">This field is used to hold fragmented packets until the entire packet can be re-assembled.</span></span> |
| <span data-ttu-id="d0a19-298">*nx_packet_pad*</span><span class="sxs-lookup"><span data-stu-id="d0a19-298">*nx_packet_pad*</span></span>           | <span data-ttu-id="d0a19-299">I det här fältet definieras längden på utfyllnad i 4 byte-ord för att uppnå det önskade justerings kravet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-299">This fields defines the length of padding in 4- byte words to achieve the desired alignment requirement.</span></span> <span data-ttu-id="d0a19-300">Det här fältet tas bort om *NX_PACKET_HEADER_PAD* inte har definierats.</span><span class="sxs-lookup"><span data-stu-id="d0a19-300">This field is removed if *NX_PACKET_HEADER_PAD* is not defined.</span></span> |
|  |  |

### <a name="packet-header-offsets"></a><span data-ttu-id="d0a19-301">Paket huvud förskjutningar</span><span class="sxs-lookup"><span data-stu-id="d0a19-301">Packet Header Offsets</span></span>

<span data-ttu-id="d0a19-302">Paketets huvud storlek definieras för att tillåta tillräckligt med utrymme för att rymma rubrikens storlek.</span><span class="sxs-lookup"><span data-stu-id="d0a19-302">Packet header size is defined to allow enough room to accommodate the size of the header.</span></span> <span data-ttu-id="d0a19-303">Tjänsten *nx_packet_allocate* används för att allokera ett paket och justerar lägga-pekaren i paketet enligt den typ av paket som angetts.</span><span class="sxs-lookup"><span data-stu-id="d0a19-303">The *nx_packet_allocate* service is used to allocate a packet and adjusts the prepend pointer in the packet according to the type of packet specified.</span></span> <span data-ttu-id="d0a19-304">Paket typen talar om för NetX vilken förskjutning som krävs för att lägga till protokoll huvudet (till exempel UDP, TCP eller ICMP) framför protokoll data.</span><span class="sxs-lookup"><span data-stu-id="d0a19-304">The packet type tells NetX the offset required for inserting the protocol header (such as UDP, TCP, or ICMP) in front of the protocol data.</span></span>

<span data-ttu-id="d0a19-305">Följande typer definieras i NetX för att ta hänsyn till IP-huvudet och det fysiska skiktet (Ethernet) i paketet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-305">The following types are defined in NetX to take into account the IP header and physical layer (Ethernet) header in the packet.</span></span> <span data-ttu-id="d0a19-306">I det senare fallet antas det vara 16 byte som tar hänsyn till den nödvändiga justeringen av 4 byte.</span><span class="sxs-lookup"><span data-stu-id="d0a19-306">In the latter case, it is assumed to be 16 bytes taking the required 4-byte alignment into consideration.</span></span> <span data-ttu-id="d0a19-307">IP-paket definieras fortfarande i NetX för program för att allokera paket för IP-nätverk.</span><span class="sxs-lookup"><span data-stu-id="d0a19-307">IP packets are still defined in NetX for applications to allocate packets for IP networks.</span></span> <span data-ttu-id="d0a19-308">Följande tabell innehåller symboler som definierats:</span><span class="sxs-lookup"><span data-stu-id="d0a19-308">The following table shows symbols defined:</span></span>

| <span data-ttu-id="d0a19-309">Pakettyp</span><span class="sxs-lookup"><span data-stu-id="d0a19-309">Packet Type</span></span>   | <span data-ttu-id="d0a19-310">Värde</span><span class="sxs-lookup"><span data-stu-id="d0a19-310">Value</span></span> |
|---------------|-------|
| <span data-ttu-id="d0a19-311">NX_IP_PACKET</span><span class="sxs-lookup"><span data-stu-id="d0a19-311">NX_IP_PACKET</span></span>  | <span data-ttu-id="d0a19-312">0x24</span><span class="sxs-lookup"><span data-stu-id="d0a19-312">0x24</span></span>  |
| <span data-ttu-id="d0a19-313">NX_UDP_PACKET</span><span class="sxs-lookup"><span data-stu-id="d0a19-313">NX_UDP_PACKET</span></span> | <span data-ttu-id="d0a19-314">0x2c</span><span class="sxs-lookup"><span data-stu-id="d0a19-314">0x2c</span></span>  |
| <span data-ttu-id="d0a19-315">NX_TCP_PACKET</span><span class="sxs-lookup"><span data-stu-id="d0a19-315">NX_TCP_PACKET</span></span> | <span data-ttu-id="d0a19-316">0x38</span><span class="sxs-lookup"><span data-stu-id="d0a19-316">0x38</span></span>  |
|               |       |

### <a name="pool-capacity"></a><span data-ttu-id="d0a19-317">Pool-kapacitet</span><span class="sxs-lookup"><span data-stu-id="d0a19-317">Pool Capacity</span></span>
<span data-ttu-id="d0a19-318">Antalet paket i en adresspool är en funktion i nytto lastens storlek och det totala antalet byte i minnes området som har angetts till Packet poolens Create-tjänst.</span><span class="sxs-lookup"><span data-stu-id="d0a19-318">The number of packets in a packet pool is a function of the payload size and the total number of bytes in the memory area supplied to the packet pool create service.</span></span> <span data-ttu-id="d0a19-319">Poolens kapacitet beräknas genom att du dividerar paket storleken (inklusive storleken på NX_PACKET huvud, nytto lastens storlek och rätt justering) till det totala antalet byte i det angivna minnes området.</span><span class="sxs-lookup"><span data-stu-id="d0a19-319">The capacity of the pool is calculated by dividing the packet size (including the size of the NX_PACKET header, the payload size, and proper alignment) into the total number of bytes in the supplied memory area.</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="d0a19-320">Tråd upphängning</span><span class="sxs-lookup"><span data-stu-id="d0a19-320">Thread Suspension</span></span>
<span data-ttu-id="d0a19-321">Program trådar kan pausas i väntan på ett paket från en tom pool.</span><span class="sxs-lookup"><span data-stu-id="d0a19-321">Application threads can suspend while waiting for a packet from an empty pool.</span></span> <span data-ttu-id="d0a19-322">När ett paket returneras till poolen får den pausade tråden det här paketet och återupptas.</span><span class="sxs-lookup"><span data-stu-id="d0a19-322">When a packet is returned to the pool, the suspended thread is given this packet and resumed.</span></span>

<span data-ttu-id="d0a19-323">Om flera trådar är inaktiverade i samma modempool återupptas de i den ordning som de var pausade (FIFO).</span><span class="sxs-lookup"><span data-stu-id="d0a19-323">If multiple threads are suspended on the same packet pool, they are resumed in the order they were suspended (FIFO).</span></span>

### <a name="pool-statistics-and-errors"></a><span data-ttu-id="d0a19-324">Statistik och fel i pooler</span><span class="sxs-lookup"><span data-stu-id="d0a19-324">Pool Statistics and Errors</span></span>
<span data-ttu-id="d0a19-325">Om den här inställningen är aktive rad håller NetX Packet Management-program varu **fel** att spåra flera statistik och fel som kan vara användbara för programmet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-325">If enabled, the NetX packet management software **Errors** keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="d0a19-326">Följande statistik och fel rapporter underhålls för paketbaserade pooler:</span><span class="sxs-lookup"><span data-stu-id="d0a19-326">The following statistics and error reports are maintained for packet pools:</span></span>

* <span data-ttu-id="d0a19-327">Totalt antal paket i poolen</span><span class="sxs-lookup"><span data-stu-id="d0a19-327">Total Packets in Pool</span></span>
* <span data-ttu-id="d0a19-328">Lediga paket i poolen</span><span class="sxs-lookup"><span data-stu-id="d0a19-328">Free Packets in Pool</span></span>
* <span data-ttu-id="d0a19-329">Pool tomma tilldelnings begär Anden</span><span class="sxs-lookup"><span data-stu-id="d0a19-329">Pool Empty Allocation Requests</span></span>
* <span data-ttu-id="d0a19-330">Förskjutande av pool, tomma allokeringar</span><span class="sxs-lookup"><span data-stu-id="d0a19-330">Pool Empty Allocation Suspensions</span></span>
* <span data-ttu-id="d0a19-331">Ogiltiga paket versioner</span><span class="sxs-lookup"><span data-stu-id="d0a19-331">Invalid Packet Releases</span></span>

<span data-ttu-id="d0a19-332">Alla dessa statistik-och fel rapporter, förutom det totala antalet och det lediga paket antalet i poolen, är inbyggda i NetX-biblioteket om inte \***NX_DISABLE_PACKET_INFO** _ har definierats.</span><span class="sxs-lookup"><span data-stu-id="d0a19-332">All of these statistics and error reports, except for total and free packet count in pool, are built into NetX library unless \***NX_DISABLE_PACKET_INFO** _ is defined.</span></span> <span data-ttu-id="d0a19-333">Dessa data är tillgängliga för programmet med tjänsten _ \*_nx_packet_pool_info_get_\*\*.</span><span class="sxs-lookup"><span data-stu-id="d0a19-333">This data is available to the application with the _ *_nx_packet_pool_info_get_*\* service.</span></span>

### <a name="packet-pool-control-block-nx_packet_pool"></a><span data-ttu-id="d0a19-334">Kontroll block för Packet-pool NX_PACKET_POOL</span><span class="sxs-lookup"><span data-stu-id="d0a19-334">Packet Pool Control Block NX_PACKET_POOL</span></span>

<span data-ttu-id="d0a19-335">Egenskaperna för varje paket minnes uppsättning finns i kontroll blocket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-335">The characteristics of each packet memory pool are found in its control block.</span></span> <span data-ttu-id="d0a19-336">Den innehåller användbar information, till exempel den länkade listan över lediga paket, antalet lediga paket och nytto Last storleken för paket i den här poolen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-336">It contains useful information such as the linked list of free packets, the number of free packets, and the payload size for packets in this pool.</span></span> <span data-ttu-id="d0a19-337">Den här strukturen definieras i filen *nx_api. h* .</span><span class="sxs-lookup"><span data-stu-id="d0a19-337">This structure is defined in the *nx_api.h* file.</span></span>

<span data-ttu-id="d0a19-338">Du kan placera kontroll block var som helst i minnet, men det är vanligt att kontrol lera att kontrollen blockerar en global struktur genom att definiera den utanför omfånget för en funktion.</span><span class="sxs-lookup"><span data-stu-id="d0a19-338">Packet pool control blocks can be located anywhere in memory, but it is most common to make the control block a global structure by defining it outside the scope of any function.</span></span>

## <a name="ip-protocol"></a><span data-ttu-id="d0a19-339">IP-protokoll</span><span class="sxs-lookup"><span data-stu-id="d0a19-339">IP Protocol</span></span>

<span data-ttu-id="d0a19-340">Komponenten Internet Protocol (IP) i NetX ansvarar för att skicka och ta emot IP-paket på Internet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-340">The Internet Protocol (IP) component of NetX is responsible for sending and receiving IP packets on the Internet.</span></span> <span data-ttu-id="d0a19-341">I NetX är det den komponent som slutligen ansvarar för att skicka och ta emot TCP-, UDP-, ICMP-och IGMP-meddelanden med hjälp av den underliggande nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-341">In NetX, it is the component ultimately responsible for sending and receiving TCP, UDP, ICMP, and IGMP messages, utilizing the underlying network driver.</span></span>

<span data-ttu-id="d0a19-342">NetX stöder IP-protokoll (RFC 791)</span><span class="sxs-lookup"><span data-stu-id="d0a19-342">NetX supports IP protocol (RFC 791)</span></span>

### <a name="ip-addresses"></a><span data-ttu-id="d0a19-343">IP-adresser</span><span class="sxs-lookup"><span data-stu-id="d0a19-343">IP Addresses</span></span>

<span data-ttu-id="d0a19-344">Varje värd på Internet har en unik 32-bitars identifierare som kallas för en IP-adress.</span><span class="sxs-lookup"><span data-stu-id="d0a19-344">Each host on the Internet has a unique 32-bit identifier called an IP address.</span></span> <span data-ttu-id="d0a19-345">Det finns fem klasser av IP-adresser enligt beskrivningen i bild 4.</span><span class="sxs-lookup"><span data-stu-id="d0a19-345">There are five classes of IP addresses as described in Figure 4.</span></span> <span data-ttu-id="d0a19-346">Intervallen för de fem IP-adress klasserna är följande:</span><span class="sxs-lookup"><span data-stu-id="d0a19-346">The ranges of the five IP address classes are as follows:</span></span>

| <span data-ttu-id="d0a19-347">Klass</span><span class="sxs-lookup"><span data-stu-id="d0a19-347">Class</span></span> | <span data-ttu-id="d0a19-348">Intervall</span><span class="sxs-lookup"><span data-stu-id="d0a19-348">Range</span></span>                        |
|-------|------------------------------|
| <span data-ttu-id="d0a19-349">A</span><span class="sxs-lookup"><span data-stu-id="d0a19-349">A</span></span>     | <span data-ttu-id="d0a19-350">0.0.0.0 till 127.255.255.255</span><span class="sxs-lookup"><span data-stu-id="d0a19-350">0.0.0.0 to 127.255.255.255</span></span>   |
| <span data-ttu-id="d0a19-351">B</span><span class="sxs-lookup"><span data-stu-id="d0a19-351">B</span></span>     | <span data-ttu-id="d0a19-352">128.0.0.0 till 191.255.255.255</span><span class="sxs-lookup"><span data-stu-id="d0a19-352">128.0.0.0 to 191.255.255.255</span></span> |
| <span data-ttu-id="d0a19-353">C</span><span class="sxs-lookup"><span data-stu-id="d0a19-353">C</span></span>     | <span data-ttu-id="d0a19-354">192.0.0.0 till 223.255.255.255</span><span class="sxs-lookup"><span data-stu-id="d0a19-354">192.0.0.0 to 223.255.255.255</span></span> |
| <span data-ttu-id="d0a19-355">D</span><span class="sxs-lookup"><span data-stu-id="d0a19-355">D</span></span>     | <span data-ttu-id="d0a19-356">224.0.0.0 till 239.255.255.255</span><span class="sxs-lookup"><span data-stu-id="d0a19-356">224.0.0.0 to 239.255.255.255</span></span> |
| <span data-ttu-id="d0a19-357">E</span><span class="sxs-lookup"><span data-stu-id="d0a19-357">E</span></span>     | <span data-ttu-id="d0a19-358">240.0.0.0 till 247.255.255.255</span><span class="sxs-lookup"><span data-stu-id="d0a19-358">240.0.0.0 to 247.255.255.255</span></span> |

<span data-ttu-id="d0a19-359">**7 bitar 24 bitar**</span><span class="sxs-lookup"><span data-stu-id="d0a19-359">**7 bits 24 bits**</span></span>

![IP-adress struktur](./media/user-guide/ip-address-structure.png)

<span data-ttu-id="d0a19-361">**BILD 4. IP-adress struktur**</span><span class="sxs-lookup"><span data-stu-id="d0a19-361">**FIGURE 4. IP Address Structure**</span></span>

<span data-ttu-id="d0a19-362">Det finns också tre typer av adress specifikationer: *unicast*, *broadcast* och *multicast*.</span><span class="sxs-lookup"><span data-stu-id="d0a19-362">There are also three types of address specifications: *unicast*, *broadcast*, and *multicast*.</span></span> <span data-ttu-id="d0a19-363">Unicast-adresser är de IP-adresser som identifierar en speciell värd på Internet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-363">Unicast addresses are those IP addresses that identify a specific host on the Internet.</span></span> <span data-ttu-id="d0a19-364">Unicast-adresser kan vara antingen en källa eller en mål-IP-adress.</span><span class="sxs-lookup"><span data-stu-id="d0a19-364">Unicast addresses can be either a source or a destination IP address.</span></span> <span data-ttu-id="d0a19-365">En broadcast-adress identifierar alla värdar i ett särskilt nätverk eller under nätverk och kan bara användas som mål adresser.</span><span class="sxs-lookup"><span data-stu-id="d0a19-365">A broadcast address identifies all hosts on a specific network or sub-network and can only be used as destination addresses.</span></span> <span data-ttu-id="d0a19-366">Broadcast-adresser anges genom att ha den värd-ID-del av adressen som anges till dem.</span><span class="sxs-lookup"><span data-stu-id="d0a19-366">Broadcast addresses are specified by having the host ID portion of the address set to ones.</span></span> <span data-ttu-id="d0a19-367">Multicast-adresser (klass D) anger en dynamisk grupp värdar på Internet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-367">Multicast addresses (Class D) specify a dynamic group of hosts on the Internet.</span></span> <span data-ttu-id="d0a19-368">Medlemmar i multicast-gruppen kan ansluta till och lämna när de vill.</span><span class="sxs-lookup"><span data-stu-id="d0a19-368">Members of the multicast group may join and leave whenever they wish.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-369">*Endast anslutnings bara protokoll som UDP över IP kan använda broadcast och begränsad broadcast-kapacitet för multicast-gruppen.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-369">*Only connectionless protocols like UDP over IP can utilize broadcast and the limited broadcast capability of the multicast group.*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-370">*Makrot* IP_ADDRESS *definieras i*  \* **nx_api. h** _.</span><span class="sxs-lookup"><span data-stu-id="d0a19-370">*The macro* IP_ADDRESS *is defined in* \***nx_api.h** _.</span></span> <span data-ttu-id="d0a19-371">Det möjliggör enkel specifikation av IP-adresser med kommatecken i stället för en punkt.</span><span class="sxs-lookup"><span data-stu-id="d0a19-371">It allows easy specification of IP addresses using commas instead of a periods.</span></span> <span data-ttu-id="d0a19-372">Exempel: IP_ADDRESS (128, 0, 0) _specifies den första klass B-adressen som visas i bild 4. \*</span><span class="sxs-lookup"><span data-stu-id="d0a19-372">For example, IP_ADDRESS(128,0,0,0) _specifies the first class B address shown in Figure 4.\*</span></span>

### <a name="ip-gateway-address"></a><span data-ttu-id="d0a19-373">IP-gateway-adress</span><span class="sxs-lookup"><span data-stu-id="d0a19-373">IP Gateway Address</span></span>

<span data-ttu-id="d0a19-374">Nätverksgateway hjälper värdar i sina nätverk att vidarebefordra paket som är avsedda för destinationer utanför den lokala domänen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-374">Network gateways assist hosts on their networks to relay packets destined to destinations outside the local domain.</span></span> <span data-ttu-id="d0a19-375">Varje nod har en viss kunskap om vilka nästa hopp som ska skickas till, antingen på målet en av dess grannar, eller genom en förprogrammerad statisk routningstabell.</span><span class="sxs-lookup"><span data-stu-id="d0a19-375">Each node has some knowledge of which next hop to send to, either the destination one of its neighbors, or through a pre-programmed static routing table.</span></span> <span data-ttu-id="d0a19-376">Men om dessa metoder inte fungerar bör noden vidarebefordra paketet till dess standardgateway som innehåller mer information om hur paketet dirigeras till målet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-376">However if these approaches fail, the node should forward the packet to its default gateway which has more information on how to route the packet to its destination.</span></span> <span data-ttu-id="d0a19-377">Observera att standardgateway måste vara direkt tillgänglig via ett av de fysiska gränssnitt som är kopplade till IP-instansen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-377">Note that the default gateway must be directly accessible through one of the physical interfaces attached to the IP instance.</span></span> <span data-ttu-id="d0a19-378">Programmet anropar ***nx_ip_gateway_address_set*** att konfigurera IP-adress för standardgateway.</span><span class="sxs-lookup"><span data-stu-id="d0a19-378">The application calls ***nx_ip_gateway_address_set*** to configure IP default gateway address.</span></span>

### <a name="ip-header"></a><span data-ttu-id="d0a19-379">IP-huvud</span><span class="sxs-lookup"><span data-stu-id="d0a19-379">IP Header</span></span>

<span data-ttu-id="d0a19-380">För att IP-paket ska kunna skickas på Internet måste det ha ett IP-huvud.</span><span class="sxs-lookup"><span data-stu-id="d0a19-380">For any IP packet to be sent on the Internet, it must have an IP header.</span></span> <span data-ttu-id="d0a19-381">När protokoll på högre nivå (UDP, TCP, ICMP eller IGMP) anropar IP-komponenten för att skicka ett paket, placerar modulen IP-överföring ett IP-huvud framför data.</span><span class="sxs-lookup"><span data-stu-id="d0a19-381">When higher-level protocols (UDP, TCP, ICMP, or IGMP) call the IP component to send a packet, the IP transmit module places an IP header in front of the data.</span></span> <span data-ttu-id="d0a19-382">När IP-paket tas emot från nätverket, tar IP-komponenten bort IP-huvudet från paketet innan det levereras till protokoll på högre nivå.</span><span class="sxs-lookup"><span data-stu-id="d0a19-382">Conversely, when IP packets are received from the network, the IP component removes the IP header from the packet before delivery to the higher-level protocols.</span></span> <span data-ttu-id="d0a19-383">Bild 5 visar formatet på IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-383">Figure 5 shows the format of the IP header.</span></span>

![Format för IP-huvud](./media/user-guide/ip-header-format.png)

<span data-ttu-id="d0a19-385">**BILD 5. Format för IP-huvud**</span><span class="sxs-lookup"><span data-stu-id="d0a19-385">**FIGURE 5. IP Header Format**</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-386">*Alla rubriker i TCP/IP-implementeringen förväntas vara i big endian format. I det här formatet finns de mest signifikanta byten av ordet på den lägsta byte-adressen. Till exempel måste 4-bitars versionen och längden på 4-bitars huvudet för IP-huvudet finnas på den första byten i rubriken.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-386">*All headers in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address. For example, the 4-bit version and the 4-bit header length of the IP header must be located on the first byte of the header.*</span></span>

<span data-ttu-id="d0a19-387">Fälten i IP-huvudet definieras enligt följande:</span><span class="sxs-lookup"><span data-stu-id="d0a19-387">The fields of the IP header are defined as follows:</span></span>

<span data-ttu-id="d0a19-388">**Fält syfte för IP-huvud**</span><span class="sxs-lookup"><span data-stu-id="d0a19-388">**IP Header Field Purpose**</span></span>

<span data-ttu-id="d0a19-389">***4-bitars version*** Det här fältet innehåller den version av IP som detta sidhuvud representerar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-389">***4-bit version*** This field contains the version of IP this header represents.</span></span> <span data-ttu-id="d0a19-390">För IP version 4, vilket är vad NetX stöder, är värdet för det här fältet 4.</span><span class="sxs-lookup"><span data-stu-id="d0a19-390">For IP version 4, which is what NetX supports, the value of this field is 4.</span></span>

<span data-ttu-id="d0a19-391">***4-bitars rubrik längd*** Det här fältet anger antalet 32-bitars ord i IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-391">***4-bit header length*** This field specifies the number of 32-bit words in the IP header.</span></span> <span data-ttu-id="d0a19-392">Om det inte finns några alternativ ord är värdet för det här fältet 5.</span><span class="sxs-lookup"><span data-stu-id="d0a19-392">If no option words are present, the value for this field is 5.</span></span>

<span data-ttu-id="d0a19-393">***8-bitars typ av tjänst (TOS)*** I det här fältet anges vilken typ av tjänst som begärs för det här IP-paketet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-393">***8-bit type of service (TOS)*** This field specifies the type of service requested for this IP packet.</span></span> <span data-ttu-id="d0a19-394">Giltiga begär Anden är följande:</span><span class="sxs-lookup"><span data-stu-id="d0a19-394">Valid requests are as follows:</span></span>

| <span data-ttu-id="d0a19-395">**TOS-begäran**</span><span class="sxs-lookup"><span data-stu-id="d0a19-395">**TOS Request**</span></span>     | <span data-ttu-id="d0a19-396">**Värde**</span><span class="sxs-lookup"><span data-stu-id="d0a19-396">**Value**</span></span> |
| ------------------- | --------- |
| <span data-ttu-id="d0a19-397">Normal</span><span class="sxs-lookup"><span data-stu-id="d0a19-397">Normal</span></span>              | <span data-ttu-id="d0a19-398">0x00</span><span class="sxs-lookup"><span data-stu-id="d0a19-398">0x00</span></span>      |
| <span data-ttu-id="d0a19-399">Minsta fördröjning</span><span class="sxs-lookup"><span data-stu-id="d0a19-399">Minimum Delay</span></span>       | <span data-ttu-id="d0a19-400">0x10</span><span class="sxs-lookup"><span data-stu-id="d0a19-400">0x10</span></span>      |
| <span data-ttu-id="d0a19-401">Maximalt antal data</span><span class="sxs-lookup"><span data-stu-id="d0a19-401">Maximum Data</span></span>        | <span data-ttu-id="d0a19-402">0x08</span><span class="sxs-lookup"><span data-stu-id="d0a19-402">0x08</span></span>      |
| <span data-ttu-id="d0a19-403">Högsta pålitlighet</span><span class="sxs-lookup"><span data-stu-id="d0a19-403">Maximum Reliability</span></span> | <span data-ttu-id="d0a19-404">0x04</span><span class="sxs-lookup"><span data-stu-id="d0a19-404">0x04</span></span>      |
| <span data-ttu-id="d0a19-405">Lägsta kostnad</span><span class="sxs-lookup"><span data-stu-id="d0a19-405">Minimum Cost</span></span>        | <span data-ttu-id="d0a19-406">0x02</span><span class="sxs-lookup"><span data-stu-id="d0a19-406">0x02</span></span>      |

<span data-ttu-id="d0a19-407">***16-bitars total längd*** Det här fältet innehåller den totala längden för IP-datagram i byte, inklusive IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-407">***16-bit total length*** This field contains the total length of the IP datagram in bytes, including the IP header.</span></span> <span data-ttu-id="d0a19-408">Ett IP-datagram är den grundläggande informations enheten som finns på ett TCP/IP-Internet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-408">An IP datagram is the basic unit of information found on a TCP/IP Internet.</span></span> <span data-ttu-id="d0a19-409">Den innehåller en mål-och käll adress förutom data.</span><span class="sxs-lookup"><span data-stu-id="d0a19-409">It contains a destination and source address in addition to data.</span></span> <span data-ttu-id="d0a19-410">Eftersom det är ett 16-bitars fält är den maximala storleken för ett IP-datagram 65 535 byte.</span><span class="sxs-lookup"><span data-stu-id="d0a19-410">Because it is a 16-bit field, the maximum size of an IP datagram is 65,535 bytes.</span></span>

<span data-ttu-id="d0a19-411">***16-bitars identifiering*** Fältet är ett tal som används för att unikt identifiera varje IP-datagram som skickas från en värd.</span><span class="sxs-lookup"><span data-stu-id="d0a19-411">***16-bit identification*** The field is a number used to uniquely identify each IP datagram sent from a host.</span></span> <span data-ttu-id="d0a19-412">Det här talet ökar ofta när ett IP-datagram har skickats.</span><span class="sxs-lookup"><span data-stu-id="d0a19-412">This number is typically incremented after an IP datagram is sent.</span></span> <span data-ttu-id="d0a19-413">Det är särskilt användbart i att montera mottagna IP-paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-413">It is especially useful in assembling received IP packet fragments.</span></span>

<span data-ttu-id="d0a19-414">***3-bitars flaggor*** Det här fältet innehåller information om IP-fragment.</span><span class="sxs-lookup"><span data-stu-id="d0a19-414">***3-bit flags*** This field contains IP fragmentation information.</span></span> <span data-ttu-id="d0a19-415">Bit 14 är biten "ingen fragment".</span><span class="sxs-lookup"><span data-stu-id="d0a19-415">Bit 14 is the "don't fragment" bit.</span></span> <span data-ttu-id="d0a19-416">Om den här biten anges fragmenteras inte det utgående IP-datagrammet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-416">If this bit is set, the outgoing IP datagram will not be fragmented.</span></span> <span data-ttu-id="d0a19-417">Bit 13 är biten "fler fragment".</span><span class="sxs-lookup"><span data-stu-id="d0a19-417">Bit 13 is the "more fragments" bit.</span></span> <span data-ttu-id="d0a19-418">Om den här biten anges finns det fler fragment.</span><span class="sxs-lookup"><span data-stu-id="d0a19-418">If this bit is set, there are more fragments.</span></span> <span data-ttu-id="d0a19-419">Om den här biten är klar är det sista fragmentet i IP-paketet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-419">If this bit is clear, this is the last fragment of the IP packet.</span></span>

<span data-ttu-id="d0a19-420">**Fält syfte för IP-huvud**</span><span class="sxs-lookup"><span data-stu-id="d0a19-420">**IP Header Field Purpose**</span></span>

<span data-ttu-id="d0a19-421">***13-bitars fragment förskjutning*** Det här fältet innehåller den övre 13 bitarna i fragment förskjutningen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-421">***13-bit fragment offset*** This field contains the upper 13-bits of the fragment offset.</span></span> <span data-ttu-id="d0a19-422">Därför tillåts fragment förskjutningar bara på 8 byte-gränser.</span><span class="sxs-lookup"><span data-stu-id="d0a19-422">Because of this, fragment offsets are only allowed on 8-byte boundaries.</span></span> <span data-ttu-id="d0a19-423">Det första fragmentet i ett fragmenterat IP-datagram kommer att ha biten "fler fragment" och ha en förskjutning på 0.</span><span class="sxs-lookup"><span data-stu-id="d0a19-423">The first fragment of a fragmented IP datagram will have the “more fragments” bit set and have an offset of 0.</span></span>

<span data-ttu-id="d0a19-424">***8-bitars TTL-värde (Time to Live)*** Det här fältet innehåller antalet routrar som det här datagrammet kan skicka, vilket begränsar datagrammets livstid.</span><span class="sxs-lookup"><span data-stu-id="d0a19-424">***8-bit time to live (TTL)*** This field contains the number of routers this datagram can pass, which limits the lifetime of the datagram.</span></span>

<span data-ttu-id="d0a19-425">***8-bitars protokoll*** Det här fältet anger vilket protokoll som använder IP-datagrammet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-425">***8-bit protocol*** This field specifies which protocol is using the IP datagram.</span></span> <span data-ttu-id="d0a19-426">Följande är en lista över giltiga protokoll och deras värden:</span><span class="sxs-lookup"><span data-stu-id="d0a19-426">The following is a list of valid protocols and their values:</span></span>

| <span data-ttu-id="d0a19-427">Protokoll</span><span class="sxs-lookup"><span data-stu-id="d0a19-427">Protocol</span></span> | <span data-ttu-id="d0a19-428">Värde</span><span class="sxs-lookup"><span data-stu-id="d0a19-428">Value</span></span> |
|----------|-------|
| <span data-ttu-id="d0a19-429">ICMP</span><span class="sxs-lookup"><span data-stu-id="d0a19-429">ICMP</span></span>     | <span data-ttu-id="d0a19-430">0x01</span><span class="sxs-lookup"><span data-stu-id="d0a19-430">0x01</span></span>  |
| <span data-ttu-id="d0a19-431">PROXYLÄGE</span><span class="sxs-lookup"><span data-stu-id="d0a19-431">IGMP</span></span>     | <span data-ttu-id="d0a19-432">0x02</span><span class="sxs-lookup"><span data-stu-id="d0a19-432">0x02</span></span>  |
| <span data-ttu-id="d0a19-433">TCP</span><span class="sxs-lookup"><span data-stu-id="d0a19-433">TCP</span></span>      | <span data-ttu-id="d0a19-434">0X06</span><span class="sxs-lookup"><span data-stu-id="d0a19-434">0X06</span></span>  |
| <span data-ttu-id="d0a19-435">UDP</span><span class="sxs-lookup"><span data-stu-id="d0a19-435">UDP</span></span>      | <span data-ttu-id="d0a19-436">0X11</span><span class="sxs-lookup"><span data-stu-id="d0a19-436">0X11</span></span>  |
|          |       |


<span data-ttu-id="d0a19-437">***16-bitars kontroll Summa*** Det här fältet innehåller 16-bitars kontroll summa som endast täcker IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-437">***16-bit checksum*** This field contains the 16-bit checksum that covers the IP header only.</span></span> <span data-ttu-id="d0a19-438">Det finns ytterligare kontroll summor i protokoll på högre nivå som behandlar IP-nyttolasten.</span><span class="sxs-lookup"><span data-stu-id="d0a19-438">There are additional checksums in the higher level protocols that cover the IP payload.</span></span>

<span data-ttu-id="d0a19-439">***32-bitars käll-IP-adress*** Det här fältet innehåller avsändarens IP-adress och är alltid en värd adress.</span><span class="sxs-lookup"><span data-stu-id="d0a19-439">***32-bit source IP address*** This field contains the IP address of the sender and is always a host address.</span></span>

<span data-ttu-id="d0a19-440">***32-bitars mål-IP-adress*** Det här fältet innehåller mottagarens eller mottagarens IP-adress om adressen är en broadcast-eller multicast-adress.</span><span class="sxs-lookup"><span data-stu-id="d0a19-440">***32-bit destination IP address*** This field contains the IP address of the receiver or receivers if the address is a broadcast or multicast address.</span></span>

### <a name="creating-ip-instances"></a><span data-ttu-id="d0a19-441">Skapar IP-instanser</span><span class="sxs-lookup"><span data-stu-id="d0a19-441">Creating IP Instances</span></span>

<span data-ttu-id="d0a19-442">IP-instanser skapas antingen under initieringen eller under körningen av program trådar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-442">IP instances are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="d0a19-443">Den första IP-adressen, nätverks masken, standard paketet, medie driv rutinen och minnet och prioriteten för den interna IP-tråden definieras av tjänsten *nx_ip_create* .</span><span class="sxs-lookup"><span data-stu-id="d0a19-443">The initial IP address, network mask, default packet pool, media driver, and memory and priority of the internal IP thread are defined by the *nx_ip_create* service.</span></span> <span data-ttu-id="d0a19-444">Om programmet initierar IP-instansen med dess IP-adress inställt på en ogiltig adress (0.0.0.0), förutsätts att gränssnitts adressen kommer att lösas av manuell konfiguration senare, via RARP eller via DHCP eller liknande protokoll.</span><span class="sxs-lookup"><span data-stu-id="d0a19-444">If the application initializes the IP instance with its IP address set to an invalid address(0.0.0.0), it is assumed that the interface address is going to resolved by manual configuration later, via RARP, or through DHCP or similar protocols.</span></span>

<span data-ttu-id="d0a19-445">För system med flera nätverks gränssnitt anges det primära gränssnittet när du anropar *nx_ip_create*.</span><span class="sxs-lookup"><span data-stu-id="d0a19-445">For systems with multiple network interfaces, the primary interface is designated when calling *nx_ip_create*.</span></span> <span data-ttu-id="d0a19-446">Varje ytterligare gränssnitt kan kopplas till samma IP-instans genom att anropa *nx_ip_interface_attach*.</span><span class="sxs-lookup"><span data-stu-id="d0a19-446">Each additional interface can be attached to the same IP instance by calling *nx_ip_interface_attach*.</span></span> <span data-ttu-id="d0a19-447">Den här tjänsten lagrar information om nätverks gränssnittet (till exempel IP-adress, nätverks mask) i gränssnitts kontroll blocket och kopplar driv rutins instansen till gränssnitts kontroll blocket i IP-instansen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-447">This service stores information about the network interface (such as IP address, network mask) in the interface control block, and associates the driver instance with the interface control block in the IP instance.</span></span> <span data-ttu-id="d0a19-448">När driv rutinen tar emot ett data paket måste den lagra gränssnitts informationen i NX_PACKETs strukturen innan den vidarebefordras till IP Receive-logiken.</span><span class="sxs-lookup"><span data-stu-id="d0a19-448">As the driver receives a data packet, it needs to store the interface information in the NX_PACKET structure before forwarding it to the IP receive logic.</span></span> <span data-ttu-id="d0a19-449">Observera att en IP-instans redan måste skapas innan du kopplar några gränssnitt.</span><span class="sxs-lookup"><span data-stu-id="d0a19-449">Note an IP instance must already be created before attaching any interfaces.</span></span>

 ### <a name="ip-send"></a><span data-ttu-id="d0a19-450">IP-sändning</span><span class="sxs-lookup"><span data-stu-id="d0a19-450">IP Send</span></span>
 <span data-ttu-id="d0a19-451">IP-sändnings bearbetning i NetX är mycket effektivt.</span><span class="sxs-lookup"><span data-stu-id="d0a19-451">The IP send processing in NetX is very streamlined.</span></span>

<span data-ttu-id="d0a19-452">Lägga-pekaren i paketet flyttas bakåt för att hantera IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-452">The prepend pointer in the packet is moved backwards to accommodate the IP header.</span></span> <span data-ttu-id="d0a19-453">IP-huvudet har slutförts (med alla alternativ som anges av anrops protokoll skiktet), beräkning av IP-kontroll i rad och paketet skickas till den associerade nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-453">The IP header is completed (with all the options specified by the calling protocol layer), the IP checksum is computed in-line, and the packet is dispatched to the associated network driver.</span></span> <span data-ttu-id="d0a19-454">Dessutom samordnas utgående fragmentering från bearbetningen av IP-överföring.</span><span class="sxs-lookup"><span data-stu-id="d0a19-454">In addition, outgoing fragmentation is also coordinated from within the IP send processing.</span></span>

<span data-ttu-id="d0a19-455">För IP initierar NetX ARP-begäranden om fysisk mappning krävs för målets IP-adress.</span><span class="sxs-lookup"><span data-stu-id="d0a19-455">For IP, NetX initiates ARP requests if physical mapping is needed for the destination IP address.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-456">*För IP-anslutning placeras paket som kräver IP-namnmatchning (dvs. fysisk mappning) i ARP-kön tills antalet paket i kö överskrider ARP-ködjup (definieras av* *symbolen **NX_ARP_MAX_QUEUE_DEPTH**). Om* *ködjup nås tar netx bort det äldsta paketet i kön och fortsätter att vänta på adress matchning för de återstående paketen i kö. Å andra sidan, om en ARP-post inte har lösts, släpps de väntande paketen på ARP-posten vid tids gränsen för ARP-posten.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-456">*For IP connectivity, packets that require IP address resolution (i.e., physical mapping) are enqueued on the ARP queue until the number of packets queued exceeds the ARP queue depth (defined by the* *symbol **NX_ARP_MAX_QUEUE_DEPTH**). If the* *queue depth is reached, NetX will remove the oldest packet on the queue and continue waiting for address resolution for the remaining packets enqueued. On the other hand, if an ARP entry is not resolved, the pending packets on the ARP entry are released upon ARP entry timeout.*</span></span>

<span data-ttu-id="d0a19-457">För system med flera nätverks gränssnitt väljer NetX ett gränssnitt baserat på mål-IP-adressen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-457">For systems with multiple network interfaces, NetX chooses an interface based on the destination IP address.</span></span> <span data-ttu-id="d0a19-458">Följande procedur gäller för urvals processen:</span><span class="sxs-lookup"><span data-stu-id="d0a19-458">The following procedure applies to the selection process:</span></span>

1. <span data-ttu-id="d0a19-459">Om en mål adress är IP-broadcast eller multicast, och om ett giltigt utgående gränssnitt har angetts, använder du det gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-459">If a destination address is IP broadcast or multicast, and if a valid outgoing interface is specified, use that interface.</span></span> <span data-ttu-id="d0a19-460">Annars används det första fysiska gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-460">Otherwise, the first physical interface is used.</span></span>

2. <span data-ttu-id="d0a19-461">Om mål adressen finns i tabellen för statisk routning används det gränssnitt som är associerat med gatewayen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-461">If the destination address is found in the static routing table, the interface associated with the gateway is used.</span></span>

3. <span data-ttu-id="d0a19-462">Om målet är länkat, används on-Link-gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-462">If the destination is on-link, the on-link interface is used.</span></span>

4. <span data-ttu-id="d0a19-463">Om mål adressen är en loopback-adress 127.0.0.1 används loopback-gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-463">If the destination address is a loopback address 127.0.0.1, the loopback interface is used.</span></span>

5. <span data-ttu-id="d0a19-464">Om standard-gatewayen är korrekt konfigurerad använder du det gränssnitt som är associerat med standard-gatewayen för att överföra paketet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-464">If the default gateway is properly configured, use the interface associated with the default gateway to transmit the packet.</span></span>

6. <span data-ttu-id="d0a19-465">Utgående paket ignoreras om ovanstående inte fungerar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-465">The output packet is dropped if all the above fails.</span></span>

### <a name="ip-receive"></a><span data-ttu-id="d0a19-466">IP-mottagning</span><span class="sxs-lookup"><span data-stu-id="d0a19-466">IP Receive</span></span>

<span data-ttu-id="d0a19-467">Den mottagna IP-bearbetningen anropas antingen från nätverks driv rutinen eller den interna IP-tråden (för bearbetning av paket i kön med uppskjutna mottagna paket).</span><span class="sxs-lookup"><span data-stu-id="d0a19-467">The IP receive processing is either called from the network driver or the internal IP thread (for processing packets on the deferred received packet queue).</span></span> <span data-ttu-id="d0a19-468">IP-inleveransbearbetning undersöker protokoll fältet och försöker skicka paketet till rätt protokoll komponent.</span><span class="sxs-lookup"><span data-stu-id="d0a19-468">The IP receive processing examines the protocol field and attempts to dispatch the packet to the proper protocol component.</span></span> <span data-ttu-id="d0a19-469">Innan paketet skickas tas IP-huvudet bort genom att lägga-pekaren flyttas förbi IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-469">Before the packet is actually dispatched, the IP header is removed by advancing the prepend pointer past the IP header.</span></span>

<span data-ttu-id="d0a19-470">IP Receive-bearbetning identifierar också fragmenterade IP-paket och utför nödvändiga steg för att sätta samman dem igen om fragmentering har Aktiver ATS.</span><span class="sxs-lookup"><span data-stu-id="d0a19-470">IP receive processing also detects fragmented IP packets and performs the necessary steps to reassemble them if fragmentation is enabled.</span></span> <span data-ttu-id="d0a19-471">Om fragmentering krävs men inte aktive rad, ignoreras paketet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-471">If fragmentation is needed but not enabled, the packet is dropped.</span></span>

<span data-ttu-id="d0a19-472">NetX identifierar lämpligt nätverks gränssnitt baserat på det gränssnitt som anges i paketet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-472">NetX determines the appropriate network interface based on the interface specified in the packet.</span></span> <span data-ttu-id="d0a19-473">Om paket gränssnittet är NULL, NetX som standard det primära gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-473">If the packet interface is NULL, NetX defaults to the primary interface.</span></span> <span data-ttu-id="d0a19-474">Detta görs för att garantera kompatibilitet med äldre NetX Ethernet-drivrutiner.</span><span class="sxs-lookup"><span data-stu-id="d0a19-474">This is done to guarantee compatibility with legacy NetX Ethernet drivers.</span></span>

### <a name="raw-ip-send"></a><span data-ttu-id="d0a19-475">RAW IP-sändning</span><span class="sxs-lookup"><span data-stu-id="d0a19-475">Raw IP Send</span></span>

<span data-ttu-id="d0a19-476">Ett RAW IP-paket är en IP-ram som innehåller nytto lasten i versaler och protokoll som inte stöds direkt (och bearbetas) av NetX.</span><span class="sxs-lookup"><span data-stu-id="d0a19-476">A raw IP packet is an IP frame that contains upper layer protocol payload not directly supported (and processed) by NetX.</span></span> <span data-ttu-id="d0a19-477">Med ett RAW-paket kan utvecklare definiera sina egna IP-baserade program.</span><span class="sxs-lookup"><span data-stu-id="d0a19-477">A raw packet allows developers to define their own IP-based applications.</span></span> <span data-ttu-id="d0a19-478">Ett program kan skicka Raw IP-paket direkt med hjälp av ***nx_ip_raw_packet_send** _-tjänsten om RAW IP-paketfiltrering har Aktiver ATS med tjänsten _*_nx_ip_raw_packet_enabled_\*_ .</span><span class="sxs-lookup"><span data-stu-id="d0a19-478">An application may send raw IP packets directly using the ***nx_ip_raw_packet_send** _ service if raw IP packet processing has been enabled with the _*_nx_ip_raw_packet_enabled_\*_ service.</span></span> <span data-ttu-id="d0a19-479">Om mål adressen är en multicast-eller broadcast-adress, kommer NetX att standardvärdet för det första (primära) gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-479">If the destination address is a multicast or broadcast address, however, NetX defaults to the first (primary) interface.</span></span> <span data-ttu-id="d0a19-480">För att skicka sådana paket från sekundära gränssnitt måste programmet därför använda tjänsten _ *_nx_ip_raw_packet_interface_send_*\* för att ange käll adressen som ska användas för det utgående paketet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-480">Therefore, to send such packets out on secondary interfaces, the application must use the _ *_nx_ip_raw_packet_interface_send_*\* service to specify the source address to use for the outgoing packet.</span></span>

### <a name="raw-ip-receive"></a><span data-ttu-id="d0a19-481">RAW IP-mottagning</span><span class="sxs-lookup"><span data-stu-id="d0a19-481">Raw IP Receive</span></span>

<span data-ttu-id="d0a19-482">Om RAW IP-paketfiltrering är aktive rad kan programmet få obehandlade IP-paket via tjänsten \***nx_ip_raw_packet_receive** _.</span><span class="sxs-lookup"><span data-stu-id="d0a19-482">If raw IP packet processing is enabled, the application may receive raw IP packets through the \***nx_ip_raw_packet_receive** _ service.</span></span> <span data-ttu-id="d0a19-483">Alla inkommande paket bearbetas enligt det protokoll som anges i IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-483">All incoming packets are processed according to the protocol specified in the IP header.</span></span> <span data-ttu-id="d0a19-484">Om protokollet anger UDP, TCP, IGMP eller ICMP, kommer NetX att bearbeta paketet med lämplig hanterare för paket protokoll typen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-484">If the protocol specifies UDP, TCP, IGMP or ICMP, NetX will process the packet using the appropriate handler for the packet protocol type.</span></span> <span data-ttu-id="d0a19-485">Om protokollet inte är ett av dessa protokoll och RAW IP Receive är aktive rad placeras det inkommande paketet i den obehandlade paket kön som väntar på att programmet ska ta emot det via tjänsten _ \*_nx_ip_raw_packet_receive_\*\*.</span><span class="sxs-lookup"><span data-stu-id="d0a19-485">If the protocol is not one of these protocols, and raw IP receive is enabled, the incoming packet will be put into the raw packet queue waiting for the application to receive it via the _ *_nx_ip_raw_packet_receive_*\* service.</span></span> <span data-ttu-id="d0a19-486">Dessutom kan program trådar pausas med en valfri tids gräns vid väntan på ett RAW IP-paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-486">In addition, application threads may suspend with an optional timeout while waiting for a raw IP packet.</span></span>

### <a name="default-packet-pool"></a><span data-ttu-id="d0a19-487">Standard pakets bassäng</span><span class="sxs-lookup"><span data-stu-id="d0a19-487">Default Packet Pool</span></span>

<span data-ttu-id="d0a19-488">Varje IP-instans tilldelas en standardpool för paket när den skapas.</span><span class="sxs-lookup"><span data-stu-id="d0a19-488">Each IP instance is given a default packet pool during creation.</span></span> <span data-ttu-id="d0a19-489">Den här poolen används för att allokera paket för ARP, RARP, ICMP, IGMP, olika TCP-kontroll paket (till exempel SYN, ACK).</span><span class="sxs-lookup"><span data-stu-id="d0a19-489">This packet pool is used to allocate packets for ARP, RARP, ICMP, IGMP, various TCP control packets (such as SYN, ACK).</span></span> <span data-ttu-id="d0a19-490">Om standardpoolen är tom när NetX måste allokera ett paket kan NetX behöva avbryta den aktuella åtgärden och returnera ett fel meddelande om möjligt.</span><span class="sxs-lookup"><span data-stu-id="d0a19-490">If the default packet pool is empty when NetX needs to allocate a packet, NetX may have to abort the particular operation, and will return an error message if possible.</span></span>

### <a name="ip-helper-thread"></a><span data-ttu-id="d0a19-491">IP-hjälp tråd</span><span class="sxs-lookup"><span data-stu-id="d0a19-491">IP Helper Thread</span></span>

<span data-ttu-id="d0a19-492">Varje IP-instans har en hjälp tråd.</span><span class="sxs-lookup"><span data-stu-id="d0a19-492">Each IP instance has a helper thread.</span></span> <span data-ttu-id="d0a19-493">Den här tråden ansvarar för hantering av all uppskjuten paket bearbetning och all periodisk bearbetning.</span><span class="sxs-lookup"><span data-stu-id="d0a19-493">This thread is responsible for handling all deferred packet processing and all periodic processing.</span></span> <span data-ttu-id="d0a19-494">IP-hjälpens tråd skapas i ***nx_ip_create.***</span><span class="sxs-lookup"><span data-stu-id="d0a19-494">The IP helper thread is created in ***nx_ip_create.***</span></span> <span data-ttu-id="d0a19-495">Det är här som tråden tilldelas sin stack och prioritet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-495">This is where the thread is given its stack and priority.</span></span> <span data-ttu-id="d0a19-496">Observera att den första bearbetningen i IP Helper-tråden är att slutföra initieringen av nätverks driv rutinen som är associerad med IP-Create-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="d0a19-496">Note that the first processing in the IP helper thread is to finish the network driver initialization associated with the IP create service.</span></span> <span data-ttu-id="d0a19-497">När nätverks driv rutins initieringen är klar startar hjälp tråden en oändlig slinga för att bearbeta paket och periodiska begär Anden.</span><span class="sxs-lookup"><span data-stu-id="d0a19-497">After the network driver initialization is complete, the helper thread starts an endless loop to process packet and periodic requests.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-498">*Om ett oförutsägbart beteende visas i IP-undersöknings tråden, är det första fel söknings steget att öka dess stack storlek under IP-tjänsten för att skapa fel sökning. Om stacken är för liten kan IP-hjälpen eventuellt skriva över minne, vilket kan orsaka ovanliga problem.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-498">*If unexplained behavior is seen within the IP helper thread, increasing its stack size during the IP create service is the first debugging step. If the stack is too small, the IP helper thread could possibly be overwriting memory, which may cause unusual problems.*</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="d0a19-499">Tråd upphängning</span><span class="sxs-lookup"><span data-stu-id="d0a19-499">Thread Suspension</span></span>

<span data-ttu-id="d0a19-500">Program trådar kan pausas vid försök att ta emot obehandlade IP-paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-500">Application threads can suspend while attempting to receive raw IP packets.</span></span> <span data-ttu-id="d0a19-501">När ett RAW-paket tas emot, tilldelas det nya paketet den första tråden och tråden återupptas.</span><span class="sxs-lookup"><span data-stu-id="d0a19-501">After a raw packet is received, the new packet is given to the first thread suspended and that thread is resumed.</span></span> <span data-ttu-id="d0a19-502">NetX Services för att ta emot paket har en valfri tids gräns för timeout.</span><span class="sxs-lookup"><span data-stu-id="d0a19-502">NetX services for receiving packets all have an optional suspension timeout.</span></span> <span data-ttu-id="d0a19-503">När ett paket tas emot eller tids gränsen går ut, återupptas program tråden med rätt slut för ande status.</span><span class="sxs-lookup"><span data-stu-id="d0a19-503">When a packet is received or the timeout expires, the application thread is resumed with the appropriate completion status.</span></span>

### <a name="ip-statistics-and-errors"></a><span data-ttu-id="d0a19-504">IP-statistik och fel</span><span class="sxs-lookup"><span data-stu-id="d0a19-504">IP Statistics and Errors</span></span>

<span data-ttu-id="d0a19-505">Om den är aktive rad håller NetX koll på flera statistik och fel som kan vara användbara för programmet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-505">If enabled, the NetX keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="d0a19-506">Följande statistik och fel rapporter underhålls för varje IP-instans:</span><span class="sxs-lookup"><span data-stu-id="d0a19-506">The following statistics and error reports are maintained for each IP instance:</span></span>

- <span data-ttu-id="d0a19-507">Totalt antal skickade IP-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-507">Total IP Packets Sent</span></span>
- <span data-ttu-id="d0a19-508">Totalt antal skickade IP-byte</span><span class="sxs-lookup"><span data-stu-id="d0a19-508">Total IP Bytes Sent</span></span>
- <span data-ttu-id="d0a19-509">Totalt antal mottagna IP-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-509">Total IP Packets Received</span></span>
- <span data-ttu-id="d0a19-510">Totalt antal mottagna IP-byte</span><span class="sxs-lookup"><span data-stu-id="d0a19-510">Total IP Bytes Received</span></span>
- <span data-ttu-id="d0a19-511">Totalt antal ogiltiga IP-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-511">Total IP Invalid Packets</span></span>
- <span data-ttu-id="d0a19-512">Totalt antal borttagna IP-mottagna paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-512">Total IP Receive Packets Dropped</span></span>
- <span data-ttu-id="d0a19-513">Totalt antal fel vid kontroll av IP-mottagning</span><span class="sxs-lookup"><span data-stu-id="d0a19-513">Total IP Receive Checksum Errors</span></span>
- <span data-ttu-id="d0a19-514">Totalt antal borttagna IP-skickade paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-514">Total IP Send Packets Dropped</span></span>
- <span data-ttu-id="d0a19-515">Totalt antal skickade IP-fragment</span><span class="sxs-lookup"><span data-stu-id="d0a19-515">Total IP Fragments Sent</span></span>
- <span data-ttu-id="d0a19-516">Totalt antal mottagna IP-fragment</span><span class="sxs-lookup"><span data-stu-id="d0a19-516">Total IP Fragments Received</span></span>

<span data-ttu-id="d0a19-517">Alla dessa statistik-och fel rapporter är tillgängliga för programmet med tjänsten ***nx_ip_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-517">All of these statistics and error reports are available to the application with the ***nx_ip_info_get*** service.</span></span>

### <a name="ip-control-block-nx_ip"></a><span data-ttu-id="d0a19-518">Kontroll block för IP-kontroll NX_IP</span><span class="sxs-lookup"><span data-stu-id="d0a19-518">IP Control Block NX_IP</span></span>

<span data-ttu-id="d0a19-519">Egenskaperna för varje IP-instans finns i kontroll blocket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-519">The characteristics of each IP instance are found in its control block.</span></span> <span data-ttu-id="d0a19-520">Den innehåller användbar information, till exempel IP-adresser och nätverks masker för varje nätverks enhet och en tabell med grann-IP och mappning av fysiska maskin varu adresser.</span><span class="sxs-lookup"><span data-stu-id="d0a19-520">It contains useful information such as the IP addresses and network masks of each network device, and a table of neighbor IP and physical hardware address mapping.</span></span> <span data-ttu-id="d0a19-521">Den här strukturen definieras i kontroll blocken för ***nx_api. h*** -kontroll som kan finnas var som helst i minnet, men det är vanligt att kontrol lera att kontrollen blockerar en global struktur genom att definiera den utanför omfånget för en funktion.</span><span class="sxs-lookup"><span data-stu-id="d0a19-521">This structure is defined in the ***nx_api.h*** IP instance control blocks can be located anywhere in memory, but it is most common to make the control block a global structure by defining it outside the scope of any function.</span></span>

### <a name="static-ip-routing"></a><span data-ttu-id="d0a19-522">Statisk IP-routning</span><span class="sxs-lookup"><span data-stu-id="d0a19-522">Static IP Routing</span></span>

<span data-ttu-id="d0a19-523">Funktionen för statisk routning gör att ett program kan ange ett IP-nätverk och nästa hopp adress för specifika IP-adresser för nätverks mål.</span><span class="sxs-lookup"><span data-stu-id="d0a19-523">The static routing feature allows an application to specify an IP network and next hop address for specific out of network destination IP addresses.</span></span> <span data-ttu-id="d0a19-524">Om statisk routning är aktiverat söker NetX igenom den statiska routningstabellen för en post som matchar mål adressen för det paket som ska skickas.</span><span class="sxs-lookup"><span data-stu-id="d0a19-524">If static routing is enabled, NetX searches through the static routing table for an entry matching the destination address of the packet to send.</span></span> <span data-ttu-id="d0a19-525">Om ingen matchning hittas söker NetX igenom listan över fysiska gränssnitt och väljer en käll-IP-adress och nästa hopp adress baserat på mål-IP-adressen och nätverks masken.</span><span class="sxs-lookup"><span data-stu-id="d0a19-525">If no match is found, NetX searches through the list of physical interfaces and chooses a source IP address and next hop address based on the destination IP address and the network mask.</span></span> <span data-ttu-id="d0a19-526">Om målet inte matchar någon av IP-adresserna för de nätverks driv rutiner som är kopplade till IP-instansen, väljer NetX ett gränssnitt som är direkt anslutet till standard-gatewayen och använder IP-adressen för gränssnittet som käll adress och standard-gatewayen som nästa hopp.</span><span class="sxs-lookup"><span data-stu-id="d0a19-526">If the destination does not match any of the IP addresses of the network drivers attached to the IP instance, NetX chooses an interface that is directly connected to the default gateway, and uses the IP address of the interface as source address, and the default gateway as the next hop.</span></span>

<span data-ttu-id="d0a19-527">Poster kan läggas till och tas bort från tabellen med statiska vägar med hjälp av ***nx_ip_static_route_add*** och \***nx_ip_static_route_delete** _ tjänster.</span><span class="sxs-lookup"><span data-stu-id="d0a19-527">Entries can be added and removed from the static routing table using the ***nx_ip_static_route_add*** and \***nx_ip_static_route_delete** _ services, respectively.</span></span> <span data-ttu-id="d0a19-528">Om du vill använda statisk routning måste värd programmet aktivera den här funktionen genom att definiera _ *_NX_ENABLE_IP_STATIC_ROUTING_*. \*</span><span class="sxs-lookup"><span data-stu-id="d0a19-528">To use static routing, the host application must enable this feature by defining _ *_NX_ENABLE_IP_STATIC_ROUTING_*.\*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-529">*När du lägger till en post i den statiska routningstabellen, söker NetX efter en matchande post för den angivna mål adressen redan i tabellen. Om det finns en sådan, ger den företräde för posten med det mindre nätverket (längre prefix) i nätverks masken.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-529">*When adding an entry to the static routing table, NetX checks for a matching entry for the specified destination address already in the table. If one exists, it gives preference to the entry with the smaller network (longer prefix) in the network mask.*</span></span>

### <a name="ip-fragmentation"></a><span data-ttu-id="d0a19-530">IP-fragmentering</span><span class="sxs-lookup"><span data-stu-id="d0a19-530">IP Fragmentation</span></span>

<span data-ttu-id="d0a19-531">Nätverks enheten kan ha gränser för storleken på utgående paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-531">The network device may have limits on the size of outgoing packets.</span></span> <span data-ttu-id="d0a19-532">Den här gränsen kallas för maximal överförings enhet (MTU).</span><span class="sxs-lookup"><span data-stu-id="d0a19-532">This limit is called the maximum transmission unit (MTU).</span></span> <span data-ttu-id="d0a19-533">IP-MTU är den största IP-bildrutans storlek som en länk skikt driv rutin kan överföra utan att fragmentera IP-paketet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-533">IP MTU is the largest IP frame size a link layer driver is able to transmit without fragmenting the IP packet.</span></span> <span data-ttu-id="d0a19-534">Under en initierings fas av enhets driv rutinen måste driv rutins modulen konfigurera dess IP-MTU-storlek via tjänsten \***nx_ip_interface_mtu_set**. \*</span><span class="sxs-lookup"><span data-stu-id="d0a19-534">During a device driver initialization phase, the driver module must configure its IP MTU size via the service \***nx_ip_interface_mtu_set**.\*</span></span>

<span data-ttu-id="d0a19-535">Även om det inte rekommenderas kan programmet generera datagram som är större än den underliggande IP-MTU som stöds av enheten.</span><span class="sxs-lookup"><span data-stu-id="d0a19-535">Although not recommended, the application may generate datagrams larger than the underlying IP MTU supported by the device.</span></span> <span data-ttu-id="d0a19-536">Innan det här IP-datagrammet överförs måste IP-skiktet fragmentera dessa paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-536">Before transmitting such IP datagram, the IP layer must fragment these packets.</span></span> <span data-ttu-id="d0a19-537">När du tar emot fragmenterade IP-ramar måste det mottagande slutet lagra alla fragmenterade IP-ramar med samma fragment-ID och ommontera dem i rätt ordning.</span><span class="sxs-lookup"><span data-stu-id="d0a19-537">On receiving fragmented IP frames, the receiving end must store all fragmented IP frames with the same fragmentation ID, and reassemble them in order.</span></span> <span data-ttu-id="d0a19-538">Om IP-mottagnings logiken inte kan samla in alla fragment för att återställa den ursprungliga IP-ramen i tiden, släpps alla fragment.</span><span class="sxs-lookup"><span data-stu-id="d0a19-538">If the IP receive logic is unable to collect all the fragments to restore the original IP frame in time, all the fragments are released.</span></span> <span data-ttu-id="d0a19-539">Det är upp till det övre skikt protokollet för att identifiera sådana paket förluster och återställa från det.</span><span class="sxs-lookup"><span data-stu-id="d0a19-539">It is up to the upper layer protocol to detect such packet loss and recover from it.</span></span>

<span data-ttu-id="d0a19-540">För att stödja IP-fragmentering och omsammansättnings åtgärd måste system designern aktivera funktionen IP-fragmentering i NetX med hjälp av tjänsten ***nx_ip_fragment_enable*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-540">In order to support IP fragmentation and reassembly operation, the system designer must enable the IP fragmentation feature in NetX using the ***nx_ip_fragment_enable*** service.</span></span> <span data-ttu-id="d0a19-541">Om den här funktionen inte är aktive rad ignoreras inkommande fragmenterade IP-paket, samt paket som överskrider nätverks driv Rutinens MTU.</span><span class="sxs-lookup"><span data-stu-id="d0a19-541">If this feature is not enabled, incoming fragmented IP packets are discarded, as well as packets that exceed the network driver's MTU.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-542">*Logiken för IP-fragmentering kan tas bort helt genom att definiera*  \* **NX_DISABLE_FRAGMENTATION** _ _When skapa theNetX-bibliotek.</span><span class="sxs-lookup"><span data-stu-id="d0a19-542">*The IP Fragmentation logic can be removed completely by defining* \***NX_DISABLE_FRAGMENTATION** _ _when building theNetX library.</span></span> <span data-ttu-id="d0a19-543">Detta bidrar till att minska kod storleken för NetX. \*</span><span class="sxs-lookup"><span data-stu-id="d0a19-543">Doing so helps reduce the code size of NetX.\*</span></span>

## <a name="address-resolution-protocol-arp-in-ip"></a><span data-ttu-id="d0a19-544">ARP (Address Resolution Protocol) i IP</span><span class="sxs-lookup"><span data-stu-id="d0a19-544">Address Resolution Protocol (ARP) in IP</span></span>

<span data-ttu-id="d0a19-545">ARP-protokollet (Address Resolution Protocol) ansvarar för att dynamiskt mappa 32-bitars IP-adresser till de underliggande fysiska medierna (RFC 826).</span><span class="sxs-lookup"><span data-stu-id="d0a19-545">The Address Resolution Protocol (ARP) is responsible for dynamically mapping 32-bit IP addresses to those of the underlying physical media (RFC 826).</span></span> <span data-ttu-id="d0a19-546">Ethernet är det mest typiska fysiska mediet och stöder 48-bitars adresser.</span><span class="sxs-lookup"><span data-stu-id="d0a19-546">Ethernet is the most typical physical media, and it supports 48-bit addresses.</span></span> <span data-ttu-id="d0a19-547">Behovet av ARP bestäms av nätverks driv rutinen som tillhandahålls till ***nx_ip_create*** tjänsten.</span><span class="sxs-lookup"><span data-stu-id="d0a19-547">The need for ARP is determined by the network driver supplied to the ***nx_ip_create*** service.</span></span> <span data-ttu-id="d0a19-548">Om fysisk mappning krävs måste nätverks driv rutinen ange flaggan ***nx_interface_address_mapping_needed*** i gränssnittet struktur.</span><span class="sxs-lookup"><span data-stu-id="d0a19-548">If physical mapping is required, the network driver must set the flag ***nx_interface_address_mapping_needed*** in the interface strcuture.</span></span>

### <a name="arp-enable"></a><span data-ttu-id="d0a19-549">Aktivera ARP</span><span class="sxs-lookup"><span data-stu-id="d0a19-549">ARP Enable</span></span>
<span data-ttu-id="d0a19-550">För att ARP ska fungera korrekt måste den först aktive ras av programmet med ***nx_arp_enable*** -tjänsten.</span><span class="sxs-lookup"><span data-stu-id="d0a19-550">For ARP to function properly, it must first be enabled by the application with the ***nx_arp_enable*** service.</span></span> <span data-ttu-id="d0a19-551">Den här tjänsten konfigurerar olika data strukturer för ARP-bearbetning, inklusive skapandet av ett ARP-cache-utrymme från det minne som har angetts till tjänsten ARP enable.</span><span class="sxs-lookup"><span data-stu-id="d0a19-551">This service sets up various data structures for ARP processing, including the creation of an ARP cache area from the memory supplied to the ARP enable service.</span></span>

### <a name="arp-cache"></a><span data-ttu-id="d0a19-552">ARP-cache</span><span class="sxs-lookup"><span data-stu-id="d0a19-552">ARP Cache</span></span>
<span data-ttu-id="d0a19-553">ARP-cachen kan visas som en matris med interna ARP-mappnings data strukturer.</span><span class="sxs-lookup"><span data-stu-id="d0a19-553">The ARP cache can be viewed as an array of internal ARP mapping data structures.</span></span> <span data-ttu-id="d0a19-554">Varje intern struktur kan underhålla relationen mellan en IP-adress och en fysisk maskin varu adress.</span><span class="sxs-lookup"><span data-stu-id="d0a19-554">Each internal structure is capable of maintaining the relationship between an IP address and a physical hardware address.</span></span> <span data-ttu-id="d0a19-555">Dessutom har varje data struktur länk pekare så att den kan ingå i flera länkade listor.</span><span class="sxs-lookup"><span data-stu-id="d0a19-555">In addition, each data structure has link pointers so it can be part of multiple linked lists.</span></span>

<span data-ttu-id="d0a19-556">Programmet kan slå upp en IP-adress från ARP-cachen genom att tillhandahålla maskin varans MAC-adress med hjälp av tjänsten \***nx_arp_ip_address_find** _ om mappningen finns i ARP-tabellen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-556">Application can look up an IP address from the ARP cache by supplying hardware MAC address using the service \***nx_arp_ip_address_find** _ if the mapping exists in the ARP table.</span></span> <span data-ttu-id="d0a19-557">På samma sätt returnerar tjänsten _ *_nx_arp_hardware_address_find_*\* Mac-adressen för en specifik IP-adress.</span><span class="sxs-lookup"><span data-stu-id="d0a19-557">Similarly, the service _ *_nx_arp_hardware_address_find_*\* returns the MAC address for a given IP address.</span></span>


### <a name="arp-dynamic-entries"></a><span data-ttu-id="d0a19-558">Dynamiska ARP-poster</span><span class="sxs-lookup"><span data-stu-id="d0a19-558">ARP Dynamic Entries</span></span>

<span data-ttu-id="d0a19-559">Som standard placerar tjänsten ARP Enable alla poster i ARP-cachen i listan över tillgängliga dynamiska ARP-poster.</span><span class="sxs-lookup"><span data-stu-id="d0a19-559">By default, the ARP enable service places all entries in the ARP cache on the list of available dynamic ARP entries.</span></span> <span data-ttu-id="d0a19-560">En dynamisk ARP-post tilldelas från den här listan av NetX när en skicka-begäran till en omappad IP-adress identifieras.</span><span class="sxs-lookup"><span data-stu-id="d0a19-560">A dynamic ARP entry is allocated from this list by NetX when a send request to an unmapped IP address is detected.</span></span> <span data-ttu-id="d0a19-561">Efter allokeringen konfigureras ARP-posten och en ARP-begäran skickas till det fysiska mediet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-561">After allocation, the ARP entry is set up and an ARP request is sent to the physical media.</span></span>

<span data-ttu-id="d0a19-562">En dynamisk post kan också skapas av tjänsten ***nx_arp_dynamic_entry_set***.</span><span class="sxs-lookup"><span data-stu-id="d0a19-562">A dynamic entry can also be created by the service ***nx_arp_dynamic_entry_set***.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-563">*Om alla dynamiska ARP-poster används ersätts den senast använda ARP-posten med en ny mappning.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-563">*If all dynamic ARP entries are in use, the least recently used ARP entry is replaced with a new mapping.*</span></span>

### <a name="arp-static-entries"></a><span data-ttu-id="d0a19-564">Statiska ARP-poster</span><span class="sxs-lookup"><span data-stu-id="d0a19-564">ARP Static Entries</span></span>
<span data-ttu-id="d0a19-565">Programmet kan också konfigurera statiska ARP-mappningar med hjälp av tjänsten ***nx_arp_static_entry_create*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-565">The application can also set up static ARP mapping by using the ***nx_arp_static_entry_create*** service.</span></span> <span data-ttu-id="d0a19-566">Den här tjänsten allokerar en ARP-post från listan över dynamiska ARP-poster och placerar den på den statiska listan med mappnings informationen som tillhandahålls av programmet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-566">This service allocates an ARP entry from the dynamic ARP entry list and places it on the static list with the mapping information supplied by the application.</span></span> <span data-ttu-id="d0a19-567">Statiska ARP-poster omfattas inte av åter användning eller åldrande.</span><span class="sxs-lookup"><span data-stu-id="d0a19-567">Static ARP entries are not subject to reuse or aging.</span></span> <span data-ttu-id="d0a19-568">Programmet kan ta bort en statisk post genom att använda tjänsten ***nx_arp_static_entry_delete***.</span><span class="sxs-lookup"><span data-stu-id="d0a19-568">The application can delete a static entry by using the service ***nx_arp_static_entry_delete***.</span></span>
<span data-ttu-id="d0a19-569">Om du vill ta bort alla statiska poster i ARP-tabellen kan programmet använda tjänsten ***nx_arp_static_entries_delete***.</span><span class="sxs-lookup"><span data-stu-id="d0a19-569">To remove all static entries in the ARP table, the application may use the service ***nx_arp_static_entries_delete***.</span></span>

### <a name="automatic-arp-entry"></a><span data-ttu-id="d0a19-570">Automatisk ARP-post</span><span class="sxs-lookup"><span data-stu-id="d0a19-570">Automatic ARP Entry</span></span>
<span data-ttu-id="d0a19-571">NetX registrerar peers IP/MAC-mappning efter peer-svar på ARP-begäran.</span><span class="sxs-lookup"><span data-stu-id="d0a19-571">NetX records the peer's IP/MAC mapping after the peer responses to the ARP request.</span></span> <span data-ttu-id="d0a19-572">NetX implementerar också funktionen automatisk ARP-post där den registrerar peer IP/MAC-adress mappning baserat på oombedda ARP-begäranden från nätverket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-572">NetX also implements the automatic ARP entry feature where it records peer IP/MAC address mapping based on unsolicited ARP requests from the network.</span></span> <span data-ttu-id="d0a19-573">Med den här funktionen kan ARP-tabellen fyllas i med peer-information, vilket minskar fördröjningen som krävs för att gå igenom ARP-begäran/svars cykeln.</span><span class="sxs-lookup"><span data-stu-id="d0a19-573">This feature allows the ARP table to be populated with peer information, reducing the delay needed to go through the ARP request/response cycle.</span></span> <span data-ttu-id="d0a19-574">Nack delen med att aktivera automatisk ARP är dock att ARP-tabellen ofta fyller på ett upptaget nätverk med många noder på den lokala länken, vilket skulle leda till byte av ARP-post.</span><span class="sxs-lookup"><span data-stu-id="d0a19-574">However the downside with enabling automatic ARP is that the ARP table tend to fill up quickly on a busy network with many nodes on the local link, which would eventually lead to ARP entry replacement.</span></span>

<span data-ttu-id="d0a19-575">Den här funktionen är aktive rad som standard.</span><span class="sxs-lookup"><span data-stu-id="d0a19-575">This feature is enabled by default.</span></span> <span data-ttu-id="d0a19-576">För att inaktivera det måste NetX-biblioteket kompileras med symbolen ***NX_DISABLE_ARP_AUTO_ENTRY*** definierad.</span><span class="sxs-lookup"><span data-stu-id="d0a19-576">To disable it, the NetX library must be compiled with the symbol ***NX_DISABLE_ARP_AUTO_ENTRY*** defined.</span></span>

### <a name="arp-messages"></a><span data-ttu-id="d0a19-577">ARP-meddelanden</span><span class="sxs-lookup"><span data-stu-id="d0a19-577">ARP Messages</span></span>

<span data-ttu-id="d0a19-578">Som tidigare nämnts skickas ett meddelande om ARP-begäran när IP-aktiviteten identifierar att mappning krävs för en IP-adress.</span><span class="sxs-lookup"><span data-stu-id="d0a19-578">As mentioned previously, an ARP request message is sent when the IP task detects that mapping is needed for an IP address.</span></span> <span data-ttu-id="d0a19-579">ARP-begäranden skickas regelbundet (var \***NX_ARP_UPDATE_RATE** _ sekunder) tills ett motsvarande ARP-svar tas emot.</span><span class="sxs-lookup"><span data-stu-id="d0a19-579">ARP requests are sent periodically (every \***NX_ARP_UPDATE_RATE** _ seconds) until a corresponding ARP response is received.</span></span> <span data-ttu-id="d0a19-580">Totalt _ *_NX_ARP_MAXIMUM_RETRIES_*\* ARP-begäranden görs innan ARP-försöket överges.</span><span class="sxs-lookup"><span data-stu-id="d0a19-580">A total of _ *_NX_ARP_MAXIMUM_RETRIES_*\* ARP requests are made before the ARP attempt is abandoned.</span></span> <span data-ttu-id="d0a19-581">När ett ARP-svar tas emot lagras den associerade fysiska adress informationen i ARP-posten i cacheminnet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-581">When an ARP response is received, the associated physical address information is stored in the ARP entry that is in the cache.</span></span>

<span data-ttu-id="d0a19-582">För multihome-system bestämmer NetX vilket gränssnitt som ska skicka ARP-förfrågningar och svar baserat på den angivna mål adressen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-582">For multihome systems, NetX determines which interface to send the ARP requests and responses based on destination address specified.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-583">*Utgående IP-paket köas när netx väntar på ARP-svaret. Antalet utgående IP-* *paket i kö definieras av konstanten*  \* **NX_ARP_MAX_QUEUE_DEPTH**. \*</span><span class="sxs-lookup"><span data-stu-id="d0a19-583">*Outgoing IP packets are queued while NetX waits for the ARP response. The number of outgoing IP* *packets queued is defined by the constant* \***NX_ARP_MAX_QUEUE_DEPTH**.\*</span></span>

<span data-ttu-id="d0a19-584">NetX svarar också på ARP-förfrågningar från andra noder i det lokala IP-nätverket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-584">NetX also responds to ARP requests from other nodes on the local IP network.</span></span> <span data-ttu-id="d0a19-585">När en extern ARP-begäran görs som matchar den aktuella IP-adressen för det gränssnitt som tar emot ARP-begäran, skapar NetX ett ARP-svarsmeddelande som innehåller den aktuella fysiska adressen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-585">When an external ARP request is made that matches the current IP address of the interface that receives the ARP request, NetX builds an ARP response message that contains the current physical address.</span></span>

<span data-ttu-id="d0a19-586">Formatet på Ethernet ARP-begäranden och-svar visas i bild 6 och beskrivs nedan:</span><span class="sxs-lookup"><span data-stu-id="d0a19-586">The formats of Ethernet ARP requests and responses are shown in Figure 6 and are described below:</span></span>

| <span data-ttu-id="d0a19-587">Fråge-/svars fält</span><span class="sxs-lookup"><span data-stu-id="d0a19-587">Request/Response Field</span></span>       | <span data-ttu-id="d0a19-588">Syfte</span><span class="sxs-lookup"><span data-stu-id="d0a19-588">Purpose</span></span>    |
|------------------------------|-----------------|
| <span data-ttu-id="d0a19-589">Ethernet-mål adress</span><span class="sxs-lookup"><span data-stu-id="d0a19-589">Ethernet Destination Address</span></span> | <span data-ttu-id="d0a19-590">Detta 6-byte-fält innehåller mål adressen för ARP-svaret och är en sändning (alla) för ARP-förfrågningar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-590">This 6-byte field contains the destination address for the ARP response and is a broadcast (all ones) for ARP requests.</span></span> <span data-ttu-id="d0a19-591">Det här fältet ställs in av nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-591">This field is setup by the network driver.</span></span> |
| <span data-ttu-id="d0a19-592">Ethernet-källans adress</span><span class="sxs-lookup"><span data-stu-id="d0a19-592">Ethernet Source Address</span></span>      | <span data-ttu-id="d0a19-593">Detta 6-byte-fält innehåller adressen till avsändaren av ARP-begäran eller-svaret och har kon figurer ATS av nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-593">This 6-byte field contains the address of the sender of the ARP request or response and is set up by the network driver.</span></span> |
| <span data-ttu-id="d0a19-594">Ramtyp</span><span class="sxs-lookup"><span data-stu-id="d0a19-594">Frame Type</span></span>                   | <span data-ttu-id="d0a19-595">Detta fält i 2 byte innehåller typen av Ethernet-ram som finns och, för ARP-förfrågningar och svar, detta är lika med 0x0806.</span><span class="sxs-lookup"><span data-stu-id="d0a19-595">This 2-byte field contains the type of Ethernet frame present and, for ARP requests and responses, this is equal to 0x0806.</span></span> <span data-ttu-id="d0a19-596">Detta är det sista fältet som nätverks driv rutinen ansvarar för att konfigurera.</span><span class="sxs-lookup"><span data-stu-id="d0a19-596">This is the last field the network driver is responsible for setting up.</span></span> |
| <span data-ttu-id="d0a19-597">Maskin varu typ</span><span class="sxs-lookup"><span data-stu-id="d0a19-597">Hardware Type</span></span>                | <span data-ttu-id="d0a19-598">Detta fält i 2 byte innehåller maskin varu typen, som är 0x0001 för Ethernet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-598">This 2-byte field contains the hardware type, which is 0x0001 for Ethernet.</span></span> |
| <span data-ttu-id="d0a19-599">Protokoll typ</span><span class="sxs-lookup"><span data-stu-id="d0a19-599">Protocol Type</span></span>                | <span data-ttu-id="d0a19-600">Detta fält i 2 byte innehåller protokoll typen, som är 0x0800 för IP-adresser.</span><span class="sxs-lookup"><span data-stu-id="d0a19-600">This 2-byte field contains the protocol type, which is 0x0800 for IP addresses.</span></span> |
| <span data-ttu-id="d0a19-601">Maskin varu storlek</span><span class="sxs-lookup"><span data-stu-id="d0a19-601">Hardware Size</span></span>                | <span data-ttu-id="d0a19-602">Det här 1-byte fältet innehåller maskin varu adressens storlek, som är 6 för Ethernet-adresser.</span><span class="sxs-lookup"><span data-stu-id="d0a19-602">This 1-byte field contains the hardware address size, which is 6 for Ethernet addresses.</span></span> |


![ARP-paketfilter](./media/user-guide/arp-packet-format.png)

<span data-ttu-id="d0a19-604">**BILD 6. ARP-paketfilter**</span><span class="sxs-lookup"><span data-stu-id="d0a19-604">**FIGURE 6. ARP Packet Format**</span></span>

| <span data-ttu-id="d0a19-605">Fråge-/svars fält</span><span class="sxs-lookup"><span data-stu-id="d0a19-605">Request/Response Field</span></span> | <span data-ttu-id="d0a19-606">Syfte</span><span class="sxs-lookup"><span data-stu-id="d0a19-606">Purpose</span></span>  |
|---|---|
| <span data-ttu-id="d0a19-607">Protokoll storlek</span><span class="sxs-lookup"><span data-stu-id="d0a19-607">Protocol Size</span></span> | <span data-ttu-id="d0a19-608">Detta 1-byte-fält innehåller IP-adressens storlek, som är 4 för IP-adresser.</span><span class="sxs-lookup"><span data-stu-id="d0a19-608">This 1-byte field contains the IP address size, which is 4 for IP addresses.</span></span>  |
| <span data-ttu-id="d0a19-609">Åtgärds kod</span><span class="sxs-lookup"><span data-stu-id="d0a19-609">Operation Code</span></span> | <span data-ttu-id="d0a19-610">Detta fält i 2 byte innehåller åtgärden för det här ARP-paketet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-610">This 2-byte field contains the operation for this ARP packet.</span></span> <span data-ttu-id="d0a19-611">En ARP-begäran anges med värdet 0x0001, medan ett ARP-svar representeras av värdet 0x0002.</span><span class="sxs-lookup"><span data-stu-id="d0a19-611">An ARP request is specified with the value of 0x0001, while an ARP response is represented by a value of 0x0002.</span></span>  |
| <span data-ttu-id="d0a19-612">Avsändarens Ethernet-adress</span><span class="sxs-lookup"><span data-stu-id="d0a19-612">Sender Ethernet Address</span></span> | <span data-ttu-id="d0a19-613">Det här 6-byte-fältet innehåller avsändarens Ethernet-adress.</span><span class="sxs-lookup"><span data-stu-id="d0a19-613">This 6-byte field contains the sender's Ethernet address.</span></span> |
| <span data-ttu-id="d0a19-614">Avsändarens IP-adress</span><span class="sxs-lookup"><span data-stu-id="d0a19-614">Sender IP Address</span></span> | <span data-ttu-id="d0a19-615">Detta fält med fyra byte innehåller avsändarens IP-adress.</span><span class="sxs-lookup"><span data-stu-id="d0a19-615">This 4-byte field contains the sender's IP address.</span></span> |
| <span data-ttu-id="d0a19-616">Mål-Ethernet-adress</span><span class="sxs-lookup"><span data-stu-id="d0a19-616">Target Ethernet Address</span></span> | <span data-ttu-id="d0a19-617">Detta 6-byte-fält innehåller målets Ethernet-adress.</span><span class="sxs-lookup"><span data-stu-id="d0a19-617">This 6-byte field contains the target's Ethernet address.</span></span> |
| <span data-ttu-id="d0a19-618">Mål-IP-adress</span><span class="sxs-lookup"><span data-stu-id="d0a19-618">Target IP Address</span></span> | <span data-ttu-id="d0a19-619">Detta fält i 4 byte innehåller målets IP-adress.</span><span class="sxs-lookup"><span data-stu-id="d0a19-619">This 4-byte field contains the target's IP address.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="d0a19-620">*ARP-förfrågningar och-svar är paket med Ethernet-nivå. Alla andra TCP/IP-paket kapslas in av ett IP-pakets huvud.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-620">*ARP requests and responses are Ethernet-level packets. All other TCP/IP packets are encapsulated by an IP packet header.*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-621">*Alla ARP-meddelanden i TCP/IP-implementeringen förväntas vara i big endian format. I det här formatet finns de mest signifikanta byten av ordet på den lägsta byte-adressen.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-621">*All ARP messages in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="arp-aging"></a><span data-ttu-id="d0a19-622">ARP-åldrande</span><span class="sxs-lookup"><span data-stu-id="d0a19-622">ARP Aging</span></span>

<span data-ttu-id="d0a19-623">NetX stöder automatisk ogiltig dynamisk ARP-post.</span><span class="sxs-lookup"><span data-stu-id="d0a19-623">NetX supports automatic dynamic ARP entry invalidation.</span></span><span data-ttu-id="d0a19-624">\ ***NX_ARP_EXPIRATION_RATE** _specifies antalet sekunder som en upprättad IP-adress till fysisk mappning fortfarande är giltig.</span><span class="sxs-lookup"><span data-stu-id="d0a19-624">\ ***NX_ARP_EXPIRATION_RATE** _specifies the number of seconds an established IP address to physical mapping stays valid.</span></span> <span data-ttu-id="d0a19-625">Efter förfallo datum tas ARP-posten bort från ARP-cachen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-625">After expiration, the ARP entry is removed from the ARP cache.</span></span> <span data-ttu-id="d0a19-626">Nästa försök att skicka till motsvarande IP-adress leder till en ny ARP-begäran.</span><span class="sxs-lookup"><span data-stu-id="d0a19-626">The next attempt to send to the corresponding IP address will result in a new ARP request.</span></span> <span data-ttu-id="d0a19-627">Om du anger _ *_NX_ARP_EXPIRATION_RATE_*\* till noll inaktive ras ARP-åldrande, vilket är standard konfigurationen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-627">Setting _ *_NX_ARP_EXPIRATION_RATE_*\* to zero disables ARP aging, which is the default configuration.</span></span>

### <a name="arp-defend"></a><span data-ttu-id="d0a19-628">ARP-försvara</span><span class="sxs-lookup"><span data-stu-id="d0a19-628">ARP Defend</span></span>

<span data-ttu-id="d0a19-629">När en ARP-begäran eller ett ARP-svars paket tas emot och avsändaren har samma IP-adress, som står i konflikt med IP-adressen för den här noden, skickar NetX en ARP-begäran för den adressen som försvars tid.</span><span class="sxs-lookup"><span data-stu-id="d0a19-629">When an ARP request or ARP response packet is received and the sender has the same IP address, which conflicts with the IP address of this node, NetX sends an ARP request for that address as a defense.</span></span> <span data-ttu-id="d0a19-630">Om ett konflikt-ARP-paket tas emot mer än en gång om 10 sekunder, skickar NetX inte fler försvarande paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-630">If the conflict ARP packet is received more than once in 10 seconds, NetX does not send more defend packets.</span></span> <span data-ttu-id="d0a19-631">Standard intervallet på 10 sekunder kan omdefinieras med \***NX_ARP_DEFEND_INTERVAL** _.</span><span class="sxs-lookup"><span data-stu-id="d0a19-631">The default interval 10 seconds can be redefined by \***NX_ARP_DEFEND_INTERVAL** _.</span></span> <span data-ttu-id="d0a19-632">Det här beteendet följer principen som anges i 2.4 (c) av RFC5227.</span><span class="sxs-lookup"><span data-stu-id="d0a19-632">This behavior follows the policy specified in 2.4(c) of RFC5227.</span></span> <span data-ttu-id="d0a19-633">Eftersom Windows XP ignorerar ARP-meddelande som ett svar för sin ARP-avsökning kan användaren definiera _ *_NX_ARP_DEFEND_BY_REPLY_* \* för att skicka ARP-svar som ytterligare försvar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-633">Since Windows XP ignores ARP announcement as a response for its ARP probe, user can define _\*_NX_ARP_DEFEND_BY_REPLY_\*\*to send ARP response as additional defence.</span></span>

### <a name="arp-statistics-and-errors"></a><span data-ttu-id="d0a19-634">ARP-statistik och fel</span><span class="sxs-lookup"><span data-stu-id="d0a19-634">ARP Statistics and Errors</span></span>

<span data-ttu-id="d0a19-635">Om den är aktive rad håller NetX ARP-programvaran reda på flera statistik och fel som kan vara användbara för programmet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-635">If enabled, the NetX ARP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="d0a19-636">Följande statistik och fel rapporter underhålls för varje IP-ARP-bearbetning:</span><span class="sxs-lookup"><span data-stu-id="d0a19-636">The following statistics and error reports are maintained for each IP's ARP processing:</span></span>

- <span data-ttu-id="d0a19-637">Totalt antal skickade ARP-begäranden</span><span class="sxs-lookup"><span data-stu-id="d0a19-637">Total ARP Requests Sent</span></span>
- <span data-ttu-id="d0a19-638">Totalt antal mottagna ARP-begäranden</span><span class="sxs-lookup"><span data-stu-id="d0a19-638">Total ARP Requests Received</span></span>
- <span data-ttu-id="d0a19-639">Totalt antal skickade ARP-svar</span><span class="sxs-lookup"><span data-stu-id="d0a19-639">Total ARP Responses Sent</span></span>
- <span data-ttu-id="d0a19-640">Totalt antal mottagna ARP-svar</span><span class="sxs-lookup"><span data-stu-id="d0a19-640">Total ARP Responses Received</span></span>
- <span data-ttu-id="d0a19-641">Totalt antal dynamiska ARP-poster</span><span class="sxs-lookup"><span data-stu-id="d0a19-641">Total ARP Dynamic Entries</span></span>
- <span data-ttu-id="d0a19-642">Totalt antal statiska ARP-poster</span><span class="sxs-lookup"><span data-stu-id="d0a19-642">Total ARP Static Entries</span></span>
- <span data-ttu-id="d0a19-643">Totalt antal inaktuella ARP-poster</span><span class="sxs-lookup"><span data-stu-id="d0a19-643">Total ARP Aged Entries</span></span>
- <span data-ttu-id="d0a19-644">Totalt antal ogiltiga ARP-meddelanden</span><span class="sxs-lookup"><span data-stu-id="d0a19-644">Total ARP Invalid Messages</span></span>

<span data-ttu-id="d0a19-645">Alla dessa statistik-och fel rapporter är tillgängliga för programmet med tjänsten ***nx_arp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-645">All these statistics and error reports are available to the application with the ***nx_arp_info_get*** service.</span></span>

## <a name="reverse-address-resolution-protocol-rarp-in-ip"></a><span data-ttu-id="d0a19-646">RARP (reversed Address Resolution Protocol) i IP</span><span class="sxs-lookup"><span data-stu-id="d0a19-646">Reverse Address Resolution Protocol (RARP) in IP</span></span>

<span data-ttu-id="d0a19-647">RARP (reversed Address Resolution Protocol) är protokollet för att begära nätverks tilldelning av värdens 32-bitars IP-adresser (RFC 903).</span><span class="sxs-lookup"><span data-stu-id="d0a19-647">The Reverse Address Resolution Protocol (RARP) is the protocol for requesting network assignment of the host's 32-bit IP addresses (RFC 903).</span></span> <span data-ttu-id="d0a19-648">Detta görs via en RARP-begäran och fortsätter regelbundet tills en nätverks medlem tilldelar en IP-adress till värd nätverks gränssnittet i ett RARP-svar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-648">This is done through an RARP request and continues periodically until a network member assigns an IP address to the host network interface in an RARP response.</span></span> <span data-ttu-id="d0a19-649">Programmet skapar en IP-instans av tjänsten ***nx_ip_create*** med en noll IP-adress.</span><span class="sxs-lookup"><span data-stu-id="d0a19-649">The application creates an IP instance by the service ***nx_ip_create*** with a zero IP address.</span></span> <span data-ttu-id="d0a19-650">Om RARP har Aktiver ATS av programmet kan det använda RARP-protokollet för att begära en IP-adress från nätverks servern som är tillgänglig via gränssnittet som har en noll IP-adress.</span><span class="sxs-lookup"><span data-stu-id="d0a19-650">If RARP is enabled by the application, it can use the RARP protocol to request an IP address from the network server accessible through the interface that has a zero IP address.</span></span>

### <a name="rarp-enable"></a><span data-ttu-id="d0a19-651">Aktivera RARP</span><span class="sxs-lookup"><span data-stu-id="d0a19-651">RARP Enable</span></span>

<span data-ttu-id="d0a19-652">Om du vill använda RARP måste programmet skapa IP-instansen med en IP-adress som är noll och sedan aktivera RARP med hjälp av tjänsten ***nx_rarp_enable***.</span><span class="sxs-lookup"><span data-stu-id="d0a19-652">To use RARP, the application must create the IP instance with an IP address of zero, then enable RARP using the service ***nx_rarp_enable***.</span></span> <span data-ttu-id="d0a19-653">För flera hem system måste minst en nätverks enhet som är associerad med IP-instansen ha en IP-adress som är noll.</span><span class="sxs-lookup"><span data-stu-id="d0a19-653">For multihome systems, at least one network device associated with the IP instance must have an IP address of zero.</span></span> <span data-ttu-id="d0a19-654">RARP-bearbetningen skickar regelbundet RARP begär Anden för NetX-systemet som kräver en IP-adress tills ett giltigt RARP-svar med den angivna IP-adressen för nätverket tas emot.</span><span class="sxs-lookup"><span data-stu-id="d0a19-654">The RARP processing periodically sends RARP request messages for the NetX system requiring an IP address until a valid RARP reply with the network designated IP address is received.</span></span> <span data-ttu-id="d0a19-655">I det här läget är RARP-bearbetningen klar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-655">At this point, RARP processing is complete.</span></span>

<span data-ttu-id="d0a19-656">När RARP har Aktiver ATS inaktive ras den automatiskt när alla gränssnitts adresser har lösts.</span><span class="sxs-lookup"><span data-stu-id="d0a19-656">After RARP has been enabled, it is disabled automatically after all interface addresses are resolved.</span></span> <span data-ttu-id="d0a19-657">Programmet kan tvinga RARP att avslutas genom att använda tjänsten ***nx_rarp_disable***.</span><span class="sxs-lookup"><span data-stu-id="d0a19-657">The application may force RARP to terminate by using the service ***nx_rarp_disable***.</span></span>

###  <a name="rarp-request"></a><span data-ttu-id="d0a19-658">RARP-begäran</span><span class="sxs-lookup"><span data-stu-id="d0a19-658">RARP Request</span></span>

<span data-ttu-id="d0a19-659">Formatet på ett RARP begär ande paket är nästan identiskt med ARP-paketet som visas i bild 6 i avsnittet om [ARP-meddelanden](#arp-messages). Den enda skillnaden är att fältet ramtyp är 0x8035 och fältet *Åtgärds kod* är 3, vilket anger en RARP-begäran.</span><span class="sxs-lookup"><span data-stu-id="d0a19-659">The format of an RARP request packet is almost identical to the ARP packet shown in Figure 6 in the topic [ARP Messages](#arp-messages).The only difference is the frame type field is 0x8035 and the *Operation Code* field is 3, designating an RARP request.</span></span> <span data-ttu-id="d0a19-660">Som tidigare nämnts kommer RARP-begäranden att skickas regelbundet (var ***NX_RARP_UPDATE_RATE*** sekund) tills ett RARP-svar med den tilldelade IP-adressen för nätverket tas emot.</span><span class="sxs-lookup"><span data-stu-id="d0a19-660">As mentioned previously, RARP requests will be sent periodically (every ***NX_RARP_UPDATE_RATE*** seconds) until a RARP reply with the network assigned IP address is received.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-661">*Alla RARP-meddelanden i TCP/IP-implementeringen förväntas vara i big endian format. I det här formatet finns de mest signifikanta byten av ordet på den lägsta byte-adressen.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-661">*All RARP messages in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="rarp-reply"></a><span data-ttu-id="d0a19-662">RARP-svar</span><span class="sxs-lookup"><span data-stu-id="d0a19-662">RARP Reply</span></span>

<span data-ttu-id="d0a19-663">RARP svarsmeddelanden tas emot från nätverket och innehåller den nätverks tilldelade IP-adressen för den här värden.</span><span class="sxs-lookup"><span data-stu-id="d0a19-663">RARP reply messages are received from the network and contain the network assigned IP address for this host.</span></span> <span data-ttu-id="d0a19-664">Formatet på ett RARP Reply-paket är nästan identiskt med ARP-paketet som visas i bild 6.</span><span class="sxs-lookup"><span data-stu-id="d0a19-664">The format of an RARP reply packet is almost identical to the ARP packet shown in Figure 6.</span></span> <span data-ttu-id="d0a19-665">Den enda skillnaden är att fältet ramtyp är 0x8035 och fältet *Åtgärds kod* är 4, vilket anger ett RARP-svar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-665">The only difference is the frame type field is 0x8035 and the *Operation Code* field is 4, which designates an RARP reply.</span></span> <span data-ttu-id="d0a19-666">När den har tagits emot är IP-adressen konfigurerad i IP-instansen, den periodiska RARP-begäran är inaktive rad och IP-instansen är nu klar för normal nätverks drift.</span><span class="sxs-lookup"><span data-stu-id="d0a19-666">After received, the IP address is setup in the IP instance, the periodic RARP request is disabled, and the IP instance is now ready for normal network operation.</span></span>

<span data-ttu-id="d0a19-667">För multihome-värdar tillämpas IP-adressen på det begärda nätverks gränssnittet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-667">For multihome hosts, the IP address is applied to the requesting network interface.</span></span> <span data-ttu-id="d0a19-668">Om det fortfarande finns andra nätverks gränssnitt som begär en tilldelning av IP-adresser, fortsätter den periodiska RARP-tjänsten tills alla IP-begäranden för IP-adresser är lösta.</span><span class="sxs-lookup"><span data-stu-id="d0a19-668">If there are other network interfaces still requesting an IP address assignment, the periodic RARP service continues until all interface IP address requests are resolved.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-669">*Programmet ska inte använda IP-instansen förrän RARP-bearbetningen har slutförts. **Nx_ip_status_check** kan användas av program för att vänta på att RARP slutförs. För multihome-system ska programmet inte använda det begärda gränssnittet förrän RARP-bearbetningen har slutförts på det gränssnittet. Status för IP-adressen på den sekundära enheten kan kontrol leras med tjänsten **nx_ip_interface_status_check** .*</span><span class="sxs-lookup"><span data-stu-id="d0a19-669">*The application should not use the IP instance until the RARP processing is complete. The **nx_ip_status_check** may be used by applications to wait for the RARP completion. For multihome systems, the application should not use the requesting interface until the RARP processing is complete on that interface. Status of the IP address on the secondary device can be checked with the **nx_ip_interface_status_check** service.*</span></span>

### <a name="rarp-statistics-and-errors"></a><span data-ttu-id="d0a19-670">RARP statistik och fel</span><span class="sxs-lookup"><span data-stu-id="d0a19-670">RARP Statistics and Errors</span></span>

<span data-ttu-id="d0a19-671">Om den är aktive rad håller NetX RARP-programvaran reda på flera statistik och fel som kan vara användbara för programmet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-671">If enabled, the NetX RARP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="d0a19-672">Följande statistik och fel rapporter underhålls för varje IP-RARP bearbetning:</span><span class="sxs-lookup"><span data-stu-id="d0a19-672">The following statistics and error reports are maintained for each IP's RARP processing:</span></span>

- <span data-ttu-id="d0a19-673">Totalt antal skickade RARP-begäranden</span><span class="sxs-lookup"><span data-stu-id="d0a19-673">Total RARP Requests Sent</span></span>
- <span data-ttu-id="d0a19-674">Totalt antal mottagna RARP-svar</span><span class="sxs-lookup"><span data-stu-id="d0a19-674">Total RARP Responses Received</span></span>
- <span data-ttu-id="d0a19-675">Totalt antal RARP ogiltiga meddelanden</span><span class="sxs-lookup"><span data-stu-id="d0a19-675">Total RARP Invalid Messages</span></span>

<span data-ttu-id="d0a19-676">Alla dessa statistik-och fel rapporter är tillgängliga för programmet med tjänsten ***nx_rarp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-676">All these statistics and error reports are available to the application with the ***nx_rarp_info_get*** service.</span></span>

## <a name="internet-control-message-protocol-icmp"></a><span data-ttu-id="d0a19-677">Internet Control Message Protocol (ICMP)</span><span class="sxs-lookup"><span data-stu-id="d0a19-677">Internet Control Message Protocol (ICMP)</span></span>

<span data-ttu-id="d0a19-678">Internet Control Message Protocol för IP (ICMP) är begränsad till överföring av fel och kontroll av information mellan IP-medlemmar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-678">Internet Control Message Protocol for IP (ICMP) is limited to passing error and control information between IP network members.</span></span>

<span data-ttu-id="d0a19-679">Precis som de flesta andra program skikt (t. ex. TCP/IP-meddelanden) kapslas ICMP-meddelanden av ett IP-huvud med ICMP-protokollets beteckning.</span><span class="sxs-lookup"><span data-stu-id="d0a19-679">Like most other application layer (e.g., TCP/IP) messages, ICMP messages are encapsulated by an IP header with the ICMP protocol designation.</span></span>

### <a name="icmp-statistics-and-errors"></a><span data-ttu-id="d0a19-680">ICMP-statistik och fel</span><span class="sxs-lookup"><span data-stu-id="d0a19-680">ICMP Statistics and Errors</span></span>

<span data-ttu-id="d0a19-681">Om aktive rad håller NetX koll på flera ICMP-statistik och fel som kan vara användbara för programmet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-681">If enabled, NetX keeps track of several ICMP statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="d0a19-682">Följande statistik och fel rapporter hanteras för varje IP-ICMP-bearbetning:</span><span class="sxs-lookup"><span data-stu-id="d0a19-682">The following statistics and error reports are maintained for each IP's ICMP processing:</span></span>

- <span data-ttu-id="d0a19-683">Totalt antal ICMP-pingar som skickats</span><span class="sxs-lookup"><span data-stu-id="d0a19-683">Total ICMP Pings Sent</span></span>
- <span data-ttu-id="d0a19-684">Totalt antal ICMP-Ping-Timeoutar</span><span class="sxs-lookup"><span data-stu-id="d0a19-684">Total ICMP Ping Timeouts</span></span>
- <span data-ttu-id="d0a19-685">Totalt antal inaktiverade ICMP Ping-trådar</span><span class="sxs-lookup"><span data-stu-id="d0a19-685">Total ICMP Ping Threads Suspended</span></span>
- <span data-ttu-id="d0a19-686">Totalt antal mottagna ICMP ping-svar</span><span class="sxs-lookup"><span data-stu-id="d0a19-686">Total ICMP Ping Responses Received</span></span>
- <span data-ttu-id="d0a19-687">Totalt antal fel i ICMP-kontrollsumma</span><span class="sxs-lookup"><span data-stu-id="d0a19-687">Total ICMP Checksum Errors</span></span>
- <span data-ttu-id="d0a19-688">Totalt antal ICMP-ohanterade meddelanden</span><span class="sxs-lookup"><span data-stu-id="d0a19-688">Total ICMP Unhandled Messages</span></span>

<span data-ttu-id="d0a19-689">Alla dessa statistik-och fel rapporter är tillgängliga för programmet med tjänsten ***nx_icmp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-689">All these statistics and error reports are available to the application with the ***nx_icmp_info_get*** service.</span></span>

### <a name="icmp-enable"></a><span data-ttu-id="d0a19-690">ICMP-aktivering</span><span class="sxs-lookup"><span data-stu-id="d0a19-690">ICMP Enable</span></span>
<span data-ttu-id="d0a19-691">Innan ICMP-meddelanden kan bearbetas av NetX måste programmet anropa tjänsten ***nx_icmp_enable*** för att aktivera ICMP-bearbetning.</span><span class="sxs-lookup"><span data-stu-id="d0a19-691">Before ICMP messages can be processed by NetX, the application must call the ***nx_icmp_enable*** service to enable ICMP processing.</span></span> <span data-ttu-id="d0a19-692">När det är färdigt kan programmet utfärda ping-begäranden och fält inkommande ping-paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-692">After this is done, the application can issue ping requests and field incoming ping packets.</span></span>

### <a name="icmp-echo-request"></a><span data-ttu-id="d0a19-693">ICMP-ekobegäran</span><span class="sxs-lookup"><span data-stu-id="d0a19-693">ICMP Echo Request</span></span>
<span data-ttu-id="d0a19-694">En ekobegäran är en typ av ICMP-meddelanden som vanligt vis används för att kontrol lera om det finns en speciell nod i nätverket, som identifieras av dess värd-IP-adress.</span><span class="sxs-lookup"><span data-stu-id="d0a19-694">An echo request is one type of ICMP message that is typically used to check for the existence of a specific node on the network, as identified by its host IP address.</span></span> <span data-ttu-id="d0a19-695">Det populära Ping-kommandot implementeras med ICMP Echo Request/Echo Reply-meddelanden.</span><span class="sxs-lookup"><span data-stu-id="d0a19-695">The popular ping command is implemented using ICMP echo request/echo reply messages.</span></span> <span data-ttu-id="d0a19-696">Om den aktuella värden finns, bearbetar dess nätverks stack ping-begäran och svaren med ett ping-svar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-696">If the specific host is present, its network stack processes the ping request and responses with a ping response.</span></span> <span data-ttu-id="d0a19-697">Bild 7 information om ICMP Ping Message-formatet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-697">Figure 7 details the ICMP ping message format.</span></span>

![ICMP ping-meddelande](./media/user-guide/icmp-ping-message.png)

<span data-ttu-id="d0a19-699">**BILD 7. ICMP ping-meddelande**</span><span class="sxs-lookup"><span data-stu-id="d0a19-699">**FIGURE 7. ICMP Ping Message**</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-700">*Alla ICMP-meddelanden i TCP/IP-implementeringen förväntas vara i big endian format. I det här formatet finns de mest signifikanta byten av ordet på den lägsta byte-adressen.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-700">*All ICMP messages in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

<span data-ttu-id="d0a19-701">I följande tabell beskrivs ICMP-huvudets format:</span><span class="sxs-lookup"><span data-stu-id="d0a19-701">The following table describes the ICMP header format:</span></span>

| <span data-ttu-id="d0a19-702">Rubrik fält</span><span class="sxs-lookup"><span data-stu-id="d0a19-702">Header Field</span></span>    | <span data-ttu-id="d0a19-703">Syfte</span><span class="sxs-lookup"><span data-stu-id="d0a19-703">Purpose</span></span> |
|-----------------|---------------------------------------------------|
| <span data-ttu-id="d0a19-704">Typ</span><span class="sxs-lookup"><span data-stu-id="d0a19-704">Type</span></span>            | <span data-ttu-id="d0a19-705">I det här fältet anges ICMP-meddelandet (bitar 31-24).</span><span class="sxs-lookup"><span data-stu-id="d0a19-705">This field specifies the ICMP message (bits 31- 24).</span></span> <span data-ttu-id="d0a19-706">De vanligaste är: 0 Echo Reply 8 ECHO förfrågan</span><span class="sxs-lookup"><span data-stu-id="d0a19-706">The most common are:   0 Echo Reply   8 Echo Request</span></span> |
| <span data-ttu-id="d0a19-707">Kod</span><span class="sxs-lookup"><span data-stu-id="d0a19-707">Code</span></span>            | <span data-ttu-id="d0a19-708">Det här fältet är Sammanhangs beroende av typ fältet (bitar 23-16).</span><span class="sxs-lookup"><span data-stu-id="d0a19-708">This field is context specific on the type field (bits 23-16).</span></span> <span data-ttu-id="d0a19-709">För en ekobegäran eller svara har koden värdet noll.</span><span class="sxs-lookup"><span data-stu-id="d0a19-709">For an echo request or reply the code is set to zero.</span></span> |
| <span data-ttu-id="d0a19-710">Kontrollsumma</span><span class="sxs-lookup"><span data-stu-id="d0a19-710">Checksum</span></span>        | <span data-ttu-id="d0a19-711">Det här fältet innehåller 16-bitars kontroll summa för den enda komplement summan av ICMP-meddelandet, inklusive hela ICMP-huvudet som börjar med fältet typ.</span><span class="sxs-lookup"><span data-stu-id="d0a19-711">This field contains the 16-bit checksum of the one's complement sum of the ICMP message including the entire the ICMP header starting with the Type field.</span></span> <span data-ttu-id="d0a19-712">Innan du genererar kontroll summan rensas fältet kontroll summa.</span><span class="sxs-lookup"><span data-stu-id="d0a19-712">Before generating the checksum, the checksum field is cleared.</span></span>                 |
| <span data-ttu-id="d0a19-713">Identification</span><span class="sxs-lookup"><span data-stu-id="d0a19-713">Identification</span></span>  | <span data-ttu-id="d0a19-714">Det här fältet innehåller ett ID-värde som identifierar värden. en värd ska använda det ID som extraheras från en EKOBEGÄRAN i eko svaret (bitar 31-16).</span><span class="sxs-lookup"><span data-stu-id="d0a19-714">This field contains an ID value identifying the host; a host should use the ID extracted from an ECHO request in the ECHO REPLY (bits 31-16).</span></span> |
| <span data-ttu-id="d0a19-715">Sekvensnummer</span><span class="sxs-lookup"><span data-stu-id="d0a19-715">Sequence number</span></span> | <span data-ttu-id="d0a19-716">Det här fältet innehåller ett ID-värde; en värd ska använda det ID som extraheras från en EKOBEGÄRAN i eko svaret (bitar 31-16).</span><span class="sxs-lookup"><span data-stu-id="d0a19-716">This field contains an ID value; a host should use the ID extracted from an ECHO request in the ECHO REPLY (bits 31-16).</span></span> <span data-ttu-id="d0a19-717">Till skillnad från fältet identifierare kommer det här värdet att ändras i en efterföljande ekobegäran från samma värd (bitar 15-0).</span><span class="sxs-lookup"><span data-stu-id="d0a19-717">Unlike the identifier field, this value will change in a subsequent Echo request from the same host (bits 15-0).</span></span> |


### <a name="icmp-echo-response"></a><span data-ttu-id="d0a19-718">ICMP Echo svar</span><span class="sxs-lookup"><span data-stu-id="d0a19-718">ICMP Echo Response</span></span>
<span data-ttu-id="d0a19-719">Ett ping-svar är en annan typ av ICMP-meddelanden som genereras internt av ICMP-komponenten som svar på en extern ping-begäran.</span><span class="sxs-lookup"><span data-stu-id="d0a19-719">A ping response is another type of ICMP message that is generated internally by the ICMP component in response to an external ping request.</span></span> <span data-ttu-id="d0a19-720">Utöver bekräftelsen innehåller ping-svaret även en kopia av de användar data som angavs i ping-begäran.</span><span class="sxs-lookup"><span data-stu-id="d0a19-720">In addition to acknowledgement, the ping response also contains a copy of the user data supplied in the ping request.</span></span>

## <a name="internet-group-management-protocol-igmp"></a><span data-ttu-id="d0a19-721">Internet Grupphanteringsprotokoll (IGMP)</span><span class="sxs-lookup"><span data-stu-id="d0a19-721">Internet Group Management Protocol (IGMP)</span></span>

<span data-ttu-id="d0a19-722">IGMP (Internet Group Management Protocol) tillhandahåller en enhet för att kommunicera med sina grannar och dess routrar som den avser att ta emot, eller ansluta till, en IP-multicast-grupp (RFC 1112 och RFC 2236).</span><span class="sxs-lookup"><span data-stu-id="d0a19-722">The Internet Group Management Protocol (IGMP) provides a device to communicate with its neighbors and its routers that it intends to receive, or join, an IP multicast group (RFC 1112 and RFC 2236).</span></span> <span data-ttu-id="d0a19-723">En multicast-grupp är i princip en dynamisk uppsättning nätverks medlemmar och representeras av en klass D IP-adress.</span><span class="sxs-lookup"><span data-stu-id="d0a19-723">A multicast group is basically a dynamic collection of network members and is represented by a Class D IP address.</span></span> <span data-ttu-id="d0a19-724">Medlemmar i multicast-gruppen kan lämna när som helst och nya medlemmar kan gå med i taget.</span><span class="sxs-lookup"><span data-stu-id="d0a19-724">Members of the multicast group may leave at any time, and new members may join at any time.</span></span> <span data-ttu-id="d0a19-725">Den samordning som används för att ansluta till och lämna gruppen är ansvaret för IGMP.</span><span class="sxs-lookup"><span data-stu-id="d0a19-725">The coordination involved in joining and leaving the group is the responsibility of IGMP.</span></span>

### <a name="igmp-enable"></a><span data-ttu-id="d0a19-726">Aktivera IGMP</span><span class="sxs-lookup"><span data-stu-id="d0a19-726">IGMP Enable</span></span>

<span data-ttu-id="d0a19-727">Innan en multicasting-aktivitet kan ske i NetX måste programmet anropa tjänsten ***nx_igmp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-727">Before any multicasting activity can take place in NetX, the application must call the ***nx_igmp_enable*** service.</span></span> <span data-ttu-id="d0a19-728">Den här tjänsten utför grundläggande IGMP-initiering som förberedelse för multicast-begäranden.</span><span class="sxs-lookup"><span data-stu-id="d0a19-728">This service performs basic IGMP initialization in preparation for multicast requests.</span></span>

### <a name="multicast-ip-addressing"></a><span data-ttu-id="d0a19-729">Multicast-IP-adressering</span><span class="sxs-lookup"><span data-stu-id="d0a19-729">Multicast IP Addressing</span></span>

<span data-ttu-id="d0a19-730">Som tidigare nämnts är multicast-adresser faktiskt klass D IP-adresser som visas i bild 4 på sidan 58.</span><span class="sxs-lookup"><span data-stu-id="d0a19-730">As mentioned previously, multicast addresses are actually Class D IP addresses as shown in Figure 4 on page 58.</span></span> <span data-ttu-id="d0a19-731">De nedre 28 bitarna i klass D-adressen motsvarar multicast-gruppens ID.</span><span class="sxs-lookup"><span data-stu-id="d0a19-731">The lower 28-bits of the Class D address correspond to the multicast group ID.</span></span> <span data-ttu-id="d0a19-732">Det finns en serie fördefinierade multicast-adresser.</span><span class="sxs-lookup"><span data-stu-id="d0a19-732">There are a series of pre-defined multicast addresses.</span></span> <span data-ttu-id="d0a19-733">Men *alla värd adresser* (244.0.0.1) är särskilt viktiga för IGMP-bearbetning.</span><span class="sxs-lookup"><span data-stu-id="d0a19-733">However, the *all hosts address* (244.0.0.1) is particularly important to IGMP processing.</span></span> <span data-ttu-id="d0a19-734">*Adressen alla värdar* används av routrar för att fråga alla multicast-medlemmar att rapportera om vilka multicast-grupper de tillhör.</span><span class="sxs-lookup"><span data-stu-id="d0a19-734">The *all hosts address* is used by routers to query all multicast members to report on which multicast groups they belong to.</span></span>

### <a name="physical-address-mapping-in-ip"></a><span data-ttu-id="d0a19-735">Fysisk adress mappning i IP</span><span class="sxs-lookup"><span data-stu-id="d0a19-735">Physical Address Mapping in IP</span></span>

<span data-ttu-id="d0a19-736">Klass D multicast-adresser mappas direkt till fysiska Ethernet-adresser som sträcker sig från 01.00.5 e. 00.00.00 till 01.00.5 e. 7f. AA. AA.</span><span class="sxs-lookup"><span data-stu-id="d0a19-736">Class D multicast addresses map directly to physical Ethernet addresses ranging from 01.00.5e.00.00.00 through 01.00.5e.7f.ff.ff.</span></span> <span data-ttu-id="d0a19-737">De lägre 23 bitarna av IP-multicast-adress kartan direkt till de lägre 23 bitarna av Ethernet-adressen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-737">The lower 23 bits of the IP multicast address map directly to the lower 23 bits of the Ethernet address.</span></span>

### <a name="multicast-group-join"></a><span data-ttu-id="d0a19-738">Anslutning till multicast-grupp</span><span class="sxs-lookup"><span data-stu-id="d0a19-738">Multicast Group Join</span></span>

<span data-ttu-id="d0a19-739">Program som behöver ansluta till en viss multicast-grupp kan göra detta genom att anropa tjänsten ***nx_igmp_multicast_join*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-739">Applications that need to join a particular multicast group may do so by calling the ***nx_igmp_multicast_join*** service.</span></span> <span data-ttu-id="d0a19-740">Den här tjänsten håller reda på antalet begär Anden att ansluta till den här multicast-gruppen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-740">This service keeps track of the number of requests to join this multicast group.</span></span> <span data-ttu-id="d0a19-741">Om det här är den första program förfrågan för att ansluta till multicast-gruppen skickas en IGMP-rapport ut från det primära nätverket som anger att den här värdens avsikt att ansluta till gruppen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-741">If this is the first application request to join the multicast group, an IGMP report is sent out on the primary network indicating this host's intention to join the group.</span></span> <span data-ttu-id="d0a19-742">Därefter anropas nätverks driv rutinen för att ställa in för att lyssna efter paket med Ethernet-adressen för den här multicast-gruppen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-742">Next, the network driver is called to set up for listening for packets with the Ethernet address for this multicast group.</span></span>

<span data-ttu-id="d0a19-743">Om multicast-gruppen är tillgänglig via ett visst gränssnitt i ett multihome-system använder programmet tjänsten ***nx_igmp_multicast_interface_join*** i stället för \***nx_igmp_multicast_join**, \* som är begränsat till multicast-grupper i det primära nätverket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-743">In a multihome system, if the multicast group is accessible via a specific interface, application shall use the service ***nx_igmp_multicast_interface_join*** instead of \***nx_igmp_multicast_join**,\* which is limited to multicast groups on the primary network.</span></span>

### <a name="multicast-group-leave"></a><span data-ttu-id="d0a19-744">Lämna multicast-grupp</span><span class="sxs-lookup"><span data-stu-id="d0a19-744">Multicast Group Leave</span></span>

<span data-ttu-id="d0a19-745">Program som måste lämna en tidigare ansluten multicast-grupp kan göra det genom att anropa tjänsten ***nx_igmp_multicast_leave*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-745">Applications that need to leave a previously joined multicast group may do so by calling the ***nx_igmp_multicast_leave*** service.</span></span> <span data-ttu-id="d0a19-746">Den här tjänsten minskar det interna antalet som är associerat med hur många gånger gruppen anslöts.</span><span class="sxs-lookup"><span data-stu-id="d0a19-746">This service reduces the internal count associated with how many times the group was joined.</span></span> <span data-ttu-id="d0a19-747">Om det inte finns några utestående kopplings begär Anden för en grupp, anropas nätverks driv rutinen för att inaktivera lyssning av paket med multicast-gruppens Ethernet-adress</span><span class="sxs-lookup"><span data-stu-id="d0a19-747">If there are no outstanding join requests for a group, the network driver is called to disable listening for packets with this multicast group's Ethernet address</span></span>

### <a name="multicast-loopback"></a><span data-ttu-id="d0a19-748">Multicast-loopback</span><span class="sxs-lookup"><span data-stu-id="d0a19-748">Multicast Loopback</span></span>

<span data-ttu-id="d0a19-749">Ett program kan vilja ta emot multicast-trafik som härstammar från en av källorna på samma nod.</span><span class="sxs-lookup"><span data-stu-id="d0a19-749">An application may wish to receive multicast traffic originated from one of the sources on the same node.</span></span> <span data-ttu-id="d0a19-750">För detta krävs att loopback aktive ras av IP-multicast-komponenten med hjälp av tjänsten ***nx_igmp_loopback_enable***.</span><span class="sxs-lookup"><span data-stu-id="d0a19-750">This requires the IP multicast component to have loopback enabled by using the service ***nx_igmp_loopback_enable***.</span></span>

### <a name="igmp-report-message"></a><span data-ttu-id="d0a19-751">IGMP-rapport meddelande</span><span class="sxs-lookup"><span data-stu-id="d0a19-751">IGMP Report Message</span></span>

<span data-ttu-id="d0a19-752">När programmet ansluter till en multicast-grupp skickas ett IGMP-rapport meddelande via nätverket för att indikera värddatorns avsikt att ansluta till en viss multicast-grupp.</span><span class="sxs-lookup"><span data-stu-id="d0a19-752">When the application joins a multicast group, an IGMP report message is sent via the network to indicate the host's intention to join a particular multicast group.</span></span> <span data-ttu-id="d0a19-753">Formatet på IGMP-rapportens meddelande visas i bild 8.</span><span class="sxs-lookup"><span data-stu-id="d0a19-753">The format of the IGMP report message is shown in Figure 8.</span></span> <span data-ttu-id="d0a19-754">Multicast-gruppadressen används för både grupp meddelandet i IGMP-rapport meddelandet och mål-IP-adressen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-754">The multicast group address is used for both the group message in the IGMP report message and the destination IP address.</span></span>

![IGMP-rapport meddelande](./media/user-guide/igmp-report-message.png)

<span data-ttu-id="d0a19-756">**FIGUR 8. IGMP-rapport meddelande**</span><span class="sxs-lookup"><span data-stu-id="d0a19-756">**FIGURE 8. IGMP Report Message**</span></span>

<span data-ttu-id="d0a19-757">I bilden ovan (bild 8) innehåller IGMP-huvudet ett fält av version/typ, maximal svars tid, ett fält för kontroll summa och ett adress fält för multicast-gruppen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-757">In the figure above (Figure 8), the IGMP header contains a version/type field, maximum response time, a checksum field, and a multicast group address field.</span></span> <span data-ttu-id="d0a19-758">För IGMPv1-meddelanden är fältet maximal svars tid alltid inställt på noll, eftersom detta inte är en del av IGMPv1-protokollet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-758">For IGMPv1 messages, the Maximum Response Time field is always set to zero, as this is not part of the IGMPv1 protocol.</span></span> <span data-ttu-id="d0a19-759">Fältet Max svars tid anges när värden får ett IGMP-meddelande av typen fråga och rensas när en värd får ett annat värde för rapport typ meddelandet som definieras av IGMPv2-protokollet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-759">The Maximum Response Time field is set when the host receives a Query type IGMP message and cleared when a host receives another host's Report type message as defined by the IGMPv2 protocol.</span></span>

<span data-ttu-id="d0a19-760">I följande avsnitt beskrivs IGMP-huvud formatet:</span><span class="sxs-lookup"><span data-stu-id="d0a19-760">The following describes the IGMP header format:</span></span>

| <span data-ttu-id="d0a19-761">**Rubrik fält**</span><span class="sxs-lookup"><span data-stu-id="d0a19-761">**Header Field**</span></span>          | <span data-ttu-id="d0a19-762">**Syfte**</span><span class="sxs-lookup"><span data-stu-id="d0a19-762">**Purpose**</span></span> |
|-----------------------|--------------------------------------------------------------------|
| <span data-ttu-id="d0a19-763">Version</span><span class="sxs-lookup"><span data-stu-id="d0a19-763">Version</span></span>               | <span data-ttu-id="d0a19-764">Det här fältet anger IGMP-versionen (bitar 31-28).</span><span class="sxs-lookup"><span data-stu-id="d0a19-764">This field specifies the IGMP version (bits 31- 28).</span></span>                                                                               |
| <span data-ttu-id="d0a19-765">Typ</span><span class="sxs-lookup"><span data-stu-id="d0a19-765">Type</span></span>                  | <span data-ttu-id="d0a19-766">Det här fältet anger typen av IGMP-meddelande (bitar 27 -24).</span><span class="sxs-lookup"><span data-stu-id="d0a19-766">This field specifies the type of IGMP message (bits 27 -24).</span></span>                                                                       |
| <span data-ttu-id="d0a19-767">Maximal svars tid</span><span class="sxs-lookup"><span data-stu-id="d0a19-767">Maximum Response Time</span></span> | <span data-ttu-id="d0a19-768">Används inte i IGMPv1.</span><span class="sxs-lookup"><span data-stu-id="d0a19-768">Not used in IGMPv1.</span></span> <span data-ttu-id="d0a19-769">I IGMPv2 används det här fältet som maximal svars tid.</span><span class="sxs-lookup"><span data-stu-id="d0a19-769">In IGMPv2 this field serves as the maximum response time.</span></span>                                                      |
| <span data-ttu-id="d0a19-770">Kontrollsumma</span><span class="sxs-lookup"><span data-stu-id="d0a19-770">Checksum</span></span>              | <span data-ttu-id="d0a19-771">Det här fältet innehåller 16-bitars kontroll summa för den enda komplement summan av IGMP-meddelandet som börjar med IGMP-versionen (bitar 0-15)</span><span class="sxs-lookup"><span data-stu-id="d0a19-771">This field contains the 16-bit checksum of the one's complement sum of the IGMP message starting with the IGMP version (bits 0-15)</span></span> |
| <span data-ttu-id="d0a19-772">Grupp adress</span><span class="sxs-lookup"><span data-stu-id="d0a19-772">Group Address</span></span>         | <span data-ttu-id="d0a19-773">32-bitars klass D grupp IP-adress</span><span class="sxs-lookup"><span data-stu-id="d0a19-773">32-bit class D group IP address</span></span> |


<span data-ttu-id="d0a19-774">IGMP-rapport meddelanden skickas också som svar på IGMP-frågemeddelanden som skickas av en multicast-router.</span><span class="sxs-lookup"><span data-stu-id="d0a19-774">IGMP report messages are also sent in response to IGMP query messages sent by a multicast router.</span></span> <span data-ttu-id="d0a19-775">Multicast-routrar skickar regelbundet frågemeddelanden ut för att se vilka värdar som fortfarande kräver grupp medlemskap.</span><span class="sxs-lookup"><span data-stu-id="d0a19-775">Multicast routers periodically send query messages out to see which hosts still require group membership.</span></span> <span data-ttu-id="d0a19-776">Fråga meddelanden har samma format som IGMP-rapport meddelandet som visas i bild 8.</span><span class="sxs-lookup"><span data-stu-id="d0a19-776">Query messages have the same format as the IGMP Report message shown in Figure 8.</span></span> <span data-ttu-id="d0a19-777">De enda skillnaderna är att IGMP-typen är lika med 1 och att grupp adress fältet är inställt på 0.</span><span class="sxs-lookup"><span data-stu-id="d0a19-777">The only differences are the IGMP type is equal to 1 and the group address field is set to 0.</span></span> <span data-ttu-id="d0a19-778">IGMP-frågemeddelanden skickas till IP-adressen *alla värdar* av multicast-routern.</span><span class="sxs-lookup"><span data-stu-id="d0a19-778">IGMP Query messages are sent to the *all hosts* IP address by the multicast router.</span></span> <span data-ttu-id="d0a19-779">En värd som fortfarande vill behålla grupp medlemskapet svarar genom att skicka ett annat IGMP-rapport meddelande.</span><span class="sxs-lookup"><span data-stu-id="d0a19-779">A host that still wishes to maintain group membership responds by sending another IGMP Report message.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-780">*Alla meddelanden i TCP/IP-implementeringen förväntas vara i **big endian** format. I det här formatet finns de mest signifikanta byten av ordet på den lägsta byte-adressen.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-780">*All messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="igmp-statistics-and-errors"></a><span data-ttu-id="d0a19-781">IGMP-statistik och fel</span><span class="sxs-lookup"><span data-stu-id="d0a19-781">IGMP Statistics and Errors</span></span>

<span data-ttu-id="d0a19-782">Om den är aktive rad håller NetX IGMP-programvaran reda på flera statistik och fel som kan vara användbara för programmet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-782">If enabled, the NetX IGMP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="d0a19-783">Följande statistik och fel rapporter underhålls för varje IP-IGMP-bearbetning:</span><span class="sxs-lookup"><span data-stu-id="d0a19-783">The following statistics and error reports are maintained for each IP's IGMP processing:</span></span>

- <span data-ttu-id="d0a19-784">Totalt antal skickade IGMP-rapporter</span><span class="sxs-lookup"><span data-stu-id="d0a19-784">Total IGMP Reports Sent</span></span>
- <span data-ttu-id="d0a19-785">Totalt antal mottagna IGMP-frågor</span><span class="sxs-lookup"><span data-stu-id="d0a19-785">Total IGMP Queries Received</span></span>
- <span data-ttu-id="d0a19-786">Totalt antal fel i IGMP-kontrollsumma</span><span class="sxs-lookup"><span data-stu-id="d0a19-786">Total IGMP Checksum Errors</span></span>
- <span data-ttu-id="d0a19-787">Totalt antal IGMP-aktuella grupper anslutna</span><span class="sxs-lookup"><span data-stu-id="d0a19-787">Total IGMP Current Groups Joined</span></span>

<span data-ttu-id="d0a19-788">Alla dessa statistik-och fel rapporter är tillgängliga för programmet med tjänsten ***nx_igmp_info_get*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-788">All these statistics and error reports are available to the application with the ***nx_igmp_info_get*** service.</span></span>

## <a name="user-datagram-protocol-udp"></a><span data-ttu-id="d0a19-789">UDP (User Datagram Protocol)</span><span class="sxs-lookup"><span data-stu-id="d0a19-789">User Datagram Protocol (UDP)</span></span>

<span data-ttu-id="d0a19-790">UDP (User Datagram Protocol) ger den enklaste formen av data överföring mellan nätverks medlemmar (RFC 768).</span><span class="sxs-lookup"><span data-stu-id="d0a19-790">The User Datagram Protocol (UDP) provides the simplest form of data transfer between network members (RFC 768).</span></span> <span data-ttu-id="d0a19-791">UDP-datapaket skickas från en nätverks medlem till en annan på bästa möjliga sätt. Det finns alltså ingen inbyggd mekanism för bekräftelse av paket mottagaren.</span><span class="sxs-lookup"><span data-stu-id="d0a19-791">UDP data packets are sent from one network member to another in a best effort fashion; i.e., there is no built-in mechanism for acknowledgement by the packet recipient.</span></span> <span data-ttu-id="d0a19-792">Att skicka ett UDP-paket kräver dessutom inte att någon anslutning upprättas i förväg.</span><span class="sxs-lookup"><span data-stu-id="d0a19-792">In addition, sending a UDP packet does not require any connection to be established in advance.</span></span> <span data-ttu-id="d0a19-793">Därför är det mycket effektivt att överföra UDP-paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-793">Because of this, UDP packet transmission is very efficient.</span></span>

### <a name="udp-header"></a><span data-ttu-id="d0a19-794">UDP-huvud</span><span class="sxs-lookup"><span data-stu-id="d0a19-794">UDP Header</span></span>
<span data-ttu-id="d0a19-795">UDP placerar ett enkelt paket huvud framför programmets data vid överföring och tar bort ett liknande UDP-huvud från paketet vid mottagning innan ett mottaget UDP-paket levereras till programmet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-795">UDP places a simple packet header in front of the application's data on transmission, and removes a similar UDP header from the packet on reception before delivering a received UDP packet to the application.</span></span> <span data-ttu-id="d0a19-796">UDP använder IP-protokollet för att skicka och ta emot paket, vilket innebär att det finns ett IP-huvud framför UDP-huvudet när paketet är i nätverket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-796">UDP utilizes the IP protocol for sending and receiving packets, which means there is an IP header in front of the UDP header when the packet is on the network.</span></span> <span data-ttu-id="d0a19-797">Bild 9 visar UDP-huvudets format.</span><span class="sxs-lookup"><span data-stu-id="d0a19-797">Figure 9 shows the format of the UDP header.</span></span>

![UDP-huvud](./media/user-guide/udp-header.png)

<span data-ttu-id="d0a19-799">**BILD 9. UDP-huvud**</span><span class="sxs-lookup"><span data-stu-id="d0a19-799">**FIGURE 9. UDP Header**</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-800">*Alla rubriker i UDP/IP-implementeringen förväntas vara i big endian format. I det här formatet finns de mest signifikanta byten av ordet på den lägsta byte-adressen.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-800">*All headers in the UDP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

<span data-ttu-id="d0a19-801">I följande avsnitt beskrivs UDP-huvudets format:</span><span class="sxs-lookup"><span data-stu-id="d0a19-801">The following describes the UDP header format:</span></span>

| <span data-ttu-id="d0a19-802">Rubrik fält</span><span class="sxs-lookup"><span data-stu-id="d0a19-802">Header Field</span></span>                   | <span data-ttu-id="d0a19-803">Syfte</span><span class="sxs-lookup"><span data-stu-id="d0a19-803">Purpose</span></span> |
|--------------------------------|---------------------------------------------|
| <span data-ttu-id="d0a19-804">16-bitars käll port nummer</span><span class="sxs-lookup"><span data-stu-id="d0a19-804">16-bit source port number</span></span>      | <span data-ttu-id="d0a19-805">Det här fältet innehåller porten som UDP-paketet skickas från.</span><span class="sxs-lookup"><span data-stu-id="d0a19-805">This field contains the port on which the UDP packet is being sent from.</span></span> <span data-ttu-id="d0a19-806">Giltiga UDP-portar sträcker sig från 1 till 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="d0a19-806">Valid UDP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="d0a19-807">16-bitars mål port nummer</span><span class="sxs-lookup"><span data-stu-id="d0a19-807">16-bit destination port number</span></span> | <span data-ttu-id="d0a19-808">Det här fältet innehåller den UDP-port som paketet skickas till.</span><span class="sxs-lookup"><span data-stu-id="d0a19-808">This field contains the UDP port to which the packet is being sent to.</span></span> <span data-ttu-id="d0a19-809">Giltiga UDP-portar sträcker sig från 1 till 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="d0a19-809">Valid UDP ports range from 1 through 0xFFFF.</span></span>   |
| <span data-ttu-id="d0a19-810">16-bitars UDP-längd</span><span class="sxs-lookup"><span data-stu-id="d0a19-810">16-bit UDP length</span></span>   | <span data-ttu-id="d0a19-811">Det här fältet innehåller antalet byte i UDP-paketet, inklusive storleken på UDP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-811">This field contains the number of bytes in the UDP packet, including the size of the UDP header.</span></span>                                  |
| <span data-ttu-id="d0a19-812">16-bitars UDP-kontrollsumma</span><span class="sxs-lookup"><span data-stu-id="d0a19-812">16-bit UDP checksum</span></span> | <span data-ttu-id="d0a19-813">Det här fältet innehåller 16-bitars kontroll summa för paketet, inklusive UDP-huvudet, paket data området och pseudo-IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-813">This field contains the 16-bit checksum for the packet, including the UDP header, the packet data area, and the pseudo IP header.</span></span> |

### <a name="udp-enable"></a><span data-ttu-id="d0a19-814">Aktivera UDP</span><span class="sxs-lookup"><span data-stu-id="d0a19-814">UDP Enable</span></span>

<span data-ttu-id="d0a19-815">Innan överföring av UDP-paket är möjligt måste programmet först aktivera UDP genom att anropa tjänsten ***nx_udp_enable*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-815">Before UDP packet transmission is possible, the application must first enable UDP by calling the ***nx_udp_enable*** service.</span></span> <span data-ttu-id="d0a19-816">När det har Aktiver ATS är programmet fritt att skicka och ta emot UDP-paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-816">After enabled, the application is free to send and receive UDP packets.</span></span>

### <a name="udp-socket-create"></a><span data-ttu-id="d0a19-817">Skapa UDP-socket</span><span class="sxs-lookup"><span data-stu-id="d0a19-817">UDP Socket Create</span></span>

<span data-ttu-id="d0a19-818">UDP-Sockets skapas antingen under initieringen eller under körningen av program trådar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-818">UDP sockets are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="d0a19-819">Den första typen av tjänst, Time to Live och Receive Queue djup definieras av tjänsten ***nx_udp_socket_create*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-819">The initial type of service, time to live, and receive queue depth are defined by the ***nx_udp_socket_create*** service.</span></span> <span data-ttu-id="d0a19-820">Det finns ingen gräns för antalet UDP-socketar i ett program.</span><span class="sxs-lookup"><span data-stu-id="d0a19-820">There are no limits on the number of UDP sockets in an application.</span></span>

### <a name="udp-checksum"></a><span data-ttu-id="d0a19-821">UDP-kontrollsumma</span><span class="sxs-lookup"><span data-stu-id="d0a19-821">UDP Checksum</span></span>

<span data-ttu-id="d0a19-822">UDP anger en komplett 16-bitars kontroll summa som täcker IP-pseudo-huvudet (som består av käll-IP-adressen, målets IP-adress och protokoll/längd-IP-adress), UDP-huvudet och UDP-paketets data.</span><span class="sxs-lookup"><span data-stu-id="d0a19-822">UDP specifies a one's complement 16-bit checksum that covers the IP pseudo header (consisting of the source IP address, destination IP address, and the protocol/length IP word), the UDP header, and the UDP packet data.</span></span> <span data-ttu-id="d0a19-823">Om den beräknade UDP-kontrollsumman är 0 lagras den som alla (0xFFFF).</span><span class="sxs-lookup"><span data-stu-id="d0a19-823">If the calculated UDP checksum is 0, it is stored as all ones (0xFFFF).</span></span> <span data-ttu-id="d0a19-824">Om inaktive ring av UDP-kontrollsumma är inaktive rad placeras noll i fältet UDP-kontrollsumma för att indikera att kontroll summan inte har beräknats.</span><span class="sxs-lookup"><span data-stu-id="d0a19-824">If the sending socket has the UDP checksum logic disabled, a zero is placed in the UDP checksum field to indicate the checksum was not calculated.</span></span> <span data-ttu-id="d0a19-825">Om UDP-kontrollsumma inte matchar den beräknade kontroll summan av mottagaren, ignoreras UDP-paketet helt enkelt.</span><span class="sxs-lookup"><span data-stu-id="d0a19-825">If the UDP checksum does not match the computed checksum by the receiver, the UDP packet is simply discarded.</span></span>

<span data-ttu-id="d0a19-826">I IP-nätverket är UDP-kontrollsumma valfri.</span><span class="sxs-lookup"><span data-stu-id="d0a19-826">On the IP network, UDP checksum is optional.</span></span> <span data-ttu-id="d0a19-827">NetX gör det möjligt för ett program att aktivera eller inaktivera beräkning av UDP-kontrollsumma per socket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-827">NetX allows an application to enable or disable UDP checksum calculation on a per-socket basis.</span></span> <span data-ttu-id="d0a19-828">Som standard är logiken för kontroll summa för UDP aktiverat.</span><span class="sxs-lookup"><span data-stu-id="d0a19-828">By default, the UDP socket checksum logic is enabled.</span></span> <span data-ttu-id="d0a19-829">Programmet kan inaktivera logik för kontroll summa för en viss UDP-socket genom att anropa tjänsten ***nx_udp_socket_checksum_disable*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-829">The application can disable checksum logic for a particular UDP socket by calling the ***nx_udp_socket_checksum_disable*** service.</span></span>

<span data-ttu-id="d0a19-830">Vissa Ethernet-styrenheter kan generera UDP-kontrollsumma i farten.</span><span class="sxs-lookup"><span data-stu-id="d0a19-830">Certain Ethernet controllers are able to generate the UDP checksum on the fly.</span></span> <span data-ttu-id="d0a19-831">Om systemet kan använda beräknings funktionen för maskin varu kontroll summa kan NetX-biblioteket skapas utan logik för kontroll summa.</span><span class="sxs-lookup"><span data-stu-id="d0a19-831">If the system is able to use hardware checksum computation feature, the NetX library can be built without the checksum logic.</span></span> <span data-ttu-id="d0a19-832">Om du vill inaktivera kontroll summa för UDP-programvara måste NetX-biblioteket skapas med följande symboler: ***NX_DISABLE_UDP_TX_CHECKSUM*** och \***NX_DISABLE_UDP_RX_CHECKSUM **_ (beskrivs i [kapitel 2](chapter2.md)). Konfigurations alternativen tar bort den logiska kontroll summan för UDP från NetX helt, samtidigt som anropet _* nx_udp_socket_checksum_disable*** -tjänsten gör det möjligt för programmet att inaktivera bearbetning av IP UDP-kontrollsumma per socket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-832">To disable UDP software checksum, the NetX library must be built with the following symbols defined: ***NX_DISABLE_UDP_TX_CHECKSUM*** and ***NX_DISABLE_UDP_RX_CHECKSUM\*\*_ (described in [Chapter 2](chapter2.md)). The configuration options remove UDP checksum logic from NetX entirely, while calling the _* nx_udp_socket_checksum_disable**\* service allows the application to disable IP UDP checksum processing on a per socket basis.</span></span>

### <a name="udp-ports-and-binding"></a><span data-ttu-id="d0a19-833">UDP-portar och bindning</span><span class="sxs-lookup"><span data-stu-id="d0a19-833">UDP Ports and Binding</span></span>

<span data-ttu-id="d0a19-834">En UDP-port är en logisk slut punkt i UDP-protokollet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-834">A UDP port is a logical end point in the UDP protocol.</span></span> <span data-ttu-id="d0a19-835">Det finns 65 535 giltiga portar i UDP-komponenten NetX, från 1 till 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="d0a19-835">There are 65,535 valid ports in the UDP component of NetX, ranging from 1 through 0xFFFF.</span></span> <span data-ttu-id="d0a19-836">Om du vill skicka eller ta emot UDP-data måste programmet först skapa en UDP-socket och sedan binda den till en önskad port.</span><span class="sxs-lookup"><span data-stu-id="d0a19-836">To send or receive UDP data, the application must first create a UDP socket, then bind it to a desired port.</span></span> <span data-ttu-id="d0a19-837">När du har bundit en UDP-socket till en port kan programmet skicka och ta emot data på denna socket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-837">After binding a UDP socket to a port, the application may send and receive data on that socket.</span></span>

### <a name="udp-fast-pathtrade"></a><span data-ttu-id="d0a19-838">Snabb sökväg för UDP&trade;</span><span class="sxs-lookup"><span data-stu-id="d0a19-838">UDP Fast Path&trade;</span></span>

<span data-ttu-id="d0a19-839">Snabb sökvägen för UDP &trade; är namnet på en låg paket väg genom netx UDP-implementering.</span><span class="sxs-lookup"><span data-stu-id="d0a19-839">The UDP Fast Path&trade; is the name for a low packet overhead path through the NetX UDP implementation.</span></span> <span data-ttu-id="d0a19-840">Att skicka ett UDP-paket kräver bara några funktions anrop: ***nx_udp_socket_send** _, _*_nx_ip_packet_send_\*_ och det eventuella anropet till nätverks driv rutinen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-840">Sending a UDP packet requires just a few function calls: ***nx_udp_socket_send** _, _*_nx_ip_packet_send_\*_, and the eventual call to the network driver.</span></span> <span data-ttu-id="d0a19-841">_*_nx_udp_socket_send_*_ är tillgängligt i netx för befintliga netx-program och gäller endast för IP-paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-841">_*_nx_udp_socket_send_*_ is available in NetX for existing NetX applications and is only applicable for IP packets.</span></span> <span data-ttu-id="d0a19-842">Den bästa metoden är dock att använda _ *_nx_udp_socket_send_*\* tjänsten som diskuteras nedan.</span><span class="sxs-lookup"><span data-stu-id="d0a19-842">The preferred method, however, is to use _ *_nx_udp_socket_send_*\* service discussed below.</span></span> <span data-ttu-id="d0a19-843">Vid mottagning av UDP-paket placeras UDP-paketet antingen på lämplig UDP socket Receive-kö eller levereras till en inaktive rad program tråd i ett enda funktions anrop från nätverks driv Rutinens mottagnings bearbetning.</span><span class="sxs-lookup"><span data-stu-id="d0a19-843">On UDP packet reception, the UDP packet is either placed on the appropriate UDP socket receive queue or delivered to a suspended application thread in a single function call from the network driver's receive interrupt processing.</span></span> <span data-ttu-id="d0a19-844">Den här mycket optimerade logiken för att skicka och ta emot UDP-paket är grunden för en snabb väg teknik för UDP.</span><span class="sxs-lookup"><span data-stu-id="d0a19-844">This highly optimized logic for sending and receiving UDP packets is the essence of UDP Fast Path technology.</span></span>

### <a name="udp-packet-send"></a><span data-ttu-id="d0a19-845">Skicka UDP-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-845">UDP Packet Send</span></span>

<span data-ttu-id="d0a19-846">Att skicka UDP-data via IP-nätverk kan enkelt utföras genom att anropa funktionen \***nx_udp_socket_send** _.</span><span class="sxs-lookup"><span data-stu-id="d0a19-846">Sending UDP data over IP networks is easily accomplished by calling the \***nx_udp_socket_send** _ function.</span></span> <span data-ttu-id="d0a19-847">Anroparen måste ange IP-versionen i fältet _IP-adress \*.</span><span class="sxs-lookup"><span data-stu-id="d0a19-847">The caller must set the IP version in the _IP address\* field.</span></span> <span data-ttu-id="d0a19-848">NetX kommer att avgöra den bästa käll adressen för överförda UDP-paket baserat på mål-IP-adressen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-848">NetX will determine the best source address for transmitted UDP packets based on the destination IP address.</span></span> <span data-ttu-id="d0a19-849">Den här tjänsten placerar ett UDP-huvud framför paket data och skickar det till nätverket med en intern IP-sändnings rutin.</span><span class="sxs-lookup"><span data-stu-id="d0a19-849">This service places a UDP header in front of the packet data and sends it out onto the network using an internal IP send routine.</span></span> <span data-ttu-id="d0a19-850">Det finns ingen tråd Inskjutning vid sändning av UDP-paket eftersom alla UDP-paketfiltrering bearbetas omedelbart.</span><span class="sxs-lookup"><span data-stu-id="d0a19-850">There is no thread suspension on sending UDP packets because all UDP packet transmissions are processed immediately.</span></span>

<span data-ttu-id="d0a19-851">För multicast-eller broadcast-mål ska programmet ange vilken käll-IP-adress som ska användas om NetX-enheten har flera IP-adresser att välja mellan.</span><span class="sxs-lookup"><span data-stu-id="d0a19-851">For multicast or broadcast destinations, the application should specify the source IP address to use if the NetX device has multiple IP addresses to choose from.</span></span> <span data-ttu-id="d0a19-852">Detta kan göras med tjänsterna ***nx_udp_socket_interface_send.***</span><span class="sxs-lookup"><span data-stu-id="d0a19-852">This can be done with the services ***nx_udp_socket_interface_send.***</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-853">*Om **nx_udp_socket_send** används för att överföra multicast-eller broadcast-paket används IP-adressen för det första gränssnittet som käll adress.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-853">*If **nx_udp_socket_send** is used for transmitting multicast or broadcast packets, the IP address of the first interface is used as source address.*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-854">*Om logics kontroll summa för UDP är aktive rad för denna socket utförs åtgärden för kontroll summa i kontexten för den anropande tråden, utan att blockera åtkomst till UDP-eller IP-datastrukturerna.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-854">*If UDP checksum logic is enabled for this socket, the checksum operation is performed in the context of the calling thread, without blocking access to the UDP or IP data structures.*</span></span>

> [!NOTE]
> <span data-ttu-id="d0a19-855">*De UDP-nyttolaster som finns i **NX_PACKETs** strukturen bör finnas på ett långt ord. Programmet måste lämna tillräckligt med utrymme mellan lägga-pekaren och data start pekaren för att NetX ska kunna placera både UDP-, IP-och fysiska medie huvudena.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-855">*The UDP payload data residing in the **NX_PACKET** structure should reside on a long-word boundary. The application needs to leave sufficient space between the prepend pointer and the data start pointer for NetX to place the UDP, IP, and physical media headers.*</span></span>

### <a name="udp-packet-receive"></a><span data-ttu-id="d0a19-856">Mottagning av UDP-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-856">UDP Packet Receive</span></span>

<span data-ttu-id="d0a19-857">Program trådar kan ta emot UDP-paket från en viss socket genom att anropa ***nx_udp_socket_receive***.</span><span class="sxs-lookup"><span data-stu-id="d0a19-857">Application threads may receive UDP packets from a particular socket by calling ***nx_udp_socket_receive***.</span></span> <span data-ttu-id="d0a19-858">Funktionen Receive Receive levererar det äldsta paketet i socketens mottagnings kön.</span><span class="sxs-lookup"><span data-stu-id="d0a19-858">The socket receive function delivers the oldest packet on the socket's receive queue.</span></span> <span data-ttu-id="d0a19-859">Om det inte finns några paket i mottagnings kön kan den anropande tråden skjuta upp (med en valfri tids gräns) tills ett paket tas emot.</span><span class="sxs-lookup"><span data-stu-id="d0a19-859">If there are no packets on the receive queue, the calling thread can suspend (with an optional timeout) until a packet arrives.</span></span>

<span data-ttu-id="d0a19-860">Bearbetningen av UDP Receive-paket (som vanligt vis anropas från nätverks driv Rutinens avbrotts hanterare) är ansvarig för att antingen placera paketet på UDP-socketens mottagnings kö eller leverera den till den första pausade tråden för ett paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-860">The UDP receive packet processing (usually called from the network driver's receive interrupt handler) is responsible for either placing the packet on the UDP socket's receive queue or delivering it to the first suspended thread waiting for a packet.</span></span> <span data-ttu-id="d0a19-861">Om paketet är i kö, kontrollerar Receive-bearbetningen även det maximala mottagnings ködjup som är associerat med socketen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-861">If the packet is queued, the receive processing also checks the maximum receive queue depth associated with the socket.</span></span> <span data-ttu-id="d0a19-862">Om det nyligen köade paketet överskrider ködjup, ignoreras det äldsta paketet i kön.</span><span class="sxs-lookup"><span data-stu-id="d0a19-862">If this newly queued packet exceeds the queue depth, the oldest packet in the queue is discarded.</span></span>

### <a name="udp-receive-notify"></a><span data-ttu-id="d0a19-863">Mottagnings meddelande för UDP</span><span class="sxs-lookup"><span data-stu-id="d0a19-863">UDP Receive Notify</span></span>

<span data-ttu-id="d0a19-864">Om program tråden behöver bearbeta mottagna data från fler än en socket ska funktionen ***nx_udp_socket_receive_notify*** användas.</span><span class="sxs-lookup"><span data-stu-id="d0a19-864">If the application thread needs to process received data from more than one socket, the ***nx_udp_socket_receive_notify*** function should be used.</span></span> <span data-ttu-id="d0a19-865">Den här funktionen registrerar en motringnings funktion för mottagnings paket för socketen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-865">This function registers a receive packet callback function for the socket.</span></span> <span data-ttu-id="d0a19-866">När ett paket tas emot på socketen körs motringningsfunktionen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-866">Whenever a packet is received on the socket, the callback function is executed.</span></span>

<span data-ttu-id="d0a19-867">Innehållet i motringningsfunktionen är programspecifikt.</span><span class="sxs-lookup"><span data-stu-id="d0a19-867">The contents of the callback function is application-specific.</span></span> <span data-ttu-id="d0a19-868">Det skulle dock förmodligen innehålla logik för att informera bearbetnings tråden att ett paket nu är tillgängligt på motsvarande socket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-868">However, it would most likely contain logic to inform the processing thread that a packet is now available on the corresponding socket.</span></span>

### <a name="peer-address-and-port"></a><span data-ttu-id="d0a19-869">Peer-adress och port</span><span class="sxs-lookup"><span data-stu-id="d0a19-869">Peer Address and Port</span></span>

<span data-ttu-id="d0a19-870">Vid mottagning av ett UDP-paket kan programmet hitta avsändarens IP-adress och port nummer med hjälp av tjänsten ***nx_udp_packet_info_extract***.</span><span class="sxs-lookup"><span data-stu-id="d0a19-870">On receiving a UDP packet, application may find the sender's IP address and port number by using the service ***nx_udp_packet_info_extract***.</span></span> <span data-ttu-id="d0a19-871">Vid lyckad återgång tillhandahåller den här tjänsten information om avsändarens IP-adress, avsändarens port nummer och det lokala gränssnitt som paketet togs emot via.</span><span class="sxs-lookup"><span data-stu-id="d0a19-871">On successful return, this service provides information on the sender's IP address, sender's port number, and the local interface through which the packet was received.</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="d0a19-872">Tråd upphängning</span><span class="sxs-lookup"><span data-stu-id="d0a19-872">Thread Suspension</span></span>

<span data-ttu-id="d0a19-873">Som tidigare nämnts kan program trådar pausa vid försök att ta emot ett UDP-paket på en viss UDP-port.</span><span class="sxs-lookup"><span data-stu-id="d0a19-873">As mentioned previously, application threads can suspend while attempting to receive a UDP packet on a particular UDP port.</span></span> <span data-ttu-id="d0a19-874">När ett paket har mottagits på den porten, tilldelas den första tråden inaktive rad och tråden återupptas sedan.</span><span class="sxs-lookup"><span data-stu-id="d0a19-874">After a packet is received on that port, it is given to the first thread suspended and that thread is then resumed.</span></span> <span data-ttu-id="d0a19-875">En valfri timeout är tillgänglig när du pausar ett UDP Receive-paket, en funktion som är tillgänglig för de flesta NetX-tjänster.</span><span class="sxs-lookup"><span data-stu-id="d0a19-875">An optional timeout is available when suspending on a UDP receive packet, a feature available for most NetX services.</span></span>

### <a name="udp-socket-statistics-and-errors"></a><span data-ttu-id="d0a19-876">Statistik och fel för UDP-socket</span><span class="sxs-lookup"><span data-stu-id="d0a19-876">UDP Socket Statistics and Errors</span></span>

<span data-ttu-id="d0a19-877">Om den är aktive rad håller NetX UDP-programvaran reda på flera statistik och fel som kan vara användbara för programmet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-877">If enabled, the NetX UDP socket software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="d0a19-878">Följande statistik och fel rapporter upprätthålls för varje IP/UDP-instans:</span><span class="sxs-lookup"><span data-stu-id="d0a19-878">The following statistics and error reports are maintained for each IP/UDP instance:</span></span>

- <span data-ttu-id="d0a19-879">Totalt antal skickade UDP-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-879">Total UDP Packets Sent</span></span>
- <span data-ttu-id="d0a19-880">Totalt antal skickade UDP-byte</span><span class="sxs-lookup"><span data-stu-id="d0a19-880">Total UDP Bytes Sent</span></span>
- <span data-ttu-id="d0a19-881">Totalt antal mottagna UDP-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-881">Total UDP Packets Received</span></span>
- <span data-ttu-id="d0a19-882">Totalt antal mottagna UDP-byte</span><span class="sxs-lookup"><span data-stu-id="d0a19-882">Total UDP Bytes Received</span></span>
- <span data-ttu-id="d0a19-883">Totalt antal ogiltiga UDP-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-883">Total UDP Invalid Packets</span></span>
- <span data-ttu-id="d0a19-884">Totalt antal mottagna UDP-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-884">Total UDP Receive Packets Dropped</span></span>
- <span data-ttu-id="d0a19-885">Totalt antal UDP mottagnings kontroll Summa fel</span><span class="sxs-lookup"><span data-stu-id="d0a19-885">Total UDP Receive Checksum Errors</span></span>
- <span data-ttu-id="d0a19-886">Skickade UDP-socket-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-886">UDP Socket Packets Sent</span></span>
- <span data-ttu-id="d0a19-887">Skickade UDP-socket-byte</span><span class="sxs-lookup"><span data-stu-id="d0a19-887">UDP Socket Bytes Sent</span></span>
- <span data-ttu-id="d0a19-888">Mottagna UDP-socket-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-888">UDP Socket Packets Received</span></span>
- <span data-ttu-id="d0a19-889">Mottagna UDP-socket byte</span><span class="sxs-lookup"><span data-stu-id="d0a19-889">UDP Socket Bytes Received</span></span>
- <span data-ttu-id="d0a19-890">Köade UDP-socket-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-890">UDP Socket Packets Queued</span></span>
- <span data-ttu-id="d0a19-891">Mottagna paket för UDP-socket tas bort</span><span class="sxs-lookup"><span data-stu-id="d0a19-891">UDP Socket Receive Packets Dropped</span></span>
- <span data-ttu-id="d0a19-892">Fel vid kontroll summa för UDP-socket</span><span class="sxs-lookup"><span data-stu-id="d0a19-892">UDP Socket Checksum Errors</span></span>

<span data-ttu-id="d0a19-893">Alla dessa statistik-och fel rapporter är tillgängliga för programmet med ***nx_udp_info_get*** tjänsten för UDP-amassed över alla UDP-socketar och ***nx_udp_socket_info_get*** -tjänsten för UDP-statistik på den angivna UDP-socketen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-893">All these statistics and error reports are available to the application with the ***nx_udp_info_get*** service for UDP statistics amassed over all UDP sockets, and the ***nx_udp_socket_info_get*** service for UDP statistics on the specified UDP socket.</span></span>

### <a name="udp-socket-control-block-nx_udp_socket"></a><span data-ttu-id="d0a19-894">UDP socket Control Block NX_UDP_SOCKET</span><span class="sxs-lookup"><span data-stu-id="d0a19-894">UDP Socket Control Block NX_UDP_SOCKET</span></span>

<span data-ttu-id="d0a19-895">Egenskaperna för varje UDP-socket finns i det associerade **NX_UDP_SOCKET** kontroll blocket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-895">The characteristics of each UDP socket are found in the associated **NX_UDP_SOCKET** control block.</span></span> <span data-ttu-id="d0a19-896">Den innehåller användbar information, till exempel länken till IP-datastrukturen, nätverks gränssnittet för att skicka och ta emot sökvägar, den kopplade porten och kön för mottagnings paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-896">It contains useful information such as the link to the IP data structure, the network interface for the sending and receiving paths, the bound port, and the receive packet queue.</span></span> <span data-ttu-id="d0a19-897">Den här strukturen definieras i filen **_nx_api. h_** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-897">This structure is defined in the **_nx_api.h_** file.</span></span>

## <a name="transmission-control-protocol-tcp"></a><span data-ttu-id="d0a19-898">Transmission Control Protocol (TCP)</span><span class="sxs-lookup"><span data-stu-id="d0a19-898">Transmission Control Protocol (TCP)</span></span>

<span data-ttu-id="d0a19-899">Transmission Control Protocol (TCP) ger tillförlitlig data överföring mellan två nätverks medlemmar (RFC 793).</span><span class="sxs-lookup"><span data-stu-id="d0a19-899">The Transmission Control Protocol (TCP) provides reliable stream data transfer between two network members (RFC 793).</span></span> <span data-ttu-id="d0a19-900">Alla data som skickas från en nätverks medlem verifieras och bekräftas av den mottagande medlemmen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-900">All data sent from one network member are verified and acknowledged by the receiving member.</span></span> <span data-ttu-id="d0a19-901">Dessutom måste de två medlemmarna ha upprättat en anslutning före en data överföring.</span><span class="sxs-lookup"><span data-stu-id="d0a19-901">In addition, the two members must have established a connection prior to any data transfer.</span></span> <span data-ttu-id="d0a19-902">Allt detta resulterar i tillförlitlig data överföring. Det kräver dock betydligt mer belastning än den tidigare beskrivna UDP-dataöverföringen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-902">All this results in reliable data transfer; however, it does require substantially more overhead than the previously described UDP data transfer.</span></span>

### <a name="tcp-header"></a><span data-ttu-id="d0a19-903">TCP-huvud</span><span class="sxs-lookup"><span data-stu-id="d0a19-903">TCP Header</span></span>

<span data-ttu-id="d0a19-904">Vid överföring placeras TCP-huvud framför data från användaren.</span><span class="sxs-lookup"><span data-stu-id="d0a19-904">On transmission, TCP header is placed in front of the data from the user.</span></span> <span data-ttu-id="d0a19-905">Vid mottagning tas TCP-huvud bort från det inkommande paketet, och endast de användar data som är tillgängliga för programmet lämnas kvar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-905">On reception, TCP header is removed from the incoming packet, leaving only the user data available to the application.</span></span> <span data-ttu-id="d0a19-906">TCP använder IP-protokollet för att skicka och ta emot paket, vilket innebär att det finns ett IP-huvud framför TCP-huvudet när paketet är i nätverket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-906">TCP utilizes the IP protocol to send and receive packets, which means there is an IP header in front of the TCP header when the packet is on the network.</span></span> <span data-ttu-id="d0a19-907">Bild 10 visar formatet för TCP-sidhuvudet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-907">Figure 10 shows the format of the TCP header.</span></span>

![TCP-huvud](./media/user-guide/tcp-header.png)

<span data-ttu-id="d0a19-909">**BILD 10. TCP-huvud**</span><span class="sxs-lookup"><span data-stu-id="d0a19-909">**FIGURE 10. TCP Header**</span></span>

<span data-ttu-id="d0a19-910">I följande avsnitt beskrivs formatet TCP-huvud:</span><span class="sxs-lookup"><span data-stu-id="d0a19-910">The following describes the TCP header format:</span></span>

| <span data-ttu-id="d0a19-911">Rubrik fält</span><span class="sxs-lookup"><span data-stu-id="d0a19-911">Header Field</span></span> | <span data-ttu-id="d0a19-912">Syfte</span><span class="sxs-lookup"><span data-stu-id="d0a19-912">Purpose</span></span> |
|---|---|
| <span data-ttu-id="d0a19-913">16-bitars käll port nummer</span><span class="sxs-lookup"><span data-stu-id="d0a19-913">16-bit source port number</span></span> | <span data-ttu-id="d0a19-914">Det här fältet innehåller den port som TCP-paketet skickas till.</span><span class="sxs-lookup"><span data-stu-id="d0a19-914">This field contains the port the TCP packet is being sent out on.</span></span> <span data-ttu-id="d0a19-915">Giltiga TCP-portar är mellan 1 och 0Xffffffff.</span><span class="sxs-lookup"><span data-stu-id="d0a19-915">Valid TCP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="d0a19-916">16-bitars mål port nummer</span><span class="sxs-lookup"><span data-stu-id="d0a19-916">16-bit destination port number</span></span> | <span data-ttu-id="d0a19-917">Det här fältet innehåller TCP-porten som paketet skickas till.</span><span class="sxs-lookup"><span data-stu-id="d0a19-917">This field contains the TCP port the packet is being sent to.</span></span> <span data-ttu-id="d0a19-918">Giltiga TCP-portar är mellan 1 och 0Xffffffff.</span><span class="sxs-lookup"><span data-stu-id="d0a19-918">Valid TCP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="d0a19-919">32-bitars sekvensnummer</span><span class="sxs-lookup"><span data-stu-id="d0a19-919">32-bit sequence number</span></span> | <span data-ttu-id="d0a19-920">Det här fältet innehåller sekvensnumret för data som skickas från det här slutet av anslutningen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-920">This field contains the sequence number for data sent from this end of the connection.</span></span> <span data-ttu-id="d0a19-921">Den ursprungliga sekvensen upprättas under den inledande anslutnings ordningen mellan två TCP-noder.</span><span class="sxs-lookup"><span data-stu-id="d0a19-921">The original sequence is established during the initial connection sequence between two TCP nodes.</span></span> <span data-ttu-id="d0a19-922">Varje data överföring från den punkten resulterar i en ökning av sekvensnumret med antalet byte som skickats.</span><span class="sxs-lookup"><span data-stu-id="d0a19-922">Every data transfer from that point results in an increment of the sequence number by the amount bytes sent.</span></span> |
| <span data-ttu-id="d0a19-923">32-bitars bekräftelse nummer</span><span class="sxs-lookup"><span data-stu-id="d0a19-923">32-bit acknowledgement number</span></span> | <span data-ttu-id="d0a19-924">Det här fältet innehåller det ordnings nummer som motsvarar den sista mottagna byte som togs emot av anslutningen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-924">This field contains the sequence number corresponding to the last byte received by this side of the connection.</span></span> <span data-ttu-id="d0a19-925">Detta används för att avgöra om data som skickats tidigare har tagits emot av den andra änden av anslutningen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-925">This is used to determine whether or not data previously sent has successfully been received by the other end of the connection.</span></span> |
| <span data-ttu-id="d0a19-926">4-bitars rubrik längd</span><span class="sxs-lookup"><span data-stu-id="d0a19-926">4-bit header length</span></span>           | <span data-ttu-id="d0a19-927">Det här fältet innehåller antalet 32-bitars ord i TCP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-927">This field contains the number of 32-bit words in the TCP header.</span></span> <span data-ttu-id="d0a19-928">Om det inte finns några alternativ i TCP-huvudet är det här fältet 5.</span><span class="sxs-lookup"><span data-stu-id="d0a19-928">If no options are present in the TCP header, this field is 5.</span></span> |
| <span data-ttu-id="d0a19-929">6-bitars kod bitar</span><span class="sxs-lookup"><span data-stu-id="d0a19-929">6-bit code bits</span></span>               | <span data-ttu-id="d0a19-930">Det här fältet innehåller sex olika kod bitar som används för att ange olika kontroll information som är associerad med anslutningen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-930">This field contains the six different code bits used to indicate various control information associated with the connection.</span></span> <span data-ttu-id="d0a19-931">Kontroll bitarna definieras enligt följande:</span><span class="sxs-lookup"><span data-stu-id="d0a19-931">The control bits are defined as follows:</span></span> |



| <span data-ttu-id="d0a19-932">Name</span><span class="sxs-lookup"><span data-stu-id="d0a19-932">Name</span></span> | <span data-ttu-id="d0a19-933">Bitmask</span><span class="sxs-lookup"><span data-stu-id="d0a19-933">Bit</span></span> | <span data-ttu-id="d0a19-934">Innebörd</span><span class="sxs-lookup"><span data-stu-id="d0a19-934">Meaning</span></span>                                                     |
|------|-----|-------------------------------------------------------------|
| <span data-ttu-id="d0a19-935">URG</span><span class="sxs-lookup"><span data-stu-id="d0a19-935">URG</span></span>  | <span data-ttu-id="d0a19-936">21</span><span class="sxs-lookup"><span data-stu-id="d0a19-936">21</span></span>  | <span data-ttu-id="d0a19-937">Brådskande data finns</span><span class="sxs-lookup"><span data-stu-id="d0a19-937">Urgent data present</span></span>                                         |
| <span data-ttu-id="d0a19-938">Följ</span><span class="sxs-lookup"><span data-stu-id="d0a19-938">ACK</span></span>  | <span data-ttu-id="d0a19-939">20</span><span class="sxs-lookup"><span data-stu-id="d0a19-939">20</span></span>  | <span data-ttu-id="d0a19-940">Bekräftelse numret är giltigt</span><span class="sxs-lookup"><span data-stu-id="d0a19-940">Acknowledgement number is valid</span></span>                             |
| <span data-ttu-id="d0a19-941">PSH</span><span class="sxs-lookup"><span data-stu-id="d0a19-941">PSH</span></span>  | <span data-ttu-id="d0a19-942">19</span><span class="sxs-lookup"><span data-stu-id="d0a19-942">19</span></span>  | <span data-ttu-id="d0a19-943">Hantera dessa data direkt</span><span class="sxs-lookup"><span data-stu-id="d0a19-943">Handle this data immediately</span></span>                                |
| <span data-ttu-id="d0a19-944">RSTA</span><span class="sxs-lookup"><span data-stu-id="d0a19-944">RST</span></span>  | <span data-ttu-id="d0a19-945">18</span><span class="sxs-lookup"><span data-stu-id="d0a19-945">18</span></span>  | <span data-ttu-id="d0a19-946">Återställ anslutningen</span><span class="sxs-lookup"><span data-stu-id="d0a19-946">Reset the connection</span></span>                                        |
| <span data-ttu-id="d0a19-947">TILLSTÅNDET</span><span class="sxs-lookup"><span data-stu-id="d0a19-947">SYN</span></span>  | <span data-ttu-id="d0a19-948">17</span><span class="sxs-lookup"><span data-stu-id="d0a19-948">17</span></span>  | <span data-ttu-id="d0a19-949">Synkronisera sekvensnummer (används för att upprätta anslutning)</span><span class="sxs-lookup"><span data-stu-id="d0a19-949">Synchronize sequence numbers (used to establish connection)</span></span> |
| <span data-ttu-id="d0a19-950">FIN</span><span class="sxs-lookup"><span data-stu-id="d0a19-950">FIN</span></span>  | <span data-ttu-id="d0a19-951">16</span><span class="sxs-lookup"><span data-stu-id="d0a19-951">16</span></span>  | <span data-ttu-id="d0a19-952">Avsändaren har slutförts med överföring (används för att stänga anslutningen)</span><span class="sxs-lookup"><span data-stu-id="d0a19-952">Sender is finished with transmit (used to close connection)</span></span> |

<span data-ttu-id="d0a19-953">**16-bitars fönster**</span><span class="sxs-lookup"><span data-stu-id="d0a19-953">**16-bit window**</span></span>

<span data-ttu-id="d0a19-954">Det här fältet används för flödes kontroll.</span><span class="sxs-lookup"><span data-stu-id="d0a19-954">This field is used for flow control.</span></span> <span data-ttu-id="d0a19-955">Det innehåller mängden byte som socketen kan ta emot för närvarande.</span><span class="sxs-lookup"><span data-stu-id="d0a19-955">It contains the amount of bytes the socket can currently receive.</span></span> <span data-ttu-id="d0a19-956">Detta används i princip för flödes kontroll.</span><span class="sxs-lookup"><span data-stu-id="d0a19-956">This basically is used for flow control.</span></span> <span data-ttu-id="d0a19-957">Avsändaren ansvarar för att se till att de data som skickas får plats i mottagarens annonserade fönster.</span><span class="sxs-lookup"><span data-stu-id="d0a19-957">The sender is responsible for making sure the data to send will fit into the receiver’s advertised window.</span></span>

| <span data-ttu-id="d0a19-958">**Rubrik fält**</span><span class="sxs-lookup"><span data-stu-id="d0a19-958">**Header Field**</span></span>          | <span data-ttu-id="d0a19-959">**Syfte**</span><span class="sxs-lookup"><span data-stu-id="d0a19-959">**Purpose**</span></span> |
| ------------------------- | --- |
| <span data-ttu-id="d0a19-960">**16-bitars TCP-kontrollsumma**</span><span class="sxs-lookup"><span data-stu-id="d0a19-960">**16-bit TCP checksum**</span></span>   | <span data-ttu-id="d0a19-961">Det här fältet innehåller 16-bitars kontroll summa för paketet, inklusive TCP-huvud, paket data området och pseudo-IP-huvudet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-961">This field contains the 16-bit checksum for the packet including the TCP header, the packet data area, and the pseudo IP header.</span></span>                |
| <span data-ttu-id="d0a19-962">**16-bitars brådskande pekare**</span><span class="sxs-lookup"><span data-stu-id="d0a19-962">**16-bit urgent pointer**</span></span> | <span data-ttu-id="d0a19-963">Det här fältet innehåller den positiva förskjutningen för den senaste byten av brådskande data.</span><span class="sxs-lookup"><span data-stu-id="d0a19-963">This field contains the positive offset of the last byte of the urgent data.</span></span> <span data-ttu-id="d0a19-964">Det här fältet är endast giltigt om URG-kodfragmentet har angetts i huvudet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-964">This field is only valid if the URG code bit is set in the header.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="d0a19-965">*Alla rubriker i TCP/IP-implementeringen förväntas vara i big endian format. I det här formatet finns de mest signifikanta byten av ordet på den lägsta byte-adressen.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-965">*All headers in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="tcp-enable"></a><span data-ttu-id="d0a19-966">TCP-aktivering</span><span class="sxs-lookup"><span data-stu-id="d0a19-966">TCP Enable</span></span>

<span data-ttu-id="d0a19-967">Innan TCP-anslutningar och paket överföring är möjliga måste programmet först aktivera TCP genom att anropa tjänsten nx_tcp_enable.</span><span class="sxs-lookup"><span data-stu-id="d0a19-967">Before TCP connections and packet transmissions are possible, the application must first enable TCP by calling the nx_tcp_enable service.</span></span> <span data-ttu-id="d0a19-968">När det har Aktiver ATS är programmet tillgängligt för att få åtkomst till alla TCP-tjänster.</span><span class="sxs-lookup"><span data-stu-id="d0a19-968">After enabled, the application is free to access all TCP services.</span></span>

### <a name="tcp-socket-create"></a><span data-ttu-id="d0a19-969">Skapa TCP-socket</span><span class="sxs-lookup"><span data-stu-id="d0a19-969">TCP Socket Create</span></span>

<span data-ttu-id="d0a19-970">TCP-Sockets skapas antingen under initieringen eller under körningen av program trådar.</span><span class="sxs-lookup"><span data-stu-id="d0a19-970">TCP sockets are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="d0a19-971">Den första typen av tjänst, tid till Live och fönster storlek definieras av tjänsten ***nx_tcp_socket_create*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-971">The initial type of service, time to live, and window size are defined by the ***nx_tcp_socket_create*** service.</span></span> <span data-ttu-id="d0a19-972">Det finns ingen gräns för antalet TCP-Sockets i ett program.</span><span class="sxs-lookup"><span data-stu-id="d0a19-972">There are no limits on the number of TCP sockets in an application.</span></span>

### <a name="tcp-checksum"></a><span data-ttu-id="d0a19-973">TCP-kontrollsumma</span><span class="sxs-lookup"><span data-stu-id="d0a19-973">TCP Checksum</span></span>

<span data-ttu-id="d0a19-974">TCP anger en komplett 16-bitars kontroll summa som täcker IP-pseudo-sidhuvudet (som består av käll-IP-adressen, målets IP-adress och protokoll/längd-IP-adress), TCP-huvudet och TCP-paketets data.</span><span class="sxs-lookup"><span data-stu-id="d0a19-974">TCP specifies a one’s complement 16-bit checksum that covers the IP pseudo header, (consisting of the source IP address, destination IP address, and the protocol/length IP word), the TCP header, and the TCP packet data.</span></span>

<span data-ttu-id="d0a19-975">Vissa nätverks styrenheter kan utföra beräkning av TCP-kontrollsumma och verifiering i maskin vara.</span><span class="sxs-lookup"><span data-stu-id="d0a19-975">Certain network controllers are able to perform TCP checksum computation and validation in hardware.</span></span> <span data-ttu-id="d0a19-976">För sådana system kan program använda sig av logik för maskin varu kontroll så mycket som möjligt för att minska körnings belastningen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-976">For such systems, applications may want to use hardware checksum logic as much as possible to reduce runtime overhead.</span></span> <span data-ttu-id="d0a19-977">Program kan inaktivera beräknings logiken för TCP-kontrollsumma från NetX-biblioteket helt i bygg tiden genom att definiera **NX_DISABLE_TCP_TX_CHECKSUM** och **NX_DISABLE_TCP_RX_CHECKSUM**.</span><span class="sxs-lookup"><span data-stu-id="d0a19-977">Applications may disable TCP checksum computation logic from the NetX library altogether at build time by defining **NX_DISABLE_TCP_TX_CHECKSUM** and **NX_DISABLE_TCP_RX_CHECKSUM**.</span></span> <span data-ttu-id="d0a19-978">På så sätt kompileras inte TCP-kontrollsummats kod i.</span><span class="sxs-lookup"><span data-stu-id="d0a19-978">This way, the TCP checksum code is not compiled in.</span></span>

### <a name="tcp-port"></a><span data-ttu-id="d0a19-979">TCP-port</span><span class="sxs-lookup"><span data-stu-id="d0a19-979">TCP Port</span></span>

<span data-ttu-id="d0a19-980">En TCP-port är en logisk anslutnings punkt i TCP-protokollet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-980">A TCP port is a logical connection point in the TCP protocol.</span></span> <span data-ttu-id="d0a19-981">Det finns 65 535 giltiga portar i TCP-komponenten i NetX, mellan 1 och 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="d0a19-981">There are 65,535 valid ports in the TCP component of NetX, ranging from 1 through 0xFFFF.</span></span> <span data-ttu-id="d0a19-982">Till skillnad från UDP där data från en port kan skickas till en annan målport, är en TCP-port ansluten till en annan angiven TCP-port, och endast när den här anslutningen upprättas kan all data överföring ske, och endast mellan de två portarna som utgör anslutningen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-982">Unlike UDP in which data from one port can be sent to any other destination port, a TCP port is connected to another specific TCP port, and only when this connection is established can any data transfer take place—and only between the two ports making up the connection.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-983">*TCP-portar är helt åtskilda från UDP-portar; t. ex. är UDP-port nummer 1 ingen relation till TCP-port nummer 1.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-983">*TCP ports are completely separate from UDP ports; e.g., UDP port number 1 has no relation to TCP port number 1.*</span></span>

## <a name="client-server-model"></a><span data-ttu-id="d0a19-984">Client-Server modell</span><span class="sxs-lookup"><span data-stu-id="d0a19-984">Client-Server Model</span></span>

<span data-ttu-id="d0a19-985">Om du vill använda TCP för data överföring måste du först upprätta en anslutning mellan de två TCP-socketarna.</span><span class="sxs-lookup"><span data-stu-id="d0a19-985">To use TCP for data transfer, a connection must first be established between the two TCP sockets.</span></span> <span data-ttu-id="d0a19-986">Upprättandet av anslutningen görs på en klient-server.</span><span class="sxs-lookup"><span data-stu-id="d0a19-986">The establishment of the connection is done in a client-server fashion.</span></span> <span data-ttu-id="d0a19-987">Klient sidan av anslutningen är den sida som initierar anslutningen, medan Server sidan bara väntar på klient anslutnings begär Anden innan bearbetningen görs.</span><span class="sxs-lookup"><span data-stu-id="d0a19-987">The client side of the connection is the side that initiates the connection, while the server side simply waits for client connection requests before any processing is done.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-988">*För multihome-enheter bestämmer NetX automatiskt käll adressen som ska användas för anslutningen och nästa hopp adress baserat på anslutningens mål-IP-adress.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-988">*For multihome devices, NetX automatically determines the source address to use for the connection, and the next hop address based on the destination IP address of the connection.*</span></span>

### <a name="tcp-socket-state-machine"></a><span data-ttu-id="d0a19-989">TCP socket State Machine</span><span class="sxs-lookup"><span data-stu-id="d0a19-989">TCP Socket State Machine</span></span>

<span data-ttu-id="d0a19-990">Anslutningen mellan två TCP-Sockets (en klient och en server) är komplex och hanteras på ett sätt som är en tillstånds dator.</span><span class="sxs-lookup"><span data-stu-id="d0a19-990">The connection between two TCP sockets (one client and one server) is complex and is managed in a state machine manner.</span></span> <span data-ttu-id="d0a19-991">Varje TCP-socket startar i ett stängt tillstånd.</span><span class="sxs-lookup"><span data-stu-id="d0a19-991">Each TCP socket starts in a CLOSED state.</span></span> <span data-ttu-id="d0a19-992">Via anslutnings händelser varje Sockets tillstånds dator migreras till ett etablerat tillstånd, vilket är den mängd data överföringen i TCP äger rum.</span><span class="sxs-lookup"><span data-stu-id="d0a19-992">Through connection events each socket's state machine migrates into the ESTABLISHED state, which is where the bulk of the data transfer in TCP takes place.</span></span> <span data-ttu-id="d0a19-993">När en sida av anslutningen inte längre vill skicka data, kopplas den bort.</span><span class="sxs-lookup"><span data-stu-id="d0a19-993">When one side of the connection no longer wishes to send data, it disconnects.</span></span> <span data-ttu-id="d0a19-994">När den andra sidan kopplas från återgår TCP-socketen till stängt tillstånd.</span><span class="sxs-lookup"><span data-stu-id="d0a19-994">After the other side disconnects, eventually the TCP socket returns to the CLOSED state.</span></span> <span data-ttu-id="d0a19-995">Den här processen upprepas varje gång en TCP-klient och Server upprättar och stänger en anslutning.</span><span class="sxs-lookup"><span data-stu-id="d0a19-995">This process repeats each time a TCP client and server establish and close a connection.</span></span> <span data-ttu-id="d0a19-996">Bild 11 visar de olika tillstånden för datorn för TCP-tillstånd.</span><span class="sxs-lookup"><span data-stu-id="d0a19-996">Figure 11 shows the various states of the TCP state machine.</span></span>

![Tillstånd för TCP-tillstånds dator](./media/user-guide/states-tcp-state-machine.png)

### <a name="figure-11-states-of-the-tcp-state-machine"></a><span data-ttu-id="d0a19-998">BILD 11.</span><span class="sxs-lookup"><span data-stu-id="d0a19-998">FIGURE 11.</span></span> <span data-ttu-id="d0a19-999">Tillstånd för TCP-tillstånds dator</span><span class="sxs-lookup"><span data-stu-id="d0a19-999">States of the TCP State Machine</span></span>

### <a name="tcp-client-connection"></a><span data-ttu-id="d0a19-1000">TCP-klient anslutning</span><span class="sxs-lookup"><span data-stu-id="d0a19-1000">TCP Client Connection</span></span>

<span data-ttu-id="d0a19-1001">Som tidigare nämnts, initierar klient sidan av TCP-anslutningen en anslutningsbegäran till en TCP-server.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1001">As mentioned previously, the client side of the TCP connection initiates a connection request to a TCP server.</span></span> <span data-ttu-id="d0a19-1002">Innan en anslutningsbegäran kan göras måste TCP aktive ras på klientens IP-instans.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1002">Before a connection request can be made, TCP must be enabled on the client IP instance.</span></span> <span data-ttu-id="d0a19-1003">Dessutom måste klienten TCP-socketen sedan skapas med ***nx_tcp_socket_create** _-tjänsten och vara kopplad till en port via tjänsten _*_nx_tcp_client_socket_bind_\*_ .</span><span class="sxs-lookup"><span data-stu-id="d0a19-1003">In addition, the client TCP socket must next be created with the ***nx_tcp_socket_create** _ service and bound to a port via the _*_nx_tcp_client_socket_bind_\*_ service.</span></span> <span data-ttu-id="d0a19-1004">När klient-socketen är kopplad, används _ \*_nx_tcp_client_socket_connect_\*\*-tjänsten för att upprätta en anslutning till en TCP-server.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1004">After the client socket is bound, the _ *_nx_tcp_client_socket_connect_*\* service is used to establish a connection with a TCP server.</span></span> <span data-ttu-id="d0a19-1005">Observera att socketen måste vara i stängt tillstånd för att ett anslutnings försök ska kunna initieras.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1005">Note the socket must be in a CLOSED state to initiate a connection attempt.</span></span> <span data-ttu-id="d0a19-1006">Att upprätta anslutningen börjar med NetX som utfärdar ett SYN paket och väntar sedan på ett SYN ACK-paket tillbaka från servern, vilket innebär att anslutningsbegäran tas emot.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1006">Establishing the connection starts with NetX issuing a SYN packet and then waiting for a SYN ACK packet back from the server, which signifies acceptance of the connection request.</span></span> <span data-ttu-id="d0a19-1007">När SYN-ACK-ACK tas emot svarar NetX med ett ACK-paket och höjer upp klientens socket till tillståndet etablerad.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1007">After the SYN ACK is received, NetX responds with an ACK packet and promotes the client socket to the ESTABLISHED state.</span></span>

### <a name="tcp-client-disconnection"></a><span data-ttu-id="d0a19-1008">TCP-klient från koppling</span><span class="sxs-lookup"><span data-stu-id="d0a19-1008">TCP Client Disconnection</span></span>

<span data-ttu-id="d0a19-1009">Att stänga anslutningen uppnås genom att anropa ***nx_tcp_socket_disconnect***.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1009">Closing the connection is accomplished by calling ***nx_tcp_socket_disconnect***.</span></span> <span data-ttu-id="d0a19-1010">Om ingen uppskjutning har angetts skickar klient-socketen ett för-paket till Server-socketen och placerar socketen i stängt tillstånd.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1010">If no suspension is specified, the client socket sends a RST packet to the server socket and places the socket in the CLOSED state.</span></span> <span data-ttu-id="d0a19-1011">Annars, om en SUS Pension begärs, utförs det fullständiga TCP-från kopplings protokollet enligt följande:</span><span class="sxs-lookup"><span data-stu-id="d0a19-1011">Otherwise, if a suspension is requested, the full TCP disconnect protocol is performed, as follows:</span></span>

- <span data-ttu-id="d0a19-1012">Om servern tidigare initierade en från kopplings förfrågan (klient-socketen redan har tagit emot ett RÄNTETRANS-paket, svarat på en ACK och är i nära VÄNTe läge), höjer NetX klientens TCP socket State till det senaste bekräftelse stadiet och skickar ett RÄNTETRANS-paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1012">If the server previously initiated a disconnect request (the client socket has already received a FIN packet, responded with an ACK, and is in the CLOSE WAIT state), NetX promotes the client TCP socket state to the LAST ACK state and sends a FIN packet.</span></span> <span data-ttu-id="d0a19-1013">Den väntar sedan på en bekräftelse från servern innan du slutför från kopplingen och anger det stängda läget.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1013">It then waits for an ACK from the server before completing the disconnect and entering the CLOSED state.</span></span>

- <span data-ttu-id="d0a19-1014">Om klienten å andra sidan är den första för att initiera en från kopplings förfrågan (servern har inte kopplats från och socketen fortfarande är i det tillstånd som har ETABLERATs), skickar NetX ett RÄNTETRANS-paket för att initiera från kopplingen och väntar på att ta emot en FIN och en bekräftelse från servern innan du slutför från kopplingen och placera socketen i ett stängt tillstånd.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1014">If on the other hand, the client is the first to initiate a disconnect request (the server has not disconnected and the socket is still in the ESTABLISHED state), NetX sends a FIN packet to initiate the disconnect and waits to receive a FIN and an ACK from the server before completing the disconnect and placing the socket in a CLOSED state.</span></span>

<span data-ttu-id="d0a19-1015">Om det fortfarande finns paket i kön för överföring av socket pausar NetX under den angivna tids gränsen för att tillåta att paketen kan bekräftas.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1015">If there are still packets on the socket transmit queue, NetX suspends for the specified timeout to allow the packets to be acknowledged.</span></span> <span data-ttu-id="d0a19-1016">Om tids gränsen går ut tömmer NetX överförings kön för klientens socket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1016">If the timeout expires, NetX empties the transmit queue of the client socket.</span></span>

<span data-ttu-id="d0a19-1017">Programmet anropar ***nx_tcp_client_socket_unbind*** för att frigöra porten från klientens socket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1017">To unbind the port from the client socket, the application calls ***nx_tcp_client_socket_unbind***.</span></span> <span data-ttu-id="d0a19-1018">Socketen måste vara i ett stängt tillstånd eller vid från koppling (t. ex. VÄNTe läge VÄNTe tid) innan porten släpps. annars returneras ett fel.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1018">The socket must be in a CLOSED state or in the process of disconnecting (i.e., TIMED WAIT state) before the port is released; otherwise, an error is returned.</span></span>

<span data-ttu-id="d0a19-1019">Slutligen, om programmet inte längre behöver klient-socketen, anropar den ***nx_tcp_socket_delete*** för att ta bort socketen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1019">Finally, if the application no longer needs the client socket, it calls ***nx_tcp_socket_delete*** to delete the socket.</span></span>

### <a name="tcp-server-connection"></a><span data-ttu-id="d0a19-1020">Anslutning till TCP-server</span><span class="sxs-lookup"><span data-stu-id="d0a19-1020">TCP Server Connection</span></span>

<span data-ttu-id="d0a19-1021">Server sidan av en TCP-anslutning är passiv; servern väntar alltså på att en klient ska initiera anslutningsbegäran.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1021">The server side of a TCP connection is passive; i.e., the server waits for a client to initiate connection request.</span></span> <span data-ttu-id="d0a19-1022">Om du vill acceptera en klient anslutning måste TCP först vara aktiverat på IP-instansen genom att anropa tjänsten \***nx_tcp_enable** _.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1022">To accept a client connection, TCP must first be enabled on the IP instance by calling the service \***nx_tcp_enable** _.</span></span> <span data-ttu-id="d0a19-1023">Därefter måste programmet skapa en TCP-socket med hjälp av _ \*_nx_tcp_socket_create_\*\*-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1023">Next, the application must create a TCP socket using the _ *_nx_tcp_socket_create_*\* service.</span></span>

<span data-ttu-id="d0a19-1024">Server-socketen måste också konfigureras för att lyssna efter anslutnings begär Anden.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1024">The server socket must also be set up for listening for connection requests.</span></span> <span data-ttu-id="d0a19-1025">Detta uppnås med hjälp av tjänsten ***nx_tcp_server_socket_listen*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-1025">This is achieved by using the ***nx_tcp_server_socket_listen*** service.</span></span> <span data-ttu-id="d0a19-1026">Den här tjänsten placerar serverns socket i LYSSNINGs tillstånd och binder den angivna Server porten till socketen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1026">This service places the server socket in the LISTEN state and binds the specified server port to the socket.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-1027">*Om du vill ange en utgångs rutin för socket-motringning anger programmet lämplig motringning för argumentet tcp_listen_callback i **nx_tcp_server_socket_listens** tjänsten. Den här program återanrops funktionen körs sedan av NetX när en ny anslutning begärs på den här Server porten. Bearbetningen i återanropet är under program kontroll.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-1027">*To set a socket listen callback routine the application specifies the appropriate callback function for the tcp_listen_callback argument of the **nx_tcp_server_socket_listen** service. This application callback function is then executed by NetX whenever a new connection is requested on this server port. The processing in the callback is under application control.*</span></span>

<span data-ttu-id="d0a19-1028">För att godkänna förfrågningar om klient anslutning anropar programmet \***nx_tcp_server_socket_accept** _-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1028">To accept client connection requests, the application calls the \***nx_tcp_server_socket_accept** _ service.</span></span> <span data-ttu-id="d0a19-1029">Server-socketen måste antingen vara i ett LYSSNINGs tillstånd eller tillstånd som tagits emot (dvs. servern är i LYSSNINGs tillståndet och har tagit emot ett SYN paket från en klient som begär en anslutning) för att anropa tjänsten accept.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1029">The server socket must either be in a LISTEN state or a SYN RECEIVED state (i.e., the server is in the LISTEN state and has received a SYN packet from a client requesting a connection) to call the accept service.</span></span> <span data-ttu-id="d0a19-1030">En lyckad retur status från _ *_nx_tcp_server_socket_accept_*\* anger att anslutningen har kon figurer ATS och att serverns socket har tillståndet etablerad.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1030">A successful return status from _ *_nx_tcp_server_socket_accept_*\* indicates the connection has been set up and the server socket is in the ESTABLISHED state.</span></span>

<span data-ttu-id="d0a19-1031">När Server-socketen har en giltig anslutning, köas ytterligare klient anslutnings begär anden till det djup som anges av *listen_queue_size*, som skickas till \***nx_tcp_server_socket_listen** _-tjänsten.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1031">After the server socket has a valid connection, additional client connection requests are queued up to the depth specified by the *listen_queue_size*, passed into the \***nx_tcp_server_socket_listen** _ service.</span></span> <span data-ttu-id="d0a19-1032">För att kunna bearbeta efterföljande anslutningar på en server port måste programmet anropa _ *_nx_tcp_server_socket_relisten_*\* med en tillgänglig socket (t. ex. en socket i ett stängt tillstånd).</span><span class="sxs-lookup"><span data-stu-id="d0a19-1032">In order to process subsequent connections on a server port, the application must call _ *_nx_tcp_server_socket_relisten_*\* with an available socket (i.e., a socket in a CLOSED state).</span></span> <span data-ttu-id="d0a19-1033">Observera att samma server-socket kan användas om den tidigare anslutningen som är associerad med socketen nu är slutförd och socketen är i stängt tillstånd.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1033">Note that the same server socket could be used if the previous connection associated with the socket is now finished and the socket is in the CLOSED state.</span></span>

### <a name="tcp-server-disconnection"></a><span data-ttu-id="d0a19-1034">AvAnslutning av TCP-server</span><span class="sxs-lookup"><span data-stu-id="d0a19-1034">TCP Server Disconnection</span></span>

<span data-ttu-id="d0a19-1035">Att stänga anslutningen uppnås genom att anropa ***nx_tcp_socket_disconnect***.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1035">Closing the connection is accomplished by calling ***nx_tcp_socket_disconnect***.</span></span> <span data-ttu-id="d0a19-1036">Om ingen uppskjutning har angetts skickar Server-socketen ett för-paket till klientens socket och placerar socketen i stängt tillstånd.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1036">If no suspension is specified, the server socket sends a RST packet to the client socket and places the socket in the CLOSED state.</span></span> <span data-ttu-id="d0a19-1037">Annars, om en SUS Pension begärs, utförs det fullständiga TCP-från kopplings protokollet enligt följande: |</span><span class="sxs-lookup"><span data-stu-id="d0a19-1037">Otherwise, if a suspension is requested, the full TCP disconnect protocol is performed, as follows: |</span></span>

- <span data-ttu-id="d0a19-1038">Om klienten tidigare initierade en från kopplings förfrågan (Server-socketen redan har tagit emot ett RÄNTETRANS-paket, svarat på en ACK och är i nära VÄNTe läge), höjer NetX TCP socket State till det senaste bekräftelse stadiet och skickar ett RÄNTETRANS-paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1038">If the client previously initiated a disconnect request (the server socket has already received a FIN packet, responded with an ACK, and is in the CLOSE WAIT state), NetX promotes the TCP socket state to the LAST ACK state and sends a FIN packet.</span></span> <span data-ttu-id="d0a19-1039">Den väntar sedan på en bekräftelse från klienten innan du slutför från kopplingen och anger det stängda läget.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1039">It then waits for an ACK from the client before completing the disconnect and entering the CLOSED state.</span></span>

- <span data-ttu-id="d0a19-1040">Om servern å andra sidan är den första att initiera en från kopplings förfrågan (klienten har inte kopplats från och att socketen fortfarande är i det tillstånd som har ETABLERATs), skickar NetX ett RÄNTETRANS-paket för att initiera från kopplingen och väntar på att ta emot en FIN och en bekräftelse från klienten innan du slutför från kopplingen och placera socketen i ett stängt tillstånd.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1040">If on the other hand, the server is the first to initiate a disconnect request (the client has not disconnected and the socket is still in the ESTABLISHED state), NetX sends a FIN packet to initiate the disconnect and waits to receive a FIN and an ACK from the client before completing the disconnect and placing the socket in a CLOSED state.</span></span>

<span data-ttu-id="d0a19-1041">Om det fortfarande finns paket i kön för överföring av socket pausar NetX under den angivna tids gränsen för att tillåta att dessa paket bekräftas.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1041">If there are still packets on the socket transmit queue, NetX suspends for the specified timeout to allow those packets to be acknowledged.</span></span> <span data-ttu-id="d0a19-1042">Om tids gränsen går ut tömmer NetX för serverns socket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1042">If the timeout expires, NetX flushes the transmit queue of the server socket.</span></span>

<span data-ttu-id="d0a19-1043">När från kopplings bearbetningen har slutförts och Server-socketen är i stängt tillstånd måste programmet anropa tjänsten ***nx_tcp_server_socket_unaccept*** för att avsluta associationen mellan denna socket och Server porten.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1043">After the disconnect processing is complete and the server socket is in the CLOSED state, the application must call the ***nx_tcp_server_socket_unaccept*** service to end the association of this socket with the server port.</span></span> <span data-ttu-id="d0a19-1044">OBS! den här tjänsten måste anropas av programmet även om ***nx_tcp_socket_disconnect*** eller \***nx_tcp_server_socket_accept** _ returnerar en fel status.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1044">Note this service must be called by the application even if ***nx_tcp_socket_disconnect*** or \***nx_tcp_server_socket_accept** _ return an error status.</span></span> <span data-ttu-id="d0a19-1045">När _ *_nx_tcp_server_socket_unaccept_*\* returnerar kan socketen användas som en klient eller Server-socket, eller till och med tas bort om den inte längre behövs.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1045">After the _ *_nx_tcp_server_socket_unaccept_*\* returns, the socket can be used as a client or server socket, or even deleted if it is no longer needed.</span></span> <span data-ttu-id="d0a19-1046">Om du vill acceptera en annan klient anslutning på samma server port bör ***nx_tcp_server_socket_relisten*** tjänsten anropas på denna socket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1046">If accepting another client connection on the same server port is desired, the ***nx_tcp_server_socket_relisten*** service should be called on this socket.</span></span>

<span data-ttu-id="d0a19-1047">Följande kod segment illustrerar sekvensen av anrop en typisk TCP-server använder:</span><span class="sxs-lookup"><span data-stu-id="d0a19-1047">The following code segment illustrates the sequence of calls a typical TCP server uses:</span></span>

```c
/* Set up a previously created TCP socket to listen on port 12 */

nx_tcp_server_socket_listen()

/* Loop to make a (another) connection. */
while(1) {

    /* Wait for a client socket connection request for 100 ticks. */
    nx_tcp_server_socket_accept();

    /* (Send and receive TCP messages with the TCP client) */

    /* Disconnect the server socket. */
    nx_tcp_socket_disconnect();

    /* Remove this server socket from listening on the port. */

    nx_tcp_server_socket_unaccept(&server_socket);

    /* Set up server socket to relisten on the same port for the next
    client. */
    nx_tcp_server_socket_relisten();
}
```

### <a name="mss-validation"></a><span data-ttu-id="d0a19-1048">MSS-verifiering</span><span class="sxs-lookup"><span data-stu-id="d0a19-1048">MSS Validation</span></span>

<span data-ttu-id="d0a19-1049">Maximal segment storlek (MSS) är den maximala mängden byte som en TCP-värd kan ta emot utan att fragmenteras av det underliggande IP-lagret.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1049">The Maximum Segment Size (MSS) is the maximum amount of bytes a TCP host can receive without being fragmented by the underlying IP layer.</span></span> <span data-ttu-id="d0a19-1050">Under fasen för etablering av TCP-anslutningar, avslutar båda sina egna TCP-MSS-värden, så att avsändaren inte skickar ett TCP-datasegment som är större än mottagarens MSS.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1050">During TCP connection establishment phase, both ends exchanges its own TCP MSS value, so that the sender does not send a TCP data segment that is larger than the receiver's MSS.</span></span> <span data-ttu-id="d0a19-1051">NetX TCP-modul kan alternativt validera dess peers annonserade MSS-värde innan en anslutning upprättas.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1051">NetX TCP module will optionally validate its peer's advertised MSS value before establishing a connection.</span></span> <span data-ttu-id="d0a19-1052">Som standard aktiverar NetX inte någon sådan kontroll.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1052">By default NetX does not enable such a check.</span></span> <span data-ttu-id="d0a19-1053">Program som vill utföra MSS-verifieringen måste definiera ***NX_ENABLE_TCP_MSS_CHECKING** _ vid skapande av netx-biblioteket och det minsta värdet måste definieras i _*_NX_TCP_MSS_MINIMUM_\*_.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1053">Applications wishing to perform MSS validation shall define ***NX_ENABLE_TCP_MSS_CHECKING** _ when building the NetX library, and the minimum value shall be defined in _*_NX_TCP_MSS_MINIMUM_\*_.</span></span> <span data-ttu-id="d0a19-1054">Inkommande TCP-anslutningar med MSS-värden under _ *_NX_TCP_MSS_MINIMUM_*\* ignoreras.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1054">Incoming TCP connections with MSS values below _ *_NX_TCP_MSS_MINIMUM_*\* are dropped.</span></span>

### <a name="stop-listening-on-a-server-port"></a><span data-ttu-id="d0a19-1055">Stoppa lyssning på en server port</span><span class="sxs-lookup"><span data-stu-id="d0a19-1055">Stop Listening on a Server Port</span></span>

<span data-ttu-id="d0a19-1056">Om programmet inte längre vill lyssna efter klient anslutnings begär Anden på en server port som tidigare angavs av ett anrop till tjänsten \***nx_tcp_server_socket_listen** _, anropar programmet bara tjänsten _ \*_nx_tcp_server_socket_unlisten_\*\*.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1056">If the application no longer wishes to listen for client connection requests on a server port that was previously specified by a call to the ***nx_tcp_server_socket_listen** _ service, the application simply calls the _ *_nx_tcp_server_socket_unlisten_** service.</span></span> <span data-ttu-id="d0a19-1057">Den här tjänsten placerar en socket i väntan på en anslutning tillbaka i stängt tillstånd och släpper alla paket med köade klient anslutnings begär Anden.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1057">This service places any socket waiting for a connection back in the CLOSED state and releases any queued client connection request packets.</span></span>

### <a name="tcp-window-size"></a><span data-ttu-id="d0a19-1058">TCP-fönster storlek</span><span class="sxs-lookup"><span data-stu-id="d0a19-1058">TCP Window Size</span></span>

<span data-ttu-id="d0a19-1059">Under både installationen och data överförings faserna i anslutningen, rapporterar varje port mängden data som kan hanteras, vilket kallas dess fönster storlek.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1059">During both the setup and data transfer phases of the connection, each port reports the amount of data it can handle, which is called its window size.</span></span> <span data-ttu-id="d0a19-1060">När data tas emot och bearbetas justeras den här fönstrets storlek dynamiskt.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1060">As data are received and processed, this window size is adjusted dynamically.</span></span> <span data-ttu-id="d0a19-1061">I TCP kan en sändare bara skicka en mängd data som passar i mottagarens fönster.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1061">In TCP, a sender can only send an amount of data that fits into the receiver's window.</span></span> <span data-ttu-id="d0a19-1062">I själva verket ger fönster storleken flödes kontroll för data överföring i varje riktning i anslutningen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1062">In essence, the window size provides flow control for data transfer in each direction of the connection.</span></span>

### <a name="tcp-packet-send"></a><span data-ttu-id="d0a19-1063">Skicka TCP-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-1063">TCP Packet Send</span></span>

<span data-ttu-id="d0a19-1064">Det är enkelt att skicka TCP-data genom att anropa funktionen ***nx_tcp_socket_send*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-1064">Sending TCP data is easily accomplished by calling the ***nx_tcp_socket_send*** function.</span></span> <span data-ttu-id="d0a19-1065">Om storleken på de data som överförs är större än MSS-värdet för socketen eller den aktuella peer-mottagande fönster storlek, beroende på vilket som är mindre, är TCP Internal Logic carves av data som passar i min (MSS, peer Receive-fönster) för överföring.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1065">If the size of the data being transmitted is larger than the MSS value of the socket or the current peer receive window size, whichever is smaller, TCP internal logic carves off the data that fits into min (MSS, peer receive Window) for transmission.</span></span> <span data-ttu-id="d0a19-1066">Den här tjänsten skapar sedan ett TCP-huvud framför paketet (inklusive beräkning av kontroll summa).</span><span class="sxs-lookup"><span data-stu-id="d0a19-1066">This service then builds a TCP header in front of the packet (including the checksum calculation).</span></span> <span data-ttu-id="d0a19-1067">Om mottagarens fönster storlek inte är noll, skickar anroparen lika mycket data som det kan fylla i mottagarens fönster storlek.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1067">If the receiver's window size is not zero, the caller will send as much data as it can to fill up the receiver window size.</span></span> <span data-ttu-id="d0a19-1068">Om mottagnings fönstret blir noll kan anroparen pausa och vänta tills mottagarens fönster storlek ökar tillräckligt för att det här paketet ska skickas.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1068">If the receive window becomes zero, the caller may suspend and wait for the receiver's window size to increase enough for this packet to be sent.</span></span> <span data-ttu-id="d0a19-1069">Vid en specifik tidpunkt kan flera trådar pausas vid försök att skicka data via samma socket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1069">At any given time, multiple threads may suspend while trying to send data through the same socket.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-1070">*De TCP-data som finns i NX_PACKETs strukturen bör finnas på en lång ord linje. Dessutom måste det finnas tillräckligt med utrymme mellan lägga-pekaren och data start pekaren för att placera rubrikerna TCP, IP och fysisk media.*</span><span class="sxs-lookup"><span data-stu-id="d0a19-1070">*The TCP data residing in the NX_PACKET structure should reside on a long-word boundary. In addition, there needs to be sufficient space between the prepend pointer and the data start pointer to place the TCP, IP, and physical media headers.*</span></span>

### <a name="tcp-packet-retransmit"></a><span data-ttu-id="d0a19-1071">Återsändning av TCP-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-1071">TCP Packet Retransmit</span></span>

<span data-ttu-id="d0a19-1072">Tidigare skickade TCP-paket som faktiskt lagrats internt tills en ACK returneras från den andra sidan av anslutningen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1072">Previously transmitted TCP packets sent actually stored internally until an ACK is returned from the other side of the connection.</span></span> <span data-ttu-id="d0a19-1073">Om överförda data inte har bekräftats inom tids gränsen, skickas det lagrade paketet igen och nästa timeout-period anges.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1073">If transmitted data is not acknowledged within the timeout period, the stored packet is re-sent and the next timeout period is set.</span></span> <span data-ttu-id="d0a19-1074">När en ACK tas emot släpps slutligen alla paket som omfattas av bekräftelse numret i den interna överförings kön.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1074">When an ACK is received, all packets covered by the acknowledgement number in the internal transmit queue are finally released.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d0a19-1075">\* Programmet får inte återanvända paketet eller ändra paketets innehåll efter att funktionen \***nx_tcp_socket_send** _ returnerar med NX_SUCCESS.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1075">\*Application shall not reuse the packet or alter the contents of the packet after the \***nx_tcp_socket_send** _ function returns with NX_SUCCESS.</span></span> <span data-ttu-id="d0a19-1076">Det överförda paketet släpps slutligen genom intern bearbetning av NetX när data har godkänts av den andra end._</span><span class="sxs-lookup"><span data-stu-id="d0a19-1076">The transmitted packet is eventually released by NetX internal processing after the data is acknowledged by the other end._</span></span>

### <a name="tcp-keepalive"></a><span data-ttu-id="d0a19-1077">TCP keepalive</span><span class="sxs-lookup"><span data-stu-id="d0a19-1077">TCP Keepalive</span></span>

<span data-ttu-id="d0a19-1078">TCP keepalive-funktionen gör det möjligt för en socket att identifiera om dess peer-kopplas bort utan korrekt avslutning (t. ex. om motparten har kraschat) eller för att förhindra vissa nätverks övervaknings anläggningar att avsluta en anslutning under långa perioder av inaktivitet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1078">TCP Keepalive feature allows a socket to detect whether or not its peer disconnects without proper termination (for example, the peer crashed), or to prevent certain network monitoring facilities to terminate a connection for long periods of idle.</span></span> <span data-ttu-id="d0a19-1079">TCP keepalive fungerar genom att regelbundet skicka en TCP-ram utan data, och sekvensnumret anges till ett lägre värde än det aktuella sekvensnumret.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1079">TCP Keepalive works by periodically sending a TCP frame with no data, and the sequence number set to one less than the current sequence number.</span></span> <span data-ttu-id="d0a19-1080">När en sådan TCP keepalive-ram tas emot, kan mottagaren, om den fortfarande är aktiv, svara med ett ACK-värde för det aktuella sekvensnumret.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1080">On receiving such TCP Keepalive frame, the recipient, if still alive, responses with an ACK for its current sequence number.</span></span> <span data-ttu-id="d0a19-1081">Detta slutför keepalive-transaktionen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1081">This completes the keepalive transaction.</span></span>

<span data-ttu-id="d0a19-1082">Som standard är keepalive-funktionen inte aktive rad.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1082">By default the keepalive feature is not enabled.</span></span> <span data-ttu-id="d0a19-1083">Om du vill använda den här funktionen måste NetX-biblioteket skapas med \***NX_ENABLE_TCP_KEEPALIVE** _ definieras.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1083">To use this feature, NetX library must be built with \***NX_ENABLE_TCP_KEEPALIVE** _ defined.</span></span> <span data-ttu-id="d0a19-1084">Symbolen _ *_NX_TCP_KEEPALIVE_INITIAL_*\* anger antalet sekunder av inaktivitet innan keepalive-ramen initieras.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1084">The symbol _ *_NX_TCP_KEEPALIVE_INITIAL_*\* specifies the number of seconds of inactivity before the keepalive frame is initiated.</span></span>

### <a name="tcp-packet-receive"></a><span data-ttu-id="d0a19-1085">Mottagning av TCP-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-1085">TCP Packet Receive</span></span>

<span data-ttu-id="d0a19-1086">TCP Receive-paketets bearbetning (anropas från IP-hjälpens tråd) ansvarar för hantering av olika anslutnings-och från kopplings åtgärder samt överföring av bekräftelse bearbetning.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1086">The TCP receive packet processing (called from the IP helper thread) is responsible for handling various connection and disconnection actions as well as transmit acknowledge processing.</span></span> <span data-ttu-id="d0a19-1087">Dessutom ansvarar TCP Receive Packet-bearbetningen för att placera paket med ta emot data på rätt TCP-Sockets mottagande kö eller leverera paketet till den första pausade tråden som väntar på ett paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1087">In addition, the TCP receive packet processing is responsible for placing packets with receive data on the appropriate TCP socket's receive queue or delivering the packet to the first suspended thread waiting for a packet.</span></span>

### <a name="tcp-receive-notify"></a><span data-ttu-id="d0a19-1088">TCP Receive-avisering</span><span class="sxs-lookup"><span data-stu-id="d0a19-1088">TCP Receive Notify</span></span>

<span data-ttu-id="d0a19-1089">Om program tråden behöver bearbeta mottagna data från fler än en socket ska funktionen ***nx_tcp_socket_receive_notify*** användas.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1089">If the application thread needs to process received data from more than one socket, the ***nx_tcp_socket_receive_notify*** function should be used.</span></span> <span data-ttu-id="d0a19-1090">Den här funktionen registrerar en motringnings funktion för mottagnings paket för socketen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1090">This function registers a receive packet callback function for the socket.</span></span> <span data-ttu-id="d0a19-1091">När ett paket tas emot på socketen körs motringningsfunktionen.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1091">Whenever a packet is received on the socket, the callback function is executed.</span></span>

<span data-ttu-id="d0a19-1092">Innehållet i motringningsfunktionen är programspecifikt. funktionen skulle dock förmodligen innehålla logik för att informera bearbetnings tråden att ett paket är tillgängligt på motsvarande socket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1092">The contents of the callback function are application-specific; however, the function would most likely contain logic to inform the processing thread that a packet is available on the corresponding socket.</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="d0a19-1093">Tråd upphängning</span><span class="sxs-lookup"><span data-stu-id="d0a19-1093">Thread Suspension</span></span>

<span data-ttu-id="d0a19-1094">Som tidigare nämnts kan program trådar pausa vid försök att ta emot data från en viss TCP-port.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1094">As mentioned previously, application threads can suspend while attempting to receive data from a particular TCP port.</span></span> <span data-ttu-id="d0a19-1095">När ett paket har mottagits på den porten, tilldelas den första tråden inaktive rad och tråden återupptas sedan.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1095">After a packet is received on that port, it is given to the first thread suspended and that thread is then resumed.</span></span> <span data-ttu-id="d0a19-1096">En valfri timeout är tillgänglig när du pausar ett TCP Receive-paket, en funktion som är tillgänglig för de flesta NetX-tjänster.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1096">An optional timeout is available when suspending on a TCP receive packet, a feature available for most NetX services.</span></span>

<span data-ttu-id="d0a19-1097">Tråd upphängning är också tillgängligt för anslutning (både klient och Server), klient bindning och från kopplings tjänster.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1097">Thread suspension is also available for connection (both client and server), client binding, and disconnection services.</span></span>

### <a name="tcp-socket-statistics-and-errors"></a><span data-ttu-id="d0a19-1098">TCP-socket statistik och fel</span><span class="sxs-lookup"><span data-stu-id="d0a19-1098">TCP Socket Statistics and Errors</span></span>

<span data-ttu-id="d0a19-1099">Om den här inställningen är aktive rad håller NetX TCP socket Track-baserad på flera statistik och fel som kan vara användbara för programmet.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1099">If enabled, the NetX TCP socket software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="d0a19-1100">Följande statistik och fel rapporter underhålls för varje IP/TCP-instans:</span><span class="sxs-lookup"><span data-stu-id="d0a19-1100">The following statistics and error reports are maintained for each IP/TCP instance:</span></span>

- <span data-ttu-id="d0a19-1101">Totalt antal skickade TCP-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-1101">Total TCP Packets Sent</span></span>
- <span data-ttu-id="d0a19-1102">Totalt antal skickade TCP-byte</span><span class="sxs-lookup"><span data-stu-id="d0a19-1102">Total TCP Bytes Sent</span></span>
- <span data-ttu-id="d0a19-1103">Totalt antal mottagna TCP-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-1103">Total TCP Packets Received</span></span>
- <span data-ttu-id="d0a19-1104">Totalt antal mottagna TCP-byte</span><span class="sxs-lookup"><span data-stu-id="d0a19-1104">Total TCP Bytes Received</span></span>
- <span data-ttu-id="d0a19-1105">Totalt antal ogiltiga TCP-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-1105">Total TCP Invalid Packets</span></span>
- <span data-ttu-id="d0a19-1106">Totalt antal borttagna TCP-mottagna paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-1106">Total TCP Receive Packets Dropped</span></span>
- <span data-ttu-id="d0a19-1107">Totalt antal fel i TCP Receive-kontrollsumma</span><span class="sxs-lookup"><span data-stu-id="d0a19-1107">Total TCP Receive Checksum Errors</span></span>
- <span data-ttu-id="d0a19-1108">Totalt antal TCP-anslutningar</span><span class="sxs-lookup"><span data-stu-id="d0a19-1108">Total TCP Connections</span></span>
- <span data-ttu-id="d0a19-1109">Totalt antal TCP-anslutningar</span><span class="sxs-lookup"><span data-stu-id="d0a19-1109">Total TCP Disconnections</span></span>
- <span data-ttu-id="d0a19-1110">Totalt antal borttagna TCP-anslutningar</span><span class="sxs-lookup"><span data-stu-id="d0a19-1110">Total TCP Connections Dropped</span></span>
- <span data-ttu-id="d0a19-1111">Totalt antal återsändningar av TCP-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-1111">Total TCP Packet Retransmits</span></span>
- <span data-ttu-id="d0a19-1112">Skickade TCP-socket-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-1112">TCP Socket Packets Sent</span></span>
- <span data-ttu-id="d0a19-1113">Skickade TCP-socket-byte</span><span class="sxs-lookup"><span data-stu-id="d0a19-1113">TCP Socket Bytes Sent</span></span>
- <span data-ttu-id="d0a19-1114">Mottagna TCP-socket-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-1114">TCP Socket Packets Received</span></span>
- <span data-ttu-id="d0a19-1115">Mottagna TCP-socket-byte</span><span class="sxs-lookup"><span data-stu-id="d0a19-1115">TCP Socket Bytes Received</span></span>
- <span data-ttu-id="d0a19-1116">Återsändning av TCP-socket-paket</span><span class="sxs-lookup"><span data-stu-id="d0a19-1116">TCP Socket Packet Retransmits</span></span>
- <span data-ttu-id="d0a19-1117">TCP-socket-paket i kö</span><span class="sxs-lookup"><span data-stu-id="d0a19-1117">TCP Socket Packets Queued</span></span>
- <span data-ttu-id="d0a19-1118">Fel vid kontroll summa för TCP-socket</span><span class="sxs-lookup"><span data-stu-id="d0a19-1118">TCP Socket Checksum Errors</span></span>
- <span data-ttu-id="d0a19-1119">TCP-socket-tillstånd</span><span class="sxs-lookup"><span data-stu-id="d0a19-1119">TCP Socket State</span></span>
- <span data-ttu-id="d0a19-1120">Djup i överförings kön för TCP-socket</span><span class="sxs-lookup"><span data-stu-id="d0a19-1120">TCP Socket Transmit Queue Depth</span></span>
- <span data-ttu-id="d0a19-1121">Överförings fönster storlek för TCP-socket</span><span class="sxs-lookup"><span data-stu-id="d0a19-1121">TCP Socket Transmit Window Size</span></span>
- <span data-ttu-id="d0a19-1122">TCP-Sockets mottagnings fönster storlek</span><span class="sxs-lookup"><span data-stu-id="d0a19-1122">TCP Socket Receive Window Size</span></span>

<span data-ttu-id="d0a19-1123">Alla dessa statistik-och fel rapporter är tillgängliga för programmet med \***nx_tcp_info_get** _-tjänsten för total TCP-statistik och _ \*_nx_tcp_socket_info_get_\*\*-tjänsten för TCP-statistik per socket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1123">All these statistics and error reports are available to the application with the ***nx_tcp_info_get** _ service for total TCP statistics and the _ *_nx_tcp_socket_info_get_** service for TCP statistics per socket.</span></span>

## <a name="tcp-socket-control-block-nx_tcp_socket"></a><span data-ttu-id="d0a19-1124">TCP socket Control Block NX_TCP_SOCKET</span><span class="sxs-lookup"><span data-stu-id="d0a19-1124">TCP Socket Control Block NX_TCP_SOCKET</span></span>

<span data-ttu-id="d0a19-1125">Egenskaperna för varje TCP-socket finns i det associerade *NX_TCP_SOCKET* kontroll blocket som innehåller användbar information, till exempel länken till IP-datastrukturen, nätverks anslutnings gränssnittet, den bundna porten och kön för mottagnings paket.</span><span class="sxs-lookup"><span data-stu-id="d0a19-1125">The characteristics of each TCP socket are found in the associated *NX_TCP_SOCKET* control block, which contains useful information such as the link to the IP data structure, the network connection interface, the bound port, and the receive packet queue.</span></span> <span data-ttu-id="d0a19-1126">Den här strukturen definieras i filen ***nx_api. h*** .</span><span class="sxs-lookup"><span data-stu-id="d0a19-1126">This structure is defined in the ***nx_api.h*** file.</span></span>
