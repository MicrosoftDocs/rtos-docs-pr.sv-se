---
title: Kapitel 1 – Introduktion till Azure återställnings tider NetX-AutoIP
description: Azure återställnings tider NetX AutoIP-protokollet är ett protokoll som utformats för att dynamiskt konfigurera IPv4-adresser i ett lokalt nätverk.
author: philmea
ms.author: philmea
ms.date: 06/04/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: c26b4112814bb586e056246d68c2597d56df6085
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 03/22/2021
ms.locfileid: "104826850"
---
# <a name="chapter-1---introduction-to-azure-rtos-netx-autoip"></a><span data-ttu-id="2c4d4-103">Kapitel 1 – Introduktion till Azure återställnings tider NetX-AutoIP</span><span class="sxs-lookup"><span data-stu-id="2c4d4-103">Chapter 1 - Introduction to Azure RTOS NetX AutoIP</span></span>
  
<span data-ttu-id="2c4d4-104">Azure återställnings tider NetX AutoIP-protokollet är ett protokoll som utformats för att dynamiskt konfigurera IPv4-adresser i ett lokalt nätverk.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-104">The Azure RTOS NetX AutoIP Protocol is a protocol designed for dynamically configuring IPv4 addresses on a local network.</span></span> <span data-ttu-id="2c4d4-105">AutoIP är ett enkelt protokoll som använder ARP-funktioner för att utföra sin automatiska funktion för tilldelning av IP-adresser.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-105">AutoIP is a simple protocol that utilizes ARP capabilities to perform its automatic IP address assignment function.</span></span> <span data-ttu-id="2c4d4-106">AutoIP allokerar adresser i intervallet 169.254.1.0 till 169.254.254.255.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-106">AutoIP allocates addresses in the range of 169.254.1.0 through 169.254.254.255.</span></span>

## <a name="autoip-requirements"></a><span data-ttu-id="2c4d4-107">Krav för AutoIP</span><span class="sxs-lookup"><span data-stu-id="2c4d4-107">AutoIP Requirements</span></span>

<span data-ttu-id="2c4d4-108">För att kunna fungera korrekt kräver NetX AutoIP-paketet att en NetX-IP-instans redan har skapats.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-108">In order to function properly, the NetX AutoIP package requires that a NetX IP instance has already been created.</span></span> <span data-ttu-id="2c4d4-109">Dessutom måste ARP vara aktiverat på samma IP-instans.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-109">In addition, ARP must be enabled on that same IP instance.</span></span> <span data-ttu-id="2c4d4-110">NetX AutoIP-paketet har inga ytterligare krav.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-110">The NetX AutoIP package has no further requirements.</span></span>

## <a name="autoip-constraints"></a><span data-ttu-id="2c4d4-111">AutoIP-begränsningar</span><span class="sxs-lookup"><span data-stu-id="2c4d4-111">AutoIP Constraints</span></span> 

<span data-ttu-id="2c4d4-112">NetX AutoIP-protokollet implementerar kraven i RFC3927-standarden.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-112">The NetX AutoIP protocol implements the requirements of the RFC3927 standard.</span></span> <span data-ttu-id="2c4d4-113">Det finns dock följande begränsningar:</span><span class="sxs-lookup"><span data-stu-id="2c4d4-113">However, there are the following constraints:</span></span>

1. <span data-ttu-id="2c4d4-114">Om NetX DHCP används måste DHCP-tråden skapas med en högre prioritet än både NetX IP-instansnamnet och AutoIP-tråden.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-114">If NetX DHCP is used, the DHCP thread must be created with a higher priority than both the NetX IP instance thread and the AutoIP thread.</span></span>
1. <span data-ttu-id="2c4d4-115">NetX AutoIP tillhandahåller inte en mekanism för gamla IP-adresser som ska fortsätta användas.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-115">NetX AutoIP does not provide a mechanism for old IP addresses to continue being used.</span></span>
1. <span data-ttu-id="2c4d4-116">När IP-adressen ändras ansvarar programmet för att bryta ned alla befintliga TCP-anslutningar och återupprätta dem på den nya IP-adressen.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-116">When the IP address changes, the application is responsible for tearing down any existing TCP connections and re-establishing them on the new IP address.</span></span>

## <a name="autoip-protocol-implementation"></a><span data-ttu-id="2c4d4-117">Implementering av AutoIP-protokoll</span><span class="sxs-lookup"><span data-stu-id="2c4d4-117">AutoIP Protocol Implementation</span></span>

<span data-ttu-id="2c4d4-118">NetX AutoIP-protokollet väljer först en slumpmässig adress inom AutoIP IPv4-adress intervall för 169.254.1.0 via 169.254.254.255.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-118">The NetX AutoIP protocol first selects a random address within the AutoIP IPv4 address range of 169.254.1.0 through 169.254.254.255.</span></span> <span data-ttu-id="2c4d4-119">Du kan också tvinga fram en Start-IP-adress genom att tillhandahålla den ***nx_auto_ip_start*** funktionen.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-119">Alternatively, the application may force a starting IP address by providing it to the ***nx_auto_ip_start*** function.</span></span> <span data-ttu-id="2c4d4-120">Detta är användbart i situationer där en AutoIP-adress har använts i en tidigare körning.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-120">This is useful in situations where an AutoIP address was successfully used in a prior run.</span></span>

<span data-ttu-id="2c4d4-121">När du har valt en AutoIP-adress skickar NetX AutoIP ut en serie ARP-avsökningar för den valda adressen.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-121">Once an AutoIP address is selected, NetX AutoIP sends out a series of ARP probes for the selected address.</span></span> <span data-ttu-id="2c4d4-122">En ARP-avsökning består av ett meddelande om ARP-begäran med avsändar adressen satt till 0.0.0.0 och mål adressen som angetts till önskad AutoIP-adress.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-122">An ARP probe consists of an ARP request message with the sender address set to 0.0.0.0 and the target address set to the desired AutoIP address.</span></span> <span data-ttu-id="2c4d4-123">En serie med dessa ARP-avsökningar skickas (det faktiska antalet bestäms av definiera NX_AUTO_IP_PROBE_NUM).</span><span class="sxs-lookup"><span data-stu-id="2c4d4-123">A series of these ARP probes are sent (the actual number is determined by the define NX_AUTO_IP_PROBE_NUM).</span></span> <span data-ttu-id="2c4d4-124">Om en annan nätverksmapp svarar på den här avsökningen eller skickar en identisk avsökning för samma adress väljs en ny AutoIP-adress slumpmässigt i IPv4-adressintervallet för AutoIP och avsöknings bearbetningen upprepas.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-124">If another network node responds to this probe or sends an identical probe for the same address, a new AutoIP address is randomly selected within the AutoIP IPv4 address range and the probe processing repeats.</span></span>

<span data-ttu-id="2c4d4-125">Om NX_AUTO_IP_PROBE_NUM avsökningar skickas utan några svar utfärdar NetX AutoIP en serie ARP-meddelanden för den valda adressen.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-125">If NX_AUTO_IP_PROBE_NUM probes are sent without any responses, NetX AutoIP issues a series of ARP announcements for the selected address.</span></span> <span data-ttu-id="2c4d4-126">Ett ARP-meddelande består av ett meddelande om ARP-begäran med både avsändar-och mål adressen i ARP-meddelandet inställt på den valda AutoIP-adressen.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-126">An ARP announcement consists of an ARP request message with both the sender and target address in the ARP message set to the selected AutoIP address.</span></span> <span data-ttu-id="2c4d4-127">En serie med ARP-meddelanden skickas, som motsvarar det definierade NX_AUTO_IP_ANNOUNCE_NUM.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-127">A series of ARP announcement messages are sent, corresponding to the define NX_AUTO_IP_ANNOUNCE_NUM.</span></span> <span data-ttu-id="2c4d4-128">Om en annan nätverksmapp svarar på ett meddelande eller skickar ett identiskt meddelande för samma adress, väljs en ny AutoIP-adress slumpmässigt i AutoIP IPv4-adressintervallet och avsöknings bearbetningen börjar om.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-128">If another network node responds to an announce message or sends an identical announcement for the same address, a new AutoIP address is randomly selected within the AutoIP IPv4 address range and the probe processing starts over.</span></span>

<span data-ttu-id="2c4d4-129">När avsökningen och meddelandet slutförs utan några identifierade konflikter betraktas den valda AutoIP-adressen som giltig och den tillhör ande IP-instansen konfigureras med den här adressen.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-129">When the probe and announcement completes without any detected conflicts, the selected AutoIP address is considered valid and the associated IP instance is setup with this address.</span></span>

## <a name="autoip-address-change"></a><span data-ttu-id="2c4d4-130">Ändring av AutoIP-adress</span><span class="sxs-lookup"><span data-stu-id="2c4d4-130">AutoIP Address Change</span></span>

<span data-ttu-id="2c4d4-131">Som nämnts tidigare ändrar NetX AutoIP IP-instansnamnet efter lyckad avsökning och meddelande bearbetning.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-131">As mentioned before, NetX AutoIP changes the IP instance address after successful probe and announcement processing.</span></span> <span data-ttu-id="2c4d4-132">Övervakning av det här ärendet är inte terribly viktigt.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-132">Monitoring for this case is not terribly important.</span></span> <span data-ttu-id="2c4d4-133">Det är dock möjligt att låta AutoIP-adressen ändras i framtiden.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-133">However, it is possible to have the AutoIP address change in the future.</span></span> <span data-ttu-id="2c4d4-134">Potentiella orsaker är framtida AutoIP-konflikter samt DHCP-adress matchning.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-134">Potential causes include future AutoIP address conflicts as well as DHCP address resolution.</span></span> <span data-ttu-id="2c4d4-135">För att dessa potentiella situationer ska kunna bearbetas korrekt bör programmet använda följande NetX-API för att varna för alla och alla IP-adress ändringar:</span><span class="sxs-lookup"><span data-stu-id="2c4d4-135">In order to process these potential situations properly, the application should use the following NetX API to alert it of any and all IP address changes:</span></span>

```c
nx_ip_address_change_notify(NX_IP *ip_ptr,
                            VOID (*ip_address_change_notify)(NX_IP *,VOID*),
                            VOID *additional_info);
```

<span data-ttu-id="2c4d4-136">Bearbetningen i den tillhandahållna *ip_address_change_notify* funktionen måste antingen starta om netx AutoIP-processorn eller inaktivera den om DHCP har löst IP-adressen.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-136">The processing in the supplied *ip_address_change_notify* function must either restart the NetX AutoIP processor or disable it if DHCP has subsequently resolved the IP address.</span></span> <span data-ttu-id="2c4d4-137">Exempel bearbetning finns i avsnittet om *litet exempel system* .</span><span class="sxs-lookup"><span data-stu-id="2c4d4-137">Please refer to the *Small Example System* section for sample processing.</span></span>

## <a name="autoip-rfcs"></a><span data-ttu-id="2c4d4-138">AutoIP-rapporter</span><span class="sxs-lookup"><span data-stu-id="2c4d4-138">AutoIP RFCs</span></span>

<span data-ttu-id="2c4d4-139">NetX AutoIP är kompatibel med RFC3927 och relaterade RFC: er.</span><span class="sxs-lookup"><span data-stu-id="2c4d4-139">NetX AutoIP is compliant with RFC3927 and related RFCs.</span></span>